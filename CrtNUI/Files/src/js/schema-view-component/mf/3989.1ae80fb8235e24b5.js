(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[3989],{35106:(A,ta,v)=>{var F={"./add-data-source-icon.svg":66259,"./autonumber-icon.svg":96074,"./business-rule-addon-icon.svg":40153,"./call-icon.svg":1342,"./cell-icon.svg":80159,"./copy-icon.svg":92595,"./delete-icon.svg":73972,"./gauge-tile-icon.svg":51119,"./gears-icon.svg":63691,"./metric-tile-icon.svg":27890,"./padding.svg":87885,"./reset.svg":25006,"./schema-outlet-icon.svg":45115,"./settings.svg":66576,"./source-code.svg":63893,"./tab-action-add-icon.svg":70494,"./tab-action-remove-icon.svg":42702,"./undo.svg":1781};function N(n){var U=h(n);return v(U)}function h(n){if(!v.o(F,n)){var U=new Error("Cannot find module '"+n+"'");throw U.code="MODULE_NOT_FOUND",U}return F[n]}N.keys=function(){return Object.keys(F)},N.resolve=h,A.exports=N,N.id=35106},93989:(A,ta,v)=>{v.r(ta),v.d(ta,{AbstractFilterViewElementConfigFinder:()=>io,AbstractFilteringModelRelationConfigConverter:()=>oo,ActionSettingsType:()=>Z,ActionType:()=>ui,AddAccountCompactProfileCommand:()=>yr,AddAllowedResultsCommand:()=>Qi,AddApprovalListCommand:()=>qi,AddAttachmentsCommand:()=>Ki,AddCalendarCommand:()=>lr,AddCommunicationOptionsCommand:()=>fr,AddContactCompactProfileCommand:()=>vr,AddDataSourceComponent:()=>Rn,AddDataSourceItemCommand:()=>wi,AddDataSourceModule:()=>Kt,AddEntityCommand:()=>Er,AddEntityComponent:()=>ha,AddEntityDataSourceCommand:()=>Tr,AddEntityModule:()=>Jt,AddFeedCommand:()=>Ji,AddNewDataSourceItemCommand:()=>Sr,AddNextStepsCommand:()=>Zi,AddViewItemCommand:()=>Ve,AfterDesignerItemSavedCommand:()=>Xi,ApplyChangedPropertyStrategy:()=>_.ApplyChangedPropertyStrategy,AttributePropertiesDataProvider:()=>mo,AuxiliaryItemsService:()=>kn,BaseDesignGridItemComponent:()=>oi,BaseDesignerCommand:()=>g.BaseDesignerCommand,BaseInterfaceDesignerComponent:()=>an,BaseInterfaceDesignerFeatures:()=>Ba,BaseInterfaceDesignerModule:()=>wn,BindViewModelAttributeCommand:()=>Kr,BlockEventsLayerComponent:()=>ve,CENTER_CANVAS_ELEMENT:()=>bo,CHANGE_LISTENER:()=>Ya,ChangeDataSourceItemCommand:()=>Dr,ChangeEntityDataSourceCommand:()=>Or,ChangeFilterViewItemCommand:()=>Di,ChangeFolderTreeViewItemCommand:()=>Br,ChangeListenerInitializer:()=>Zn,ChangeListenerModule:()=>Xn,ChangePrimaryDataSourceCommand:()=>gr,ChangeRequestParameterBindingCommand:()=>wr,ChangeViewItemBindingCommand:()=>xr,ChangeViewItemCommand:()=>qa,ChartWidgetDisplayValueCreator:()=>Gi,ClearViewContainerCommand:()=>cr,ConfigureDataGridRelatedItemsCommand:()=>pr,ConnectedDropListService:()=>g.ConnectedDropListService,ControlDesignerToolsProvider:()=>Ei,CopyApprovalListItemCommand:()=>ur,CopyChartWidgetViewItemCommand:()=>Yi,CopyCommunicationOptionsItemCommand:()=>Cr,CopyDataGridItemCommand:()=>Ja,CopyFileListItemCommand:()=>Rr,CopyFilterViewItemCommand:()=>li,CopyFolderTreeViewItemCommand:()=>Lr,CopyGalleryItemCommand:()=>Gr,CopyIndicatorWidgetViewItemCommand:()=>er,CopyQuickFilterViewItemCommand:()=>$r,CopySummariesCommand:()=>Hr,CopySummaryItemCommand:()=>Wr,CopyViewDataSourcesItemCommand:()=>Ka,CopyViewItemCommand:()=>gn,CreateDataGridItemCommand:()=>Si,CreateExpandedDataGridItemCommand:()=>mr,CreateOrEditLookupEntityCommand:()=>Ir,CreateOrUpdateEntityBusinessRulesAddonsCommand:()=>Fr,CrtCaptionCreator:()=>H,CrtDesignElementDesigner:()=>_a,CrtDesignerAccountCompactProfileComponent:()=>qe,CrtDesignerButtonComponent:()=>pn,CrtDesignerButtonToggleGroupComponent:()=>xt,CrtDesignerCalendarComponent:()=>Xe,CrtDesignerCommand:()=>M,CrtDesignerCommunicationOptionsComponent:()=>_t,CrtDesignerContactCompactProfileComponent:()=>Ke,CrtDesignerContainerComponent:()=>zc,CrtDesignerDataGridComponent:()=>fe,CrtDesignerEntityStageProgressBarComponent:()=>At,CrtDesignerFileListComponent:()=>vt,CrtDesignerImageInputComponent:()=>Ue,CrtDesignerPhoneInputComponent:()=>We,CrtDesignerRichTextEditorComponent:()=>Mt,CrtDesignerSchemaOutletComponent:()=>Ze,CrtDesignerSummariesComponent:()=>ue,CrtDesignerSummaryItemComponent:()=>Ie,CrtDesignerTabContainerComponent:()=>dn,CrtDesignerTimelineComponent:()=>Ot,CrtDesignerTimelineTileComponent:()=>Et,CrtDroppableListComponent:()=>we,CrtReferencedListStateHandler:()=>Lt,CrtSafariInformationPanelComponent:()=>va,DEFAULT_COPY_VIEW_ITEM_COMMAND:()=>wl,DEFAULT_PLACEHOLDER_SIZE_PX:()=>ci,DEFAULT_WIDGET_WINDOW_MESSAGE_NAMES:()=>po,DataGridDisplayValueCreator:()=>zi,DataGridFilterViewElementConfigFinder:()=>na,DataGridFilteringModelRelationConfigConverter:()=>Mn,DataSourceDependencySettingService:()=>Na,DefaultEntityColumnConfigService:()=>ct,DesignElementDesignerRegistryService:()=>U,DesignElementSettingComponent:()=>Ge,DesignTimeModelGenerator:()=>ua,DesignType:()=>g.DesignType,DesignerAccountCompactProfileModule:()=>It,DesignerApprovalSchemaService:()=>_e,DesignerButtonToggleGroupModule:()=>Oe,DesignerCommOptionStateHandler:()=>ot,DesignerCommandFactoryService:()=>g.DesignerCommandFactoryService,DesignerContactCompactProfileModule:()=>Pt,DesignerContainerResizableItemComponent:()=>Sa,DesignerContainerService:()=>z,DesignerCrtCalendarModule:()=>Re,DesignerCrtCommunicationOptionsModule:()=>ft,DesignerCrtDataGridModule:()=>ge,DesignerCrtExpansionPanelModule:()=>yt,DesignerCrtFileListModule:()=>St,DesignerCrtImageInputModule:()=>Me,DesignerCrtPhoneInputModule:()=>Ae,DesignerCrtRichTextEditorModule:()=>Te,DesignerCrtSchemaOutletModule:()=>Ne,DesignerCrtSummariesModule:()=>xe,DesignerCrtSummaryItemModule:()=>Pe,DesignerCrtTabPanelModule:()=>Ee,DesignerCrtTimelineModule:()=>Fe,DesignerDataGridStateHandler:()=>Bt,DesignerDataSchemaRepository:()=>Ut,DesignerDataSourceManager:()=>$,DesignerDataSourceService:()=>te,DesignerEntityDataSourceService:()=>le,DesignerEntityService:()=>B,DesignerEntityStageProgressBarModule:()=>Vt,DesignerFeedService:()=>Ht,DesignerFileEntityService:()=>La,DesignerFileListStateHandler:()=>rt,DesignerFlexContainerComponent:()=>on,DesignerFlexContainerModule:()=>Se,DesignerGridCellComponent:()=>Un,DesignerGridColumnComponent:()=>gt,DesignerGridContainerComponent:()=>ht,DesignerGridContainerModule:()=>j,DesignerGridHoveredCellComponent:()=>rn,DesignerGridMatrixService:()=>Bn,DesignerGridResizableItemComponent:()=>pe,DesignerGridRowComponent:()=>ut,DesignerHeaderContainerComponent:()=>bt,DesignerHeaderContainerModule:()=>De,DesignerLoaderService:()=>g.DesignerLoaderService,DesignerMessageComposerChannelColumn:()=>rs,DesignerMessageComposerColumn:()=>is,DesignerMessageComposerConfigService:()=>ee,DesignerMessageComposerData:()=>es,DesignerMessageComposerEntity:()=>ts,DesignerMessageComposerEntityResponse:()=>as,DesignerMessageComposerFilter:()=>ns,DesignerMessageComposerService:()=>ke,DesignerOverlayService:()=>be,DesignerPageParametersDataSourceService:()=>zt,DesignerSettingsComponent:()=>Vn,DesignerSettingsService:()=>ga,DesignerSummaryItemColumnProvider:()=>wa,DesignerTimelineColumn:()=>ls,DesignerTimelineConfigService:()=>Be,DesignerTimelineEntity:()=>os,DesignerTimelineEntityResponse:()=>cs,DesignerTimelineFilter:()=>ss,DesignerTimelineService:()=>Wt,DesignerToolsComponent:()=>$n,DesignerToolsGroupProvider:()=>at,DesignerToolsProvider:()=>W,DesignerToolsProviderArrayItem:()=>k,DesignerToolsProviderRegistryService:()=>V,DesignerToolsService:()=>R,DesignerUndoService:()=>An,DesignerViewNodeManipulationService:()=>Fn,DisabledInputChangeViewItemCommand:()=>tr,DisplayValueCreator:()=>Zt,DisplayValueCreatorFactoryService:()=>ce,DraggableListComponent:()=>Gn,DraggableTileComponent:()=>nn,DropListRefProxy:()=>kt,DroppableListModule:()=>q,EditableTabHeaderComponent:()=>Hn,EntityDataSourceDesignerToolProvider:()=>to,FILTERING_MODEL_RELATION_CONFIG_CONVERTER_FACTORY:()=>Oi,FILTER_VIEW_ELEMENT_CONFIG_FINDERS:()=>Ti,FilterAttributeService:()=>Pn,FilterBuilderModule:()=>un,FilterDataProvidingPreprocessorsModule:()=>ka,FilterOptionsConfigResolver:()=>jt,FilterOptionsConfigResolverModule:()=>Gt,FilterTargetsService:()=>$t,FilterViewElementConfigFindersModule:()=>Va,FilterViewElementConfigProvider:()=>oe,FilterViewElementConfigSchemaProvider:()=>Dn,FilterViewElementProvider:()=>ma,FilterViewElementProviderModule:()=>On,FilteringModelRelationConfigConvertersModule:()=>Fa,FolderTreeDisplayValueCreator:()=>ki,FolderTreeService:()=>st,GridColumnsValidator:()=>Ii,GridLayoutConfigPositionApplierService:()=>zn,GridLayoutConfigPositionResolverService:()=>tn,INTERFACE_DESIGNER_FEATURE_TOKEN:()=>vs,IS_SCHEMA_CHANGED_TOKEN:()=>_o,InputDisplayValueCreator:()=>Bi,InterfaceDesignerHeaderComponent:()=>ya,InterfaceDesignerPageType:()=>ds,InterfaceDesignerPropertiesPanelWidthValidatorService:()=>de,LoadingPart:()=>g.LoadingPart,MacrosTemplateSupportChangeViewItemCommand:()=>nr,MessageComposerDisplayValueCreator:()=>ji,MetaItemDesignSettingChangesApplierService:()=>g.MetaItemDesignSettingChangesApplierService,MetaItemDesignSettingChangesMediatorService:()=>Y,MetaItemDesignSettingChangesOperation:()=>_.MetaItemDesignSettingChangesOperation,MetaItemDesignSettingsService:()=>g.MetaItemDesignSettingsService,MetaItemDesignerOpeningState:()=>X,MetaItemDesignerService:()=>J,ModelDependenciesConvertor:()=>gi,MoveToContainerCommand:()=>ar,OpenPanelAnimationService:()=>dt,PROVIDE_WIDGET_WINDOW_MESSAGES_NAMES:()=>go,PageParametersDataSourceDesignerToolProvider:()=>no,PropertiesPanelScrollService:()=>Le,RelatedComponentStoreService:()=>Qt,RemoveButtonToggleGroupViewItemCommand:()=>hr,RemoveCalendarCommand:()=>dr,RemoveChartWidgetViewItemCommand:()=>rr,RemoveCollectionViewItemCommand:()=>yi,RemoveComboBoxViewItemCommand:()=>br,RemoveDataGridViewItemCommand:()=>vi,RemoveDataSourceItemCommand:()=>Mr,RemoveFilterViewItemCommand:()=>Mi,RemoveFolderTreeViewItemCommand:()=>jr,RemoveIndicatorWidgetViewItemCommand:()=>sr,RemoveSummariesCommand:()=>Qr,RemoveTabPanelViewItemCommand:()=>qr,RemoveViewItemCommand:()=>Je,ResetFilterTargetsCommand:()=>zr,SAFARI_INFORMATION_PANEL_DEFAULT:()=>Hi,SHOULD_FILL_ROWS_OF_VISIBLE_PART:()=>ho,SHOULD_LIFT_GRID_ELEMENTS:()=>Ni,SaveEntityDataSourcesCommand:()=>Ar,SetDragCursorService:()=>Ln,SetEntityDataSourceCommand:()=>Vr,SetFilterViewElementOptionsCommand:()=>kr,SetSelectionViewElementOptionsCommand:()=>Ur,SetViewModelAttributeCommand:()=>Jr,SummariesActionsMenuProvider:()=>cn,SummariesExpandedStateService:()=>He,SummaryItemActionsMenuProvider:()=>ln,SummaryItemsProvider:()=>wt,TabPanelDisplayValueCreator:()=>Ri,TimelineTileDisplayValueCreator:()=>Li,USE_DESIGNER_LOADER_MASK:()=>g.USE_DESIGNER_LOADER_MASK,UpdateEntityDataSourceAttributesCommand:()=>Pr,UpdateEntityRelatedPageAddonCommand:()=>Nr,UpdateEntityRelatedPageAddonCommandConfig:()=>Lo,UpdateViewConfigCommand:()=>or,UpdateViewModelAttributeCommand:()=>Zr,ViewItemCommandExecutor:()=>g.ViewItemCommandExecutor,WIDGET_DESIGNERS_MAP:()=>Xr,WIDGET_WINDOW_MESSAGE_NAMES:()=>Fi,WidgetDesignerComponent:()=>Ft,WidgetDesignerModule:()=>hn,WidgetWindowMessagesModule:()=>mt,WidgetWindowMessenger:()=>qt,allowDesignContentForType:()=>Ms,changeSelected:()=>ii,convertViewConfigItems:()=>me,designerContainerComponentMixin:()=>_i,executeCommand:()=>g.executeCommand,executeCommand$:()=>g.executeCommand$,findNewItemIndex:()=>Ca,findNewItemIndexByPoint:()=>$i,generateMatrix:()=>Ui,getMacrosKey:()=>g.getMacrosKey,hotKeyHandlerMixin:()=>bi,isGridLayoutConfig:()=>fo,jsonValidator:()=>bm,listenSchemaChangesMixin:()=>si,sysImageSchemaUId:()=>ao});var F=v(8239),N=v(75903),h=v(75378),n=v(94450);class U{static registerItem(e){U._items.set(e.type,e.component)}getDesignerComponentType(e){return U._items.get(e)||null}}U._items=new Map,U.\u0275fac=function(e){return new(e||U)},U.\u0275prov=n.\u0275\u0275defineInjectable({token:U,factory:U.\u0275fac,providedIn:"root"});var g=v(16710),d=v(21322),l=v(27049);class J{constructor(e){this._designSchemaService=e,this._metaItemDesignerOpened$=new d.Subject,this._destroyed$=new d.Subject}get metaItemDesignerOpened$(){return this._metaItemDesignerOpened$.pipe((0,l.takeUntil)(this._destroyed$))}openMetaItemDesigner(e,t,a){this._metaItemDesignerOpened$.next(e?{metaItemType:e,mode:t,...a}:null)}validate(){return{isValid:!0,messages:[]}}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}J.\u0275fac=function(e){return new(e||J)(n.\u0275\u0275inject(g.DesignerSchemaService))},J.\u0275prov=n.\u0275\u0275defineInjectable({token:J,factory:J.\u0275fac});class Y{constructor(){this._subscribe$=new d.Subject,this._destroyed$=new d.Subject}publish(e){this._subscribe$.next(e)}get subscribe$(){return this._subscribe$.pipe((0,l.takeUntil)(this._destroyed$))}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}Y.\u0275fac=function(e){return new(e||Y)},Y.\u0275prov=n.\u0275\u0275defineInjectable({token:Y,factory:Y.\u0275fac});var D=v(77207);class ee{constructor(e){this._translateService=e,this._customEntityCaptionKey="Components.MessageComposer.DesignerCustomEntities",this._customEntitiesList=["Email","Feed"]}getNewViewItemConfig(e,t){const a=t.items?.length||0;return{containerName:t.name,index:a,designerTool:{defaultConfig:{type:e.typeName,defaultPropertyValues:{type:e.typeName,classes:["view-element"],sortedByColumn:e.sortedByColumn,data:e}}}}}getCaption(e){const t=e.schemaType||e.schemaName;if(this._customEntitiesList.some(a=>a===t)){const a=this._translateService.instant(this._customEntityCaptionKey+"."+t);return(0,d.of)(a?.Caption||t)}return(0,d.of)(t)}}ee.\u0275fac=function(e){return new(e||ee)(n.\u0275\u0275inject(D.TranslateService))},ee.\u0275prov=n.\u0275\u0275defineInjectable({token:ee,factory:ee.\u0275fac});class ke{constructor(e){this._defaultSortedByColumn="CreatedOn",this._defaultChannels=[{uId:(0,h.generateGuid)(),schemaType:"Email",sortedByColumn:this._defaultSortedByColumn,typeName:"crt.EmailComposer"},{uId:(0,h.generateGuid)(),schemaType:"Feed",sortedByColumn:this._defaultSortedByColumn,typeName:"crt.FeedComposer"}],this._initChannelsCaptions(e)}_initChannelsCaptions(e){const t=this._defaultChannels[0],a=this._defaultChannels[1];e.getCaption(t).subscribe(i=>t.caption=i),e.getCaption(a).subscribe(i=>a.caption=i)}getPredefinedChannels(){return(0,d.of)(this._defaultChannels)}}ke.\u0275fac=function(e){return new(e||ke)(n.\u0275\u0275inject(ee))},ke.\u0275prov=n.\u0275\u0275defineInjectable({token:ke,factory:ke.\u0275fac,providedIn:"root"});var S=v(14537);class at{get groups$(){return(0,d.of)(Object.keys(h.DesignerToolGroupType).map(e=>({items$:(0,d.of)([]),caption:this._translateService.instant(`CDK.${e}GroupCaption`),name:e,type:h.DesignerToolGroupType[e],iconName:null,styles:(0,S.DESIGNER_TOOL_GROUP_CONFIG)(e)?.styles})))}constructor(e){this._translateService=e}}at.\u0275fac=function(e){return new(e||at)(n.\u0275\u0275inject(D.TranslateService))},at.\u0275prov=n.\u0275\u0275defineInjectable({token:at,factory:at.\u0275fac,providedIn:"root"});class k{constructor(e){this.instanceType=e}}class V{constructor(e){this._injector=e}static _has(e){return!!V.designerToolsProviders.find(t=>t.instanceType===e)}static register(e){if(V._has(e))throw new Error(`Error when register ${e.name} type. Element with this type has already exist`);V.designerToolsProviders.push(new k(e))}getAll(){return(0,d.forkJoin)(V.designerToolsProviders.map(e=>{const t=e?.instanceType,a=this._injector.runInContext(()=>new t);return(0,d.of)(a)}))}}V.designerToolsProviders=[],V.\u0275fac=function(e){return new(e||V)(n.\u0275\u0275inject(n.EnvironmentInjector))},V.\u0275prov=n.\u0275\u0275defineInjectable({token:V,factory:V.\u0275fac,providedIn:"root"});class R{get groups$(){return(0,d.combineLatest)([this._getDesignerTools(),this._designerToolsGroupProvider.groups$]).pipe((0,l.map)(([e,t])=>{const a=t.filter(i=>this._getGroupDesignerTools(e,i).length!==0);return a.forEach(i=>{const o=this._getGroupDesignerTools(e,i);i.items$=(0,d.of)(o)}),a}))}constructor(e,t){this._designerToolsProviderRegistryService=e,this._designerToolsGroupProvider=t}_getGroupDesignerTools(e,t){return e.filter(a=>a.groupType===t.type)}_getDesignerTools(){return this._designerToolsProviderRegistryService.getAll().pipe((0,l.switchMap)(e=>e.length===0?(0,d.of)([]):(0,d.combineLatest)(e.map(t=>t.getItems$()))),(0,l.map)(e=>[].concat(...e)))}}R.\u0275fac=function(e){return new(e||R)(n.\u0275\u0275inject(V),n.\u0275\u0275inject(at))},R.\u0275prov=n.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac,providedIn:"root"});class W{}var _=v(52045),I=v(24709);class te{constructor(e,t,a){this.dataSourceFactory=e,this.designerSchemaService=t,this.controlExtraConfigProvider=a}clearCache(){throw new Error("method clearCache not implemented")}_filterDataSourceConfigs(e){const t=Object.entries(e).filter(([a,i])=>this.getIsMatchedDataSource(a,i));return Object.fromEntries(t)}initDesignTimeDataSources(e){const t=Object.entries(e||{});if(t.length===0)return(0,d.of)([]);const a=t.map(([i,o])=>this.dataSourceFactory.create(i,o));return(0,d.forkJoin)(a)}getIsMatchedDataSource(e,t){return t.type===this.filterDataSourceType}getDataSourcesInSchema(){return(0,d.merge)(this.designerSchemaService.schemaLoaded$,this.designerSchemaService.schemaChanged$.pipe((0,d.filter)(e=>e?.changes?.operation===this.schemaChangeOperation),(0,d.map)(e=>e?.schema))).pipe((0,d.tap)(e=>(0,_.setDataSourcesScope)(e)),(0,d.map)(e=>e?.modelConfig?.dataSources??{}),(0,d.map)(e=>this._filterDataSourceConfigs(e)))}getDataSchema(e){return this.getDataSources$().pipe((0,d.take)(1),(0,d.map)(t=>t.find(a=>a.dataSourceName===e)),(0,d.mergeMap)(t=>(t?.getSchema()??(0,d.of)(null)).pipe((0,d.take)(1))))}getDataSources$(e=null){return this.getDataSourcesInSchema().pipe((0,d.map)(t=>e?Object.fromEntries(Object.entries(t).filter(([,a])=>a.scope===e)):t),(0,d.mergeMap)(t=>this.initDesignTimeDataSources(t)))}getControlConfig(e,t,a){return(0,d.of)({})}getIsNewAttribute(e,t){return(0,d.of)(!1)}}te.\u0275fac=function(e){return new(e||te)(n.\u0275\u0275inject(I.DataSourceFactoryService),n.\u0275\u0275inject(g.DesignerSchemaService),n.\u0275\u0275inject(g.AttributeControlExtraConfigProvider))},te.\u0275prov=n.\u0275\u0275defineInjectable({token:te,factory:te.\u0275fac,providedIn:"root"});var G=v(33177),ie=v(38626),C=v(49475),Aa=v(36124),ae=v(41307),it=v(98956);class B{constructor(e,t,a,i,o,s){this._entitySchemaDesignerService=e,this._translateService=t,this._userInfo=a,this._sysSettingsService=i,this._lczToString=o,this._addonInfoFactory=s,this._schemaNamePrefixSysSettingCode="SchemaNamePrefix",this._backwardPathRegExpString=/\[(\w*):(\w*):?(\w*)?\]/,this._entityRequested=new Map,this._entityChanged$=new d.Subject,this._schemaNamePrefix=null}get schemaNamePrefix(){return this._getSchemaNamePrefix()}_getDataValueTypeNewColumnsCount(e,t,a){return e.filter(i=>i.find(o=>o.cultureName===t&&o.value?.startsWith(a))).length}_getColumnCaption(e,t,a){const i=t.type,o=a??`${h.DataValueType[i]}Column`,s=this._translateService.instant(`NewColumnSubGroup.${o}`),c=[...e.columns,...e.inheritedColumns].map(y=>y.caption),m=this._userInfo.cultureInfo.sysCultureName,b=this._getDataValueTypeNewColumnsCount(c,m,s);return{cultureName:m,value:s+" "+(b+1)}}_innerGetByName(e){if(this._entityRequested.has(e))return this._entityRequested.get(e);const t=this._entitySchemaDesignerService.initDesignItemByName(e).pipe((0,l.share)(),(0,l.tap)(()=>{this._entityRequested.delete(e)}));return this._entityRequested.set(e,t),t}_getSchemaNamePrefix(){return this._schemaNamePrefix!=null?(0,d.of)(this._schemaNamePrefix):this._sysSettingsService.getByCodes([this._schemaNamePrefixSysSettingCode]).pipe((0,l.map)(e=>e.values),(0,l.map)(e=>e[this._schemaNamePrefixSysSettingCode]),(0,l.map)(e=>e?.value||""),(0,l.tap)(e=>this._schemaNamePrefix=e))}_processChangesForReferenceSchemas(e){const t=e.findIndex(a=>a.path==="referenceSchema");if(t>=0){const a=e[t];return this.getAvailableReferenceSchemas().pipe((0,l.map)(i=>{const{name:o,uId:s}=i.find(m=>m.uId===a.value)||{},c=e.slice();return c[t]={...a,value:{name:o,uId:s}},c}))}return(0,d.of)(e)}_getEntitySchemaByName(e){return this._entitySchemaDesignerService.getEntitySchemaByName(e)}_getLocalizableValue(e){return this._lczToString.transform(new C.LocalizableStringArray(e.filter(t=>t.value)))}_getReferenceBackwardPathData(e,t,a,i){const{entitySchemaName:o}=this._getBackwardPathData(t);return e=o,t=a.shift(),i-=1,this._isBackwardPath(t)?this._getReferenceBackwardPathData(e,t,a,i):{entitySchemaName:e,columnName:t,pathParts:a,pathPartsLength:i}}_isBackwardPath(e){return new RegExp(this._backwardPathRegExpString).test(e)}_getBackwardPathData(e){const t=new RegExp(this._backwardPathRegExpString),a=e.match(t);return{entitySchemaName:a[1],relationColumn:a[2]}}_getManagerItemValueToSort(e){return e.caption?.toLowerCase().trim().replace(/"/g,"")}_sortManagerItems(e){return e.map(t=>({item:t,sortValue:this._getManagerItemValueToSort(t)})).sort((t,a)=>t.sortValue<a.sortValue?-1:t.sortValue>a.sortValue?1:0).map(({item:t})=>t)}getExistingColumns(e){return this._entitySchemaDesignerService.getExistingColumns(e)}getIsNewSchemaByUId(e){return this._entitySchemaDesignerService.getIsNewSchemaByUId(e)}getAvailableReferenceSchemas(e=!1){return this._entitySchemaDesignerService.getAvailableReferenceSchemas(e).pipe((0,l.map)(t=>this._sortManagerItems(t)))}getReferenceSchemasLookupItems(e=!1){return this.getAvailableReferenceSchemas(e).pipe((0,l.map)(t=>t.map(a=>({value:a.name,displayValue:a.caption,lowerDisplayValue:a.caption?.toLowerCase(),entityUId:a.uId}))))}findFileSchemasForReferenceSchema(e){return this._entitySchemaDesignerService.findFileSchemasForReferenceSchema(e)}checkUniqueSchemaName(e,t){return this._entitySchemaDesignerService.checkUniqueSchemaName(e,t)}getEntitySchemaNameLengthLimit(){return this._entitySchemaDesignerService.getEntitySchemaNameLengthLimit()}getByName(e){return this._getEntitySchemaByName(e).pipe((0,l.mergeMap)(t=>t?(0,d.merge)((0,d.of)(t),this._entityChanged$.pipe((0,l.filter)(a=>a===t.name),(0,l.map)(()=>t))):(0,d.merge)(this._innerGetByName(e),this._entityChanged$.pipe((0,l.filter)(a=>a===e),(0,l.mergeMap)(()=>this._getEntitySchemaByName(e))))))}getEntitySchemesDesignItems(e){let t=e.map(a=>a.schemaName);return t=t.filter(a=>!!a),t.length===0?(0,d.of)([]):(0,d.forkJoin)(t.map(a=>this._getEntitySchemaByName(a))).pipe((0,l.map)(a=>a.filter(i=>!!i)),(0,l.mergeMap)(a=>{const i=t.filter(c=>!a.find(m=>m.name===c));if(i.length===0)return(0,d.merge)((0,d.of)(a),this._entityChanged$.pipe((0,l.filter)(c=>t.includes(c)),(0,l.map)(()=>a)));const o=e.filter(c=>i.includes(c.schemaName)),s=this._entitySchemaDesignerService.initDesignItems(o).pipe((0,l.share)(),(0,l.tap)(()=>{i.forEach(c=>this._entityRequested.delete(c))}));return i.forEach(c=>{const m=s.pipe((0,l.map)(b=>b.find(y=>y.name===c)));this._entityRequested.set(c,m)}),(0,d.merge)(s.pipe((0,l.map)(c=>[...c,...a])),this._entityChanged$.pipe((0,l.filter)(c=>t.includes(c)),(0,l.mergeMap)(()=>(0,d.forkJoin)(t.map(c=>this._getEntitySchemaByName(c))))))}))}getEntityCaption(e){return e?this._entitySchemaDesignerService.getAvailableReferenceSchemas().pipe((0,l.map)(t=>t.find(a=>a.name===e)),(0,l.map)(t=>t?.caption)):(0,d.of)(null)}getEntityColumnByName(e,t){return this.getByName(e).pipe((0,l.take)(1),(0,l.map)(a=>[...a.columns,...a.inheritedColumns].find(i=>i.name===t)))}getReferenceColumn(e){let t=e.split("."),a=t.length,i=t.shift(),o=t.shift();if(this._isBackwardPath(o)){const s=this._getReferenceBackwardPathData(i,o,t,a);i=s.entitySchemaName,o=s.columnName,t=s.pathParts,a=s.pathPartsLength}return a===2?this.getEntityColumnByName(i,o):this.getEntityColumnByName(i,o).pipe((0,l.mergeMap)(s=>{if(!s)return(0,d.of)(null);const c=`${s.referenceSchema?.name}.${t.join(".")}`;return this.getReferenceColumn(c)}))}getForwardReferenceColumnCaptionByPath(e){const t=e.split("."),a=t.shift();return(0,d.combineLatest)(t.map((i,o)=>{const s=`${a}.${t.slice(0,o+1).join(".")}`;return this.getReferenceColumn(s).pipe((0,l.map)(c=>c?this._getLocalizableValue(c.caption):null))})).pipe((0,l.mergeMap)(i=>i.some(o=>o==null)?(0,d.of)(""):this.getByName(a).pipe((0,l.take)(1),(0,l.map)(o=>`${this._getLocalizableValue(o.caption)}.${i.join(".")}`))))}createDesignItem(e,t){return this._entitySchemaDesignerService.createDesignItem(e,t)}createLookupDesignItem(e,t){return this._entitySchemaDesignerService.createLookupDesignItem(e,t)}createColumn(e,t,a){return(0,d.combineLatest)([this._entitySchemaDesignerService.getEntitySchemaByName(e),this._getSchemaNamePrefix()]).pipe((0,l.map)(([i,o])=>{const s=i.createColumn(t,o);return s.caption=new C.LocalizableStringArray([this._getColumnCaption(i,s,a?.captionKey)]),s}),(0,l.tap)(i=>{this._entitySchemaDesignerService.markSchemaAsChanged(e),this._entityChanged$.next(e)}))}updateColumn(e,t,a){return this._entitySchemaDesignerService.getEntitySchemaByName(e).pipe((0,l.take)(1),(0,l.mergeMap)(i=>this._processChangesForReferenceSchemas(a).pipe((0,l.map)(o=>({schema:i,processedChanges:o})))),(0,l.map)(({schema:i,processedChanges:o})=>{const s=[...i.columns,...i.inheritedColumns].find(c=>c.name===t);return o.forEach(c=>{s[c.path]=c.value}),this._entitySchemaDesignerService.markSchemaAsChanged(e),this._entityChanged$.next(e),s}))}createOrUpdateEntityAddon(e,t,a){return this._entitySchemaDesignerService.getEntitySchemaByName(e).pipe((0,l.mergeMap)(i=>{const o=i.addons.find(c=>c.addonName===t);if(o)return o.addonConfig=(0,d.of)(a),(0,d.of)(o);const s=this._addonInfoFactory.createAddonInfo(i,t,i.parentSchema.uId,"EntitySchemaManager");return i.addons.push(s),s.addonConfig.pipe((0,l.map)(()=>(s.addonConfig=(0,d.of)(a),s)))}),(0,l.tap)(()=>{this._entitySchemaDesignerService.markSchemaAsChanged(e),this._entityChanged$.next(e)}))}updateEntity(e,t){return this._entitySchemaDesignerService.getEntitySchemaByName(e).pipe((0,l.take)(1),(0,l.map)(a=>(t?.forEach(i=>{a[i.path]=i.value,i.path==="name"&&(this._entitySchemaDesignerService.updateEntitySchemaMaps(),e=i.value.toString())}),this._entitySchemaDesignerService.markSchemaAsChanged(e),this._entityChanged$.next(e),a)))}canRemoveColumn(e,t){return(0,d.forkJoin)([this.getByName(e).pipe((0,l.take)(1)),this.getExistingColumns(e)]).pipe((0,l.map)(([a,i])=>{const o=Boolean(a.inheritedColumns.find(c=>c.name===t)),s=Boolean(i.find(c=>c.name===t));return!o&&!s}))}removeColumn(e,t){return this.getByName(e).pipe((0,l.take)(1),(0,l.map)(a=>{const i=a.columns.find(o=>o.name===t);return i&&(a.columns.deleteItemByUId(i.uId),this._entitySchemaDesignerService.markSchemaAsChanged(e),this._entityChanged$.next(e)),a}))}createOrUpdateSchemaAddon(e,t,a){return this.createOrUpdateEntityAddon(e,t,a)}getSchemaByName(e){return this.getByName(e)}clearCache(){this._entitySchemaDesignerService.clearCache()}}B.\u0275fac=function(e){return new(e||B)(n.\u0275\u0275inject(Aa.EntitySchemaDesignerService),n.\u0275\u0275inject(D.TranslateService),n.\u0275\u0275inject(C.UserInfo),n.\u0275\u0275inject(ae.SysSettingsService),n.\u0275\u0275inject(C.LczToStringPipe),n.\u0275\u0275inject(it.AddonInfoFactory))},B.\u0275prov=n.\u0275\u0275defineInjectable({token:B,factory:B.\u0275fac});class es{}class ts{}class ns{}class as{}class is{}class rs{}class os{}class ss{}class cs{}class ls{}class ds{}var X;(function(r){r[r.Add=0]="Add",r[r.Edit=1]="Edit",r[r.Init=2]="Init"})(X||(X={}));const ao="93986bfe-2dbd-46bc-9bf9-d03dfefbf3b8";class le extends te{constructor(e,t,a,i,o){super(a,e,o),this._designerSchemaService=e,this._designerEntityService=t,this._factory=a,this._featureValues=i,this._dataSourcesInitialized=!1,this._runtimeSchemaCacheInvalidationBroadcastService=(0,n.inject)(G.BroadcastChannelFactory).createInstance(I.SCHEMA_CHANGED_INVALIDATE_CACHE_CHANNEL_NAME),this.schemaChangeOperation=_.MetaItemDesignSettingChangesOperation.CreateDataSource,this.filterDataSourceType="crt.EntityDataSource",this.attributeConfigProvider=(0,n.inject)(g.EntityDataSourceAttributeConfigProvider),this._entitySchemaService=(0,n.inject)(C.EntitySchemaService),this.attributeChanged$=new d.Subject}_getDataSourcesInfo(e){return e?Object.keys(e).filter(a=>e[a].type===this.filterDataSourceType).map(a=>({dataSourceName:a,entitySchemaName:e[a].config.entitySchemaName,hiddenInPageDesigner:e[a].hiddenInPageDesigner,scope:e[a].scope,config:e[a].config})):[]}_getDataSourceReferencePaths(e){if(!e)return[];const t=e.attributes;return Object.values(t??{}).filter(a=>a&&a.type===h.DataSchemaAttributeType.ForwardReferenceAttribute).map(a=>a.path)}_enrichDataSource(e){return this._designerEntityService.getByName(e.entitySchemaName).pipe((0,d.map)(t=>(e.entitySchema=t,e.entitySchemaName=t.name,e)))}_enrichDataSources(e){if(e.length===0)return(0,d.of)(e);if(this._featureValues?.DisableGetSchemaDesignItemsOptimization)return(0,d.combineLatest)([...e.map(a=>this._enrichDataSource(a))]);const t=e.map(a=>({schemaName:a.entitySchemaName,forwardReferencePaths:this._getDataSourceReferencePaths(a.config)}));return this._designerEntityService.getEntitySchemesDesignItems(t).pipe((0,d.map)(a=>(e.forEach(i=>{i.entitySchema=a.find(o=>o.name===i.entitySchemaName)}),e)))}_removeAttributeDataSourceBinding(e,t){const a=this._designerSchemaService.getDataSourceConfigByName(t);return a?.attributes&&(delete a.attributes[e],this._designerSchemaService.bindDataSource(t,a)),(0,d.of)(null)}_getRemoveColumnInfo(e,t){return this.getDataSchema(e).pipe((0,d.mergeMap)(a=>this._designerEntityService.canRemoveColumn(a.name,t).pipe((0,d.map)(i=>({schema:a,canRemoveColumn:i})))))}_getSchemaNameByDataSourceName(e){return this.getDataSchema(e).pipe((0,d.map)(t=>t?.dataSourceConfig?.config?.entitySchemaName))}_getIsImageLookupColumn(e){return e.dataValueType===h.DataValueType.IMAGELOOKUP}_getIsAutonumberColumn(e){return e.isAutonumber}_getColumnUpdateConfig(e){const t=[];return this._getIsImageLookupColumn(e)&&t.push({path:"referenceSchema",value:ao},{path:"isValueCloneable",value:!1}),this._getIsAutonumberColumn(e)&&t.push({path:"defValue",value:{valueSourceType:h.DefaultValueSource.Sequence,sequenceNumberOfChars:ie.DEFAULT_SEQUENCE_NUMBER_OF_CHARS,sequencePrefix:""}},{path:"isMultiLineText",value:!1},{path:"isLocalizableText",value:!1},{path:"isMasked",value:!1},{path:"isFormatValidated",value:!1},{path:"isValueCloneable",value:!1}),t}_getShouldUpdateColumn(e){return this._getIsImageLookupColumn(e)||this._getIsAutonumberColumn(e)}_getColumnType(e,t){var a=this;return(0,d.from)((0,F.Z)(function*(){const i=e.split(".");let o=t.entitySchema.name;if(i.length===1)return t.entitySchema.columns?.find(m=>m.name===e)?.type;let s;do{const c=i.shift();if(s=(yield a._entitySchemaService.getEntitySchemaByName(o).toPromise()).entitySchema?.columns?.find(b=>b.name===c),o=s?.referenceSchemaName,!s)return null}while(i.length>0);return s.dataValueType})())}_getControlType(e,t){return e&&this.attributeConfigProvider.getControlTypeToReplace(e,t)||t}_updateReferenceAttributes(e,t,a){const i=this._designerSchemaService.getDataSourceConfigByName(e);let o=!1;const s=new RegExp(`^\\b${t}\\b`),c=Object.entries(i.attributes??{}).map(([m,b])=>[m,b]).map(([m,b])=>{let y=b;if(b.type===h.DataSchemaAttributeType.ForwardReferenceAttribute&&s.test(b.path)){o=!0;const T=b.path.replace(s,a);y={...b,path:T}}return[m,y]});o&&this._designerSchemaService.bindDataSource(e,{...i,attributes:Object.fromEntries(c)})}_updateDependencies(e,t,a){const i=this._designerSchemaService.getModelDependencies(),o=i[e];if(o){const c=new RegExp(`^${t}`),m=o.map(b=>c.test(b.attributePath)?{attributePath:b.attributePath.replace(c,a),relationPath:b.relationPath}:b);this._designerSchemaService.setModelDependency(e,m)}this._designerSchemaService.getDependentModelsNames(e,t).forEach(c=>{const b=i[c].map(y=>y.relationPath.startsWith(`${e}.${t}`)?{attributePath:y.attributePath,relationPath:y.relationPath.replace(`${e}.${t}`,`${e}.${a}`)}:y);this._designerSchemaService.setModelDependency(c,b)})}_getColumnByPath(e,t){if(!e)return(0,d.of)(null);if(e.split(".").length===1){const a=t.entitySchema,i=[...a.columns,...a.inheritedColumns].find(o=>o.name===e);return(0,d.of)(i)}return this._designerEntityService.getReferenceColumn(`${t.entitySchemaName}.${e}`)}getDataSourcesInfo$(){return this.getDataSourcesInSchema().pipe((0,d.map)(e=>this._getDataSourcesInfo(e)),(0,d.mergeMap)(e=>this._enrichDataSources(e)))}initDataSources(e){if(this._dataSourcesInitialized)return(0,d.of)(e);const t=Object.values(e).map(a=>({schemaName:a.config.entitySchemaName,forwardReferencePaths:this._getDataSourceReferencePaths(a.config)}));return this._designerEntityService.getEntitySchemesDesignItems(t).pipe((0,d.map)(()=>e),(0,d.tap)(()=>{this._dataSourcesInitialized=!0}))}getDataSources$(e=null){return this.getDataSourcesInSchema().pipe((0,d.mergeMap)(t=>this.initDataSources(t)),(0,d.map)(t=>e?Object.fromEntries(Object.entries(t).filter(([,a])=>a.scope===e)):t),(0,d.mergeMap)(t=>this.initDesignTimeDataSources(t)))}getForwardReferenceAttributeCaptionByPath$(e){const t=e.split("."),a=t.shift();return this.getDataSchema(a).pipe((0,d.mergeMap)(i=>this._designerEntityService.getForwardReferenceColumnCaptionByPath(`${i.name}.${t.join(".")}`)))}createDataSourceConfig(e){return{type:C.DataSourceType.EntityDataSource,config:{entitySchemaName:e.entitySchemaName}}}getIsNewAttribute(e,t){return this.getDataSchema(e).pipe((0,l.switchMap)(a=>(0,d.forkJoin)([this._designerEntityService.getEntityColumnByName(a.name,t),this._designerEntityService.getExistingColumns(a.name)])),(0,d.map)(([a,i])=>Boolean(a)&&!i.some(o=>o.uId===a.uId)))}invalidateRuntimeSchemaCache(e){this._runtimeSchemaCacheInvalidationBroadcastService.publish({schemaName:e})}removeAttribute(e){const a=this._designerSchemaService.getMappedDataSourceAttributePath(e).split("."),i=a.shift(),o=a.join(".");return this._getRemoveColumnInfo(i,o).pipe((0,d.mergeMap)(({schema:s,canRemoveColumn:c})=>{const m=s.attributes.find(b=>b.name===o);if(m){if(m.attributeType===h.DataSchemaAttributeType.ForwardReferenceAttribute)return this._removeAttributeDataSourceBinding(o,i);if(m.attributeType===h.DataSchemaAttributeType.OwnAttribute&&c)return this._designerEntityService.removeColumn(s.name,o).pipe((0,d.map)(()=>null))}return(0,d.of)(null)}))}removeAttributeOnViewElementDelete(e){return this.removeAttribute(e)}changeAttribute(e,t,a){let i=null;return this._getSchemaNameByDataSourceName(e).pipe((0,l.take)(1),(0,d.tap)(o=>i=o),(0,l.switchMap)(o=>{if(o){const s=a.find(c=>c.path==="name");return s&&(this._updateReferenceAttributes(e,t,s.value),this._updateDependencies(e,t,s.value)),this._designerEntityService.updateColumn(o,t,a)}return(0,d.of)({})}),(0,l.switchMap)(o=>(this.invalidateRuntimeSchemaCache(i),(0,d.of)({dataValueType:o.type,isMultiLineText:Boolean(o.isMultiLineText)}))),(0,d.tap)(()=>{this.attributeChanged$.next({dataSourceName:e,attributeName:t,changes:a})}))}createAttribute(e){let t=null,a=null;const i=e.dataSourceConfig;return this._getSchemaNameByDataSourceName(i.dataSourceName).pipe((0,l.take)(1),(0,d.tap)(o=>t=o),(0,l.switchMap)(o=>this._designerEntityService.createColumn(o,e.dataValueType,{captionKey:i.captionKey})),(0,l.switchMap)(o=>(a=o.name,this._getShouldUpdateColumn(e)?this._designerEntityService.updateColumn(t,o.name,this._getColumnUpdateConfig(e)):(0,d.of)(o))),(0,d.map)(()=>(this._featureValues?.UseRequireEntitySchema8x||this.invalidateRuntimeSchemaCache(t),a)))}getControlConfig(e,t,a){let i={};return this.getDataSourcesInfo$().pipe((0,l.take)(1),(0,l.switchMap)(o=>{const s=o.find(c=>c.dataSourceName===t);return this._getColumnByPath(a,s).pipe((0,d.map)(c=>({column:c,dataSource:s})))}),(0,l.switchMap)(({column:o,dataSource:s})=>(i={...this.controlExtraConfigProvider.getControlExtraConfig(e,o?.type,o?.isMultiLineText)},this._getColumnType(a,s))),(0,d.map)(o=>{const s=this._getControlType(o,e);return s!==e&&(i.type=s),i}))}clearCache(){this._dataSourcesInitialized=!1,this._designerEntityService.clearCache()}}le.\u0275fac=function(e){return new(e||le)(n.\u0275\u0275inject(g.DesignerSchemaService),n.\u0275\u0275inject(B),n.\u0275\u0275inject(I.DataSourceFactoryService),n.\u0275\u0275inject(C.FEATURE_VALUES),n.\u0275\u0275inject(g.AttributeControlExtraConfigProvider))},le.\u0275prov=n.\u0275\u0275defineInjectable({token:le,factory:le.\u0275fac,providedIn:"any"});class zt extends te{constructor(e,t,a,i){super(a,e,i),this._designerSchemaService=e,this._lczToString=t,this._factory=a,this.schemaChangeOperation=_.MetaItemDesignSettingChangesOperation.ParameterChanged,this.filterDataSourceType="crt.PageParametersDataSource",this.attributeConfigProvider=(0,n.inject)(g.PageParametersDataSourceAttributeConfigProvider)}_adaptChange(e){switch(e.path){case"requirementType":return{...e,path:"required",value:e.value===it.AttributeRequirementType.YES};case"type":return{...e,path:"dataValueType"};case"referenceSchema":return{...e,path:"referenceSchemaUId"};default:return e}}createDataSourceConfig(e){return{config:{parameters:{}},scope:h.DataSourceScope.Page,type:C.DataSourceType.PageParametersDataSource}}getForwardReferenceAttributeCaptionByPath$(e){const t=e.split("."),a=t.shift();return this.getDataSchema(a).pipe((0,d.map)(i=>{const o=t[t.length-1],s=i.dataSourceConfig.config.parameters[o],c=this._lczToString.transform(s?.caption);return{dataSourceCaption:i.caption,parameterCaption:c}}),(0,d.map)(({dataSourceCaption:i,parameterCaption:o})=>`${i}.${o}`))}removeAttribute(e){return this._designerSchemaService.removeParameter(e),(0,d.of)(void 0)}removeAttributeOnViewElementDelete(e){return(0,d.of)(void 0)}changeAttribute(e,t,a){const i=a.map(this._adaptChange);return this._designerSchemaService.updateParameter(t,i).pipe((0,d.map)(o=>({dataValueType:o?.dataValueType})))}createAttribute(e){const t=e.dataSourceConfig;return this._designerSchemaService.createParameter(e.name,e.dataValueType,{captionKey:t?.captionKey}).pipe((0,d.map)(a=>a.name))}getControlConfig(e,t,a){return this.getDataSchema(t).pipe((0,d.map)(i=>{const o=i.attributes.find(m=>m.name===a),s={...this.controlExtraConfigProvider.getControlExtraConfig(e,o?.dataValueType,!1)},c=this.attributeConfigProvider.getConfigByType(o?.dataValueType)?.controlType;return c!==e&&(s.type=c),s}))}}zt.\u0275fac=function(e){return new(e||zt)(n.\u0275\u0275inject(g.DesignerSchemaService),n.\u0275\u0275inject(C.LczToStringPipe),n.\u0275\u0275inject(I.DataSourceFactoryService),n.\u0275\u0275inject(g.AttributeControlExtraConfigProvider))},zt.\u0275prov=n.\u0275\u0275defineInjectable({token:zt,factory:zt.\u0275fac,providedIn:"any"});var p=v(74742),ms=v(6523),vm=v(90093);function Pi(){return function(r){V.register(r)}}let Ei=class extends W{constructor(){super(...arguments),this._featureService=(0,n.inject)(ae.FeatureService),this._designItemsIconsProvider=(0,n.inject)(g.DesignItemsIconsProvider),this._injector=(0,n.inject)(n.Injector)}_getAvailablePackages(e){const t=new h.EntitySchemaQuery("VwSysPackages");return t.addSchemaColumn("Name"),t.filters.addSchemaColumnInFilterWithParameters(h.ComparisonType.Equal,"Name",e),this._injector.get(ms.QueryExecutor).executeSelectQuery(t).pipe((0,l.map)(i=>i.map(o=>o.Name)))}_getFeaturesState(e){return this._featureService.getFeaturesState(e).pipe((0,l.mergeMap)(t=>{const a={};return t.forEach((i,o)=>{const s=e[o];a[s]=i}),(0,d.of)(a)}),(0,l.defaultIfEmpty)({}))}_sortByPosition(e,t){return e.position-t.position}_getAddItemCommand(e,t){return h.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos.get(e)?.designViewItemCommands?.create||t||"crt.AddViewItemCommand"}_getConfigCollection(e){return e instanceof Array?e:[e]}getItems$(){const e=this._injector.get(S.ToolbarViewElementConfigResolver),t=this._injector.get(D.TranslateService),a=e.getDesignViewElementConfigs();let i=[];for(const[c,m]of a.entries())[...this._getConfigCollection(m)].forEach(b=>{const y=this._getAddItemCommand(c,b.addCommandTypeName),T={name:c,id:b.id,caption:t.instant(b.caption),hint:b.hint&&t.instant(b.hint),iconName:this._designItemsIconsProvider.registerIconAndGetIconName(b.icon),addCommandTypeName:y,defaultConfig:{type:c,defaultPropertyValues:b.defaultPropertyValues,defaultLocalizableStrings:b.defaultLocalizableStrings},canDrop:!0,groupType:b.groupType,position:b.position||Number.MAX_VALUE,requiredPackages:b.requiredPackages||[],requiredFeatures:b.requiredFeatures||{}};i.push(T)});i.sort(this._sortByPosition);const o=i.filter(c=>!!c.requiredPackages?.length).flatMap(c=>c.requiredPackages),s=i.filter(c=>!!c.requiredFeatures).map(c=>Object.keys(c.requiredFeatures)).flatMap(c=>c).filter((c,m,b)=>b.indexOf(c)===m);return(0,d.forkJoin)([this._getAvailablePackages(o),this._getFeaturesState(s)]).pipe((0,l.map)(([c,m])=>(c&&(i=i.filter(b=>b.requiredPackages?.every(y=>c.includes(y))??!0)),m&&(i=i.filter(b=>b.requiredFeatures?Object.keys(b.requiredFeatures).every(T=>m[T]===b.requiredFeatures[T]):!0)),i)),(0,l.share)())}};Ei=(0,p.__decorate)([Pi()],Ei);class de{isValid(e){return e>=de.panelMinWidth&&e<=de.panelMaxWidth}}de.panelMaxWidth=600,de.panelMinWidth=350,de.\u0275fac=function(e){return new(e||de)},de.\u0275prov=n.\u0275\u0275defineInjectable({token:de,factory:de.\u0275fac});var O=v(55770);class kt{constructor(e){this._connectedDropListService=e,this._destroyed$=new d.Subject,this._connectedDropListService.connectedDropList$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(t=>O.DropListRef.registeredContainers=t)}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}kt.\u0275fac=function(e){return new(e||kt)(n.\u0275\u0275inject(g.ConnectedDropListService))},kt.\u0275prov=n.\u0275\u0275defineInjectable({token:kt,factory:kt.\u0275fac,providedIn:"root"});var u=v(34038),pi=v(46338),x=v(97600);class ${constructor(e,t){this._entityDataSourceService=e,this._pageParametersDataSourceService=t}get services(){return[this._entityDataSourceService,this._pageParametersDataSourceService]}_getDataSources$(e=null){return(0,d.zip)(this.services.map(t=>this._getDataSourcesDesignInfo(t,e))).pipe((0,l.map)(t=>[].concat(...t)))}_getDataSourcesDesignInfo(e,t){return e.getDataSources$(t).pipe((0,l.map)(a=>a.map(i=>({dataSource:i,designerService:e}))))}getDataSourceServiceByDataSourceName(e){return this.getDataSourceDesignInfoByName$(e).pipe((0,l.map)(t=>t?.designerService))}getDataSources$(e=null){return this._getDataSources$(e).pipe((0,l.map)(t=>t.map(a=>a.dataSource)))}getDataSourceSchemaByName$(e){return this.getDataSources$().pipe((0,l.take)(1),(0,l.map)(t=>t.find(a=>a.dataSourceName===e)),(0,l.mergeMap)(t=>t?t.getSchema().pipe((0,l.take)(1)):(0,d.of)(null)))}getDataSourceByName$(e){return this.getDataSources$().pipe((0,l.map)(t=>t.find(a=>a.dataSourceName===e)),(0,l.take)(1))}getDataSourceDesignInfoByName$(e){return this._getDataSources$().pipe((0,l.map)(t=>t.find(a=>a.dataSource.dataSourceName===e)),(0,l.take)(1))}}$.\u0275fac=function(e){return new(e||$)(n.\u0275\u0275inject(le),n.\u0275\u0275inject(zt))},$.\u0275prov=n.\u0275\u0275defineInjectable({token:$,factory:$.\u0275fac});class Bt extends pi.BaseDataGridStateHandlerService{constructor(e,t,a,i,o,s){super(e),this.schemaService=e,this.designerCommandFactoryService=t,this.designerEntityService=a,this.translateService=i,this.dataSourceManager=o,this._featureValues=s,this.typeName="DataGrid",this.defaultColumnCodes=[]}_updateDataSourceAttributes(e){const{columns:t,dataSourceName:a}=e,i=t.filter(c=>c.columnType!=="tools").map(c=>c.code).map(c=>c.split(`${a}_`).pop()),o=(0,x.uniq)(i),s={dataSourceName:a,dataSourceAttributePaths:o,columns:(0,x.cloneDeep)(t)};return this.designerCommandFactoryService.create("crt.UpdateEntityDataSourceAttributes",s)}_updateViewModelAttribute(e){const{viewElementConfig:t,columns:a,dataSourceName:i}=e,s=t.items.toString().split("$").pop(),c=a.filter(y=>y.columnType!=="tools").map(y=>y.code).map(y=>(0,C.removeSpecialSymbols)(y)).map(y=>y.split(`${i}_`).pop());t.primaryColumnName&&c.push(t.primaryColumnName.split(`${i}_`).pop());const m=(0,x.uniq)(c),b={attribute:s,dataSourceName:i,value:m,collectionAttributePrefix:`${i}_`,strategy:_.ApplyChangedPropertyStrategy.Override};return this.designerCommandFactoryService.create("crt.BindViewModelAttributeCommand",b)}_addColumnsToChanges(e,t,a){const i=this._getColumnsWithMacrosCaption(e,a);t.push({path:"itemConfig.columns",value:i,applyPropertyStrategy:_.ApplyChangedPropertyStrategy.Override})}_getColumnsWithMacrosCaption(e,t){const i=this.schemaService.getViewConfigInfoByName(t).viewConfig.columns,s=((typeof i=="string"?[]:i)??[]).reduce((c,m)=>({...c,[m.id]:m.caption}),{});return e.map(c=>{const m=(0,x.cloneDeep)(c),b=(0,C.removeSpecialSymbols)(m.code);let y=s[m.id],T;return(m.captionResourcesChanged||!y)&&(T=`#ResourceString(${b})#`),!y&&(m.aggregationConfig?.aggregationFunction||m.changed)&&this._featureValues?.DisableGridColumnCaptionMacroFix&&(T=`#ResourceString(${t}_${m.id.split("-")[0]})#`),y=T||y,delete m.aggregationConfig,delete m.captionResources,delete m.originalCaption,delete m.captionResourcesChanged,delete m.changed,{...m,code:b,caption:y}})}_addResourcesToChanges(e,t,a){const i=this.translateService.currentLang;e.filter(s=>s.captionResourcesChanged).forEach(s=>{if(s.aggregationConfig?.aggregationFunction||s.changed){const c=this._getCaption(s,i);if(c){let m=(0,C.removeSpecialSymbols)(s.code);this._featureValues?.DisableGridColumnCaptionMacroFix&&(m=`${a}_${s.id.split("-")[0]}`),t.push({name:m,value:c})}}})}_getCaption(e,t){return this._isCaptionLocalizable()?e.captionResources&&e.captionResourcesChanged?e.captionResources:null:this._getLocalizableModel(e.caption,t)}_isCaptionLocalizable(){return this._featureValues.DataGridDesignTimeLocalizableTitle}_getLocalizableModel(e,t){const a=new C.LocalizableStringArray;return a.setValueLocalizableString(t,e),a}_createColumnCaptionResourceMacros(e,t){return`#ResourceString(${e}_${t})#`}_getEntitySchemaDisplayColumn(e,t){if(e.primaryDisplayColumn)return this.createColumnDefinition(e.primaryDisplayColumn,t);const a=[...e.columns,...e.inheritedColumns];if(a.length>0){let i=a.find(o=>o.type===h.DataValueType.Text||o.type===h.DataValueType.SHORT_TEXT||o.type===h.DataValueType.PHONE_TEXT||o.type===h.DataValueType.WEB_TEXT||o.type===h.DataValueType.EMAIL_TEXT||o.type===h.DataValueType.MEDIUM_TEXT);return i=i||a[0],this.createColumnDefinition(i,t)}}_createOrChangeDataSource(e,t){if(this.schemaService.isDataSourceExists(e)){const a=this.schemaService.getDataSourceConfigByName(e);a.entitySchemaName=t,this.schemaService.bindDataSource(e,a)}else this.schemaService.createDataSource(e,{type:"crt.EntityDataSource",scope:h.DataSourceScope.ViewElement,config:{entitySchemaName:t}})}_getDefaultColumns(e,t){const a=[...e.columns,...e.inheritedColumns],i=[];return this.defaultColumnCodes.forEach(o=>{const s=a.find(c=>c.name===o);s&&i.push(this.createColumnDefinition(s,t))}),i}getUpdateViewItemCommand(e){const{viewElementConfig:t,columns:a}=e,i=[{path:"itemConfig.items",value:t.items},{path:"itemConfig.primaryColumnName",value:t.primaryColumnName,applyPropertyStrategy:_.ApplyChangedPropertyStrategy.Override}],o=t.name;this._addColumnsToChanges(a,i,o);const s=[];this._addResourcesToChanges(a,s,o);const c={name:t.name,changes:i,resourceChanges:s,selectOnCanvas:!1};return this.designerCommandFactoryService.create("crt.ChangeViewItemCommand",c)}createColumnDefinition(e,t){return{id:(0,h.generateGuid)(),code:`${t}_${e.name}`,caption:this._createColumnCaptionResourceMacros(t,e.name),dataValueType:e.type}}getViewModelAttributeConfig(e){const t={isCollection:!0,modelConfig:{path:e},viewModelConfig:{attributes:{}}};if(this.defaultSorting){const a={sortingConfig:{default:[this.defaultSorting]}};t.modelConfig={...t.modelConfig,...a}}return t}createViewModelAttribute(e,t){if(!(e.items===void 0||(0,_.isBindingExpression)(e.items)))return;e.items||(e.items??(e.items=`$${(0,u.createDataGridItemsAttributeName)(e)}`));const i=(0,_.parseExpression)(e.items).attributePath;if(this.schemaService.isViewModelAttributeExists(i))return;const o=this.getViewModelAttributeConfig(t);this.schemaService.createViewModelAttribute(i,o)}innerHandle(e){const t=[this._updateDataSourceAttributes(e),this._updateViewModelAttribute(e),this.getUpdateViewItemCommand(e)];return(0,d.concat)(...t).pipe((0,l.switchMap)(a=>a.execute()),(0,l.last)(),(0,l.map)(()=>{}))}getColumnsChangedConfig(e,t,a){let i=[];!t.columns&&this.defaultColumnCodes.length&&(i=this._getDefaultColumns(e,a));const o=this._getEntitySchemaDisplayColumn(e,a);let s=[...i];return s.find(c=>c.code===o.code)||(s=[...s,o]),{columns:s,viewElementConfig:t,dataSourceName:a}}applyColumns(e,t,a){return this.designerEntityService.getByName(t).pipe((0,l.take)(1),(0,l.switchMap)(i=>{e.primaryColumnName=i.primaryColumn?`${a}_`+i.primaryColumn.name:void 0;const o=this.getColumnsChangedConfig(i,e,a);return this.innerHandle(o)}))}getColumnsFromSchema(e){const t=e?.columns??[];if(typeof t=="string"){const a=t.split("$").pop(),i=this.schemaService.getViewModelAttribute(a);if("value"in i&&i.value instanceof Array)return(0,d.of)(i.value)}return(0,d.of)(t)}getDataSourceName(e){if(typeof e.items=="string"&&e.items.startsWith("$")){const t=e.items.split("$").pop();return(0,d.of)(this.schemaService.getMappedDataSourceAttributePath(t))}return(0,d.of)(void 0)}handleEntitySelect(e,t,a){return a||(a=e.name||`${this.typeName}${(0,h.generateGuid)()}`,a+=I.DATA_SOURCE_PREFIX),this._createOrChangeDataSource(a,t),this.createViewModelAttribute(e,a),this.applyColumns(e,t,a)}}Bt.\u0275fac=function(e){return new(e||Bt)(n.\u0275\u0275inject(g.DesignerSchemaService),n.\u0275\u0275inject(g.DesignerCommandFactoryService),n.\u0275\u0275inject(B),n.\u0275\u0275inject(D.TranslateService),n.\u0275\u0275inject($),n.\u0275\u0275inject(C.FEATURE_VALUES))},Bt.\u0275prov=n.\u0275\u0275defineInjectable({token:Bt,factory:Bt.\u0275fac});class gi{static toModelsDependenciesConfig(e,t){const a={...e},i={};return Object.keys(a).forEach(o=>{i[o]=a[o].filter(s=>!(0,x.isEmpty)(s)&&Object.values(s).every(c=>!(0,x.isNil)(c))).map(s=>{const b=t.dataSources?.[s.matchedDsName].config?.attributes?.[s.matchedDsAttributeName]?.path??s.matchedDsAttributeName;return{attributePath:s.targetDsAttributeName,relationPath:`${s.matchedDsName}.${b}`}})}),i}static toDependenciesSettings(e,t){const a={...e},i={};return Object.keys(a).forEach(o=>{i[o]=a[o].map(s=>{const c=s.relationPath.split("."),m=c.shift(),b=t.dataSources?.[m]?.config,y=c.join("."),T=Object.keys(b?.attributes??{}).find(L=>b?.attributes?.[L]?.path===y)??y;return{targetDsAttributeName:s.attributePath,targetDsName:o,matchedDsName:m,matchedDsAttributeName:T}})}),i}}class io{}class na extends io{constructor(e){super(),this._schemaService=e}_getBoundFilterViewConfigInfo(e){if(!e)return[];const t=this._schemaService.findAttributeByDataSourceAttributePath(e);return t?this._schemaService.getViewConfigInfoByFilter(i=>i.type==="crt.DataGrid"&&i.items===`$${t}`)??[]:[]}getBoundFilterViewElements(e){return this._getBoundFilterViewConfigInfo(e).map(t=>t.viewConfig)}isBoundToFilterViewElement(e){return this._getBoundFilterViewConfigInfo(e).length>0}}na.\u0275fac=function(e){return new(e||na)(n.\u0275\u0275inject(_.SchemaService))},na.\u0275prov=n.\u0275\u0275defineInjectable({token:na,factory:na.\u0275fac});const Ti=new n.InjectionToken("Represents a list of filter view element config finders");class Va{}Va.\u0275fac=function(e){return new(e||Va)},Va.\u0275mod=n.\u0275\u0275defineNgModule({type:Va}),Va.\u0275inj=n.\u0275\u0275defineInjector({providers:[{provide:Ti,useClass:na,multi:!0}]});class ro{_getFilterViewConfigByName(e){return this.getViewConfigByName(e)?.viewConfig}_getFilterAttributesNames(e){return(this.getCollectionAttributeConfig(e)?.modelConfig?.filterAttributes||[]).map(i=>i.name)}_createFilterViewElementExposeFiltersMap(e){const a=(0,x.uniq)((e??[]).map(({viewElementName:i})=>i)).map(i=>{const o=e.filter(({viewElementName:s})=>s===i).map(({viewElementExposeFilters:s})=>s).flat().filter(s=>s?.attribute);return[i,o]}).filter(([i,o])=>i&&o.length);return new Map(a)}_addFiltersToCollectionAttribute(e,t){var a;const i=this.getCollectionAttributeConfig(e);!i?.modelConfig?.path||((a=i.modelConfig).filterAttributes??(a.filterAttributes=[]),t.forEach(o=>{i.modelConfig.filterAttributes.some(c=>c.name===o)||i.modelConfig.filterAttributes.push({name:o,loadOnChange:!0})}))}_addFiltersToViewElementFilterOptions(e){this.getFilterElementsConfigs().filter(t=>e.has(t.name)).map(t=>{var a;return(a=t._filterOptions).expose??(a.expose=[]),e.get(t.name).forEach(o=>{t._filterOptions.expose.some(c=>c.attribute===o.attribute)||t._filterOptions.expose.push(o)}),t}).forEach(t=>this._updateViewElementFilterOptions(t))}_removeFiltersFromCollectionAttribute(e,t){!e||e.modelConfig?.filterAttributes?.length&&(e.modelConfig.filterAttributes=e.modelConfig.filterAttributes.filter(({name:a})=>!t.includes(a)))}_removeFiltersFromViewElementFilterOptions(e){const t=(a,i)=>{this._removeFiltersFromFilterViewElement(a,i)};this._findFilterElementsByFilterAttributeNamesAndDoAction(e,t)}_findFilterElementsByFilterAttributeNamesAndDoAction(e,t){this.getFilterElementsConfigs().forEach(a=>{const i=a._filterOptions.expose.filter(o=>e.includes(o?.attribute)).map(o=>o.attribute);i.length&&t(a,i)})}_removeFiltersFromFilterViewElement(e,t){if(!t.length)return;const a=[...e._filterOptions.expose];e._filterOptions.expose=a.filter(i=>!t.includes(i?.attribute)),this._updateViewElementFilterOptions(e),this._restoreExposeFiltersIfBounded(e,t,a)}_restoreExposeFiltersIfBounded(e,t,a){const i=t.filter(s=>this.isViewModelAttributeBound(s));if(!i.length)return;const o=a.filter(s=>i.includes(s?.attribute));e._filterOptions.expose.push(...o),this._updateViewElementFilterOptions(e)}_updateViewElementFilterOptions(e){this.updateViewElement({itemConfig:e,applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig._filterOptions"}],selectOnCanvas:!1})}_getViewModelAttributes(){return(this.getViewModelConfig()??{}).attributes??{}}_resetFilterOptionsExposeArgs(e,t){const a=(i,o)=>{o.forEach(s=>{const c=i?._filterOptions?.expose?.find(m=>m.attribute===s);c&&c.converters?.forEach(m=>t(m.args))}),this._updateViewElementFilterOptions(i)};this._findFilterElementsByFilterAttributeNamesAndDoAction(e,a)}_addCopiedFilterInFilterAttributesIfNeed(e,t,a,i){const o=e.modelConfig?.filterAttributes?.find(({name:c})=>t.includes(c));if(!o)return;const s=o.name.replace(a,i);e.modelConfig.filterAttributes.push({name:s,loadOnChange:!0})}_getExposeFilterAttributeNames(e){return(this._getFilterViewConfigByName(e)?._filterOptions?.expose??[]).map(i=>i?.attribute).filter(Boolean)}getFilterElementsConfigs(){return this.getViewConfigInfoByFilter(t=>Boolean(t?._filterOptions))?.map(t=>t.viewConfig)??[]}addFiltersToCollection(e,t){const a=this._createFilterViewElementExposeFiltersMap(t);if(!e||!a.size)return;const i=Array.from(a.values()).flat().map(({attribute:o})=>o);this._addFiltersToCollectionAttribute(e,i),this._addFiltersToViewElementFilterOptions(a)}createCopiedFilterInCollections(e,t){const a=this._getExposeFilterAttributeNames(e);if(!a.length)return;const i=this._getViewModelAttributes();Object.values(i).forEach(o=>this._addCopiedFilterInFilterAttributesIfNeed(o,a,e,t))}removeFiltersFromCollection(e,t){if(!e||!t?.length)return;const a=this.getCollectionAttributeConfig(e);this._removeFiltersFromCollectionAttribute(a,t),this._removeFiltersFromViewElementFilterOptions(t)}removeFiltersByFilterViewElement(e){const t=this._getExposeFilterAttributeNames(e);if(!t.length)return;const a=this._getViewModelAttributes();Object.values(a).forEach(i=>this._removeFiltersFromCollectionAttribute(i,t))}resetFilterOptionsExposeArgs(e,t){t=(0,x.isFunction)(t)?t:i=>i?.splice(0,i.length);const a=this._getFilterAttributesNames(e);!a.length||this._resetFilterOptionsExposeArgs(a,t)}isFilterViewModelAttributes(e){let t=[];const a=(i,o)=>{t=[...t,...o]};return this._findFilterElementsByFilterAttributeNamesAndDoAction(e,a),[...new Set(t)]}}class oe extends ro{constructor(e){super(),this._designerSchemaService=e}getCollectionAttributeConfig(e){return this._designerSchemaService.getViewModelAttribute(e)}getViewConfigByName(e){return this._designerSchemaService.getViewConfigInfoByName(e)}getViewConfigInfoByFilter(e){return this._designerSchemaService.getViewConfigInfoByFilter(e)}getViewModelConfig(){return this._designerSchemaService.getViewModelConfig()}isViewModelAttributeBound(e){return this._designerSchemaService.isViewModelAttributeBound(e)}updateViewElement({itemConfig:e,applyPropertiesStrategies:t,selectOnCanvas:a=!0}){this._designerSchemaService.update({itemConfig:e,applyPropertiesStrategies:t,selectOnCanvas:a})}}oe.\u0275fac=function(e){return new(e||oe)(n.\u0275\u0275inject(g.DesignerSchemaService))},oe.\u0275prov=n.\u0275\u0275defineInjectable({token:oe,factory:oe.\u0275fac});class Dn extends ro{constructor(e){super(),this._changesApplierService=e}_applyChanges(e){const t={itemConfig:this._schema?.viewConfig};this._changesApplierService.apply(t,e)}getCollectionAttributeConfig(e){return C.MetadataSchemaUtils.getViewModelAttribute(this._schema,e)}getViewConfigByName(e){return C.MetadataSchemaUtils.getViewConfigInfoByName(this._schema,e)}getViewConfigInfoByFilter(e){return C.MetadataSchemaUtils.getViewConfigInfoByFilter(e,this._schema?.viewConfig)}getViewModelConfig(){return C.MetadataSchemaUtils.getViewModelConfig(this._schema)}isViewModelAttributeBound(e){return C.MetadataSchemaUtils.isViewModelAttributeBound(this._schema,e)}updateViewElement({itemConfig:e,applyPropertiesStrategies:t}){this._applyChanges({settings:{itemConfig:e,applyPropertiesStrategies:t},operation:_.MetaItemDesignSettingChangesOperation.Update})}initSchema(e){this._schema=e}}Dn.\u0275fac=function(e){return new(e||Dn)(n.\u0275\u0275inject(g.MetaItemDesignSettingChangesApplierService))},Dn.\u0275prov=n.\u0275\u0275defineInjectable({token:Dn,factory:Dn.\u0275fac});class oo{}const so="crt.ToInFilter",co="crt.ToValuesFromCollection";class Mn extends oo{constructor(e){super(),this._schemaService=e}toExposeFilterConfig(e,t){const{attributePath:a,relationPath:i}=t??{};if(!e||!a||!i)return null;const o=i.split(".").shift(),s=i.split(".").slice(1).join("."),c=this._schemaService.findAttributeByDataSourceAttributePath(o);return!c||!s?null:{attribute:e,converters:[{converter:co,args:[c,s]},{converter:so,args:[a]}]}}toModelRelationConfig(e){const t=e?.converters?.filter(Boolean)??[];if(!t.length)return null;const a=t.find(({converter:b})=>b===so),i=t.find(({converter:b})=>b===co),[o]=a?.args??[],[s,c]=i?.args??[],m=this._schemaService.getMappedDataSourceAttributePath(s);return!o||!m||!c?null:{attributePath:o,relationPath:`${m}.${c}`}}}Mn.\u0275fac=function(e){return new(e||Mn)(n.\u0275\u0275inject(_.SchemaService))},Mn.\u0275prov=n.\u0275\u0275defineInjectable({token:Mn,factory:Mn.\u0275fac});const Oi=new n.InjectionToken("Represents a factory of converters between model relation config and expose filter config");function ps(){return G.FactoryProvider.create({token:Oi,mappings:[{predicate:"crt.DataGrid",injectable:Mn}]})}class Fa{}Fa.\u0275fac=function(e){return new(e||Fa)},Fa.\u0275mod=n.\u0275\u0275defineNgModule({type:Fa}),Fa.\u0275inj=n.\u0275\u0275defineInjector({providers:[Mn,ps()]});class Na{constructor(e,t,a,i){this._schemaService=e,this._filterViewElementConfigProvider=t,this._filterViewElementConfigFinders=a,this._modelRelationConfigExposeFilterConfigConverterFactory=i}_getModelDependencyFilterRelations(e){const t=this._getFilterAttributeNames(e);return t.length?this._filterViewElementConfigProvider.getFilterElementsConfigs().map(a=>({elementType:a?.type,elementExposeFilterConfigs:a?._filterOptions?.expose??[]})).map(({elementType:a,elementExposeFilterConfigs:i})=>i.map(o=>({elementType:a,elementExposeFilterConfig:o}))).flat().filter(({elementExposeFilterConfig:a})=>t.includes(a?.attribute)).map(({elementType:a,elementExposeFilterConfig:i})=>({filterAttributeName:i.attribute,modelRelationConfig:this._modelRelationConfigExposeFilterConfigConverterFactory.create(a)?.toModelRelationConfig(i)})).filter(({modelRelationConfig:a})=>a):[]}_getFilterAttributeNames(e){return(this._schemaService.getViewModelConfig()?.attributes?.[e]?.modelConfig?.filterAttributes??[]).map(o=>o?.name).filter(Boolean)}_toModelRelationConfig(e,t,a){return gi.toModelsDependenciesConfig({[e]:[t]},a)[e].pop()}_toDataSourceDependencySetting(e,t,a){return gi.toDependenciesSettings({[e]:[t]},a)[e].pop()}_updateModelDependencies(e,t){const a={[e]:t.map(({modelRelationConfig:i})=>i)};this._schemaService.upsertModelDependencies(a)}_addCollectionModelDependentFilters(e,t){const i=(0,x.uniq)(t.map(({dependencySetting:o})=>o.matchedDsName)).map(o=>{const s=this._getFilteringRelativeModelDependencyConfigs(o,t);return this._createFilterViewElementExposeConfigs(o,s)}).flat();this._filterViewElementConfigProvider.addFiltersToCollection(e,i)}_getFilteringRelativeModelDependencyConfigs(e,t){return t.filter(({dependencySetting:a})=>a.matchedDsName===e&&a.filterByActiveItem).map(({modelRelationConfig:a})=>a)}_createFilterViewElementExposeConfigs(e,t){return this._filterViewElementConfigFinders.map(a=>a.getBoundFilterViewElements(e)).flat().map(a=>this._createFilterViewElementExposeConfig(a,t)).filter(Boolean)}_createFilterViewElementExposeConfig(e,t){const{name:a,type:i}=e??{},o=this._modelRelationConfigExposeFilterConfigConverterFactory.create(i),s=t.map(c=>{const m=(0,h.generateGuid)().split("-").shift(),b=`${a}_${m}_ExposeFilter`;return o?.toExposeFilterConfig(b,c)}).filter(Boolean);return!a||!s.length?null:{viewElementName:a,viewElementExposeFilters:s}}_removeCollectionModelDependentFilters(e){const t=this._getModelDependencyFilterRelations(e).map(({filterAttributeName:a})=>a);this._filterViewElementConfigProvider.removeFiltersFromCollection(e,t)}getByCollectionAttributeName(e){if(!e)return[];const t=this._schemaService.getMappedDataSourceAttributePath(e);if(!t)return[];const a=this._schemaService.getModelConfig()??{},i=a.dependencies?.[t]??[],o=this._getModelDependencyFilterRelations(e);return i.map(s=>{const c=this._toDataSourceDependencySetting(t,s,a);return c.filterByActiveItem=o.some(m=>(0,x.isEqual)(s,m.modelRelationConfig)),c}).filter(Boolean)}updateByCollectionAttributeName(e,t){if(!e)return;const a=this._schemaService.getMappedDataSourceAttributePath(e);if(!a)return;const i=this._schemaService.getModelConfig()??{},o=(t??[]).map(s=>({dependencySetting:s,modelRelationConfig:this._toModelRelationConfig(a,s,i)})).filter(({modelRelationConfig:s})=>s);this._updateModelDependencies(a,o),this._removeCollectionModelDependentFilters(e),this._addCollectionModelDependentFilters(e,o)}}Na.\u0275fac=function(e){return new(e||Na)(n.\u0275\u0275inject(_.SchemaService),n.\u0275\u0275inject(oe),n.\u0275\u0275inject(Ti),n.\u0275\u0275inject(Oi))},Na.\u0275prov=n.\u0275\u0275defineInjectable({token:Na,factory:Na.\u0275fac});class Lt extends Bt{constructor(){super(...arguments),this.defaultColumnCodes=[],this.forwardReferenceColumns=[]}tryAddViewModelAttribute(e,t){const a=e.name||this.schemaService.generateUniqueAttributeNameByType(this.typeName);this.schemaService.isViewModelAttributeExists(a)||this.createViewModelAttribute(e,t)}tryAddMasterRecordAttribute(e){if(!e.masterRecordColumnValue)return(0,d.of)(null);const t=this.schemaService.getPrimaryDataSourceName();return t?this.dataSourceManager.getDataSourceByName$(t).pipe((0,d.switchMap)(a=>this.addMasterRecordAttribute(a,e.name))):(0,d.of)(null)}addMasterRecordAttribute(e,t){return e.getSchema().pipe((0,d.switchMap)(a=>{const i=a.primaryAttributeName||"Id";if(this.schemaService.isViewModelAttributeExists(i))return(0,d.of)(i);const o={modelConfig:{path:`${e.dataSourceName}.${i}`}};return this.schemaService.createViewModelAttribute(i,o),(0,d.of)(i)}))}applyEntityColumns(e,t,a){return e.columns?(0,d.of)(null):this.applyColumns(e,t,a)}}Lt.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Lt)))(t||Lt)}}(),Lt.\u0275prov=n.\u0275\u0275defineInjectable({token:Lt,factory:Lt.\u0275fac});class rt extends Lt{constructor(){super(...arguments),this.typeName="FileList",this.defaultColumnCodes=["Name","CreatedOn","CreatedBy","Size"],this.defaultSorting={columnName:"CreatedOn",direction:"desc"}}}rt.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(rt)))(t||rt)}}(),rt.\u0275prov=n.\u0275\u0275defineInjectable({token:rt,factory:rt.\u0275fac});class ot extends Lt{constructor(){super(...arguments),this.typeName="CommunicationOptions",this.defaultColumnCodes=["CreatedOn","Number","Primary","NonActual","CommunicationType"],this.forwardReferenceColumns=[{name:"CommunicationType.DisplayFormat",code:"CommunicationType.DisplayFormat",type:h.DataValueType.Text},{name:"CommunicationType.Name",code:"CommunicationType.Name",type:h.DataValueType.Text}],this.defaultSorting={columnName:"CreatedOn",direction:"asc"}}_getCollectionAttributeName(e){const t=e.items;return!t||!t.startsWith("$")?"":t.slice(1)}_checkViewModelAttributes(e,t){const a=this.schemaService.getViewModelConfig(),o=(a.attributes&&a.attributes[e])?.viewModelConfig?.attributes;return o?[...this.defaultColumnCodes.map(c=>`${t}_${c}`)].concat(this.forwardReferenceColumns.map(c=>`${t}_${c.name.replace(".","")}`)).every(c=>Boolean(o[c])):!1}_checkModelAttributes(e){const i=(this.schemaService.getModelConfig()||{}).dataSources[e]?.config?.attributes;return i?[...this.defaultColumnCodes].concat(this.forwardReferenceColumns.map(s=>s.name.replace(".",""))).every(s=>Boolean(i[s])):!1}getColumnsChangedConfig(e,t,a){const i=super.getColumnsChangedConfig(e,t,a);return this.forwardReferenceColumns.forEach(o=>{const s=o.code?.split(".")[0];if([...e.inheritedColumns,...e.columns].find(m=>m.name===s)){const m=o,b=this.createColumnDefinition(m,a);i.columns.push(b)}}),i}getUpdateViewItemCommand(e){const t={name:e.viewElementConfig.name,changes:[{path:"itemConfig.items",value:e.viewElementConfig.items}]};return this.designerCommandFactoryService.create("crt.ChangeViewItemCommand",t)}needApplyColumns(e,t){const a=this._getCollectionAttributeName(e);return!this._checkViewModelAttributes(a,t)||!this._checkModelAttributes(t)}}ot.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(ot)))(t||ot)}}(),ot.\u0275prov=n.\u0275\u0275defineInjectable({token:ot,factory:ot.\u0275fac});class lo{getValueAttributeName(e){return`${e}_Value`}}class xn extends lo{createFilterOptionsFrom(e,t){const a=[this.getValueAttributeName(e)];return t?.filter(i=>i.dependencyFilters?.length>0)?.forEach(i=>{a.push(...i.dependencyFilters.filter(o=>o.attributeName).map(o=>o.attributeName))}),a.filter(Boolean)}}xn.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(xn)))(t||xn)}}(),xn.\u0275prov=n.\u0275\u0275defineInjectable({token:xn,factory:xn.\u0275fac});class In extends lo{constructor(){super(...arguments),this._injector=(0,n.inject)(n.Injector),this._designerSchemaService=(0,n.inject)(g.DesignerSchemaService)}_getResolver(e){switch(this._designerSchemaService.getViewConfigInfoByName(e)?.viewConfig?.filterType){case u.QuickFilterType.Custom:return this._injector.get(xn);default:return null}}createFilterOptionsFrom(e,t){const a=this._getResolver(e);return a?a.createFilterOptionsFrom(e,t):this.getValueAttributeName(e)}}In.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(In)))(t||In)}}(),In.\u0275prov=n.\u0275\u0275defineInjectable({token:In,factory:In.\u0275fac});class aa{}aa.\u0275fac=function(e){return new(e||aa)},aa.\u0275mod=n.\u0275\u0275defineNgModule({type:aa}),aa.\u0275inj=n.\u0275\u0275defineInjector({providers:[In,xn]});class ia{createViewElementFilterConfig(e){return{viewElementName:e,viewElementExposeFilters:[{attribute:this.getFilterAttributeName(e),converters:[{converter:"crt.FolderTreeActiveFilterAttributeConverter",args:[]}]}]}}createFilterOptionsFrom(e){const{activeFolderIdAttrName:t,itemsAttrName:a,favoriteItemsAttrName:i}=(0,C.buildFolderTreeAttributeNames)(e);return[a,i,t]}getFilterAttributeName(e){return(0,C.buildFolderTreeAttributeNames)(e).activeFolderFilterAttrName}getTargetViewAttributeNamesFromFilterOptions(e,t){const{activeFolderFilterAttrName:a}=(0,C.buildFolderTreeAttributeNames)("");return[a.replace(/^_/,"")]}}ia.\u0275fac=function(e){return new(e||ia)},ia.\u0275prov=n.\u0275\u0275defineInjectable({token:ia,factory:ia.\u0275fac});class ra{constructor(){this._designerSchemaService=(0,n.inject)(g.DesignerSchemaService),this._additionalQuickFilterOptionsConfigResolver=(0,n.inject)(In)}_getConverterParameters(e,t){const a=this._getViewConfig(e);return!a||!a.filterType?[]:[this._createQuickFilterConverterParameters(a,t)]}_getViewConfig(e){return this._designerSchemaService.getViewConfigInfoByName(e)?.viewConfig}_createQuickFilterConverterParameters(e,t){const a={target:{viewAttributeName:t},quickFilterType:e.filterType};return this._allowAddConfigToConverterParameters(e)&&(a.config=e.config),a}_allowAddConfigToConverterParameters(e){return this._isCustomQuickFilterType(e)}_isCustomQuickFilterType(e){return e.filterType===u.QuickFilterType.Custom}_getTargetAttributeNameFromConverter(e){return this._getTargetAttributeNameFromArguments(e.find(t=>t.args?.length>0)?.args||[])}_getTargetAttributeNameFromArguments(e){return e.find(t=>t.target.viewAttributeName)?.target.viewAttributeName||null}createViewElementFilterConfig(e,t){return{viewElementName:e,viewElementExposeFilters:[{attribute:this.getFilterAttributeName(e,t),converters:[{converter:"crt.QuickFilterAttributeConverter",args:this._getConverterParameters(e,t)}]}]}}createFilterOptionsFrom(e,t){return this._additionalQuickFilterOptionsConfigResolver.createFilterOptionsFrom(e,t)}getFilterAttributeName(e,t){return`${e}_${t}`}getTargetViewAttributeNamesFromFilterOptions(e,t){return t?.expose.map(a=>this._getTargetAttributeNameFromConverter(a.converters||[])).filter(Boolean)||[]}}ra.\u0275fac=function(e){return new(e||ra)},ra.\u0275prov=n.\u0275\u0275defineInjectable({token:ra,factory:ra.\u0275fac});class jt{constructor(){this._injector=(0,n.inject)(n.Injector),this._designerSchemaService=(0,n.inject)(g.DesignerSchemaService)}_getResolver(e){switch(this._designerSchemaService.getViewConfigInfoByName(e)?.viewConfig?.type){case"crt.FolderTree":return this._injector.get(ia);case"crt.QuickFilter":return this._injector.get(ra);default:return null}}createViewElementFilterConfig(e,...t){const a=this._getResolver(e);return a?a.createViewElementFilterConfig(e,...t):null}createFilterOptionsFrom(e,...t){const a=this._getResolver(e);return a?a.createFilterOptionsFrom(e,...t):null}getFilterAttributeName(e,...t){const a=this._getResolver(e);return a?a.getFilterAttributeName(e,...t):null}getTargetViewAttributeNamesFromFilterOptions(e,t,...a){const i=this._getResolver(e);return i?i.getTargetViewAttributeNamesFromFilterOptions(e,t,...a):null}}jt.\u0275fac=function(e){return new(e||jt)},jt.\u0275prov=n.\u0275\u0275defineInjectable({token:jt,factory:jt.\u0275fac});class Gt{}Gt.\u0275fac=function(e){return new(e||Gt)},Gt.\u0275mod=n.\u0275\u0275defineNgModule({type:Gt}),Gt.\u0275inj=n.\u0275\u0275defineInjector({providers:[jt,ia,ra],imports:[aa]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Gt,{imports:[aa]})}();class Pn{constructor(){this._filterOptionsConfigResolver=(0,n.inject)(jt),this.designerSchemaService=(0,n.inject)(g.DesignerSchemaService)}_updateViewModelFilterAttributes(e,t,a,i){const o=this._getFilterAttributeName(t,a),s=this._createPreviousFilterAttributeName(e,t,o);Object.values(i).forEach(c=>{if(!(0,I.isModelAttributeConfig)(c))return;const m=c.modelConfig?.filterAttributes;if(!m)return;const b=m.find(y=>y.name===s);!b||(b.name=o)})}_createPreviousFilterAttributeName(e,t,a){return a.replace(t,e)}_getFilterOptions(e){const t=this._getViewConfigByName(e);return!t||!("_filterOptions"in t)?null:t._filterOptions}_getViewConfigByName(e){return this.designerSchemaService.getViewConfigInfoByName(e)?.viewConfig||null}_updateFilterOptions(e,t){t.expose.forEach(a=>{this._updateExposeAttributeValue(e,a)}),t.from=this._createFilterOptionsFromValue(e)}_updateExposeAttributeValue(e,t){const a=this._getTargetViewAttributeNames(e,{expose:[{converters:t.converters||[]}]}).shift();!a||(t.attribute=this._getFilterAttributeName(e,a))}_getTargetViewAttributeNames(e,t){return this._filterOptionsConfigResolver.getTargetViewAttributeNamesFromFilterOptions(e,t)}_getFilterAttributeName(e,t){return this._filterOptionsConfigResolver.getFilterAttributeName(e,t)}_createFilterOptionsFromValue(e){return this._filterOptionsConfigResolver.createFilterOptionsFrom(e)}renameViewElement(e,t){const a=this._getFilterOptions(t),i=this._getTargetViewAttributeNames(t,a),o=this.designerSchemaService.getViewModelConfig(!0)?.attributes||{};return i.forEach(s=>{this._updateViewModelFilterAttributes(e,t,s,o)}),a&&this._updateFilterOptions(t,a),(0,d.of)(null)}}Pn.\u0275fac=function(e){return new(e||Pn)},Pn.\u0275prov=n.\u0275\u0275defineInjectable({token:Pn,factory:Pn.\u0275fac});class $t{constructor(e){this.injector=e,this._designerSchemaService=this.injector.get(g.DesignerSchemaService)}_getFilterViewConfigInfos(e){return this._designerSchemaService.getViewConfigInfoByProperty("type",e)}_removeTargetsFromBindedSearchViewItems(e,t){const a=this._getAttributeNameFromViewConfigInfo(t);this._getBindedSearchViewConfigInfos(e,a).forEach(o=>this._updateTargetFromBindedViewItems("targetAttributes",[],o))}_getBindedSearchViewConfigInfos(e,t){return e.filter(({viewConfig:a})=>a?.targetAttributes?.includes(t))}_handleTargetsFromBindedQuickFilterViewItems(e,t,a){const i=this._getAttributeNameFromViewConfigInfo(t);this._getBindedQuickFilterViewConfigInfos(e,i).forEach(s=>{const c=(0,x.get)(s.viewConfig,"targets"),m=a.call(this,c,i);this._updateTargetFromBindedViewItems("targets",m,s)})}_removeTargets(e,t){return e.filter(a=>a.viewAttributeName!==t)}_resetTargets(e,t){return e.map(a=>a.viewAttributeName!==t?a:this._createBaseQuickFilterTarget(a.viewAttributeName))}_createBaseQuickFilterTarget(e){return{viewAttributeName:e}}_getBindedQuickFilterViewConfigInfos(e,t){return e.filter(({viewConfig:a})=>a?.targets?.some(i=>i.viewAttributeName===t))}_getAttributeNameFromViewConfigInfo(e){const t=this._designerSchemaService.getViewConfigInfoByName(e),a=(0,x.get)(t.viewConfig,"items");return this._getBoundAttributeName(a)}_getBoundAttributeName(e){return e&&e.startsWith("$")?e.slice(1):null}_updateTargetFromBindedViewItems(e,t,a){const i={...a.viewConfig,[e]:t},o=`itemConfig.${e}`;this._designerSchemaService.update({itemConfig:i,applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:o}],selectOnCanvas:!1})}removeBindingInSearchFilterViewItems(e){const t=this._getFilterViewConfigInfos("crt.SearchFilter");t.length!==0&&this._removeTargetsFromBindedSearchViewItems(t,e)}removeBindingInQuickFilterViewItems(e){const t=this._getFilterViewConfigInfos("crt.QuickFilter");t.length!==0&&this._handleTargetsFromBindedQuickFilterViewItems(t,e,this._removeTargets)}resetBindingInQuickFilterViewItems(e){const t=this._getFilterViewConfigInfos("crt.QuickFilter");t.length!==0&&this._handleTargetsFromBindedQuickFilterViewItems(t,e,this._resetTargets)}}$t.\u0275fac=function(e){return new(e||$t)(n.\u0275\u0275inject(n.Injector))},$t.\u0275prov=n.\u0275\u0275defineInjectable({token:$t,factory:$t.\u0275fac});class Ra{crtOnMetaDataInit(e){var t=this;return(0,F.Z)(function*(){const a=e;return yield t.execute(a),Promise.resolve(e)})()}}Ra.\u0275fac=function(e){return new(e||Ra)},Ra.\u0275dir=n.\u0275\u0275defineDirective({type:Ra});class za{constructor(){this.filterViewElementConfigSchemaProvider=(0,n.inject)(Dn)}_getFilterViewConfigs(e){return C.MetadataSchemaUtils.getViewConfigInfoByProperty("type",this.filterViewElementType,e.viewConfig).map(t=>t?.viewConfig).filter(Boolean)}_convertToFilterOptionsIfNeed(e,t){!(0,x.isEmpty)(e?._filterOptions)||(this._initializeFilterOptions(e),this.convertToFilterOptions(e,t))}_initializeFilterOptions(e){const t=this.createFromForFilterOptions(e);e._filterOptions={expose:[],from:t}}convert(e){this.filterViewElementConfigSchemaProvider.initSchema(e),this._getFilterViewConfigs(e).forEach(a=>{this._convertToFilterOptionsIfNeed(a,e)})}}za.\u0275fac=function(e){return new(e||za)},za.\u0275dir=n.\u0275\u0275defineDirective({type:za});class En extends za{constructor(){super(...arguments),this.filterViewElementType="crt.FolderTree"}_hasBindingWithFolderTree(e,t){const{activeFolderFilterAttrName:a}=(0,C.buildFolderTreeAttributeNames)(e.name);return t?.modelConfig?.filterAttributes?.some(i=>i.name===a)}_createViewElementFilterConfig(e){const{activeFolderFilterAttrName:t}=(0,C.buildFolderTreeAttributeNames)(e.name);return{viewElementName:e.name,viewElementExposeFilters:[{attribute:t,converters:[{converter:"crt.FolderTreeActiveFilterAttributeConverter",args:[e.rootSchemaName]}]}]}}createFromForFilterOptions(e){const{activeFolderIdAttrName:t,itemsAttrName:a,favoriteItemsAttrName:i}=(0,C.buildFolderTreeAttributeNames)(e.name);return[a,i,t]}convertToFilterOptions(e,t){const a=t.viewModelConfig?.attributes||{};Object.entries(a).forEach(([i,o])=>{!(0,I.isModelAttributeConfig)(o)||!this._hasBindingWithFolderTree(e,o)||this.filterViewElementConfigSchemaProvider.addFiltersToCollection(i,[this._createViewElementFilterConfig(e)])})}}En.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(En)))(t||En)}}(),En.\u0275prov=n.\u0275\u0275defineInjectable({token:En,factory:En.\u0275fac});class Tn extends za{constructor(){super(...arguments),this.filterViewElementType="crt.QuickFilter"}_createViewElementFilterConfig(e,t){return{viewElementName:e.name,viewElementExposeFilters:[{attribute:this._getFilterAttributeName(e.name,t.viewAttributeName),converters:[{converter:"crt.QuickFilterAttributeConverter",args:[this._createQuickFilterConverterParameters(t,e)]}]}]}}_createQuickFilterConverterParameters(e,t){const a={target:e,quickFilterType:t.filterType};return this._allowAddConfigToConverterParameters(t)&&(a.config=t.config),a}_allowAddConfigToConverterParameters(e){return e.filterType===u.QuickFilterType.Custom}_getQuickFilterValueAttributeName(e){return`${e}_Value`}_getFilterAttributeName(e,t){return`${e}_${t}`}createFromForFilterOptions(e){return this._getQuickFilterValueAttributeName(e.name)}convertToFilterOptions(e){e.targets?.forEach(t=>{this.filterViewElementConfigSchemaProvider.addFiltersToCollection(t.viewAttributeName,[this._createViewElementFilterConfig(e,t)])}),delete e.targets}}Tn.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Tn)))(t||Tn)}}(),Tn.\u0275prov=n.\u0275\u0275defineInjectable({token:Tn,factory:Tn.\u0275fac});class oa extends Ra{constructor(){super(...arguments),this._folderTreeSchemaApiConverter=(0,n.inject)(En)}execute(e){this._folderTreeSchemaApiConverter.convert(e)}}oa.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(oa)))(t||oa)}}(),oa.\u0275prov=n.\u0275\u0275defineInjectable({token:oa,factory:oa.\u0275fac});class sa extends Ra{constructor(){super(...arguments),this._featureService=(0,n.inject)(ae.FeatureService),this._quickFilterSchemaApiConverter=(0,n.inject)(Tn),this._disableUseQuickFilterNewSchemaFilterApiFeatureName="DisableUseQuickFilterNewSchemaFilterApi"}_isConvertMetadataToNewSchemaFilterAPIDisabled(){return(0,d.firstValueFrom)(this._featureService.getFeatureState(this._disableUseQuickFilterNewSchemaFilterApiFeatureName).pipe((0,d.first)(),(0,d.map)(Boolean)))}execute(e){var t=this;return(0,F.Z)(function*(){(yield t._isConvertMetadataToNewSchemaFilterAPIDisabled())||t._quickFilterSchemaApiConverter.convert(e)})()}}sa.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(sa)))(t||sa)}}(),sa.\u0275prov=n.\u0275\u0275defineInjectable({token:sa,factory:sa.\u0275fac});class ka{}ka.\u0275fac=function(e){return new(e||ka)},ka.\u0275mod=n.\u0275\u0275defineNgModule({type:ka}),ka.\u0275inj=n.\u0275\u0275defineInjector({providers:[ae.FeatureService,En,Tn,{provide:I.CRT_METADATA_PREPROCESSOR,useClass:oa,multi:!0},{provide:I.CRT_METADATA_PREPROCESSOR,useClass:sa,multi:!0}]});class ca{isAllowedFilterViewElement(e,t){const a=`#DataSourceEntityName(${t?.dataSourceName})#`;return e.rootSchemaName===t.entitySchemaName||e.rootSchemaName===a}}ca.\u0275fac=function(e){return new(e||ca)},ca.\u0275prov=n.\u0275\u0275defineInjectable({token:ca,factory:ca.\u0275fac});class la{isAllowedFilterViewElement(e){return!!e.filterType}}la.\u0275fac=function(e){return new(e||la)},la.\u0275prov=n.\u0275\u0275defineInjectable({token:la,factory:la.\u0275fac});class da{isAllowedFilterViewElement(e,t){return!e?.targetAttributes||e.targetAttributes.length===0||e.targetAttributes.includes(t.viewAttributeName)}}da.\u0275fac=function(e){return new(e||da)},da.\u0275prov=n.\u0275\u0275defineInjectable({token:da,factory:da.\u0275fac});const gs=["crt.DataGrid","crt.FileList","crt.ApprovalList","crt.Gallery"];class ma{constructor(){this._injector=(0,n.inject)(n.Injector)}_getProvider(e){switch(e?.type){case"crt.FolderTree":return this._injector.get(ca);case"crt.QuickFilter":return this._injector.get(la);case"crt.SearchFilter":return this._injector.get(da);default:return null}}isAllowedFilterViewElement(e,...t){if(gs.some(i=>i===e.type))return!1;const a=this._getProvider(e);return a?a.isAllowedFilterViewElement(e,...t):"_filterOptions"in e}}ma.\u0275fac=function(e){return new(e||ma)},ma.\u0275prov=n.\u0275\u0275defineInjectable({token:ma,factory:ma.\u0275fac});class On{}On.\u0275fac=function(e){return new(e||On)},On.\u0275mod=n.\u0275\u0275defineNgModule({type:On}),On.\u0275inj=n.\u0275\u0275defineInjector({providers:[ma,ca,la,da]});class st{constructor(){this._designerSchemaService=(0,n.inject)(g.DesignerSchemaService),this._filterOptionsConfigResolver=(0,n.inject)(jt)}_getFolderTreeViewConfigs(){return this._designerSchemaService.getViewConfigInfoByProperty("type","crt.FolderTree")?.map(e=>e?.viewConfig)}_getFilterAttributeNamesFromAttribute(e){return(e?.modelConfig?.filterAttributes||[]).map(t=>t.name)}_removeFolderTreeFilterFromAttributesIfNeed(e,t,a){const i=this._filterOptionsConfigResolver.getFilterAttributeName(e);!a.includes(i)||!t.modelConfig?.filterAttributes?.length||(t.modelConfig.filterAttributes=t.modelConfig.filterAttributes.filter(({name:o})=>o!==i))}changeActionButtonBindings(e,t){this._designerSchemaService.getViewConfigInfoByProperty("type","crt.FolderTreeActions").filter(i=>(0,x.get)(i.viewConfig,"folderTree")===e).forEach(i=>{this._designerSchemaService.update({itemConfig:{name:i.viewConfig.name,folderTree:t},selectOnCanvas:!1})})}removeFolderTreeCollectionBindings(e){const t=this._designerSchemaService.getViewModelAttribute(e),a=this._getFilterAttributeNamesFromAttribute(t);if(!a.length)return;const i=this._getFolderTreeViewConfigs();!i.length||i.forEach(o=>{this._removeFolderTreeFilterFromAttributesIfNeed(o.name,t,a)})}removeFolderTreeAttributes(e){const{activeFolderIdAttrName:t,activeFolderNameAttrName:a,activeFolderFilterAttrName:i,itemsAttrName:o,visibleAttrName:s,itemsFilterAttrName:c}=(0,C.buildFolderTreeAttributeNames)(e);[t,a,i,o,s,c].forEach(m=>this._designerSchemaService.removeViewModelAttribute(m))}}st.\u0275fac=function(e){return new(e||st)},st.\u0275prov=n.\u0275\u0275defineInjectable({token:st,factory:st.\u0275fac});class ct{constructor(e){this._translateService=e}_getNameColumnCaption(){const e=new C.LocalizableStringArray;return e.setValueLocalizableString(this._translateService.currentLang,this._translateService.instant("InterfaceDesigner.SetupEntityProperties.NameColumnCaption")),e}create(){return{name:"Name",caption:this._getNameColumnCaption(),dataValueType:h.DataValueType.MEDIUM_TEXT,requirementType:ie.EntitySchemaColumnRequirementType.YES}}}ct.\u0275fac=function(e){return new(e||ct)(n.\u0275\u0275inject(D.TranslateService))},ct.\u0275prov=n.\u0275\u0275defineInjectable({token:ct,factory:ct.\u0275fac});class Ba{constructor(){this.afterDesignerItemSaved="crt.AfterDesignerItemSaved",this.showAppearanceSettingsPanel=!1}}Ba.\u0275fac=function(e){return new(e||Ba)},Ba.\u0275prov=n.\u0275\u0275defineInjectable({token:Ba,factory:Ba.\u0275fac});class z{constructor(e){this._featureService=e,this._selectInitialized=!1,this._visibility$=new d.BehaviorSubject(!1),this._innerHoveredItemName$=new d.Subject,this._destroyed$=new d.Subject,this._dueTime=45,this._alwaysVisibleCell=!1,this.selectedChanged$=new d.ReplaySubject(1),this.hoveredItemName$=new d.Subject,this.togglePadding$=new d.Subject,this.alwaysVisibleCell$=new d.BehaviorSubject(!1),this.designVisibility$=new d.Subject,this._initFeatures(),this._innerHoveredItemName$.pipe((0,l.debounceTime)(this._dueTime),(0,l.takeUntil)(this._destroyed$)).subscribe(t=>{this.hoveredItemName$.next(t)})}get visibility$(){return this._visibility$}set visibility(e){this._visibility$.value!==e&&this._visibility$.next(e)}_initFeatures(){this._featureService.getFeatureState("GridCellsAlwaysVisible").subscribe({next:e=>{this._setAlwaysVisibleCell(e)}})}_setAlwaysVisibleCell(e){this._alwaysVisibleCell=e,this.alwaysVisibleCell$.next(this._alwaysVisibleCell)}initSelect(e=""){this._selectInitialized=!0,this.select(e,X.Init)}select(e,t=X.Edit){this._selectInitialized&&this.selectedChanged$.next({name:e,mode:t})}showElement(e){this.designVisibility$.next({name:e,visible:!0})}hideElement(e){this.designVisibility$.next({name:e,visible:!1})}setHoveredItemName(e){this._innerHoveredItemName$.next(e)}togglePadding(){this.togglePadding$.next()}toggleAlwaysVisibleCell(){this._setAlwaysVisibleCell(!this._alwaysVisibleCell)}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}z.\u0275fac=function(e){return new(e||z)(n.\u0275\u0275inject(ae.FeatureService))},z.\u0275prov=n.\u0275\u0275defineInjectable({token:z,factory:z.\u0275fac,providedIn:"root"});var us=v(66219),f=v(31134);function hs(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"div",2),n.\u0275\u0275elementContainer(2,3),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()),r&2){const t=e.$implicit;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",t.style),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngTemplateOutlet",t.templateRef)}}function bs(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,hs,3,2,"ng-container",1),n.\u0275\u0275elementContainerEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.designerOverlayInfos)}}class lt{constructor(e){this._cdr=e,this.designerOverlayInfos=[],this.show=!0}static _getVisibleElementRect(e,t){let a=t,i=e;for(;i;){if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&getComputedStyle(i).overflow!=="visible"){const m=i.getBoundingClientRect();a={top:Math.max(a.top,m.top),right:Math.min(a.right,m.right),bottom:Math.min(a.bottom,m.bottom),left:Math.max(a.left,m.left)}}i=i.parentElement}const o={top:0,right:window.innerWidth||document.documentElement.clientWidth,bottom:window.innerHeight||document.documentElement.clientHeight,left:0},s={top:Math.max(a.top,o.top),right:Math.min(a.right,o.right),bottom:Math.min(a.bottom,o.bottom),left:Math.max(a.left,o.left)};return s.left>s.right||s.top>s.bottom?null:s}static _getPosition(e){const t=e?.nativeElement?.nextElementSibling;if(!t)return;const a=t.getBoundingClientRect(),i=lt._getVisibleElementRect(t,a),o=i?.top||a?.top,s=i?.right||a?.right;return{top:o,right:s}}static getDesignerOverlayStyle(e){const t=lt._getPosition(e.elementRef);return{"top.px":t?.top,"left.px":t?.right}}ngOnDestroy(){this.update()}update(e=[]){this.designerOverlayInfos=e,this.designerOverlayInfos.forEach(t=>{t.style=lt.getDesignerOverlayStyle(t)}),this._cdr.detectChanges()}}lt.\u0275fac=function(e){return new(e||lt)(n.\u0275\u0275directiveInject(n.ChangeDetectorRef))},lt.\u0275cmp=n.\u0275\u0275defineComponent({type:lt,selectors:[["crt-designer-overlay"]],decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"crt-designer-overlay",3,"ngStyle"],[3,"ngTemplateOutlet"]],template:function(e,t){e&1&&n.\u0275\u0275template(0,bs,2,1,"ng-container",0),e&2&&n.\u0275\u0275property("ngIf",t.show)},dependencies:[f.NgForOf,f.NgIf,f.NgTemplateOutlet,f.NgStyle],styles:[".crt-designer-overlay[_ngcontent-%COMP%]{position:fixed;z-index:100}"],changeDetection:0});class be{constructor(e){this.appRef=e,this._destroyed$=new d.Subject,this._update$=new d.Subject,this.designerOverlayInfos=[],this._subscribeUpdate()}_initOverlayComponent(){if(this.overlayComponent)return;const e=this.appRef.components[0],t=e.injector.get(n.ViewContainerRef),a=t.createComponent(lt,{injector:e.injector});t.insert(a.hostView),this.overlayComponent=a.instance}_setValueToOverlayComponent(){this.overlayComponent?.update(this.designerOverlayInfos)}_subscribeElementResize(e){const t=e.nativeElement.nextElementSibling?.parentElement;if(!!t)return this.subscribeElementResize(t)}_subscribeUpdate(){this._update$.pipe((0,l.filter)(()=>this.overlayComponent?.show),(0,l.takeUntil)(this._destroyed$)).subscribe({next:()=>{this._setValueToOverlayComponent()}})}subscribeElementResize(e,t){const a=new us.Z(()=>{this.update(),t?.()});return a.observe(e),a}add(e,t){this._initOverlayComponent();const a=this._subscribeElementResize(e);this.designerOverlayInfos.push({elementRef:e,templateRef:t,resizeObserver:a}),this.update()}remove(e){this.designerOverlayInfos=this.designerOverlayInfos.filter(t=>{const a=t.templateRef===e;return a&&t.resizeObserver.disconnect(),!a}),this.update()}show(){this.overlayComponent&&!this.overlayComponent.show&&(this.overlayComponent.show=!0),this.update()}update(){this._update$.next()}ngOnDestroy(){this.designerOverlayInfos.forEach(e=>e.resizeObserver?.disconnect()),this.designerOverlayInfos=[],this.update(),this._destroyed$.next(),this._destroyed$.complete()}hide(){this.overlayComponent?.show&&(this.overlayComponent.show=!1,this._setValueToOverlayComponent())}}be.\u0275fac=function(e){return new(e||be)(n.\u0275\u0275inject(n.ApplicationRef))},be.\u0275prov=n.\u0275\u0275defineInjectable({token:be,factory:be.\u0275fac});class An{constructor(e,t){this._designerSchemaService=e,this._featureService=t,this._storage=[],this._initFeatures()}_initFeatures(){this._featureService.getFeatureState("UndoDeleteButton").pipe((0,l.filter)(e=>e)).subscribe({next:()=>{this._initUndo()}})}_initUndo(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(e=>!e.restored&&e.changes.operation===_.MetaItemDesignSettingChangesOperation.Remove)).subscribe(({changes:e})=>this._onRemove(e))}_onRemove(e){this._storage.unshift(JSON.stringify(e))}_getLastChange(){if(!this._storage.length)return null;const e=this._storage.shift();return JSON.parse(e)}_getInvertChanges(e){switch(e.operation){case _.MetaItemDesignSettingChangesOperation.Remove:return{...e,operation:_.MetaItemDesignSettingChangesOperation.Insert}}}undo(){const e=this._getLastChange();if(!e)return;const t=this._getInvertChanges(e);this._designerSchemaService.undo(t)}}An.\u0275fac=function(e){return new(e||An)(n.\u0275\u0275inject(g.DesignerSchemaService),n.\u0275\u0275inject(ae.FeatureService))},An.\u0275prov=n.\u0275\u0275defineInjectable({token:An,factory:An.\u0275fac,providedIn:"root"});class pa{constructor(e){this._lczToString=e}_getLocalizableValue(e){return this._lczToString.transform(new C.LocalizableStringArray(e.filter(t=>t.value)))}_getAttributeValidators(e){const t={};return parseInt(e.requirementType?.toString(),10)===ie.EntitySchemaColumnRequirementType.YES&&(t["crt.Required"]={type:"crt.Required"}),t}_getDataSchemaAttributeUsageType(e){return e||h.DataSchemaAttributeUsageType.General}toDataSchema(e){const t=new I.DataSchema;t.dataSourceConfig={type:"crt.EntityDataSource",config:{entitySchemaName:e.name}},t.name=e.name,t.type=h.DataSchemaType.Entity,t.primaryAttributeName=e.primaryColumn?.name,t.primaryDisplayAttributeName=e.primaryDisplayColumn?.name,t.hierarchyAttributeName=e.hierarchyColumn?.name,t.caption=this._getLocalizableValue(e.caption);const a=[...e.columns,...e.inheritedColumns];return t.attributes=a.filter(i=>i.usageType!==C.EntitySchemaColumnUsageType.None).map(i=>this.toAttributeSchema(i)),t}toAttributeSchema(e){const t=new I.DataSchemaAttribute;return t.name=e.name,t.caption=this._getLocalizableValue(e.caption),t.dataValueType=e.type,t.validators=this._getAttributeValidators(e),t.path=e.name,t.referenceSchemaName=e.referenceSchema?.name,t.attributeType=h.DataSchemaAttributeType.OwnAttribute,t.isRequired=e.requirementType===ie.EntitySchemaColumnRequirementType.YES,t.defaultValueSchema=e.defValue,t.usageType=this._getDataSchemaAttributeUsageType(e.usageType),t}}pa.\u0275fac=function(e){return new(e||pa)(n.\u0275\u0275inject(C.LczToStringPipe))},pa.\u0275prov=n.\u0275\u0275defineInjectable({token:pa,factory:pa.\u0275fac,providedIn:"root"});class Ut{constructor(e,t,a,i){this._designerEntityService=e,this._entitySchemaModelTransformer=t,this._designerDataSourceManager=a,this._designerSchemaService=i}getSchema(e,t=h.DataSchemaType.Entity){if(t===h.DataSchemaType.ClientUnit){if(this._designerSchemaService.schemaName===e)return this._designerDataSourceManager.getDataSourceSchemaByName$(C.PAGE_PARAMETERS_DATA_SOURCE_NAME);throw new Error("Retrieving arbitrary client unit data schema is not supported")}return this._designerEntityService.getByName(e).pipe((0,l.map)(a=>this._entitySchemaModelTransformer.toDataSchema(a)))}getSchemaAttribute(e,t=h.DataSchemaType.Entity){if(t===h.DataSchemaType.Entity)return this._designerEntityService.getReferenceColumn(e).pipe((0,l.map)(a=>this._entitySchemaModelTransformer.toAttributeSchema(a)));throw new Error("Retrieving data schema by path related to client unit schema is not supported")}}Ut.\u0275fac=function(e){return new(e||Ut)(n.\u0275\u0275inject(B),n.\u0275\u0275inject(pa),n.\u0275\u0275inject($),n.\u0275\u0275inject(g.DesignerSchemaService))},Ut.\u0275prov=n.\u0275\u0275defineInjectable({token:Ut,factory:Ut.\u0275fac});class Ht{constructor(e){this.designerSchemaService=e}getDefaultDataSource(){return this.designerSchemaService.getPrimaryDataSourceName()}getDefaultEntitySchema(){return this.designerSchemaService.getDataSourceConfigByName(this.getDefaultDataSource())?.entitySchemaName}}Ht.\u0275fac=function(e){return new(e||Ht)(n.\u0275\u0275inject(g.DesignerSchemaService))},Ht.\u0275prov=n.\u0275\u0275defineInjectable({token:Ht,factory:Ht.\u0275fac,providedIn:"root"});class La{constructor(e){this._fileApi=e}getFileEntitySchemaInfos(){return this._fileApi.getAllFileSchemas().pipe((0,d.map)(e=>e.map(t=>({value:t.name,displayValue:t.caption,recordColumnName:t.recordColumnName,recordSchemaName:t.recordSchemaName})).sort((t,a)=>t.displayValue.localeCompare(a.displayValue))))}}La.\u0275fac=function(e){return new(e||La)(n.\u0275\u0275inject(C.FileApiService))},La.\u0275prov=n.\u0275\u0275defineInjectable({token:La,factory:La.\u0275fac});var w=v(99293);const _s=["metaItemDesignerContainerRef"];function fs(r,e){r&1&&n.\u0275\u0275element(0,"ts-mask",9)}class Vn{constructor(e,t,a,i,o){this._registryService=e,this._dialogRef=t,this._inputSettings=a,this._changeDetectorRef=i,this._injector=o,this._destroyed$=new d.Subject,this.loading=!0,this.isModalBoxOpened=!1,this.settings=a.settings,this.caption=a.caption}set settings(e){!e||(0,x.isEqual)(this._settings,e)||(this._settings=e,this._isReadyToRenderDesigner()&&this._renderDesigner(this._settings))}_isReadyToRenderDesigner(){return!!this._metaItemDesignerContainerRef}_createDesignerComponent(e){const t=this._registryService.getDesignerComponentType(e);if(!t)throw new Error("Meta item designer type is not registered");return this._metaItemDesignerContainerRef.createComponent(t,{index:0,injector:this._injector})}_configureDesignerComponent(e){this._metaItemDesignerRef.instance.onConfigure(e),this._metaItemDesignerRef.instance.settingsChanged.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(t=>{this._settings={...this._settings,...t}}),this._metaItemDesignerRef.instance.loaded.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(()=>{this.loading=!1,this._changeDetectorRef.detectChanges()}),this._metaItemDesignerRef.instance.openModalBox.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(t=>{this.isModalBoxOpened=t,this._changeDetectorRef.detectChanges()}),this._changeDetectorRef.detectChanges()}_destroyDesignerComponentIfExists(){this._metaItemDesignerRef&&this._metaItemDesignerRef.destroy()}_renderDesigner(e){this._destroyDesignerComponentIfExists(),this.loading=!0,this._metaItemDesignerRef=this._createDesignerComponent(e.metaItemType),this._configureDesignerComponent(e)}onSaveButtonClick(){this.isModalBoxOpened||(0,d.of)(null).pipe((0,l.delay)(500),(0,l.takeUntil)(this._destroyed$)).subscribe({next:()=>{this._metaItemDesignerRef.instance.validate().isValid&&this._dialogRef.close((0,x.cloneDeep)(this._settings))}})}onCloseButtonClick(){this.isModalBoxOpened||this._dialogRef.close()}getClasses(){return{"settings-panel-header":!0,"settings-panel-cover":this.isModalBoxOpened}}ngAfterViewInit(){this._settings&&this._renderDesigner(this._settings)}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}Vn.\u0275fac=function(e){return new(e||Vn)(n.\u0275\u0275directiveInject(U),n.\u0275\u0275directiveInject(N.MatLegacyDialogRef),n.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA),n.\u0275\u0275directiveInject(n.ChangeDetectorRef),n.\u0275\u0275directiveInject(n.Injector))},Vn.\u0275cmp=n.\u0275\u0275defineComponent({type:Vn,selectors:[["crt-designer-settings"]],viewQuery:function(e,t){if(e&1&&n.\u0275\u0275viewQuery(_s,5,n.ViewContainerRef),e&2){let a;n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t._metaItemDesignerContainerRef=a.first)}},decls:15,vars:15,consts:[[3,"ngClass"],[1,"settings-panel-header-caption"],[1,"buttons"],["color","primary",1,"action-button",3,"disableRipple","disabled","clicked"],[1,"action-button",3,"disableRipple","disabled","clicked"],[1,"settings-content"],["class","component-mask",4,"ngIf"],[1,"meta-item-designer-container"],["metaItemDesignerContainerRef",""],[1,"component-mask"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0)(1,"div",1),n.\u0275\u0275text(2),n.\u0275\u0275pipe(3,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(4,"div",2)(5,"crt-button",3),n.\u0275\u0275listener("clicked",function(){return t.onSaveButtonClick()}),n.\u0275\u0275text(6),n.\u0275\u0275pipe(7,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(8,"crt-button",4),n.\u0275\u0275listener("clicked",function(){return t.onCloseButtonClick()}),n.\u0275\u0275text(9),n.\u0275\u0275pipe(10,"translate"),n.\u0275\u0275elementEnd()()(),n.\u0275\u0275elementStart(11,"div",5),n.\u0275\u0275template(12,fs,1,0,"ts-mask",6),n.\u0275\u0275elementContainer(13,7,8),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275property("ngClass",t.getClasses()),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(3,9,t.caption||"DesignerSettingsComponent.HeaderCaption")," "),n.\u0275\u0275advance(3),n.\u0275\u0275property("disableRipple",t.isModalBoxOpened)("disabled",t.loading||t.isModalBoxOpened),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(7,11,"BasePageComponent.Save")," "),n.\u0275\u0275advance(2),n.\u0275\u0275property("disableRipple",t.isModalBoxOpened)("disabled",t.isModalBoxOpened),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(10,13,"BasePageComponent.Cancel")," "),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngIf",t.loading))},dependencies:[f.NgClass,f.NgIf,u.CrtButtonComponent,w.MaskComponent,D.TranslatePipe],styles:[".settings-panel-header[_ngcontent-%COMP%]{padding-left:32px}.settings-panel-header[_ngcontent-%COMP%]   .settings-panel-header-caption[_ngcontent-%COMP%]{display:inline-block;width:100%;overflow:hidden}.settings-panel-header[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;justify-items:flex-start;align-items:flex-start;flex-flow:row nowrap;margin-bottom:32px}.settings-panel-header[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{margin-right:16px}.settings-panel-cover[_ngcontent-%COMP%]{transition:opacity .3s ease}.settings-content[_ngcontent-%COMP%]{position:relative;height:100%}.settings-content[_ngcontent-%COMP%]   .component-mask[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%}"]});class ga{constructor(e){this._dialogService=e}openSettings$(e){return this._dialogService.open(Vn,{data:e,panelClass:"settings-panel",width:"calc(100vw - 40px)",minWidth:"calc(100vw - 40px)",height:"calc(100vh - 40px)"})}}ga.\u0275fac=function(e){return new(e||ga)(n.\u0275\u0275inject(w.DialogService))},ga.\u0275prov=n.\u0275\u0275defineInjectable({token:ga,factory:ga.\u0275fac});class dt{constructor(e){this._zone=e,this._animationSpeed=10,this._openPanelAnimationMode="none",this._destroyed$=new d.Subject,this._animationInProgress=!1,this.animationMode$=new d.Subject,this.animationEnd$=new d.Subject,this._subscribeAnimationMode()}_subscribeAnimationMode(){this.animationMode$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(e=>{this._openPanelAnimationMode=e})}_setPanelPosition(e){this.panelElement.style.transform=`translateX(${e}px)`}_resetPanelPosition(){this.panelElement.style.transform=""}_clonePanel(){const e=this.panelElement.cloneNode(!0);this.panelCloneElement.appendChild(e)}_clearPanelCloneWrapper(){this.panelCloneElement.innerHTML=""}_resetOpenPanelAnimationMode(){this._openPanelAnimationMode="none"}setup(e){for(const t of Object.keys(e))this[t]=e[t]}setDesignSettingsWithAnimation(e){this._zone.runOutsideAngular(()=>{if(this._openPanelAnimationMode==="none"){e();return}this._animationInProgress&&this.animationEnd$.next(),this._animationInProgress=!0,this._clonePanel();const t=this._openPanelAnimationMode;this._resetOpenPanelAnimationMode();const{width:a}=this.panelElement.getBoundingClientRect(),i=t==="backward"?-1:1;let o=a*i;this._setPanelPosition(o),e();const s=a/this._animationSpeed*i;(0,d.interval)(0,d.animationFrameScheduler).pipe((0,l.takeUntil)(this.animationEnd$),(0,l.finalize)(()=>{this._clearPanelCloneWrapper(),this._resetPanelPosition(),this._animationInProgress=!1})).subscribe(()=>{o-=s,(t==="backward"?o<=0:o>=0)?this._setPanelPosition(o):this.animationEnd$.next()})})}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}dt.\u0275fac=function(e){return new(e||dt)(n.\u0275\u0275inject(n.NgZone))},dt.\u0275prov=n.\u0275\u0275defineInjectable({token:dt,factory:dt.\u0275fac});var Cs=v(2876);class Wt{constructor(e,t){this._httpClient=e,this._timelineResourcesService=t,this._defaultSortedByColumn="CreatedOn",this._timelineServiceUrl="/rest/TimelineDesignService",this._predefinedTimelineService="/ServiceModel/TimelineEntityService.svc/",this._defaultObjects=[{schemaType:"SysFile",sortedByColumn:this._defaultSortedByColumn,isDefault:!0},{schemaType:"Feed",sortedByColumn:this._defaultSortedByColumn,isDefault:!0}],this.availableObjects$=new d.ReplaySubject(1)}_convertToDesignerTimelineModel(e,t){const a=[];return!e||e.length===0?(0,d.of)(this._defaultObjects):this._loadSchemesInfo(e.map(i=>i.schemaName),t).pipe((0,l.map)(i=>{e.forEach(o=>{const s={uId:o.uId,schemaName:o.schemaName,schemaType:o.typeColumnValueName,filter:o.timelineFilter,columns:[],linkedColumn:i.find(c=>c.schemaName===o.schemaName).caption,sortedByColumn:o.sortColumn??this._defaultSortedByColumn,ownerColumn:o.ownerColumn,isDefault:!0,iconId:o.iconId};o.predefinedColumns?.forEach(c=>{const m={columnName:c.ColumnName,columnLayout:JSON.parse(c.ColumnLayout)};s.columns.push(m)}),a.push(s)})}),(0,l.map)(()=>a.concat(this._defaultObjects)))}_loadSchemesInfo(e,t){return this._timelineResourcesService.getEntitySchemes(e).pipe((0,l.map)(a=>a.map(i=>({schemaName:i.name,caption:i.columns.filter(o=>o.referenceSchemaName===t)[0]?.name}))))}getPredefinedObjects(e){return this._httpClient.post(this._predefinedTimelineService+"GetTimelineEntities",{schemaName:e}).pipe((0,l.pluck)("values"),(0,l.mergeMap)(t=>(0,d.forkJoin)(this._convertToDesignerTimelineModel(t,e))),(0,l.switchMap)(t=>t))}getAvailableObjects(e){return this._httpClient.post(this._timelineServiceUrl+"/GetSources",{sourceSchemaName:e}).pipe((0,l.map)(t=>[]))}warmUpSchemesLoading(e){return this._timelineResourcesService.getEntitySchemes(e).pipe((0,l.map)(()=>null))}}Wt.\u0275fac=function(e){return new(e||Wt)(n.\u0275\u0275inject(Cs.HttpClient),n.\u0275\u0275inject(u.TimelineResourcesService))},Wt.\u0275prov=n.\u0275\u0275defineInjectable({token:Wt,factory:Wt.\u0275fac,providedIn:"root"});class Be{constructor(e){this._timelineResourcesService=e,this._customEntityCaptionKey="Components.Timeline.DesignerCustomEntities",this._timelineTypeName="crt.TimelineTile"}_getTileItemName(e){const t=e.schemaType||e.schemaName;return G.NameGenerator.generateUnique(`TimelineTile_${t}`)}getNewViewItemConfig(e,t){const a=t.items?.length||0,i={type:this._timelineTypeName,classes:["view-element"],linkedColumn:e.linkedColumn,sortedByColumn:e.sortedByColumn,ownerColumn:e.ownerColumn,iconId:e.iconId,data:e,name:this._getTileItemName(e)};return delete i.data.ownerColumn,delete i.data.linkedColumn,delete i.data.sortedByColumn,delete i.data.iconId,{containerName:t.name,index:a,designerTool:{defaultConfig:{type:i.type,defaultPropertyValues:i}}}}getCaption(e){const t=e.schemaType||e.schemaName;return this._timelineResourcesService.getCaption(t,this._customEntityCaptionKey)}getCaptions(e){const t=e.map(a=>a.schemaType||a.schemaName);return this._timelineResourcesService.getCaptions(t,this._customEntityCaptionKey)}}Be.\u0275fac=function(e){return new(e||Be)(n.\u0275\u0275inject(u.TimelineResourcesService))},Be.\u0275prov=n.\u0275\u0275defineInjectable({token:Be,factory:Be.\u0275fac});class _e{constructor(e,t,a,i){this.designerEntityDataSourceService=e,this.designerSchemaService=t,this.approvalSchemaService=a,this.designerCommandFactoryService=i}static _getViewChanges(e){return[{path:"itemConfig.entityName",value:e.rootEntityName,applyPropertyStrategy:_.ApplyChangedPropertyStrategy.Override},{path:"itemConfig.approvalEntityName",value:e.approvalSchemaConfig?.entityName,applyPropertyStrategy:_.ApplyChangedPropertyStrategy.Override}]}_updateViewItem(e,t){const a={name:e,changes:t};return this.designerCommandFactoryService.create("crt.ChangeViewItemCommand",a).pipe((0,d.mergeMap)(i=>i.execute()))}_getPrimaryDataSource(e){if(!e||e.length===0)return null;const t=this.designerSchemaService.getPrimaryDataSourceName();return t?e.find(a=>a.dataSourceName===t):e[0]}updateComponentProperties(e,t){const a=_e._getViewChanges(t);return this._updateViewItem(e,a)}getDefaultApprovalConfig(){const e={};return this.designerEntityDataSourceService.getDataSources$().pipe((0,d.take)(1),(0,d.switchMap)(t=>{const a=this._getPrimaryDataSource(t);return e.primaryDataSourceName=a?.dataSourceName,a?a.getSchema():(0,d.of)(null)}),(0,d.take)(1),(0,d.switchMap)(t=>(e.rootEntityName=t?.dataSourceConfig?.config?.entitySchemaName,(0,d.of)(e.rootEntityName))),(0,d.switchMap)(t=>t?this.approvalSchemaService.getApprovalSchemaName(t).pipe((0,d.map)(a=>{e.approvalSchemaConfig=a})):(0,d.of)(null)),(0,d.map)(()=>e))}setDependencies(e,t,a){const i=this.designerSchemaService.getModelDependencies()||{},o={[e]:[{matchedDsName:t,matchedDsAttributeName:"Id",targetDsName:e,targetDsAttributeName:a}]},s=gi.toModelsDependenciesConfig(o,this.designerSchemaService.getModelConfig());i[e]=s[e],this.designerSchemaService.setModelDependencies(i)}}_e.\u0275fac=function(e){return new(e||_e)(n.\u0275\u0275inject(le),n.\u0275\u0275inject(g.DesignerSchemaService),n.\u0275\u0275inject(u.ApprovalSchemaService),n.\u0275\u0275inject(g.DesignerCommandFactoryService))},_e.\u0275prov=n.\u0275\u0275defineInjectable({token:_e,factory:_e.\u0275fac});class ua extends I.ModelGenerator{constructor(e,t,a,i){super(e,t,a,i),this.injector=i}preInitializeDataSources(e){const t=Object.fromEntries(e);return this.injector.get(le).initDataSources(t).pipe((0,l.take)(1),(0,d.map)(()=>{}))}}ua.\u0275fac=function(e){return new(e||ua)(n.\u0275\u0275inject(I.DataSourceFactoryService),n.\u0275\u0275inject(C.EntitySchemaRepository),n.\u0275\u0275inject(h.FeatureService),n.\u0275\u0275inject(n.Injector))},ua.\u0275prov=n.\u0275\u0275defineInjectable({token:ua,factory:ua.\u0275fac});class Qt{constructor(){this._store=new Map}set(e){this._store.has(e.name)||this._store.set(e.name,e)}get(e){return this._store.get(e)}ngOnDestroy(){this._store.clear()}}Qt.\u0275fac=function(e){return new(e||Qt)},Qt.\u0275prov=n.\u0275\u0275defineInjectable({token:Qt,factory:Qt.\u0275fac});class Le{constructor(e){this._window=e,this.queryScrollPosition$=new d.Subject,this.receiveScrollPosition$=new d.Subject,this.restoreScrollPosition$=new d.Subject}saveScrollPosition(){this.receiveScrollPosition$.pipe((0,l.take)(1),(0,l.filter)(Boolean)).subscribe(e=>{const t=Le.storageKey;this._window.localStorage.setItem(t,String(e))}),this.queryScrollPosition$.next()}restoreScrollPosition(){const e=Le.storageKey,t=this._window.localStorage.getItem(e);this._window.localStorage.removeItem(e);const a=t?Number.parseInt(t):0;a&&this.restoreScrollPosition$.next(a)}}Le.storageKey="properties_panel_scroll_position",Le.\u0275fac=function(e){return new(e||Le)(n.\u0275\u0275inject(G.WINDOW_TOKEN))},Le.\u0275prov=n.\u0275\u0275defineInjectable({token:Le,factory:Le.\u0275fac});var Ai=v(8785);const Vi="InterfaceDesigner.PropertiesPages.DataSourceAttributePropertiesPanel";class mo{constructor(){this._allowedCharactersRegex=new RegExp("^[A-Za-z0-9_]*$"),this._sysSettingsService=(0,n.inject)(ae.SysSettingsService),this._translateService=(0,n.inject)(D.TranslateService),this._designerDataSourceManager=(0,n.inject)($),this.designerEntityService=(0,n.inject)(B)}_getRequirementTypeOption(e){const t=it.ATTRIBUTE_REQUIREMENT_TYPE_ITEMS[e],a=`${Vi}.RequirementType.${t.name}Caption`;return{value:e.toString(),displayValue:this._translateService.instant(a)}}_getAllowedDataValueTypes(e){const t=C.ChangeColumnTypeRules.getAllowedChangeTypes(e).map(a=>a.type);return[e,...t]}_getDataValueTypeOptionPayload(e){const t=e,a=this._translateService.instant(C.DataValueTypeItems[e].translateKey);return{value:t,displayValue:a}}_getHasOnlyAllowedCharacters(e){return this._allowedCharactersRegex.test(e)}_getIsNotNullOrEmpty(e){return e!=null&&e.length>0}_checkCodeValueForAllowedChars(e){const t=e.value;return this._getIsNotNullOrEmpty(t)?!this._getHasOnlyAllowedCharacters(t):!1}_getValidatorErrorWithMessage(e,t){return{[e]:{message:this._translateService.instant(t)}}}_getValidatorErrorWithCustomMessage(e,t){return this._getValidatorErrorWithMessage(e,`${Vi}.Validators.${t}`)}_getCustomValidatorErrorsWithMessageFormat(e,t,...a){return{[e]:{message:Ai.String.format(this._translateService.instant(`${Vi}.Validators.${t}`),a)}}}_getValuePrefixValidationResult(e,t){const a=e.value;return this._getIsNotNullOrEmpty(a)&&!a.startsWith(t)?this._getCustomValidatorErrorsWithMessageFormat("getIsValidPrefix","InvalidPrefix",t):null}_getExistsValueValidation(e,t){return t?this._getCustomValidatorErrorsWithMessageFormat("getIsUniqueName","UniqueName",e):null}_getAttributesValidators(e,t){return(0,d.of)({name:[{name:"getIsAllowedCharacters",isAsync:!1,validatorFn:this.getIsAllowedCharactersValidator()},{name:"getIsUniqueName",isAsync:!1,validatorFn:this.getIsUniqueNameValidator(e,t)},{name:"getIsValidPrefix",isAsync:!0,validatorFn:this.getPrefixAsyncValidator()}]})}getIsUniqueNameValidator(e,t){return a=>{const i=a.value;if(i===t)return null;const o=e.attributes.filter(s=>s.name===i);return this._getExistsValueValidation(i,Boolean(o&&o.length>0))}}getPrefixAsyncValidator(){return e=>this._sysSettingsService.getValueByCode("SchemaNamePrefix","").pipe((0,l.map)(t=>this._getValuePrefixValidationResult(e,t)))}getIsAllowedCharactersValidator(){return e=>this._checkCodeValueForAllowedChars(e)?this._getValidatorErrorWithCustomMessage("getIsAllowedCharacters","InvalidCharacter"):null}getRequirementTypeLookupItems(e=[it.AttributeRequirementType.NO,it.AttributeRequirementType.YES]){return e.map(t=>this._getRequirementTypeOption(t))}getFormatLookupItems(e){return this._getAllowedDataValueTypes(e).map(t=>this._getDataValueTypeOptionPayload(t))}getReferenceSchemaLookupItems(){return this.designerEntityService.getAvailableReferenceSchemas().pipe((0,l.map)(e=>e.map(t=>({displayValue:t.caption,value:t.uId,name:t.name}))))}getFieldsValidators(e,t){return this._designerDataSourceManager.getDataSourceSchemaByName$(e).pipe((0,d.switchMap)(a=>this._getAttributesValidators(a,t)))}}const po={channel:"widget-designer-channel",requestConfig:"RequestWidgetConfig",responseConfig:"ResponseWidgetConfig",saveConfig:"SaveWidgetConfig",designerLoaded:"DesignerLoaded",modalOpening:"ModalOpening",modalClosing:"ModalClosing"},Fi=new n.InjectionToken("Represents a names of window massages events");function go(r){return{provide:Fi,useValue:{...po,...r}}}class qt{set initialConfig(e){this._initialConfig=e}constructor(e,t){this._window=e,this._widgetWindowMessageNames=t,this.INITIALIZE_MESSAGE="initialize",this.MESSAGE_EVENT="message",this.configChanged$=new d.Subject,this.designerLoaded$=new d.Subject,this.modalOpening$=new d.Subject,this.modalClosing$=new d.Subject}_postMessage(e,t){this._contentWindow.postMessage({channel:this._widgetWindowMessageNames.channel,name:e,payload:t},window.location.origin)}initCommunication(e){return this._contentWindow=e,(0,d.fromEvent)(this._window,this.MESSAGE_EVENT).pipe((0,l.filter)(t=>t?.data?.channel===this._widgetWindowMessageNames.channel))}onMessage(e){const{data:{name:t="",payload:a={}}}=e||{};switch(t){case this.INITIALIZE_MESSAGE:{const{handshakeMessage:i}=a;this._postMessage(i);break}case this._widgetWindowMessageNames.requestConfig:this._postMessage(this._widgetWindowMessageNames.responseConfig,this._initialConfig);break;case this._widgetWindowMessageNames.saveConfig:this.configChanged$.next(e?.data?.payload);break;case this._widgetWindowMessageNames.designerLoaded:this.designerLoaded$.next();break;case this._widgetWindowMessageNames.modalOpening:this.modalOpening$.next();break;case this._widgetWindowMessageNames.modalClosing:this.modalClosing$.next();break}}}qt.\u0275fac=function(e){return new(e||qt)(n.\u0275\u0275inject(G.WINDOW_TOKEN),n.\u0275\u0275inject(Fi))},qt.\u0275prov=n.\u0275\u0275defineInjectable({token:qt,factory:qt.\u0275fac,providedIn:"root"});class mt{static forRoot(e){return{ngModule:mt,providers:[G.WINDOW_PROVIDER,qt,go(e)]}}}mt.\u0275fac=function(e){return new(e||mt)},mt.\u0275mod=n.\u0275\u0275defineNgModule({type:mt}),mt.\u0275inj=n.\u0275\u0275defineInjector({});class Fn{constructor(e){this._designerSchemaService=e}remove(e){this._designerSchemaService.remove(e.name)}update(e,{itemConfig:t,resources:a,viewModelConfig:i,applyPropertiesStrategies:o,selectOnCanvas:s=!0}){this._designerSchemaService.update({itemConfig:t,resources:a,viewModelConfig:i,applyPropertiesStrategies:o,selectOnCanvas:s})}create(e){return this._designerSchemaService.create(e)}}Fn.\u0275fac=function(e){return new(e||Fn)(n.\u0275\u0275inject(g.DesignerSchemaService))},Fn.\u0275prov=n.\u0275\u0275defineInjectable({token:Fn,factory:Fn.\u0275fac});var Q=v(34560),se=v(66868),P=v(96923);class Nn{constructor(){this.save=new n.EventEmitter,this.cancel=new n.EventEmitter}_isNameValid(e){return e&&e.find(t=>t.value)!==void 0}onSave(){this._isNameValid(this.name)?this.save.emit({name:this.name,description:this.description}):this.name=void 0}onCancel(){this.cancel.emit()}}Nn.\u0275fac=function(e){return new(e||Nn)},Nn.\u0275cmp=n.\u0275\u0275defineComponent({type:Nn,selectors:[["crt-setup-entity-properties-dialog"]],inputs:{title:"title"},outputs:{save:"save",cancel:"cancel"},decls:22,vars:17,consts:[["mat-dialog-title","",1,"crt-setup-entity-properties-dialog-title"],[1,"crt-setup-entity-properties-dialog-form-field"],["floatLabel","always","data-qa","name-form-field"],["iconLineType","bold","required","","data-qa","name",3,"ngModel","label","ngModelChange"],["floatLabel","always","data-qa","description-form-field"],["iconLineType","bold","data-qa","description",3,"ngModel","label","ngModelChange"],[1,"crt-setup-entity-properties-dialog-actions"],["mat-button","","data-qa","cancel","shape","rounded",3,"clicked"],["mat-flat-button","","color","primary","data-qa","save","shape","rounded",3,"clicked"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275text(1),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(2,"mat-dialog-content")(3,"div",1)(4,"mat-form-field",2)(5,"mat-label"),n.\u0275\u0275text(6),n.\u0275\u0275pipe(7,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(8,"ts-localizable-text-input",3),n.\u0275\u0275listener("ngModelChange",function(i){return t.name=i}),n.\u0275\u0275elementEnd()()(),n.\u0275\u0275elementStart(9,"div",1)(10,"mat-form-field",4)(11,"mat-label"),n.\u0275\u0275text(12),n.\u0275\u0275pipe(13,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(14,"ts-localizable-text-input",5),n.\u0275\u0275listener("ngModelChange",function(i){return t.description=i}),n.\u0275\u0275elementEnd()()()(),n.\u0275\u0275elementStart(15,"mat-dialog-actions",6)(16,"crt-button",7),n.\u0275\u0275listener("clicked",function(){return t.onCancel()}),n.\u0275\u0275text(17),n.\u0275\u0275pipe(18,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(19,"crt-button",8),n.\u0275\u0275listener("clicked",function(){return t.onSave()}),n.\u0275\u0275text(20),n.\u0275\u0275pipe(21,"translate"),n.\u0275\u0275elementEnd()()),e&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",t.title,`
`),n.\u0275\u0275advance(5),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind1(7,9,"InterfaceDesigner.SetupEntityPropertiesDialog.Name")),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngModel",t.name)("label",""),n.\u0275\u0275advance(4),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind1(13,11,"InterfaceDesigner.SetupEntityPropertiesDialog.Description")),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngModel",t.description)("label",""),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(18,13,"InterfaceDesigner.SetupEntityPropertiesDialog.CancelButton")," "),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(21,15,"InterfaceDesigner.SetupEntityPropertiesDialog.SaveButton")," "))},dependencies:[u.CrtButtonComponent,Q.NgControlStatus,Q.RequiredValidator,Q.NgModel,N.MatLegacyDialogTitle,N.MatLegacyDialogContent,N.MatLegacyDialogActions,se.MatLegacyFormField,se.MatLegacyLabel,P.LocalizableTextInputComponent,D.TranslatePipe],styles:["[mat-dialog-title].crt-setup-entity-properties-dialog-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px}.crt-setup-entity-properties-dialog-form-field[_ngcontent-%COMP%]{width:100%;margin-top:5px}.crt-setup-entity-properties-dialog-form-field[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{display:block}.crt-setup-entity-properties-dialog-actions[_ngcontent-%COMP%]{justify-content:flex-end;gap:8px}"],changeDetection:0});class Rn{constructor(e,t,a){this._dialog=e,this._commandFactoryService=t,this._defaultEntityColumnService=a}_executeAddEntityDataSourceCommand(e){const t=this._defaultEntityColumnService.create(),a={caption:e.name,description:e.description,primaryDisplayColumnName:t.name,columnConfigs:[t],scope:h.DataSourceScope.Page};return(0,g.executeCommand)(this._commandFactoryService,"crt.AddEntityDataSourceCommand",a)}_getAddEntityDataSourceResult(e){const{success:t,dataSourceName:a,entitySchemaName:i,errorMessage:o}=e||{};return t?{success:!0,dataSourceName:a,entitySchemaName:i}:{success:!1,errorMessage:o}}onSave(e){var t=this;return(0,F.Z)(function*(){const a=yield t._executeAddEntityDataSourceCommand(e),i=t._getAddEntityDataSourceResult(a);t._dialog.close(i)})()}onCancel(){this._dialog.close({success:!1})}}Rn.\u0275fac=function(e){return new(e||Rn)(n.\u0275\u0275directiveInject(N.MatLegacyDialogRef),n.\u0275\u0275directiveInject(g.DesignerCommandFactoryService),n.\u0275\u0275directiveInject(ct))},Rn.\u0275cmp=n.\u0275\u0275defineComponent({type:Rn,selectors:[["crt-add-data-source"]],decls:2,vars:3,consts:[[3,"title","save","cancel"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"crt-setup-entity-properties-dialog",0),n.\u0275\u0275listener("save",function(i){return t.onSave(i)})("cancel",function(){return t.onCancel()}),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275elementEnd()),e&2&&n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(1,1,"InterfaceDesigner.SetupDataSourceDialog.SetupDataSourceTitle"))},dependencies:[Nn,D.TranslatePipe],styles:["[_nghost-%COMP%]{width:360px;box-sizing:border-box}"]});class pt{}pt.\u0275fac=function(e){return new(e||pt)},pt.\u0275mod=n.\u0275\u0275defineNgModule({type:pt}),pt.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,u.CrtButtonModule,Q.FormsModule,N.MatLegacyDialogModule,se.MatLegacyFormFieldModule,P.LocalizableTextModule,Q.ReactiveFormsModule,D.TranslateModule]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(pt,{declarations:[Nn],imports:[f.CommonModule,u.CrtButtonModule,Q.FormsModule,N.MatLegacyDialogModule,se.MatLegacyFormFieldModule,P.LocalizableTextModule,Q.ReactiveFormsModule,D.TranslateModule],exports:[Nn]})}();class Kt{}Kt.\u0275fac=function(e){return new(e||Kt)},Kt.\u0275mod=n.\u0275\u0275defineNgModule({type:Kt}),Kt.\u0275inj=n.\u0275\u0275defineInjector({providers:[ct],imports:[f.CommonModule,pt,N.MatLegacyDialogModule,D.TranslateModule]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Kt,{declarations:[Rn],imports:[f.CommonModule,pt,N.MatLegacyDialogModule,D.TranslateModule],exports:[Rn]})}();class ha{constructor(e,t,a){this._dialog=e,this._commandFactoryService=t,this._defaultEntityColumnService=a}_executeAddEntityCommand(e){const t=this._defaultEntityColumnService.create(),a={caption:e.name,description:e.description,primaryDisplayColumnName:t.name,columnConfigs:[t]};return(0,g.executeCommand)(this._commandFactoryService,"crt.AddEntityCommand",a)}_getAddEntityResult(e){const{success:t,entitySchemaName:a,errorMessage:i}=e||{};return t?{success:!0,entitySchemaName:a}:{success:!1,errorMessage:i}}onSave(e){var t=this;return(0,F.Z)(function*(){const a=yield t._executeAddEntityCommand(e),i=t._getAddEntityResult(a);t._dialog.close(i)})()}onCancel(){this._dialog.close({success:!1})}}ha.\u0275fac=function(e){return new(e||ha)(n.\u0275\u0275directiveInject(N.MatLegacyDialogRef),n.\u0275\u0275directiveInject(g.DesignerCommandFactoryService),n.\u0275\u0275directiveInject(ct))},ha.\u0275cmp=n.\u0275\u0275defineComponent({type:ha,selectors:[["crt-add-entity"]],decls:2,vars:3,consts:[[3,"title","save","cancel"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"crt-setup-entity-properties-dialog",0),n.\u0275\u0275listener("save",function(i){return t.onSave(i)})("cancel",function(){return t.onCancel()}),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275elementEnd()),e&2&&n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(1,1,"InterfaceDesigner.SetupEntityDialog.Title"))},dependencies:[Nn,D.TranslatePipe],styles:["[_nghost-%COMP%]{width:360px;box-sizing:border-box}"]});class Jt{}Jt.\u0275fac=function(e){return new(e||Jt)},Jt.\u0275mod=n.\u0275\u0275defineNgModule({type:Jt}),Jt.\u0275inj=n.\u0275\u0275defineInjector({providers:[ct],imports:[f.CommonModule,pt,N.MatLegacyDialogModule,D.TranslateModule]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Jt,{declarations:[ha],imports:[f.CommonModule,pt,N.MatLegacyDialogModule,D.TranslateModule],exports:[ha]})}();var ys=v(13098),uo=v(75130),Z;(function(r){r[r.Edit=0]="Edit",r[r.Delete=1]="Delete",r[r.Copy=2]="Copy"})(Z||(Z={}));var ui;(function(r){r.OpenSourceCode="OpenSourceCode"})(ui||(ui={}));class ba{constructor(e,t){this._commandFactoryService=e,this._designerSchemaService=t}_resolveViewItemChangeCommand(e){const t=this._designerSchemaService.getViewConfigInfoByName(e);return h.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos.get(t.viewConfig?.type)?.designViewItemCommands?.update??"crt.ChangeViewItemCommand"}resolve(e){const a={[g.DesignType.DataSourceAttribute]:"crt.ChangeDataSourceItemCommand",[g.DesignType.DataSource]:"crt.ChangeEntityDataSourceCommand",[g.DesignType.ViewElement]:this._resolveViewItemChangeCommand(e.name),[g.DesignType.ViewElementBinding]:"crt.ChangeViewItemBinding"}[e.type];return a?this._commandFactoryService.create(a,e):(0,d.of)(null)}}ba.\u0275fac=function(e){return new(e||ba)(n.\u0275\u0275inject(g.DesignerCommandFactoryService),n.\u0275\u0275inject(g.DesignerSchemaService))},ba.\u0275prov=n.\u0275\u0275defineInjectable({token:ba,factory:ba.\u0275fac});const Ni=new n.InjectionToken("SHOULD_LIFT_GRID_ELEMENTS"),ho=new n.InjectionToken("SHOULD_FILL_ROWS_OF_VISIBLE_PART"),vs=new n.InjectionToken("Use for provide commands handlers"),bo=new n.InjectionToken("CENTER_CANVAS_ELEMENT"),_o=new n.InjectionToken("Is schema changed token");var hi=v(99852);class Zt{get _designerSchemaResources(){return this.designerSchemaService.resources}constructor(e){this.injector=e,this.injectDependencies()}findValueFromResource(e){return this._resourceFinderService.findValueFromResource(e,this._designerSchemaResources)||""}findTranslate(e){return this._translateService.instant(e)||""}injectDependencies(){this.designerSchemaService=this.injector.get(g.DesignerSchemaService),this._resourceFinderService=this.injector.get(C.ResourceFinderService),this._translateService=this.injector.get(D.TranslateService)}createDisplayValue(e,t){if(e){const a=e?.caption??e?.title??e?.label??e?.config?.title;return(0,d.of)(this.findValueFromResource(a))}return(0,d.of)(e.name)}getDisplayValue(e,t){return this.createDisplayValue(e,t)}}class ce{constructor(e){this._injector=e}static register(e,t){ce.exists(e)||this._items.set(e,t)}static _getCreatorType(e){return ce._items.get(e)}static exists(e){return ce._items.has(e)}get(e){const t=ce._getCreatorType(e);return t?new t(this._injector):new Zt(this._injector)}}ce._items=new Map,ce.\u0275fac=function(e){return new(e||ce)(n.\u0275\u0275inject(n.Injector))},ce.\u0275prov=n.\u0275\u0275defineInjectable({token:ce,factory:ce.\u0275fac,providedIn:"root"});function _a(r){return function(e){return U.registerItem({type:r.type,component:e}),e}}function M(r){return function(e){if(!r.type.startsWith("crt."))throw new Error(`Error when register ${r.type} command. Type property should have format "VendorPrefix.TypeName"`);g.DesignerCommandFactoryService.register(r.type,e)}}function H(r){return function(e){if(!r.type.startsWith("crt."))throw new Error(`Error registering ${r.type} caption creator.
				Type property should start with "crt." prefix.`);ce.register(r.type,e)}}let Ri=class extends Zt{createDisplayValue(e){return(0,d.of)(this.findTranslate("InterfaceDesigner.PropertiesPages.TabPanelPropertiesPage.ItemsLabel"))}};Ri=(0,p.__decorate)([H({type:"crt.TabPanel"})],Ri);let zi=class extends Zt{constructor(e,t,a){super(e),this.injector=e,this._dataSourceManager=t,this._designerEntityService=a,this._dataSourceManager=e.get($),this._designerEntityService=e.get(B)}createDisplayValue(e){if(e.items){const t=e.items?.slice(1).split(".").pop()||"",a=this.designerSchemaService.getViewModelConfig();if(!a?.attributes)return(0,d.of)("");const i=a?.attributes[t]??{};let o=[];(0,I.isModelAttributeConfig)(i)&&(o=i?.modelConfig?.path?.split("."));const s=o?.shift();return s?this._dataSourceManager.getDataSourceByName$(s).pipe((0,d.switchMap)(c=>c.getSchema()),(0,d.map)(c=>c.dataSourceConfig?.config.entitySchemaName),(0,d.switchMap)(c=>this._designerEntityService.getEntityCaption(c))):(0,d.of)("")}return(0,d.of)(e.name)}};zi=(0,p.__decorate)([H({type:"crt.DataGrid"}),H({type:"crt.Gallery"}),(0,p.__metadata)("design:paramtypes",[n.Injector,$,B])],zi);let ki=class extends Zt{constructor(e){super(e),this.injector=e,this._designerEntityService=e.get(B)}createDisplayValue(e){const t=e.rootSchemaName;return t?this._designerEntityService.getEntityCaption(t):(0,d.of)(e.name)}};ki=(0,p.__decorate)([H({type:"crt.FolderTree"}),(0,p.__metadata)("design:paramtypes",[n.Injector])],ki);let Bi=class extends Zt{constructor(e,t){super(e),this.injector=e,this._dataSourceManager=t,this._dataSourceManager=e.get($)}createDisplayValue(e){const t=e?.control;if(t){const i=t.slice(1).split(".").pop()||"",o=this.designerSchemaService.getViewModelConfig();if(!o?.attributes)return(0,d.of)("");const s=o.attributes[i]??{};let c=[];(0,I.isModelAttributeConfig)(s)&&(c=s.modelConfig?.path?.split("."));const m=c?.shift(),b=c?.pop();return!m||!b?(0,d.of)(""):this._dataSourceManager.getDataSourceByName$(m).pipe((0,d.switchMap)(y=>y.getSchema()),(0,d.map)(y=>y?.findAttributeByName(b)),(0,d.map)(y=>y?.caption??""))}const a=e?.label;return a?(0,d.of)(this.findValueFromResource(a)):(0,d.of)(e.name)}};Bi=(0,p.__decorate)([H({type:"crt.Input"}),H({type:"crt.ComboBox"}),H({type:"crt.NumberInput"}),H({type:"crt.FileInput"}),H({type:"crt.Slider"}),H({type:"crt.DateTimePicker"}),H({type:"crt.Checkbox"}),H({type:"crt.WebInput"}),H({type:"crt.EmailInput"}),H({type:"crt.PhoneInput"}),H({type:"crt.RichTextEditor"}),H({type:"crt.ColorPicker"}),(0,p.__metadata)("design:paramtypes",[n.Injector,$])],Bi);let Li=class extends Zt{constructor(e,t){super(e),this.injector=e,this._designerTimelineConfigService=t,this._designerTimelineConfigService=e.get(Be)}createDisplayValue(e){return this._designerTimelineConfigService.getCaption(e.data)}};Li=(0,p.__decorate)([H({type:"crt.TimelineTile"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Be])],Li);let ji=class extends Zt{createDisplayValue(e){let t="";switch(e.type){case"crt.EmailComposer":t="DesignerCustomEntities.Email.Caption";break;case"crt.FeedComposer":t="DesignerCustomEntities.Feed.Caption";break;case"crt.MessageComposerSelector":t="Caption";break;default:t="";break}return(0,d.of)((0,x.isEmpty)(t)?t:this.findTranslate(`Components.MessageComposer.${t}`))}};ji=(0,p.__decorate)([H({type:"crt.MessageComposerSelector"}),H({type:"crt.EmailComposer"}),H({type:"crt.FeedComposer"})],ji);let Gi=class extends Zt{constructor(e){super(e),this.injector=e}_getLocalizedSeriesTitle(e,t){const a=t.find(i=>i?.data?.providing?.attribute===e);return a?.label?this.findValueFromResource(a.label):null}createDisplayValue(e,t){const a=super.createDisplayValue(e),i=e.config?.series||[],o=t?.attributeName;if(!o||i.length<=1)return a;const s=this._getLocalizedSeriesTitle(o,i);return s?a.pipe((0,l.map)(c=>`${s} | ${c}`)):a}};Gi=(0,p.__decorate)([H({type:"crt.ChartWidget"}),(0,p.__metadata)("design:paramtypes",[n.Injector])],Gi);class fa{constructor(e,t,a){this._designerSchemaService=e,this._designerContainerService=t,this._displayValueCreatorFactoryService=a,this._destroyed$=new d.Subject,this._navigationChanged$=new d.Subject,this._subscribeOnSelectElement(),this._subscribeOnSchemaChanged()}_getPreparedItemType(e){return/crt.*?Composer$/.test(e)?"crt.MessageComposerItem":e}_selectSupportedNavigationItems(e){const t=e[e.length-1];switch(this._getPreparedItemType(t?.type)){case"crt.MenuItem":return this._getAccessibleNavigationItems(e,["crt.Button","crt.DataGrid"]);case"crt.TabContainer":return this._getAccessibleNavigationItems(e,"crt.TabPanel");case"crt.TimelineTile":return this._getAccessibleNavigationItems(e,"crt.Timeline");case"crt.MessageComposerItem":return this._getAccessibleNavigationItems(e,"crt.MessageComposerSelector");default:return[]}}_subscribeOnSelectElement(){this._designerContainerService.selectedChanged$.pipe((0,l.takeUntil)(this._destroyed$),(0,l.switchMap)(({name:e})=>(this._elementName=e,this._getNavigationTree(this._elementName)))).subscribe(e=>{const t=this._selectSupportedNavigationItems(e);this._navigationChanged$.next(t)})}_getDisplayValue(e){return this._displayValueCreatorFactoryService.get(e.type)?.getDisplayValue(e)}_subscribeOnSchemaChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.takeUntil)(this._destroyed$),(0,l.filter)(({changes:{viewConfig:e,operation:t}})=>t===_.MetaItemDesignSettingChangesOperation.Update&&e.name===this._elementName),(0,l.switchMap)(({changes:e})=>this._getNavigationTree(e.viewConfig.name))).subscribe(e=>{const t=this._selectSupportedNavigationItems(e);this._navigationChanged$.next(t)})}_getAccessibleNavigationItems(e,t){const a=Array.isArray(t)?t:[t],o=e.map(s=>a.includes(s.type)).lastIndexOf(!0);return o===-1?e:e?.slice(o)}_getNavigationTree(e){const t=this._designerSchemaService.getViewConfigInfoByName(e),a=t.parentName,i=t.viewConfig,o=i?.type;return o?this._getDisplayValue(i).pipe((0,l.switchMap)(s=>{const c={caption:s||i.name,name:i.name,type:o};return a?this._getNavigationTree(a).pipe((0,l.switchMap)(m=>(0,d.of)([...m,c]))):(0,d.of)([c])})):(0,d.of)([])}navigationChange(){return this._navigationChanged$.pipe((0,l.startWith)([]),(0,l.pairwise)(),(0,l.switchMap)(([,e])=>(0,d.of)(e.map(t=>({name:t.name,caption:t.caption})))))}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}fa.\u0275fac=function(e){return new(e||fa)(n.\u0275\u0275inject(g.DesignerSchemaService),n.\u0275\u0275inject(z),n.\u0275\u0275inject(ce))},fa.\u0275prov=n.\u0275\u0275defineInjectable({token:fa,factory:fa.\u0275fac});var re=v(23466);function Ss(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",4)(1,"crt-breadcrumbs",5),n.\u0275\u0275listener("itemClicked",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onBreadcrumbsItemClicked(i))}),n.\u0275\u0275elementEnd()()}if(r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("breadcrumbs",t.breadcrumbs)}}const ws=function(r){return{name:"test",type:r}};function Ds(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementContainerStart(0,6,7),n.\u0275\u0275listener("viewElementShow",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onViewElementShow(i))}),n.\u0275\u0275elementContainerEnd()}if(r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("crtViewElement",n.\u0275\u0275pureFunction1(1,ws,t.propertiesComponentTypeName))}}class Xt{get isRtl(){return this._directionality.value==="rtl"}get cursors(){return{leftOrRight:"ew-resize"}}get resizeEdges(){return this.isRtl?{right:!0}:{left:!0}}set propertiesComponentTypeName(e){this._propertiesPanelSubscription?.unsubscribe(),this._propertiesPanelSubscription=new d.Subscription,this._propertiesComponentTypeName!==e&&(this._propertiesComponentTypeName=null,this._changeDetector.detectChanges(),this._propertiesComponentTypeName=e,this._changeDetector.detectChanges())}get propertiesComponentTypeName(){return this._propertiesComponentTypeName}get showBreadcrumbs(){return this._navigationItems.length>1}get breadcrumbs(){return this._navigationItems}set elementProperties(e){if(!!Xt._shouldChangeProperties(this._elementProperties,e))if(this._elementProperties=e,this._elementProperties){const a=this._getPropertiesComponentTypeByElementProperties(e);a===this.propertiesComponentTypeName?this._updatePropertiesPanelData(this._elementProperties):(this._componentRef$.next(null),this.propertiesComponentTypeName=a,this._loadPropertiesPanelData(this._elementProperties))}else this.propertiesComponentTypeName=null}get pageProperties(){return this._pageProperties}set pageProperties(e){if(!e)return;(0,x.isEqual)(this._pageProperties,e)||(this._pageProperties=e);const t="crt.PagePropertiesPanel";this.propertiesComponentTypeName!==t&&(this._componentRef$.next(null),this.propertiesComponentTypeName=t,this._propertiesPanelSubscription?.unsubscribe(),this._propertiesPanelSubscription=new d.Subscription,this._propertiesPanelSubscription.add(this._componentRef$.pipe((0,l.first)(a=>Boolean(a))).subscribe(a=>{a.setPropertyValue("config",e),this._propertiesPanelSubscription.add(a.on("changed$",i=>this._onPagePropertiesChanged(i)))})))}static _shouldChangeProperties(e,t){const a=e?.itemConfig,i=t?.itemConfig,o=a?.name,s=i?.name;return o&&s?o!==s:!0}constructor(e,t,a,i,o,s){this._panelWidthValidatorService=e,this._directionality=t,this._changeDetector=a,this._designerContainerService=i,this._interfaceDesignerPropertiesPanelService=o,this._openPanelAnimationService=s,this._destroyed$=new d.Subject,this._componentRef$=new d.ReplaySubject(1),this._navigationItems=[],this._baseCustomElementPropertiesPanel="crt.BaseCustomElementPropertiesPanel",this.panelWidth=de.panelMinWidth,this.itemPropertiesChanged=new n.EventEmitter,this.pagePropertiesChanged=new n.EventEmitter,this.action=new n.EventEmitter}_getPropertiesComponentTypeByElementProperties(e){if(e.type===g.DesignType.DataSourceAttribute||e.type===g.DesignType.DataSource)return e?.itemConfig?.propertiesPanelComponentTypeName;const t=e?.itemConfig?.type,a=h.InterfaceDesignerItemRegistry.get(t);return a?.propertiesPanelComponentTypeName?a.propertiesPanelComponentTypeName:this._baseCustomElementPropertiesPanel}_updateDSAttributeNameOnChange(e,t){if(t?.type===g.DesignType.DataSourceAttribute){const a=t.itemConfig,i=e.changes.find(o=>o.path==="name");i&&(a.dataSourceAttributeName=i.value)}}_onPagePropertiesChanged(e){const t=e.changes.find(s=>s.path==="name"),a=e.changes.find(s=>s.path==="caption"),i=e.changes.find(s=>s.path==="description"),o={name:t?.value||this.pageProperties.name,caption:a?.value||this.pageProperties.caption,description:i?.value||this.pageProperties.description};this.pagePropertiesChanged.emit(o)}_onPropertiesChanged(e,t){t=e.elementProperties||t;let a=e.name||t?.itemConfig?.name;if(t?.type===g.DesignType.DataSourceAttribute){const i=t.itemConfig;a=i.dataSourceName+"."+i.dataSourceAttributeName}t?.type===g.DesignType.DataSource&&(a=t.itemConfig.dataSourceName),this.itemPropertiesChanged.next({name:a,changes:e.changes,type:t.type}),this._updateDSAttributeNameOnChange(e,t)}_setConfigAndSubscribeOnPanelEvents(e){this._componentRef$.pipe((0,l.first)(t=>Boolean(t))).subscribe(t=>{t.setPropertyValue("config",e),this._propertiesPanelSubscription?.unsubscribe(),this._propertiesPanelSubscription=new d.Subscription,this._propertiesPanelSubscription.add(t.on("changed$",a=>this._onPropertiesChanged(a,e))),this._propertiesPanelSubscription.add(t.on("action$",a=>this.action.emit(a)))})}_updatePropertiesPanelData(e){this._setConfigAndSubscribeOnPanelEvents(e)}_loadPropertiesPanelData(e){!this._propertiesPanelViewElement||!e||this._setConfigAndSubscribeOnPanelEvents(e)}_subscribeOnNavigationChanges(){this._interfaceDesignerPropertiesPanelService.navigationChange().pipe((0,l.takeUntil)(this._destroyed$)).subscribe(e=>{this._navigationItems=e,this._changeDetector.markForCheck()})}onViewElementShow(e){this._propertiesPanelViewElement=e,this._componentRef$.next(e.componentRef),this._loadPropertiesPanelData(this._elementProperties)}validateResize(e){const t=e.rectangle.width;return this._panelWidthValidatorService.isValid(t)}onResizing(e){this.panelWidth=e.rectangle.width}onBreadcrumbsItemClicked(e){this._openPanelAnimationService.animationMode$.next("backward"),this._designerContainerService.select(e.name)}ngOnInit(){this._subscribeOnNavigationChanges()}ngOnDestroy(){this._propertiesPanelSubscription?.unsubscribe(),this._destroyed$.next(),this._destroyed$.complete()}}Xt.\u0275fac=function(e){return new(e||Xt)(n.\u0275\u0275directiveInject(de),n.\u0275\u0275directiveInject(hi.Directionality),n.\u0275\u0275directiveInject(n.ChangeDetectorRef),n.\u0275\u0275directiveInject(z),n.\u0275\u0275directiveInject(fa),n.\u0275\u0275directiveInject(dt))},Xt.\u0275cmp=n.\u0275\u0275defineComponent({type:Xt,selectors:[["crt-interface-designer-properties-panel"]],inputs:{elementProperties:"elementProperties",pageProperties:"pageProperties"},outputs:{itemPropertiesChanged:"itemPropertiesChanged",pagePropertiesChanged:"pagePropertiesChanged",action:"action"},decls:4,vars:10,consts:[["mwlResizable","","id","interface-designer-properties-panel",1,"wrapper","main-interface-designer-properties-panel",3,"resizeEdges","resizeCursors","validateResize","resizing"],["mwlResizeHandle","",1,"resize","resize-grip",3,"resizeEdges"],["class","breadcrumbs-container",4,"ngIf"],[3,"crtViewElement","viewElementShow",4,"ngIf"],[1,"breadcrumbs-container"],[3,"breadcrumbs","itemClicked"],[3,"crtViewElement","viewElementShow"],["designerMainPropertiesPanel",""]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275listener("resizing",function(i){return t.onResizing(i)}),n.\u0275\u0275element(1,"div",1),n.\u0275\u0275template(2,Ss,2,1,"div",2),n.\u0275\u0275template(3,Ds,2,3,"ng-container",3),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275styleProp("width",t.panelWidth,"px"),n.\u0275\u0275classProp("rtl",t.isRtl),n.\u0275\u0275property("resizeEdges",t.resizeEdges)("resizeCursors",t.cursors)("validateResize",t.validateResize.bind(t)),n.\u0275\u0275advance(1),n.\u0275\u0275property("resizeEdges",t.resizeEdges),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.showBreadcrumbs),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.propertiesComponentTypeName))},dependencies:[f.NgIf,re.ResizableDirective,re.ResizeHandleDirective,S.ViewElementDirective,u.CrtBreadcrumbsComponent],styles:["[_nghost-%COMP%]{z-index:2}.wrapper[_ngcontent-%COMP%]{position:relative;height:100%}.wrapper.resize-left-hover[_ngcontent-%COMP%]   .resize-grip[_ngcontent-%COMP%], .wrapper.resize-right-hover[_ngcontent-%COMP%]   .resize-grip[_ngcontent-%COMP%], .wrapper.resize-active[_ngcontent-%COMP%]   .resize-grip[_ngcontent-%COMP%]{visibility:visible;opacity:1;top:40px;transition:opacity .25s ease-in-out}.wrapper[_ngcontent-%COMP%]   .breadcrumbs-container[_ngcontent-%COMP%]{padding-top:40px;margin-bottom:-40px;min-height:35px}.resize[_ngcontent-%COMP%]{position:absolute;width:1px}.resize.resize-grip[_ngcontent-%COMP%]{height:100%;visibility:hidden;opacity:0;transition:opacity .25s ease-in-out;z-index:2}.container[_ngcontent-%COMP%]{padding:10px;display:flex;justify-content:center;flex-flow:column nowrap}"],changeDetection:0});class ja{constructor(e,t,a,i,o){this._injector=e,this._designerEntityService=t,this._commandFactoryService=a,this._dialog=i,this._crtControlStateAdapter=o,this._destroyed$=new d.Subject,this.referenceSchemas=[],this.loading=!0}get _validSchemaName(){return this.schemaNameControl.valid}get schemaNameControl(){return this._dataSourceForm.get("schemaName")}_initReferenceSchemas(e){var t=this;return(0,F.Z)(function*(){t.referenceSchemas=yield(0,d.firstValueFrom)(t._designerEntityService.getReferenceSchemasLookupItems(e))})()}_initFormGroup(){this._dataSourceForm=new Q.FormGroup({schemaName:new Q.UntypedFormControl("",[this._crtControlStateAdapter.transform({instance:new I.RequiredValidator(this._injector)})])})}ngOnInit(){var e=this;return(0,F.Z)(function*(){e._initFormGroup(),yield e._initReferenceSchemas(!0),e.loading=!1})()}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}onSelectClicked(){var e=this;return(0,F.Z)(function*(){e._validSchemaName&&(yield(0,g.executeCommand)(e._commandFactoryService,"crt.SetEntityDataSourceCommand",{entitySchemaName:e.schemaNameControl.value.value}),e._dialog.close())})()}onCancelClicked(){this._dialog.close()}onReferenceSchemasEnter(){var e=this;return(0,F.Z)(function*(){yield e.onSelectClicked()})()}}ja.\u0275fac=function(e){return new(e||ja)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(B),n.\u0275\u0275directiveInject(g.DesignerCommandFactoryService),n.\u0275\u0275directiveInject(N.MatLegacyDialogRef),n.\u0275\u0275directiveInject(I.CrtControlStateAdapter))},ja.\u0275cmp=n.\u0275\u0275defineComponent({type:ja,selectors:[["crt-add-existing-data-source"]],decls:15,vars:16,consts:[["mat-dialog-title","",1,"select-data-source-dialog-title"],[1,"form-field-wrapper"],["labelPosition","above",3,"items","control","label","loading","useStaticFiltering","keyup.enter"],[1,"select-data-source-dialog-actions"],["mat-button","","data-qa","cancel","shape","rounded",3,"clicked"],["mat-flat-button","","color","primary","data-qa","select","shape","rounded",3,"clicked"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div")(1,"div",0),n.\u0275\u0275text(2),n.\u0275\u0275pipe(3,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(4,"mat-dialog-content")(5,"div",1)(6,"crt-combobox",2),n.\u0275\u0275listener("keyup.enter",function(){return t.onReferenceSchemasEnter()}),n.\u0275\u0275pipe(7,"translate"),n.\u0275\u0275elementEnd()()(),n.\u0275\u0275elementStart(8,"mat-dialog-actions",3)(9,"crt-button",4),n.\u0275\u0275listener("clicked",function(){return t.onCancelClicked()}),n.\u0275\u0275text(10),n.\u0275\u0275pipe(11,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(12,"crt-button",5),n.\u0275\u0275listener("clicked",function(){return t.onSelectClicked()}),n.\u0275\u0275text(13),n.\u0275\u0275pipe(14,"translate"),n.\u0275\u0275elementEnd()()()),e&2&&(n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(3,8,"InterfaceDesigner.SetupDataSourceDialog.SelectDataSource")," "),n.\u0275\u0275advance(4),n.\u0275\u0275propertyInterpolate("label",n.\u0275\u0275pipeBind1(7,10,"InterfaceDesigner.SetupDataSourceDialog.Object")),n.\u0275\u0275property("items",t.referenceSchemas)("control",t.schemaNameControl)("loading",t.loading)("useStaticFiltering",!0),n.\u0275\u0275advance(4),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(11,12,"InterfaceDesigner.SetupDataSourceDialog.CancelButtonDialog")," "),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(14,14,"InterfaceDesigner.SetupDataSourceDialog.SelectButtonDialog")," "))},dependencies:[u.CrtButtonComponent,u.CrtComboBoxComponent,N.MatLegacyDialogTitle,N.MatLegacyDialogContent,N.MatLegacyDialogActions,D.TranslatePipe],styles:["[_nghost-%COMP%]{min-width:390px;box-sizing:border-box}.select-data-source-dialog-title[mat-dialog-title][_ngcontent-%COMP%]{text-align:center}.select-data-source-dialog-actions[_ngcontent-%COMP%]{margin-top:48px;justify-content:flex-end;gap:8px}"]});var Yt=v(32820),E=v(72856),en=v(7950);class zn{constructor(e){this._designerSchemaService=e}applyExplicitPositions(e,t){let a=1,i=1;return(0,x.cloneDeep)(e).map(o=>{const s=o.layoutConfig||{};let c=!1;return s.column===void 0&&(s.column=i,i++,c=!0),s.colSpan===void 0&&(s.colSpan=1,c=!0),s.row===void 0&&(s.row=a,c=!0),s.rowSpan===void 0&&(s.rowSpan=1,c=!0),s.column===1&&s.colSpan===-1&&a++,i>t&&(i=1,a++),o.layoutConfig=s,c&&this._designerSchemaService.move(o.name,o.layoutConfig),o})}}zn.\u0275fac=function(e){return new(e||zn)(n.\u0275\u0275inject(g.DesignerSchemaService))},zn.\u0275prov=n.\u0275\u0275defineInjectable({token:zn,factory:zn.\u0275fac});class kn{getAuxiliaryColumnsConfig(e){return[...Array(e).keys()].map(t=>({name:"DesignerGridColumn",type:"DesignerGridColumn",layoutConfig:{row:1,column:t+1,rowSpan:-1,colSpan:1}}))}getAuxiliaryRowConfig(e){return[...Array(e).keys()].map(t=>({name:"DesignerGridRow",type:"DesignerGridRow",layoutConfig:{row:t+1,column:1,rowSpan:1,colSpan:-1}}))}getAuxiliaryCellsConfig(e,t){const a=[];for(let i=1;i<=e;i++)for(let o=1;o<=t;o++)a.push({name:"DesignerGridCell",type:"DesignerGridCell",layoutConfig:{row:i,column:o,rowSpan:1,colSpan:1}});return a}getAdditionAuxiliaryCellsConfig(e,t){const a=[];for(let i=1;i<=e.length;i++)for(let o=1;o<=t;o++)a.push({name:"DesignerGridCell",type:"DesignerGridCell",layoutConfig:{row:e[i-1].layoutConfig.row,column:o,rowSpan:1,colSpan:1}});return a}}kn.\u0275fac=function(e){return new(e||kn)},kn.\u0275prov=n.\u0275\u0275defineInjectable({token:kn,factory:kn.\u0275fac});function Ca({currentIndex:r,moved:e,itemsSize:t,gap:a=0,autogenerateSizes:i=!1,intersectionRatio:o=.4}){const s=e>=0,c=s?r+1:r-1;if(c>=t.length)if(i)for(;c>=t.length;)t.push(t.slice(-1)[0]);else return r;const m=t[c]+a;if(m===0)return r;const b=t[r]+a,T=(m>b?b:m)*o;let L;if(s)if(e>T){const ne=e-m;ne>0?L=Ca({currentIndex:c,moved:ne,itemsSize:t,gap:a,autogenerateSizes:i,intersectionRatio:o}):L=c}else L=r;else if(-e>T){const ne=m+e;ne<0?L=Ca({currentIndex:c,moved:ne,itemsSize:t,gap:a,autogenerateSizes:i,intersectionRatio:o}):L=c}else L=r;return L}function $i({point:r,itemsSize:e,gap:t=0,autogenerateSizes:a=!1}){let i=0,o=-1;do o++,i+=e[o]+t;while(o<e.length-1&&r>i);if(r>i&&a){const s=e.slice(-1)[0];if(s===0)return o;for(;r>i;)e.push(s),i+=s,o++}return o}function fo(r){return r&&["column","row","colSpan","rowSpan"].every(e=>e in r)}function Ui(r,e){return Array(r).fill("").map(()=>Array(e).fill(""))}function me(r,e){return r?.map(a=>{const i=(0,x.cloneDeep)(a);for(const[o,s]of Object.entries(e))i[o]=s;return i})??[]}function ii(r,e){let t=!1;return r.forEach(a=>{const i=a.name===e;a.selected!==i&&(a.selected=i,t=!0)}),t}function Ms(r){return h.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos.get(r)?.designControlConfig?.allowDesignContent}class Bn{constructor(e){this._designerSchemaService=e}_moveItemAbove(e,t,a){const i=e.find(({name:y})=>y===t),o=i.layoutConfig;if(!(Boolean(i)&&o.row>1))return!1;const c=this.getFreeRowsAbove(o,a);if(!c)return!1;const m={...o,row:o.row-c};i.layoutConfig=m;const b=e.find(({name:y})=>y===i.name);return b.layoutConfig=m,this.moveMatrixElement(o,m,i.name,a),Boolean(c)}iterateLayoutConfigCell(e,t){const{column:a,row:i,colSpan:o,rowSpan:s}=e;for(let c=0;c<s;c++)for(let m=0;m<o;m++)t(i+c,a+m)}buildMatrix(e,t,a,...i){const o=Ui(e,t);return a.filter(s=>fo(s.layoutConfig)).filter(s=>!i.includes(s.name)).forEach(s=>{const c=s.layoutConfig;this.iterateLayoutConfigCell(c,(m,b)=>{o[m-1]&&(o[m-1][b-1]=s.name)})}),o}moveMatrixElement(e,t,a,i){this.iterateLayoutConfigCell(e,(o,s)=>{i[o-1][s-1]=""}),this.iterateLayoutConfigCell(t,(o,s)=>{i[o-1][s-1]=a})}getIntersectionElements(...e){let t,a;if(typeof e[0]=="number"){const[o,s,c,m,b]=e;t=this.buildMatrix(o,s,c,m),a=b}else t=e[0],a=e[1];const i=[];return a&&t&&this.iterateLayoutConfigCell(a,(o,s)=>{const c=t[o-1]?.[s-1];c&&i.every(m=>m!==c)&&i.push(c)}),i}updateItemsOrder(e,t,a,i,o){const s=this.buildMatrix(t,a,i),c=[];for(const m of s)for(const b of m)b&&!c.includes(b)&&c.push(b);for(let m=0;m<c.length;m++)o[m]?.name!==c[m]&&this._designerSchemaService.moveToIndex(c[m],m)}canDropElement(e,t,a,i,o){return this.getIntersectionElements(e,t,a,i,o).length===0}getFreeRowsAbove(e,t){const{colSpan:a,row:i,column:o}=e,s=2;let c=i;for(;c>=s;){for(let m=0;m<a;m++)if(t[c-2]?.[o-1+m])return i-c;c--}return i-c}moveItemsAbove(e,t,a){const i=[],o=this.buildMatrix(e,t,a),s=(0,x.cloneDeep)(a);for(let c=1;c<e;c++){let m=0;for(;m<t;){const b=o[c][m];b&&this._moveItemAbove(s,b,o)&&(i.push(b),m+=s.find(({name:L})=>L===b).layoutConfig.colSpan-1),m++}}return{layoutConfigs:s,affectedItems:i}}}Bn.\u0275fac=function(e){return new(e||Bn)(n.\u0275\u0275inject(g.DesignerSchemaService))},Bn.\u0275prov=n.\u0275\u0275defineInjectable({token:Bn,factory:Bn.\u0275fac});class Ln{constructor(){this._moveCursor="move"}_clear(){this._affectedElementsMap?.clear()}setMoveCursor(e){if(!this._affectedElementsMap||e.style.cursor===this._moveCursor)return;this._affectedElementsMap.get(e)||(this._affectedElementsMap.set(e,{initialCursor:e.style.cursor,target:e}),e.style.cursor=this._moveCursor)}initSettings(){this._affectedElementsMap=new Map}clearSettings(){this._clear(),this._affectedElementsMap=null}resetInitialCursors(){this._affectedElementsMap?.forEach(({initialCursor:e,target:t})=>t.style.cursor=e),this._clear()}}Ln.\u0275fac=function(e){return new(e||Ln)},Ln.\u0275prov=n.\u0275\u0275defineInjectable({token:Ln,factory:Ln.\u0275fac});class tn{getPositionByDistance({columnIndex:e,rowIndex:t,distance:a,columnSizes:i,rowSizes:o,columnGap:s,rowGap:c,intersectionRatio:m}){const b=Ca({currentIndex:e,moved:a.x,itemsSize:i,gap:s,autogenerateSizes:!1,intersectionRatio:m})+1,y=Ca({currentIndex:t,moved:a.y,itemsSize:o,gap:c,autogenerateSizes:!0,intersectionRatio:m})+1;return{column:b,row:y}}getConstrainedColumn({column:e,columnWidth:t,columnsLength:a}){return e+t>a+1?a-t+1:e}}tn.\u0275fac=function(e){return new(e||tn)},tn.\u0275prov=n.\u0275\u0275defineInjectable({token:tn,factory:tn.\u0275fac,providedIn:"root"});class je{constructor(e,t,a){this._document=e,this._cdkDrag=t,this._setDragCursorService=a,this._unsubscribe$=new d.Subject,this._cursor=this._document.body.style.cursor}ngOnInit(){this._setDragCursorService.initSettings(),this._cdkDrag.started.pipe((0,l.takeUntil)(this._unsubscribe$)).subscribe(()=>{this._document.body.style.cursor="move"}),this._cdkDrag.ended.pipe((0,l.takeUntil)(this._unsubscribe$)).subscribe(()=>{this._document.body.style.cursor=this._cursor,this._setDragCursorService.resetInitialCursors()}),this._cdkDrag.moved.pipe((0,l.takeUntil)(this._unsubscribe$)).subscribe(({event:{target:e}})=>this._setDragCursorService.setMoveCursor(e))}ngOnDestroy(){this._setDragCursorService.clearSettings(),this._unsubscribe$.next(),this._unsubscribe$.complete()}}je.\u0275fac=function(e){return new(e||je)(n.\u0275\u0275directiveInject(f.DOCUMENT),n.\u0275\u0275directiveInject(O.CdkDrag),n.\u0275\u0275directiveInject(Ln))},je.\u0275dir=n.\u0275\u0275defineDirective({type:je,selectors:[["","crtDragCursor",""]]});function xs(r,e){r&1&&n.\u0275\u0275element(0,"div",9)}function Is(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",6),n.\u0275\u0275template(1,xs,1,0,"div",7),n.\u0275\u0275element(2,"mat-icon",8),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275styleProp("width",t.styles==null||t.styles.tile==null?null:t.styles.tile.width,"px")("height",t.styles==null||t.styles.tile==null?null:t.styles.tile.height,"px"),n.\u0275\u0275advance(2),n.\u0275\u0275styleProp("width",t.styles==null||t.styles.icon==null?null:t.styles.icon.width,"px")("height",t.styles==null||t.styles.icon==null?null:t.styles.icon.height,"px"),n.\u0275\u0275property("svgIcon",t.element.iconName)}}class nn{constructor(){this._tooltip=""}get elementTooltip(){if(!this._tooltip){const{caption:e,hint:t}=this.element;this._tooltip=t?[e,t].join(`
`):e}return this._tooltip}}nn.\u0275fac=function(e){return new(e||nn)},nn.\u0275cmp=n.\u0275\u0275defineComponent({type:nn,selectors:[["crt-draggable-tile"]],inputs:{element:"element",styles:"styles"},decls:7,vars:15,consts:[[1,"tile-element-container"],[1,"tile-element",3,"title"],["cdkDrag","","crtDragCursor","","class","draggable-tile-element",3,"width","height",4,"ngIf"],[1,"background-tile-element"],[1,"background-tile-element-icon",3,"svgIcon"],[1,"background-tile-caption"],["cdkDrag","","crtDragCursor","",1,"draggable-tile-element"],["class","draggable-tile-element-placeholder",4,"cdkDragPlaceholder"],[1,"draggable-tile-element-preview",3,"svgIcon"],[1,"draggable-tile-element-placeholder"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0)(1,"div",1),n.\u0275\u0275template(2,Is,3,9,"div",2),n.\u0275\u0275elementStart(3,"div",3),n.\u0275\u0275element(4,"mat-icon",4),n.\u0275\u0275elementStart(5,"span",5),n.\u0275\u0275text(6),n.\u0275\u0275elementEnd()()()()),e&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275styleProp("width",t.styles==null||t.styles.tile==null?null:t.styles.tile.width,"px"),n.\u0275\u0275property("title",t.elementTooltip),n.\u0275\u0275attribute("data-item-marker",t.element.name),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.element.canDrop),n.\u0275\u0275advance(2),n.\u0275\u0275styleProp("width",t.styles==null||t.styles.icon==null?null:t.styles.icon.width,"px")("height",t.styles==null||t.styles.icon==null?null:t.styles.icon.height,"px"),n.\u0275\u0275property("svgIcon",t.element.iconName),n.\u0275\u0275advance(1),n.\u0275\u0275styleProp("max-width",t.styles==null||t.styles.icon==null?null:t.styles.icon.width,"px")("height",t.styles==null||t.styles.caption==null?null:t.styles.caption.height,"px"),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate(t.element.caption))},dependencies:[f.NgIf,je,O.CdkDrag,O.CdkDragPlaceholder,E.MatIcon],styles:[`.tile-element-container{border-radius:6px;text-align:center}.tile-element-container .tile-element{position:relative;margin-left:auto;margin-right:auto}.tile-element-container .tile-element .draggable-tile-element{top:0;left:0;cursor:move;position:absolute}.tile-element-container .tile-element .background-tile-element{display:flex;flex-flow:column;align-items:center;justify-content:center}.tile-element-container .tile-element .background-tile-element .background-tile-caption{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.draggable-tile-element-placeholder{position:absolute;visibility:hidden}
`],encapsulation:2,changeDetection:0});function Ps(r,e){if(r&1&&n.\u0275\u0275element(0,"mat-icon",12),r&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275styleProp("width",t.styles==null||t.styles.icon==null?null:t.styles.icon.width,"px")("height",t.styles==null||t.styles.icon==null?null:t.styles.icon.height,"px"),n.\u0275\u0275property("svgIcon",t.element.dragPreviewIcon)}}function Es(r,e){r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Ps,1,5,"mat-icon",11),n.\u0275\u0275elementContainerEnd())}function Ts(r,e){r&1&&n.\u0275\u0275element(0,"div",13)}function Os(r,e){r&1&&n.\u0275\u0275element(0,"span",14)}const As=["*"];class jn extends nn{constructor(){super(...arguments),this.clicked=new n.EventEmitter}onClick(e){this.clicked.next(e)}}jn.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(jn)))(t||jn)}}(),jn.\u0275cmp=n.\u0275\u0275defineComponent({type:jn,selectors:[["crt-draggable-row"]],inputs:{element:"element"},outputs:{clicked:"clicked"},features:[n.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:As,decls:13,vars:5,consts:[[1,"row-element-container",3,"click"],[1,"row-element",3,"title"],["cdkDrag","","crtDragCursor","",1,"draggable-row-element"],[4,"ngIf"],["class","draggable-row-element-placeholder",4,"cdkDragPlaceholder"],[1,"draggable-row-element-spacer"],[1,"background-row-element"],[1,"no-shrink","background-row-element-icon",3,"svgIcon"],[1,"no-shrink","spacer"],[1,"background-row-caption"],["class","no-shrink required",4,"ngIf"],["class","drag-icon-preview",3,"svgIcon","width","height",4,"cdkDragPreview"],[1,"drag-icon-preview",3,"svgIcon"],[1,"draggable-row-element-placeholder"],[1,"no-shrink","required"]],template:function(e,t){e&1&&(n.\u0275\u0275projectionDef(),n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275listener("click",function(){return t.onClick(t.element)}),n.\u0275\u0275elementStart(1,"div",1)(2,"div",2),n.\u0275\u0275template(3,Es,2,0,"ng-container",3),n.\u0275\u0275template(4,Ts,1,0,"div",4),n.\u0275\u0275element(5,"div",5),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"div",6),n.\u0275\u0275element(7,"mat-icon",7)(8,"div",8),n.\u0275\u0275elementStart(9,"span",9),n.\u0275\u0275text(10),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(11,Os,1,0,"span",10),n.\u0275\u0275elementEnd()(),n.\u0275\u0275projection(12),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275property("title",t.elementTooltip),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",t.element.dragPreviewIcon),n.\u0275\u0275advance(4),n.\u0275\u0275property("svgIcon",t.element.iconName),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate(t.element.caption),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.element.required))},dependencies:[f.NgIf,je,O.CdkDrag,O.CdkDragPreview,O.CdkDragPlaceholder,E.MatIcon],styles:['.row-element-container[_ngcontent-%COMP%]{padding:4px 2% 4px 4px;display:flex}.row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]{position:relative;height:24px;max-width:100%;width:100%;overflow:hidden;margin-right:2px}.row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]   .draggable-row-element[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]   .background-row-element[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{width:16px;min-width:16px;height:16px}.row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]   .draggable-row-element[_ngcontent-%COMP%]{top:0;left:0;cursor:move;position:absolute;width:100%}.row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]   .draggable-row-element-spacer[_ngcontent-%COMP%]{width:100%;height:24px}.row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]   .background-row-element[_ngcontent-%COMP%]{display:flex;flex-flow:row;align-items:center;justify-content:flex-start}.row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]   .background-row-element[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{width:12px}.row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]   .background-row-element[_ngcontent-%COMP%]   .background-row-caption[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]   .background-row-element[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{margin-left:.2em}.row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]   .background-row-element[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]:after{content:"*";font-weight:700}.row-element-container[_ngcontent-%COMP%]   .row-element[_ngcontent-%COMP%]   .background-row-element[_ngcontent-%COMP%]   .no-shrink[_ngcontent-%COMP%]{flex-shrink:0}.draggable-row-element-placeholder[_ngcontent-%COMP%]{position:absolute;visibility:hidden}'],changeDetection:0});const Vs=["extraIconButtons"];function Fs(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-draggable-tile",4),r&2){const t=n.\u0275\u0275nextContext().$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275property("element",t)("styles",a.group==null?null:a.group.styles)}}const Ns=function(r){return{$implicit:r}};function Rs(r,e){if(r&1&&n.\u0275\u0275elementContainer(0,7),r&2){const t=n.\u0275\u0275nextContext(2).$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngTemplateOutlet",a.extraIconButtonsTemplateRef)("ngTemplateOutletContext",n.\u0275\u0275pureFunction1(2,Ns,t))}}function zs(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-draggable-row",5),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext().$implicit,o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onRowClick(i))}),n.\u0275\u0275template(1,Rs,1,4,"ng-container",6),n.\u0275\u0275elementEnd()}if(r&2){const t=n.\u0275\u0275nextContext().$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275property("element",t)("styles",a.group==null?null:a.group.styles),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",a.extraIconButtonsTemplateRef)}}function ks(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Fs,1,2,"crt-draggable-tile",2),n.\u0275\u0275template(2,zs,2,3,"crt-draggable-row",3),n.\u0275\u0275elementContainerEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.isTile),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",!t.isTile)}}class Gn{constructor(e,t){this._connectedDropListService=e,this._changeDetectorRef=t,this._subscriptions=new d.Subscription,this.isTile=!0,this.rowClick=new n.EventEmitter}ngOnInit(){this._subscriptions.add(this._connectedDropListService.connectedDropList$.subscribe(e=>{this.connectedDropLists=e,this._changeDetectorRef.markForCheck()}))}ngOnDestroy(){this._subscriptions.unsubscribe()}getClasses(){return{"draggable-list-container":!0,"row-container":!this.isTile,"tile-container":this.isTile}}onRowClick(e){this.rowClick.next(e)}}Gn.\u0275fac=function(e){return new(e||Gn)(n.\u0275\u0275directiveInject(g.ConnectedDropListService),n.\u0275\u0275directiveInject(n.ChangeDetectorRef))},Gn.\u0275cmp=n.\u0275\u0275defineComponent({type:Gn,selectors:[["crt-draggable-list"]],contentQueries:function(e,t,a){if(e&1&&n.\u0275\u0275contentQuery(a,Vs,5),e&2){let i;n.\u0275\u0275queryRefresh(i=n.\u0275\u0275loadQuery())&&(t.extraIconButtonsTemplateRef=i.first)}},inputs:{group:"group",isTile:"isTile"},outputs:{rowClick:"rowClick"},decls:4,vars:11,consts:[["cdkDropList","",3,"cdkDropListData","cdkDropListSortingDisabled","cdkDropListConnectedTo","ngClass"],[4,"ngFor","ngForOf"],[3,"element","styles",4,"ngIf"],[3,"element","styles","clicked",4,"ngIf"],[3,"element","styles"],[3,"element","styles","clicked"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275pipe(1,"async"),n.\u0275\u0275template(2,ks,3,2,"ng-container",1),n.\u0275\u0275pipe(3,"async"),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275styleProp("--tile-width",t.group==null||t.group.styles==null||t.group.styles.tile==null?null:t.group.styles.tile.width,"px"),n.\u0275\u0275property("cdkDropListData",n.\u0275\u0275pipeBind1(1,7,t.group.items$))("cdkDropListSortingDisabled",!0)("cdkDropListConnectedTo",t.connectedDropLists)("ngClass",t.getClasses()),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngForOf",n.\u0275\u0275pipeBind1(3,9,t.group.items$)))},dependencies:[f.NgClass,f.NgForOf,f.NgIf,f.NgTemplateOutlet,O.CdkDropList,jn,nn,f.AsyncPipe],styles:[".draggable-list-container[_ngcontent-%COMP%]{display:grid;gap:8px;--tile-width: 72px}.draggable-list-container.tile-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(var(--tile-width),1fr))}.draggable-list-container.row-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(100%,1fr))}"],changeDetection:0});function Bs(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",3)(1,"span",4),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(3,"mat-icon",5),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext().$implicit;n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(t.groupItem.caption),n.\u0275\u0275advance(1),n.\u0275\u0275propertyInterpolate("matTooltip",t.groupItem.errorMessage)}}function Ls(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"span",9),n.\u0275\u0275listener("click",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(o.onMenuButtonClick(i))}),n.\u0275\u0275element(1,"ts-compact-actions-menu",10),n.\u0275\u0275elementEnd()}if(r&2){const t=n.\u0275\u0275nextContext(2).$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("menuItems",a.getDataSourceActions(t))}}function js(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div")(1,"div",11),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(3,"crt-draggable-list",12),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext(2).$implicit;n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate1(" ",t.newItems.caption," "),n.\u0275\u0275advance(1),n.\u0275\u0275property("group",t.newItems)("isTile",!0)}}function Gs(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",18)(1,"mat-icon",19),n.\u0275\u0275listener("click",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext().$implicit,s=n.\u0275\u0275nextContext(4);return n.\u0275\u0275resetView(s.onDataSourceAttributeDeleteIconClick(o,i))}),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275elementEnd()()}r&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275propertyInterpolate("matTooltip",n.\u0275\u0275pipeBind1(2,1,"InterfaceDesigner.DataSourceActions.RemoveAttribute")))}function $s(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",20),n.\u0275\u0275element(1,"mat-icon",21),n.\u0275\u0275elementEnd()),r&2){const t=e.$implicit;n.\u0275\u0275advance(1),n.\u0275\u0275propertyInterpolate("svgIcon",t.icon),n.\u0275\u0275propertyInterpolate("matTooltip",t.tooltip),n.\u0275\u0275property("ngClass",t.classes)}}function Us(r,e){if(r&1&&(n.\u0275\u0275template(0,Gs,3,3,"div",16),n.\u0275\u0275template(1,$s,2,3,"div",17)),r&2){const t=e.$implicit;n.\u0275\u0275property("ngIf",t.canRemove),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.infoIcons)}}function Hs(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div")(1,"div",13),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(3,"crt-draggable-list",14),n.\u0275\u0275listener("rowClick",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(o.onDataSourceAttributeClick(i))}),n.\u0275\u0275template(4,Us,2,2,"ng-template",null,15,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementEnd()()}if(r&2){const t=n.\u0275\u0275nextContext(2).$implicit;n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate1(" ",t.existingItems.caption," "),n.\u0275\u0275advance(1),n.\u0275\u0275property("group",t.existingItems)("isTile",!1)}}function Ws(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-expansion-panel",6),n.\u0275\u0275listener("opened",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext().$implicit,o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onSubGroupExpanded(i.groupItem))})("closed",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext().$implicit,o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onSubGroupCollapsed(i.groupItem))}),n.\u0275\u0275template(1,Ls,2,1,"span",7),n.\u0275\u0275template(2,js,4,3,"div",8),n.\u0275\u0275template(3,Hs,6,3,"div",8),n.\u0275\u0275elementEnd()}if(r&2){const t=n.\u0275\u0275nextContext().$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275property("expanded",a.getIsDataGroupExpanded(t.groupItem))("title",t.groupItem.caption),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.groupItem.editable),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",!t.newItems.isEmpty),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",!t.existingItems.isEmpty)}}function Qs(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div"),n.\u0275\u0275template(1,Bs,4,2,"div",1),n.\u0275\u0275template(2,Ws,4,5,"crt-expansion-panel",2),n.\u0275\u0275elementEnd()),r&2){const t=e.$implicit;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.groupItem.errorMessage),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",!t.groupItem.errorMessage)}}class Ga{constructor(e,t,a){this._metaItemDesignerService=e,this._translateService=t,this._commandFactoryService=a,this.subGroupExpanded=new n.EventEmitter,this.subGroupCollapsed=new n.EventEmitter}_fillDataSourceSubGroup(e,t,a=!0){if(!e)return null;let i=t.filter(o=>o.parentName===e.name);return a&&(i=i.sort((o,s)=>o.caption.localeCompare(s.caption))),{name:e.name,caption:e.caption,iconName:e.iconName,type:h.DesignerToolGroupType.Data,items$:(0,d.of)(i),styles:(0,S.DESIGNER_TOOL_GROUP_CONFIG)(h.DesignerToolGroupType.Data)?.styles,isEmpty:i.length===0}}_getDataSourceAttributeConfig(e){return{dataSourceName:e.dataSourceConfig.dataSourceName,dataSourceAttributeName:e.dataSourceConfig.dataSourceAttributeName,dataSourceType:e.dataSourceConfig.dataSourceType,propertiesPanelComponentTypeName:e.propertiesPanelComponentTypeName,propertiesPanelDataProviderToken:e.propertiesPanelDataProviderToken}}_onDataSourceEditActionClick(e){return()=>{this._metaItemDesignerService.openMetaItemDesigner("crt.EntityDataSource",X.Edit,{itemConfig:{dataSourceName:e.name,propertiesPanelComponentTypeName:e.propertiesPanelComponentTypeName},type:g.DesignType.DataSource})}}_sortGroupsByErrorMessage(e,t){const a=e.groupItem.errorMessage,i=t.groupItem.errorMessage;return a&&!i?-1:!a&&i?1:0}ngOnInit(){this.itemsGroups$=this.group.items$.pipe((0,l.map)(e=>{const t=[];return e.filter(i=>!i.parentName).forEach(i=>{const o=e.filter(y=>y.parentName===i.name),s=o.find(y=>y.name.includes(`${i.name}_NewItems`)),c=o.find(y=>y.name.includes(`${i.name}_ExistingItems`)),m=this._fillDataSourceSubGroup(s,e,!1),b=this._fillDataSourceSubGroup(c,e);t.push({existingItems:b,newItems:m,groupItem:i})}),t}),(0,l.map)(e=>{const t=e.find(a=>a.groupItem.errorMessage);return e.length>1&&t?e.sort(this._sortGroupsByErrorMessage):e}))}onDataSourceAttributeClick(e){this._metaItemDesignerService.openMetaItemDesigner(e.defaultConfig.type,X.Edit,{itemConfig:this._getDataSourceAttributeConfig(e),type:g.DesignType.DataSourceAttribute})}onSubGroupExpanded(e){this.subGroupExpanded.next(e)}onSubGroupCollapsed(e){this.subGroupCollapsed.next(e)}onMenuButtonClick(e){e.stopPropagation()}getDataSourceActions(e){return[{caption:this._translateService.instant("InterfaceDesigner.DataSourceActions.Edit"),code:`edit-${e.groupItem.name}-code`,handler:this._onDataSourceEditActionClick(e.groupItem)}]}getIsDataGroupExpanded(e){return this.getIsExpanded?.(e)??!0}onDataSourceAttributeDeleteIconClick(e,t){var a=this;return(0,F.Z)(function*(){if(t.stopPropagation(),e.removeCommandTypeName)yield(0,g.executeCommand)(a._commandFactoryService,e.removeCommandTypeName,e);else throw new Error("removeCommandTypeName is not set")})()}}Ga.\u0275fac=function(e){return new(e||Ga)(n.\u0275\u0275directiveInject(J),n.\u0275\u0275directiveInject(D.TranslateService),n.\u0275\u0275directiveInject(g.DesignerCommandFactoryService))},Ga.\u0275cmp=n.\u0275\u0275defineComponent({type:Ga,selectors:[["crt-data-group-draggable-list"]],inputs:{group:"group",getIsExpanded:"getIsExpanded"},outputs:{subGroupExpanded:"subGroupExpanded",subGroupCollapsed:"subGroupCollapsed"},decls:2,vars:3,consts:[[4,"ngFor","ngForOf"],["class","error-group",4,"ngIf"],["togglePosition","after","toggleType","material","class","items-group",3,"expanded","title","opened","closed",4,"ngIf"],[1,"error-group"],[1,"error-group-caption"],["matSuffix","","svgIcon","info-icon","matTooltipClass","crt-input-error-tooltip","matTooltipPosition","after",1,"error-group-icon",3,"matTooltip"],["togglePosition","after","toggleType","material",1,"items-group",3,"expanded","title","opened","closed"],["beforeToggleButtonContent","","class","menu-container",3,"click",4,"ngIf"],[4,"ngIf"],["beforeToggleButtonContent","",1,"menu-container",3,"click"],[3,"menuItems"],[1,"new-column-subgroup-title"],[1,"draggable-columns-new",3,"group","isTile"],[1,"column-subgroup-title"],[1,"draggable-columns",3,"group","isTile","rowClick"],["extraIconButtons",""],["class","delete-icon",4,"ngIf"],["class","icon-item",4,"ngFor","ngForOf"],[1,"delete-icon"],["matSuffix","","svgIcon","delete-icon","matTooltipPosition","after","matTooltipClass","crt-input-error-tooltip",3,"matTooltip","click"],[1,"icon-item"],["matSuffix","","matTooltipPosition","after","matTooltipClass","crt-input-error-tooltip",1,"info-icon",3,"svgIcon","ngClass","matTooltip"]],template:function(e,t){e&1&&(n.\u0275\u0275template(0,Qs,3,2,"div",0),n.\u0275\u0275pipe(1,"async")),e&2&&n.\u0275\u0275property("ngForOf",n.\u0275\u0275pipeBind1(1,1,t.itemsGroups$))},dependencies:[P.CompactActionsMenuComponent,f.NgClass,f.NgForOf,f.NgIf,u.CrtExpansionPanelComponent,se.MatLegacySuffix,E.MatIcon,en.MatLegacyTooltip,Gn,f.AsyncPipe,D.TranslatePipe],styles:[".new-column-subgroup-title[_ngcontent-%COMP%]{padding:8px 0 16px}.info-icon[_ngcontent-%COMP%]{width:20px;height:20px;vertical-align:middle}.icon-item[_ngcontent-%COMP%], .draggable-columns[_ngcontent-%COMP%]{margin-right:4px}.column-subgroup-title[_ngcontent-%COMP%]{padding:16px 0}.menu-container[_ngcontent-%COMP%]{margin-right:4px;display:none}.items-group[_ngcontent-%COMP%]:hover   .menu-container[_ngcontent-%COMP%]{display:block}.error-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 14px 8px 16px;border-bottom-width:1px;border-bottom-style:solid;align-items:center;height:48px}.error-group[_ngcontent-%COMP%]   .error-group-icon[_ngcontent-%COMP%]{width:22px;height:22px}.error-group[_ngcontent-%COMP%]   .error-group-caption[_ngcontent-%COMP%]{text-transform:uppercase}"],changeDetection:0});function qs(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",3)(1,"crt-button",4,5),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275reference(2);return n.\u0275\u0275resetView(i.toggleMenu())}),n.\u0275\u0275elementStart(3,"span",6),n.\u0275\u0275text(4),n.\u0275\u0275pipe(5,"translate"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(6,"mat-menu",7,8)(8,"button",9),n.\u0275\u0275listener("click",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.addNewDataSource())}),n.\u0275\u0275elementStart(9,"span"),n.\u0275\u0275text(10),n.\u0275\u0275pipe(11,"translate"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(12,"button",10),n.\u0275\u0275listener("click",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.addExistingDataSource())}),n.\u0275\u0275elementStart(13,"span"),n.\u0275\u0275text(14),n.\u0275\u0275pipe(15,"translate"),n.\u0275\u0275elementEnd()()()()}if(r&2){const t=n.\u0275\u0275reference(7),a=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("matMenuTriggerFor",t)("icon","add-button-icon")("iconPosition",a.iconPositionEnum.LeftIcon),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind1(5,6,"InterfaceDesigner.AddMenu.AddDataSource")),n.\u0275\u0275advance(6),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind1(11,8,"InterfaceDesigner.AddMenu.NewDataSource")),n.\u0275\u0275advance(4),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind1(15,10,"InterfaceDesigner.AddMenu.ExistingDataSource"))}}function Ks(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-data-group-draggable-list",13),n.\u0275\u0275listener("subGroupExpanded",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.onOpened(i))})("subGroupCollapsed",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.onClosed(i))}),n.\u0275\u0275elementEnd()}if(r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("group",t)("getIsExpanded",a.getIsSubGroupExpanded.bind(a))}}function Js(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",11),n.\u0275\u0275template(1,Ks,1,2,"crt-data-group-draggable-list",12),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("tsDataItemMarker","DataPanel"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.dataGroups)("ngForTrackBy",t.trackByItems)}}function Zs(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-draggable-list",16),r&2){const t=n.\u0275\u0275nextContext().$implicit;n.\u0275\u0275property("group",t)}}function Xs(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-data-group-draggable-list",16),r&2){const t=n.\u0275\u0275nextContext().$implicit;n.\u0275\u0275property("group",t)}}function Ys(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-expansion-panel",14),n.\u0275\u0275listener("closed",function(){const o=n.\u0275\u0275restoreView(t).$implicit,s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onClosed(o))})("opened",function(){const o=n.\u0275\u0275restoreView(t).$implicit,s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onOpened(o))}),n.\u0275\u0275template(1,Zs,1,1,"crt-draggable-list",15),n.\u0275\u0275template(2,Xs,1,1,"crt-data-group-draggable-list",15),n.\u0275\u0275elementEnd()}if(r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275property("expanded",a.getIsExpanded(t))("title",t.caption)("ngClass",a.getClasses(t))("disableOverflow",!0)("tsDataItemMarker",t.name+"Panel"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.type!=="Data"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.type==="Data")}}class $n{constructor(e,t,a,i,o,s){this._designerToolsService=e,this._dialogService=t,this._designerSchemaService=a,this._metaItemDesignerService=i,this._changeDetectorRef=o,this._featureValues=s,this.groups=[],this.dataGroups=[],this.showAddDataSourceBtn=!1,this.iconPositionEnum=P.IconPositionEnum,this._expandedGroups=new Map,this._destroyed$=new d.Subject}_initGroups(){this._designerToolsService.groups$.pipe((0,l.map)(e=>(e.forEach(t=>{this.groups.includes(t)||this._expandedGroups.set(t.name,!0)}),e)),(0,l.takeUntil)(this._destroyed$)).subscribe(e=>{if(!this._featureValues["ClientUnitSchemaFeatures.AllowParametersDatasourceDesign"]){this.groups=e,this._changeDetectorRef.markForCheck();return}const t=e.reduce((a,i)=>(a[i.type===h.ViewElementDataGroupType.Data?"data":"other"].push(i),a),{data:[],other:[]});this.dataGroups=t.data,this.groups=t.other,this._changeDetectorRef.markForCheck()})}_updateShowAddDataSourceButton(e){const t=(0,_.resolveSchemaPrimaryDataSource)(e);this.showAddDataSourceBtn=!t}_subscribeSchemaLoaded(){this._designerSchemaService.schemaLoaded$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(e=>this._updateShowAddDataSourceButton(e))}_subscribeSchemaChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{operation:e}})=>e===_.MetaItemDesignSettingChangesOperation.CreateDataSource),(0,l.takeUntil)(this._destroyed$)).subscribe(({schema:e})=>this._updateShowAddDataSourceButton(e))}_addNewDataSource(){const e={panelClass:["dialog-top-border"]};return this._dialogService.open(Rn,e)}_openDataSourceDesigner(e){this._metaItemDesignerService.openMetaItemDesigner("crt.EntityDataSource",X.Edit,{type:g.DesignType.DataSource,itemConfig:{dataSourceName:e,propertiesPanelComponentTypeName:"crt.EntityDataSourcePropertiesPanel"}})}ngOnInit(){this._initGroups(),this._subscribeSchemaLoaded(),this._subscribeSchemaChanged()}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}getIsExpanded(e){return this._expandedGroups.get(e.name)??!0}getIsSubGroupExpanded(e){return this._expandedGroups.has(e.name)?this._expandedGroups.get(e.name):e.expanded??!0}trackByItems(e,t){return t.items$}onOpened(e){this._expandedGroups.set(e.name,!0)}onClosed(e){this._expandedGroups.set(e.name,!1)}addNewDataSource(){var e=this;return(0,F.Z)(function*(){const t=yield(0,d.firstValueFrom)(e._addNewDataSource());t.success&&e._openDataSourceDesigner(t.dataSourceName)})()}addExistingDataSource(){this._dialogService.open(ja,{panelClass:["dialog-top-border"]})}getClasses(e){return{expanded:this.getIsExpanded(e),"data-group-draggable-list":e.type===h.DesignerToolGroupType.Data}}}$n.\u0275fac=function(e){return new(e||$n)(n.\u0275\u0275directiveInject(R),n.\u0275\u0275directiveInject(w.DialogService),n.\u0275\u0275directiveInject(g.DesignerSchemaService),n.\u0275\u0275directiveInject(J),n.\u0275\u0275directiveInject(n.ChangeDetectorRef),n.\u0275\u0275directiveInject(C.FEATURE_VALUES))},$n.\u0275cmp=n.\u0275\u0275defineComponent({type:$n,selectors:[["crt-designer-tools"]],decls:3,vars:4,consts:[["class","actions",4,"ngIf"],[3,"tsDataItemMarker",4,"ngIf"],["togglePosition","after","toggleType","material",3,"expanded","title","ngClass","disableOverflow","tsDataItemMarker","closed","opened",4,"ngFor","ngForOf","ngForTrackBy"],[1,"actions"],["color","default","shape","rounded","data-qa","open-add-menu",3,"matMenuTriggerFor","icon","iconPosition","clicked"],["menuTrigger","matMenuTrigger"],[1,"add-data-source"],[1,"add-data-source-menu"],["addDataSourceMenu","matMenu"],["mat-menu-item","","data-qa","add-new-data-source",3,"click"],["mat-menu-item","","data-qa","add-existing-data-source",3,"click"],[3,"tsDataItemMarker"],[3,"group","getIsExpanded","subGroupExpanded","subGroupCollapsed",4,"ngFor","ngForOf","ngForTrackBy"],[3,"group","getIsExpanded","subGroupExpanded","subGroupCollapsed"],["togglePosition","after","toggleType","material",3,"expanded","title","ngClass","disableOverflow","tsDataItemMarker","closed","opened"],[3,"group",4,"ngIf"],[3,"group"]],template:function(e,t){e&1&&(n.\u0275\u0275template(0,qs,16,12,"div",0),n.\u0275\u0275template(1,Js,2,3,"div",1),n.\u0275\u0275template(2,Ys,3,7,"crt-expansion-panel",2)),e&2&&(n.\u0275\u0275property("ngIf",t.showAddDataSourceBtn),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.dataGroups==null?null:t.dataGroups.length),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.groups)("ngForTrackBy",t.trackByItems))},dependencies:[f.NgClass,f.NgForOf,f.NgIf,u.CrtButtonComponent,u.CrtExpansionPanelComponent,Yt.MatLegacyMenu,Yt.MatLegacyMenuItem,Yt.MatLegacyMenuTrigger,P.DataItemMarkerDirective,Ga,Gn,D.TranslatePipe],styles:[`crt-designer-tools{width:100%}crt-designer-tools .actions{display:flex;justify-content:center;align-items:center;width:280px;height:48px}crt-designer-tools .actions .add-data-source-menu{max-width:290px}crt-designer-tools crt-expansion-panel{border-radius:0;box-sizing:border-box;height:auto;padding:0 16px;transition:border-bottom-color .3s ease-in-out}crt-designer-tools crt-expansion-panel .expansion-panel-header .expansion-panel-title label{text-transform:uppercase}crt-designer-tools crt-expansion-panel.expanded{border-bottom:1px solid transparent}@media screen and (max-width: 1100px){crt-designer-tools .actions{width:114px}crt-designer-tools .actions crt-button button{padding:0 8px}crt-designer-tools .actions crt-button button .add-data-source{text-overflow:ellipsis;overflow:hidden}crt-designer-tools crt-expansion-panel crt-expansion-panel-header .expansion-panel-header .expansion-panel-title{padding-right:0;max-width:100%}crt-designer-tools crt-expansion-panel crt-expansion-panel-header .expansion-panel-header .expansion-panel-title .expansion-panel-label{overflow:hidden}crt-designer-tools crt-expansion-panel crt-expansion-panel-header .expansion-panel-header .expansion-panel-title .expansion-panel-label label{white-space:normal!important}crt-designer-tools crt-expansion-panel crt-expansion-panel-header .expansion-panel-header .button-wrapper{display:none;margin-right:-16px}crt-designer-tools crt-expansion-panel crt-expansion-panel-header .expansion-panel-header:hover .button-wrapper{display:block}}
`],encapsulation:2,changeDetection:0});class $a{}$a.\u0275fac=function(e){return new(e||$a)},$a.\u0275dir=n.\u0275\u0275defineDirective({type:$a,selectors:[["","crtDesignTimeViewElement",""]],features:[n.\u0275\u0275ProvidersFeature([{provide:S.ViewElementTypeResolver,useClass:S.DesignTimeViewElementTypeResolver}])]});var ri=v(54514);function ec(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",15),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onSaveClick())}),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275text(2),n.\u0275\u0275pipe(3,"translate"),n.\u0275\u0275elementEnd()}r&2&&(n.\u0275\u0275property("color","primary")("shape","rounded")("title",n.\u0275\u0275pipeBind1(1,4,"InterfaceDesignerHeaderComponent.SaveButtonCaption")+" (Ctrl+S)"),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(3,6,"InterfaceDesignerHeaderComponent.SaveButtonCaption")," "))}function tc(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",16),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onCancelClick())}),n.\u0275\u0275text(1),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275elementEnd()}r&2&&(n.\u0275\u0275property("shape","rounded"),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(2,2,"InterfaceDesignerHeaderComponent.CancelButtonCaption")," "))}function nc(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",17),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onCloseClick())}),n.\u0275\u0275text(1),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275elementEnd()}if(r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("color",t.closeButtonColor)("shape","rounded"),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(2,3,"InterfaceDesignerHeaderComponent.CloseButtonCaption")," ")}}function ac(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",18),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onUndoClick())}),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275elementEnd()}r&2&&n.\u0275\u0275property("shape","rounded")("icon","undo")("iconPosition","only-icon")("title",n.\u0275\u0275pipeBind1(1,4,"InterfaceDesignerHeaderComponent.UndoButtonTooltip"))}function ic(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",19),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onResetSchemaClick())}),n.\u0275\u0275element(1,"mat-icon",20),n.\u0275\u0275elementEnd()}if(r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275classProp("spin",t.resetSchemaProcessing),n.\u0275\u0275property("title","Reset schema")}}function rc(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",19),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onAlwaysVisibleCellClick())}),n.\u0275\u0275element(1,"mat-icon",21),n.\u0275\u0275elementEnd()}r&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275property("title","Toggle visible cell"))}function oc(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",19),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onTogglePaddingVisibilityClick())}),n.\u0275\u0275element(1,"mat-icon",22),n.\u0275\u0275elementEnd()}r&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275property("title","Toggle padding visibility"))}function sc(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",23),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.openSetupBusinessRulesAddonsDialog())}),n.\u0275\u0275element(1,"mat-icon",24),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275elementEnd()}r&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(2,1,"SchemaDesigners.EntitySchemaDesigner.EntityEditor.EntityBusinessRules.OpenBusinessRulesButtonCaption")))}class ya{constructor(e,t,a,i,o,s,c,m){this._matIconRegistry=e,this._domSanitizer=t,this._designerUndoService=a,this._designerContainerService=i,this._featureService=o,this._dialogService=s,this._environment=c,this._isSchemaChanged$=m,this._featureInterfaceDesignerHeaderSchemaChangedDetection=!1,this.save=new n.EventEmitter,this.cancel=new n.EventEmitter,this.closeDesigner=new n.EventEmitter,this.openProperty=new n.EventEmitter,this.openSourceCode=new n.EventEmitter,this.openBusinessRuleDesigner=new n.EventEmitter,this.isVisibleTogglePaddingVisibility=!1,this.isVisibleResetSchemaButton=!1,this.isVisibleUndoButton=!1,this.isVisibleBusinessRulesButton=!1,this.resetSchemaProcessing=!1,this.isVisibleAlwaysVisibleCell=!1,this.isVisibleSaveButton=!0,this.isVisibleCancelButton=!0,this.isVisibleCloseButton=!1,this.closeButtonColor="default",this._registerIcons(),this._featureService.getFeatureState("TogglePaddingVisibility").subscribe(b=>{this.isVisibleTogglePaddingVisibility=b}),this._featureService.getFeatureState("UndoDeleteButton").subscribe(b=>{this.isVisibleUndoButton=b}),this._featureService.getFeatureState("BRules-SetupDisabled").subscribe(b=>{this.isVisibleBusinessRulesButton=!b}),this._featureService.getFeatureState("InterfaceDesignerHeaderSchemaChangedDetection").pipe((0,l.filter)(Boolean)).subscribe(()=>{this._featureInterfaceDesignerHeaderSchemaChangedDetection=!0,this.closeButtonColor="primary",this.isVisibleSaveButton=!1,this.isVisibleCancelButton=!1,this.isVisibleCloseButton=!0,this._subscribeSchemaChanged()}),this._environment&&this._environment.appPath==="/"&&!this._environment.production&&(this.isVisibleResetSchemaButton=!0,this.isVisibleAlwaysVisibleCell=!0)}_subscribeSchemaChanged(){this._isSchemaChanged$?.subscribe(e=>{this.isVisibleSaveButton=e,this.isVisibleCancelButton=e,this.isVisibleCloseButton=!e})}_registerIcons(){[{name:"cell",icon:v(80159)},{name:"toolsButton",icon:v(66576)},{name:"padding",icon:v(87885)},{name:"undo",icon:v(1781)},{name:"reset",icon:v(25006)},{name:"sourceCodeButton",icon:v(63893)},{name:"businessRuleButton",icon:v(40153)}].forEach(({name:t,icon:a})=>{this._matIconRegistry.addSvgIconLiteral(t,this._domSanitizer.bypassSecurityTrustHtml(a))})}onSaveClick(){this.save.emit()}onCancelClick(){this._featureInterfaceDesignerHeaderSchemaChangedDetection?this.cancel.emit():this.closeDesigner.emit()}onCloseClick(){this.closeDesigner.emit()}onOpenPropertyClick(){this.openProperty.emit()}onOpenSourceCodeClick(){this.openSourceCode.emit()}openSetupBusinessRulesAddonsDialog(){this.openBusinessRuleDesigner.emit()}onTogglePaddingVisibilityClick(){this._designerContainerService.togglePadding()}onResetSchemaClick(){this.resetSchemaProcessing=!0,window.resetSchema=!0,location.reload()}onUndoClick(){this._designerUndoService.undo()}onAlwaysVisibleCellClick(){this._designerContainerService.toggleAlwaysVisibleCell()}onKeyDown(e){this.isVisibleUndoButton&&(0,C.ctrlZPressed)(e)&&(e.preventDefault(),this.onUndoClick()),this.isVisibleResetSchemaButton&&(0,C.ctrlShiftZPressed)(e)&&(e.preventDefault(),this.onResetSchemaClick()),(0,C.ctrlSPressed)(e)&&(e.preventDefault(),this.isVisibleSaveButton&&!this._dialogService.hasOpenDialogs()&&this.onSaveClick())}}ya.\u0275fac=function(e){return new(e||ya)(n.\u0275\u0275directiveInject(E.MatIconRegistry),n.\u0275\u0275directiveInject(ri.DomSanitizer),n.\u0275\u0275directiveInject(An),n.\u0275\u0275directiveInject(z),n.\u0275\u0275directiveInject(ae.FeatureService),n.\u0275\u0275directiveInject(w.DialogService),n.\u0275\u0275directiveInject("environment"),n.\u0275\u0275directiveInject(_o,8))},ya.\u0275cmp=n.\u0275\u0275defineComponent({type:ya,selectors:[["crt-interface-designer-header"]],hostBindings:function(e,t){e&1&&n.\u0275\u0275listener("keydown",function(i){return t.onKeyDown(i)},!1,n.\u0275\u0275resolveWindow)},inputs:{title:"title"},outputs:{save:"save",cancel:"cancel",closeDesigner:"closeDesigner",openProperty:"openProperty",openSourceCode:"openSourceCode",openBusinessRuleDesigner:"openBusinessRuleDesigner"},decls:20,vars:15,consts:[[1,"header-container"],[1,"button-container"],[3,"color","shape","title","clicked",4,"ngIf"],[3,"shape","clicked",4,"ngIf"],[3,"color","shape","clicked",4,"ngIf"],[3,"shape","icon","iconPosition","title","clicked",4,"ngIf"],[1,"title-container"],[1,"text-container"],[1,"property-container"],["shape","rounded",3,"clicked",4,"ngIf"],["shape","rounded","data-qa","openBusinessRules",3,"clicked",4,"ngIf"],["shape","rounded","data-qa","openSourceCode",3,"clicked"],["svgIcon","sourceCodeButton",3,"title"],["shape","rounded","data-qa","openProperty",3,"clicked"],["svgIcon","toolsButton",3,"title"],[3,"color","shape","title","clicked"],[3,"shape","clicked"],[3,"color","shape","clicked"],[3,"shape","icon","iconPosition","title","clicked"],["shape","rounded",3,"clicked"],["svgIcon","reset",3,"title"],["svgIcon","cell",3,"title"],["svgIcon","padding",3,"title"],["shape","rounded","data-qa","openBusinessRules",3,"clicked"],["svgIcon","businessRuleButton",3,"title"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0)(1,"div",1),n.\u0275\u0275template(2,ec,4,8,"crt-button",2),n.\u0275\u0275template(3,tc,3,4,"crt-button",3),n.\u0275\u0275template(4,nc,3,5,"crt-button",4),n.\u0275\u0275template(5,ac,2,6,"crt-button",5),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"div",6)(7,"div",7),n.\u0275\u0275text(8),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(9,"div",8),n.\u0275\u0275template(10,ic,2,3,"crt-button",9),n.\u0275\u0275template(11,rc,2,1,"crt-button",9),n.\u0275\u0275template(12,oc,2,1,"crt-button",9),n.\u0275\u0275template(13,sc,3,3,"crt-button",10),n.\u0275\u0275elementStart(14,"crt-button",11),n.\u0275\u0275listener("clicked",function(){return t.onOpenSourceCodeClick()}),n.\u0275\u0275element(15,"mat-icon",12),n.\u0275\u0275pipe(16,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(17,"crt-button",13),n.\u0275\u0275listener("clicked",function(){return t.onOpenPropertyClick()}),n.\u0275\u0275element(18,"mat-icon",14),n.\u0275\u0275pipe(19,"translate"),n.\u0275\u0275elementEnd()()()),e&2&&(n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",t.isVisibleSaveButton),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.isVisibleCancelButton),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.isVisibleCloseButton),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.isVisibleUndoButton),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate1(" ",t.title," "),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",t.isVisibleResetSchemaButton),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.isVisibleAlwaysVisibleCell),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.isVisibleTogglePaddingVisibility),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.isVisibleBusinessRulesButton),n.\u0275\u0275advance(2),n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(16,11,"InterfaceDesignerHeaderComponent.OpenSourceCodeTooltip")),n.\u0275\u0275advance(3),n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(19,13,"InterfaceDesignerHeaderComponent.OpenPropertyTooltip")))},dependencies:[f.NgIf,u.CrtButtonComponent,E.MatIcon,D.TranslatePipe],styles:[".header-container[_ngcontent-%COMP%]{width:100%;position:sticky;top:0;z-index:100;display:flex;align-items:center;border-bottom-width:1px;border-bottom-style:solid;box-sizing:border-box;height:56px}.header-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:16px}.header-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   crt-button[_ngcontent-%COMP%] + crt-button[_ngcontent-%COMP%]{margin-left:16px}.header-container[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{width:0;text-align:center;display:flex;justify-content:center;flex-grow:1}.header-container[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .text-container[_ngcontent-%COMP%]{align-self:center;overflow:hidden;text-overflow:ellipsis;max-height:100%;white-space:nowrap}.header-container[_ngcontent-%COMP%]   .property-container[_ngcontent-%COMP%]{display:flex;align-items:center;padding-right:16px}.mat-icon.spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]});function cc(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",1)(1,"div",2),n.\u0275\u0275text(2),n.\u0275\u0275pipe(3,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(4,"button",3),n.\u0275\u0275listener("click",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onSafariInfoPanelCloseButtonClicked())}),n.\u0275\u0275element(5,"mat-icon",4),n.\u0275\u0275elementEnd()()}r&2&&(n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate1("\u26A0 ",n.\u0275\u0275pipeBind1(3,1,"InterfaceDesigner.SafariInfoPanelMessage"),""))}const Hi={interval:1e4,maxIntervalDiff:5e3};class va{constructor(){this._visible=!0}get visible(){return this._visible}set visible(e){this._visible=e,e||this._detectPerformanceIssue()}_detectPerformanceIssue(){const e=Hi.interval,t=Hi.maxIntervalDiff;let a=new Date().getTime();const i=setInterval(()=>{const o=new Date().getTime();o-a-e>t&&(clearInterval(i),this.visible=!0),a=o},e)}onSafariInfoPanelCloseButtonClicked(){this.visible=!1}}va.\u0275fac=function(e){return new(e||va)},va.\u0275cmp=n.\u0275\u0275defineComponent({type:va,selectors:[["crt-safari-information-panel"]],decls:1,vars:1,consts:[["class","safari-info-panel",4,"ngIf"],[1,"safari-info-panel"],[1,"message"],[1,"close-button",3,"click"],["svgIcon","close-button-icon"]],template:function(e,t){e&1&&n.\u0275\u0275template(0,cc,6,3,"div",0),e&2&&n.\u0275\u0275property("ngIf",t.visible)},dependencies:[f.NgIf,E.MatIcon,D.TranslatePipe],styles:[".safari-info-panel[_ngcontent-%COMP%]{display:flex;align-items:center;max-height:39px;min-height:39px}.safari-info-panel[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin:0 auto;padding:0 16px;line-height:14px}.safari-info-panel[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{border:none;background:transparent;margin-right:16px;cursor:pointer}.safari-info-panel[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{min-width:8px;max-width:8px;height:8px;display:flex}"]});const lc=["panelCloneWrapper"],dc=["panel"],mc=["canvas"],pc=["rootFlexEl"],gc=["canvas_center"];function uc(r,e){r&1&&n.\u0275\u0275element(0,"crt-safari-information-panel")}function hc(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementContainer(1,16),n.\u0275\u0275elementContainerEnd()),r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext(3);n.\u0275\u0275advance(1),n.\u0275\u0275property("crtViewElement",t)("visibilityStrategy","on-demand")("crtViewModel",a.viewModel)}}function bc(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,hc,2,3,"ng-container",15),n.\u0275\u0275elementContainerEnd()),r&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.viewConfig)}}function _c(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",13,14),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275template(3,bc,2,1,"ng-container",0),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngClass",n.\u0275\u0275pipeBind1(2,2,t.currentThemeClass$)),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngIf",t.viewConfig)}}function fc(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-flex",19,20),n.\u0275\u0275listener("innerScroll",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(i.onRootCanvasFlexScroll())}),n.\u0275\u0275elementEnd()}if(r&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("items",t.viewConfig)("crtViewModel",t.viewModel)("fitContent",!1)}}function Cc(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",13,17),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275template(3,fc,2,3,"crt-flex",18),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275classProp("center-canvas-element",t.centerCanvasElement),n.\u0275\u0275property("ngClass",n.\u0275\u0275pipeBind1(2,4,t.currentThemeClass$)),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngIf",t.viewConfig.length)}}class an extends S.CrtBaseComponent{get parentSchemas(){const e=(0,x.omit)(this._designItem?.schema,["addons"]);return e?[e,...this._designItem?.parentSchemas||[]]:[]}set canvasElRef(e){this._setCanvasElRef(e)}get canvasElRef(){return this._canvasElRef}set canvasCenterElRef(e){this._setCanvasElRef(e)}get isElementPropertiesPanelExpanded(){return this._isElementPropertiesPanelExpanded}set isElementPropertiesPanelExpanded(e){this._isElementPropertiesPanelExpanded=e,this._saveStorageValue(this._isElementPanelExpandedKey,e)}get viewConfig(){return this.viewModel?this._schema?.viewConfig:[]}set designItem(e){const t=e?.bundle??{};if(!e||this._designItem===e)return;this._designItem=e,this._schema=t,this._schemaName=e?.schema?.name,this._schema.useFullHierarchy=e?.schema?.useFullHierarchy,this._designerSchemaService.init(this._schema),(e.viewModel?(0,d.of)(e.viewModel):this._generateViewModel(this._schema)).pipe(this._measurePerformanceService.measure$("viewModel$")).pipe((0,l.take)(1),(0,l.switchMap)(i=>this._setDesignItemViewModel(i)),(0,l.switchMap)(()=>(0,d.from)(this._appearanceSettingsService.getSchemaModalClasses(this._schemaName))),(0,l.map)(i=>{this._sizeClasses=i,this._updateSizeClass(this._sizeClasses[0])}),(0,l.takeUntil)(this._destroyed$)).pipe(i=>this._measureComponentsRendering(i)).subscribe()}get rightPanelConfig(){return{direction:"left",animationDisabled:!1,showToggleButton:!0}}get leftPanelConfig(){return{direction:"right",animationDisabled:!1,showToggleButton:!1}}get designSettings(){return this._designSettings}set designSettings(e){this._openPanelAnimationService.setDesignSettingsWithAnimation(()=>{this._designSettings=e})}constructor(e,t,a,i,o,s,c,m,b,y,T,L,ne,ze,Rt,Oa,K){super(K),this._metaItemDesignerService=e,this._viewModelGenerator=t,this._changeDetectorRef=a,this._designerSchemaService=i,this._designerContainerService=o,this._modelGenerator=s,this._changeCommandResolver=c,this._storageService=m,this._designerLoaderService=b,this._relatedViewElementsService=y,this._relatedComponentStoreService=T,this._environment=L,this._document=ne,this._openPanelAnimationService=ze,this._deviceService=Rt,this._featureValues=Oa,this.injector=K,this._isElementPanelExpandedKey="isElementPanelExpanded",this._selectedItemKey="selectedItem",this._defaultTheme="default-theme",this._brightTheme="bright-theme",this._schemaChangedSubscriptions=new d.Subscription,this._destroyed$=new d.Subject,this._isElementPropertiesPanelExpanded=!1,this._sizeClasses=[],this.isLeftPanelExpanded=!0,this.centerCanvasElement=!1,this._addClsToHost=!0,this.save=new n.EventEmitter,this.cancel=new n.EventEmitter,this.closeDesigner=new n.EventEmitter,this.openProperty=new n.EventEmitter,this.openSourceCode=new n.EventEmitter,this.schemaChanged=new n.EventEmitter,this.pagePropertiesChanged=new n.EventEmitter,this.openBusinessRuleDesigner=new n.EventEmitter,this.isSafari=!1,this._renderer=this.injector.get(n.Renderer2),this._window=this.injector.get(G.WINDOW_TOKEN),this._macrosHandlerService=this.injector.get(C.MacrosHandlerService),this.centerCanvasElement=this.injector.get(bo,!1),this._designerOverlayService=this.injector.get(be),this._appearanceSettingsService=this.injector.get(C.AppearanceSettingsService),this._appearanceSettingsStore=this.injector.get(ys.DesignTimeAppearanceSettingsStoreService),this._measurePerformanceService=K.get(C.MeasurePerformanceService),this._useBrightTheme(),this._initCurrentTheme()}static _isShouldGenerateViewModel(e){return e!==_.MetaItemDesignSettingChangesOperation.Move&&e!==_.MetaItemDesignSettingChangesOperation.Remove&&e!==_.MetaItemDesignSettingChangesOperation.MoveToIndex}_onSchemaChanged(){this.schemaChanged.emit(this._schema)}_generateModel(e){return this._modelGenerator.generate(e.modelConfig)}_updateSizeClass(e,t){if(!this.centerCanvasElement)return;const a=this.rootFlexEl?.nativeElement;(0,x.isEmpty)(t)||this._renderer.removeClass(a,t),this._renderer.addClass(a,e)}_generateViewModel(e){const t=this._generateModel(e),a=this._macrosHandlerService.handleResourceMacros(e.viewModelConfig,e.resources);return(0,d.combineLatest)([t,a]).pipe((0,l.map)(([i,o])=>({...e,models:i,viewModelConfig:o,businessRulesActive:!1})),(0,l.mergeMap)(i=>this._viewModelGenerator.generate(i,n.Injector.create({providers:[{provide:I.SCOPE_NAME,useValue:this._schemaName}],parent:this.injector}))))}_getAllViewElements(e=Array.from(this.nested)){return[...e,...e.flatMap(t=>this._getAllViewElements(t.nested))]}_updateViewElementBindingContext(e,t){const a=this.findViewElementDirective(e.name);a&&(a.updateViewElementConfig(e),a.injector.get(S.BINDING_CONTEXT_DESIGN_TIME).viewModelSubject.next(t))}_initMetaItemDesignerOpenedSubscription(){this._metaItemDesignerService.metaItemDesignerOpened$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(e=>{if(this.isElementPropertiesPanelExpanded=!0,!e)this._designerContainerService.select(null);else{const{viewConfig:t}=this._designerSchemaService.getViewConfigInfoByName(this._designSettingsName),a=e.type===g.DesignType.ViewElement?t:e.itemConfig;this.designSettings={...e,itemConfig:a,resources:this._schema?.resources,viewModelConfig:this._schema?.viewModelConfig,parentSchemas:this.parentSchemas,packageUId:this._getPackageUId()}}this._changeDetectorRef.detectChanges()})}_initSelectedChangedSubscription(){this._designerContainerService.selectedChanged$.pipe((0,l.switchMap)(({name:e,mode:t})=>(0,d.combineLatest)([(0,d.of)({name:e,mode:t}),this._relatedViewElementsService.getRelatedFor(e)])),(0,l.takeUntil)(this._destroyed$)).subscribe(([{name:e,mode:t},a])=>{this._selectedItemName=e,this._designSettingsName=a??e;const i=t===X.Init;(this.isElementPropertiesPanelExpanded||i)&&(t=i?X.Edit:t,this._updateDesignSettings(this._designSettingsName,t)),this._saveStorageValue(this._selectedItemKey,this._selectedItemName)})}_initAppearanceSettingChangedSubscription(){var e=this;this._appearanceSettingsStore.appearanceSettingChanged$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe((0,F.Z)(function*(){const t=yield e._appearanceSettingsService.getSchemaModalClasses(e._schemaName);e._updateSizeClass(t[0],e._sizeClasses[0]),e._sizeClasses=t}))}_getPackageUId(){return this._designItem.schema.package.uId}_updateDesignSettings(e,t=X.Edit){const{viewConfig:a}=this._designerSchemaService.getViewConfigInfoByName(e);a?this.designSettings={metaItemType:a.type,mode:t,itemConfig:a,type:g.DesignType.ViewElement,resources:this._schema?.resources,viewModelConfig:this._schema?.viewModelConfig,parentSchemas:this.parentSchemas,packageUId:this._getPackageUId(),schemaUId:this._designItem.schema.uId}:this._openPropertyPanel()}_openPropertyPanel(){this.designSettings=null,this.openProperty.emit()}_expandRightPanelAfterSchemaChange({viewConfig:e,operation:t}){const i=h.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos.get(e.type)?.designControlConfig?.selfSelect;t===_.MetaItemDesignSettingChangesOperation.Insert&&i!==!1&&(this.isElementPropertiesPanelExpanded=!0)}_initSchemaChangedSubscription(){this._designerSchemaService.schemaChanged$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(({schema:e,changes:t})=>{this._schema=e,an._isShouldGenerateViewModel(t.operation)?this._subscribeViewModelGenerate(t.viewConfig):this._onSchemaChanged(),this._expandRightPanelAfterSchemaChange(t)}),this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:e})=>e.operation===_.MetaItemDesignSettingChangesOperation.Insert||e.operation===_.MetaItemDesignSettingChangesOperation.MoveToContainer),(0,l.switchMap)(({changes:e})=>this._relatedViewElementsService.getRelatedFor(e.viewConfig.name)),(0,l.filter)(e=>!!e),(0,l.takeUntil)(this._destroyed$)).subscribe(e=>{const t=this.findViewElementDirective(e);t&&this._relatedComponentStoreService.set(t?.componentRef?.instance)})}_subscribeViewModelGenerate(e){const t=new d.Subject;this._getGenerateViewModel().pipe((0,l.takeUntil)(t)).subscribe(a=>{this._window.requestAnimationFrame(()=>{this._measurePerformanceService.measure("_updateViewElementBindingContext",()=>{this._updateViewElementBindingContext(e,a)}),t.next(),t.complete()})})}_getGenerateViewModel(){return this._generateViewModel(this._schema).pipe((0,l.first)(),(0,l.observeOn)(d.animationFrameScheduler),(0,l.tap)(()=>this._onSchemaChanged())).pipe(this._measurePerformanceService.measure$("_generateViewModel after schema changes"))}_getSchemaStorageKey(e){let t;const{schema:a,isNew:i,extendSchema:o,parentSchemas:s}=this._designItem||{};if(a&&o||i){const c=s?.[0]?.uId;t=c?`new_${c}`:"new"}else a?t=a.uId:t="new";return`${e}_${t}`}_saveStorageValue(e,t){const a=this._getSchemaStorageKey(e);t?this._storageService.set(a,String(t)):this._storageService.remove(a)}_loadStorageValue(e){const t=this._storageService.get(this._getSchemaStorageKey(e));return String(t)}_initElementPanelExpanded(){const e=this._loadStorageValue(this._isElementPanelExpandedKey);this._isElementPropertiesPanelExpanded=e==="true"}_initSelectedItemName(){const e=this._loadStorageValue(this._selectedItemKey),t=e&&this._designerSchemaService.getViewConfigInfoByName(e);this._selectedItemName=t?.viewConfig?.name}_useBrightTheme(){const e=this._document.body;this._renderer.removeClass(e,this._defaultTheme),this._renderer.addClass(e,this._brightTheme)}_useDefaultTheme(){const e=this._document.body;this._renderer.removeClass(e,this._brightTheme),this._renderer.addClass(e,this._defaultTheme)}_initCurrentTheme(){const e=this.injector.get(C.AbstractThemeProvider);this.currentThemeClass$=e.getCurrentTheme().pipe((0,l.map)(t=>t.cssSelector))}_initOpenPanelAnimationService(){this._openPanelAnimationService.setup({panelElement:this.panel?.nativeElement,panelCloneElement:this.panelCloneWrapper?.nativeElement})}_subscribeResize(){this._resizeObserver=this._designerOverlayService.subscribeElementResize(this.canvasElRef.nativeElement)}_setCanvasElRef(e){e&&!this._canvasElRef&&(this._canvasElRef=e,this._subscribeResize())}_setDesignItemViewModel(e){var t=this;return(0,F.Z)(function*(){t.viewModel=e,t._designerLoaderService.completeLoadingPart(g.LoadingPart.ViewModelGenerated),t._initSelectedItemName(),t._selectedItemName&&(yield new Promise(a=>setTimeout(a))),t._designerContainerService.initSelect(t._selectedItemName),t._initElementPanelExpanded()})()}_measureComponentsRendering(e){if(!this._featureValues?.UseMeasurePerformanceTools)return e;let t;return(0,d.of)(null).pipe((0,l.tap)(()=>t=performance.now()),(0,l.switchMap)(()=>e),(0,l.tap)(()=>{this._measurePerformanceService.rendering$.pipe((0,l.debounceTime)(1e3)).subscribe(()=>{this._measurePerformanceService.measure("rendering of all components",()=>{},t)})}))}findViewElementDirective(e){if(e!=null)return this._getAllViewElements().find(t=>t.viewElementConfig.name===e)}onItemPropertyChanged(e){this._changeCommandResolver.resolve(e).subscribe(a=>a.execute())}onPagePropertiesChanged(e){e&&this.pagePropertiesChanged.emit({...e,caption:new C.LocalizableStringArray(e.caption),description:new C.LocalizableStringArray(e.description)})}onAction(e){e.type===ui.OpenSourceCode&&this.onOpenSourceCode()}ngOnInit(){this._initMetaItemDesignerOpenedSubscription(),this._initSchemaChangedSubscription(),this._initSelectedChangedSubscription(),this._initAppearanceSettingChangedSubscription()}ngAfterViewInit(){this._initOpenPanelAnimationService(),this.isSafari=this._deviceService?.browser===uo.BROWSERS.SAFARI}ngOnDestroy(){this._useDefaultTheme(),this._schemaChangedSubscriptions.unsubscribe(),this._resizeObserver?.disconnect(),this._designerSchemaService.ngOnDestroy(),this._destroyed$.next(),this._destroyed$.complete()}onSave(){this.save.emit()}onCancel(){this.cancel.emit()}onClose(){this.closeDesigner.emit()}onBeforeUnload(){this._environment&&this._environment.appPath==="/"&&!this._environment.production&&this.save.emit(),this._saveStorageValue(this._selectedItemKey,this._selectedItemName),this._saveStorageValue(this._isElementPanelExpandedKey,this.isElementPropertiesPanelExpanded)}onOpenProperty(){(!this.designSettings||!this.isElementPropertiesPanelExpanded)&&this.onToggleRightPanel(),this._designerContainerService.select(null)}onOpenSourceCode(){this.openSourceCode.emit()}onToggleRightPanel(){this.isElementPropertiesPanelExpanded=!this.isElementPropertiesPanelExpanded,this.isElementPropertiesPanelExpanded&&this._updateDesignSettings(this._designSettingsName)}onToggleLeftPanel(){this.isLeftPanelExpanded=!this.isLeftPanelExpanded}onOpenBusinessRuleDesigner(){this.openBusinessRuleDesigner.emit()}onRootCanvasFlexScroll(){this._designerOverlayService.hide()}}an.\u0275fac=function(e){return new(e||an)(n.\u0275\u0275directiveInject(J),n.\u0275\u0275directiveInject(I.ViewModelGenerator),n.\u0275\u0275directiveInject(n.ChangeDetectorRef),n.\u0275\u0275directiveInject(g.DesignerSchemaService),n.\u0275\u0275directiveInject(z),n.\u0275\u0275directiveInject(I.ModelGenerator),n.\u0275\u0275directiveInject(ba),n.\u0275\u0275directiveInject(C.StorageService),n.\u0275\u0275directiveInject(g.DesignerLoaderService),n.\u0275\u0275directiveInject(_.RelatedViewElementsService),n.\u0275\u0275directiveInject(Qt),n.\u0275\u0275directiveInject("environment"),n.\u0275\u0275directiveInject(f.DOCUMENT),n.\u0275\u0275directiveInject(dt),n.\u0275\u0275directiveInject(uo.DeviceDetectorService),n.\u0275\u0275directiveInject(C.FEATURE_VALUES,8),n.\u0275\u0275directiveInject(n.Injector))},an.\u0275cmp=n.\u0275\u0275defineComponent({type:an,selectors:[["crt-base-interface-designer"]],viewQuery:function(e,t){if(e&1&&(n.\u0275\u0275viewQuery(lc,5,n.ElementRef),n.\u0275\u0275viewQuery(dc,5,n.ElementRef),n.\u0275\u0275viewQuery(mc,7),n.\u0275\u0275viewQuery(pc,5,n.ElementRef),n.\u0275\u0275viewQuery(gc,5),n.\u0275\u0275viewQuery(S.ViewElementDirective,5)),e&2){let a;n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.panelCloneWrapper=a.first),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.panel=a.first),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.canvasElRef=a.first),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.rootFlexEl=a.first),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.canvasCenterElRef=a.first),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.nested=a)}},hostVars:2,hostBindings:function(e,t){e&1&&n.\u0275\u0275listener("beforeunload",function(){return t.onBeforeUnload()},!1,n.\u0275\u0275resolveWindow),e&2&&n.\u0275\u0275classProp("crt-base-interface-designer",t._addClsToHost)},inputs:{pageProperties:"pageProperties",title:"title",designItem:"designItem"},outputs:{save:"save",cancel:"cancel",closeDesigner:"closeDesigner",openProperty:"openProperty",openSourceCode:"openSourceCode",schemaChanged:"schemaChanged",pagePropertiesChanged:"pagePropertiesChanged",openBusinessRuleDesigner:"openBusinessRuleDesigner"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:15,vars:12,consts:[[4,"ngIf"],[1,"interface-designer-header",3,"title","save","cancel","closeDesigner","openProperty","openSourceCode","openBusinessRuleDesigner"],[1,"designer-container"],[1,"left-panel"],[3,"panelConfig","isExpanded","toggle"],["class","canvas-panel","crtDesignTimeViewElement","",3,"ngClass",4,"ngIf","ngIfElse"],["centerCanvas",""],[1,"element-properties-panel-container"],[1,"element-properties-panel",3,"isExpanded","panelConfig","toggle"],[1,"panel-clone-wrapper"],["panelCloneWrapper",""],[3,"elementProperties","pageProperties","itemPropertiesChanged","pagePropertiesChanged","action"],["panel",""],["crtDesignTimeViewElement","",1,"canvas-panel",3,"ngClass"],["canvas",""],[4,"ngFor","ngForOf"],[3,"crtViewElement","visibilityStrategy","crtViewModel"],["canvas_center",""],["class","root-canvas-flex","crtViewElement","",3,"items","crtViewModel","fitContent","innerScroll",4,"ngIf"],["crtViewElement","",1,"root-canvas-flex",3,"items","crtViewModel","fitContent","innerScroll"],["rootFlexEl",""]],template:function(e,t){if(e&1&&(n.\u0275\u0275template(0,uc,1,0,"crt-safari-information-panel",0),n.\u0275\u0275elementStart(1,"crt-interface-designer-header",1),n.\u0275\u0275listener("save",function(){return t.onSave()})("cancel",function(){return t.onCancel()})("closeDesigner",function(){return t.onClose()})("openProperty",function(){return t.onOpenProperty()})("openSourceCode",function(){return t.onOpenSourceCode()})("openBusinessRuleDesigner",function(){return t.onOpenBusinessRuleDesigner()}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(2,"div",2)(3,"div",3)(4,"ts-vertical-expansion-panel",4),n.\u0275\u0275listener("toggle",function(){return t.onToggleLeftPanel()}),n.\u0275\u0275element(5,"crt-designer-tools"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275template(6,_c,4,4,"div",5),n.\u0275\u0275template(7,Cc,4,6,"ng-template",null,6,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementStart(9,"div",7)(10,"ts-vertical-expansion-panel",8),n.\u0275\u0275listener("toggle",function(){return t.onToggleRightPanel()}),n.\u0275\u0275element(11,"div",9,10),n.\u0275\u0275elementStart(13,"crt-interface-designer-properties-panel",11,12),n.\u0275\u0275listener("itemPropertiesChanged",function(i){return t.onItemPropertyChanged(i)})("pagePropertiesChanged",function(i){return t.onPagePropertiesChanged(i)})("action",function(i){return t.onAction(i)}),n.\u0275\u0275elementEnd()()()()),e&2){const a=n.\u0275\u0275reference(8);n.\u0275\u0275property("ngIf",t.isSafari),n.\u0275\u0275advance(1),n.\u0275\u0275property("title",t.title),n.\u0275\u0275advance(2),n.\u0275\u0275classProp("show",t.isLeftPanelExpanded),n.\u0275\u0275advance(1),n.\u0275\u0275property("panelConfig",t.leftPanelConfig)("isExpanded",t.isLeftPanelExpanded),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",!t.centerCanvasElement)("ngIfElse",a),n.\u0275\u0275advance(4),n.\u0275\u0275property("isExpanded",t.isElementPropertiesPanelExpanded)("panelConfig",t.rightPanelConfig),n.\u0275\u0275advance(3),n.\u0275\u0275property("elementProperties",t.designSettings)("pageProperties",t.pageProperties)}},dependencies:[P.FlexContainerComponent,P.VerticalExpansionPanelComponent,f.NgClass,f.NgForOf,f.NgIf,Xt,S.ViewModelDirective,S.ViewElementDirective,$n,$a,ya,va,f.AsyncPipe],styles:[`.crt-base-interface-designer{overflow:hidden}.crt-base-interface-designer .interface-designer-header{height:56px}.crt-base-interface-designer .designer-container{display:flex;width:100%;flex-grow:1;min-height:0;min-width:0}.crt-base-interface-designer .designer-container .left-panel{z-index:3;-webkit-user-select:none;user-select:none}.crt-base-interface-designer .designer-container .left-panel.show{width:280px;transition:width .25s ease;display:block;overflow-x:hidden;overflow-y:auto;scrollbar-width:thin}.crt-base-interface-designer .designer-container .canvas-panel{flex:1;position:relative;overflow:hidden;display:flex;flex-direction:column;padding:12px 12px 0;-webkit-user-select:none;user-select:none}.crt-base-interface-designer .designer-container .canvas-panel .root-canvas-flex{height:100%}@supports (background: -webkit-named-image(i)){.crt-base-interface-designer .designer-container .canvas-panel .root-canvas-flex{height:initial}}.crt-base-interface-designer .designer-container .canvas-panel .root-canvas-flex>.crt-flex{height:100%}@supports (background: -webkit-named-image(i)){.crt-base-interface-designer .designer-container .canvas-panel .root-canvas-flex>.crt-flex{height:initial}}.crt-base-interface-designer .designer-container .canvas-panel .root-canvas-flex>.crt-flex>.crt-view-element-container{display:flex;flex-direction:column;min-height:0;min-width:0;flex-grow:1;height:100%}@supports (background: -webkit-named-image(i)){.crt-base-interface-designer .designer-container .canvas-panel .root-canvas-flex>.crt-flex>.crt-view-element-container{height:initial}}.crt-base-interface-designer .designer-container .canvas-panel .root-canvas-flex>.crt-flex>.crt-view-element-container>crt-designer-grid-container{height:100%;position:relative;overflow:hidden}.crt-base-interface-designer .designer-container .canvas-panel .root-canvas-flex>.crt-flex>.crt-view-element-container>crt-designer-grid-container>.crt-grid{position:absolute;min-height:0;min-width:0;overflow:auto}@supports (overflow: overlay){.crt-base-interface-designer .designer-container .canvas-panel .root-canvas-flex>.crt-flex>.crt-view-element-container>crt-designer-grid-container>.crt-grid{overflow:overlay}}.crt-base-interface-designer .designer-container .canvas-panel .modal-size-small{max-width:420px;min-width:420px}.crt-base-interface-designer .designer-container .canvas-panel .modal-size-medium{max-width:540px;min-width:540px}.crt-base-interface-designer .designer-container .canvas-panel .modal-size-large{max-width:60vw;min-width:60vw}.crt-base-interface-designer .designer-container .canvas-panel .modal-size-extra-large{max-width:90vw;min-width:90vw}.crt-base-interface-designer .designer-container .canvas-panel.center-canvas-element{align-items:center;flex-wrap:wrap;padding:4vh 12px}.crt-base-interface-designer .designer-container .canvas-panel.center-canvas-element .root-canvas-flex{width:auto;height:auto;box-shadow:0 0 14px #00000026;border-radius:8px}.crt-base-interface-designer .designer-header{display:block}.crt-base-interface-designer .element-properties-panel{height:100vh}.crt-base-interface-designer .element-properties-panel .panel{overflow:hidden;position:relative;z-index:2}.crt-base-interface-designer .panel-clone-wrapper{position:absolute;height:100%;pointer-events:none}@media screen and (max-width: 1100px){.crt-base-interface-designer .designer-container .left-panel.show{width:114px}}
`],encapsulation:2});var yc=v(27542),vc=v.n(yc);class Un extends S.CrtBaseComponent{constructor(e){super(e)}}Un.\u0275fac=function(e){return new(e||Un)(n.\u0275\u0275directiveInject(n.Injector))},Un.\u0275cmp=n.\u0275\u0275defineComponent({type:Un,selectors:[["crt-designer-grid-cell"]],inputs:{row:"row",column:"column",visibility:"visibility",minHeight:"minHeight"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:1,vars:4,consts:[[1,"designer-grid-cell"]],template:function(e,t){e&1&&n.\u0275\u0275element(0,"div",0),e&2&&(n.\u0275\u0275styleProp("min-height",t.minHeight),n.\u0275\u0275classProp("show-cell",t.visibility))},styles:[".designer-grid-cell[_ngcontent-%COMP%]{height:100%;min-width:32px;border-width:1px;border-style:solid;box-sizing:border-box;border-radius:8px;opacity:0;transition:.3s ease}.designer-grid-cell.show-cell[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0});class gt extends S.CrtBaseComponent{}gt.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(gt)))(t||gt)}}(),gt.\u0275cmp=n.\u0275\u0275defineComponent({type:gt,selectors:[["crt-designer-grid-column"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:1,vars:0,consts:[[1,"grid-item","col"]],template:function(e,t){e&1&&n.\u0275\u0275element(0,"div",0)},encapsulation:2});class ut extends S.CrtBaseComponent{}ut.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(ut)))(t||ut)}}(),ut.\u0275cmp=n.\u0275\u0275defineComponent({type:ut,selectors:[["crt-designer-grid-row"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:1,vars:0,consts:[[1,"grid-item","row"]],template:function(e,t){e&1&&n.\u0275\u0275element(0,"div",0)},encapsulation:2,changeDetection:0});class Sa{get cursors(){return{bottomLeft:"nesw-resize",bottomRight:"nwse-resize",leftOrRight:"ew-resize",topLeft:"nwse-resize",topRight:"nesw-resize",topOrBottom:"ns-resize"}}set hovered(e){this._hovered=e,this.changeDetectorRef.markForCheck(),requestAnimationFrame(()=>{this._applyHoveredClass()})}get hovered(){return this._hovered}constructor(e){this.injector=e,this._destroyed$=new d.Subject,this.resizeEnd=new n.EventEmitter,this.resizing=new n.EventEmitter,this.resizeStart=new n.EventEmitter,this.designerContainerService=e.get(z),this.elementRef=e.get(n.ElementRef),this.changeDetectorRef=e.get(n.ChangeDetectorRef)}isVisibleEdge(e){return!0}_subscribeHoverChanges(){this.designerContainerService.hoveredItemName$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(e=>{this.hovered=e===this.name})}_applyHoveredClass(){const t=this.elementRef.nativeElement.firstChild.classList,a="hovered";!t||(this.hovered?t.add(a):t.remove(a))}ngOnInit(){this._subscribeHoverChanges()}onResizeStart(){this.resizeStart.emit((0,x.cloneDeep)(this.layoutConfig))}onResizing(e){this.focused=!0;const t=this.getChangedLayoutConfig(e);t&&this.resizing.emit(t)}onResizeEnd(e){const t=this.getChangedLayoutConfig(e);this.resizeEnd.emit(t||this.layoutConfig)}canResize(e){return this.isVisibleEdge(e)}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}Sa.\u0275fac=function(e){return new(e||Sa)(n.\u0275\u0275directiveInject(n.Injector))},Sa.\u0275dir=n.\u0275\u0275defineDirective({type:Sa,inputs:{layoutConfig:"layoutConfig",dragActive:"dragActive",focused:"focused",name:"name"},outputs:{resizeEnd:"resizeEnd",resizing:"resizing",resizeStart:"resizeStart"}});const Co=function(){return{top:!0}};function Sc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",18),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,Co))}const yo=function(){return{bottom:!0}};function wc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",19),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,yo))}const vo=function(){return{left:!0}};function Dc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",20),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,vo))}const So=function(){return{right:!0}};function Mc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",21),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,So))}const wo=function(){return{top:!0,right:!0}};function xc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",22),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementStart(1,"div",23),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()()),r&2&&(n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(2,wo)),n.\u0275\u0275advance(1),n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(3,wo)))}const Do=function(){return{top:!0,left:!0}};function Ic(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",24),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementStart(1,"div",25),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()()),r&2&&(n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(2,Do)),n.\u0275\u0275advance(1),n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(3,Do)))}function Pc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",26),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,Co))}const Mo=function(){return{bottom:!0,right:!0}};function Ec(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",27),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementStart(1,"div",28),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()()),r&2&&(n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(2,Mo)),n.\u0275\u0275advance(1),n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(3,Mo)))}const xo=function(){return{bottom:!0,left:!0}};function Tc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",29),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementStart(1,"div",30),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()()),r&2&&(n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(2,xo)),n.\u0275\u0275advance(1),n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(3,xo)))}function Oc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",31),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,yo))}function Ac(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",32),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,vo))}function Vc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",33),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,So))}function Fc(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275element(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),n.\u0275\u0275template(5,Sc,1,2,"div",6),n.\u0275\u0275template(6,wc,1,2,"div",7),n.\u0275\u0275template(7,Dc,1,2,"div",8),n.\u0275\u0275template(8,Mc,1,2,"div",9),n.\u0275\u0275template(9,xc,2,4,"div",10),n.\u0275\u0275template(10,Ic,2,4,"div",11),n.\u0275\u0275template(11,Pc,1,2,"div",12),n.\u0275\u0275template(12,Ec,2,4,"div",13),n.\u0275\u0275template(13,Tc,2,4,"div",14),n.\u0275\u0275template(14,Oc,1,2,"div",15),n.\u0275\u0275template(15,Ac,1,2,"div",16),n.\u0275\u0275template(16,Vc,1,2,"div",17),n.\u0275\u0275elementContainerEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(5),n.\u0275\u0275property("ngIf",t.canResize("top")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("bottom")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("left")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("right")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("top right")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("top left")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("top")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("bottom right")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("bottom left")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("bottom")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("left")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("right"))}}const Nc=["*"];class pe extends Sa{constructor(e){super(e),this.injector=e,this._gridLayoutConfigPositionResolverService=e.get(tn)}static _getSize(e,t,a,i=!1){a||(a=1);const o=Math.abs(e-t);return i?t>e?a-=o:a+=o:a=o+1,a}static _getResizes(e){return{resizeToTop:e.edges.top,resizeToLeft:e.edges.left,resizeToRight:e.edges.right,resizeToBottom:e.edges.bottom}}_getIndex(){return{colStart:this.layoutConfig.column-1,rowStart:this.layoutConfig.row-1,colEnd:this.layoutConfig.column-1+(this.layoutConfig.colSpan||1)-1,rowEnd:this.layoutConfig.row-1+(this.layoutConfig.rowSpan||1)-1}}_getColumnMinWidth(){const e=this.layoutConfig.column-1;return this.columnSizes[e]}_getRowMinHeight(){const e=this.layoutConfig.row-1;return this.rowSizes[e]}_getLeftWidthToBorder(e){return this.columnSizes.reduce((a,i,o)=>o<=e?a+i:a,0)+this.gap.column*e}_getRightWidthToBorder(e,t){const a=this.columnSizes.reduce((s,c,m)=>m>=e?s+c:s,0),i=t-e,o=this.columnSizes.length-1-t;return a+this.gap.column*(i+o)}_getTopHeightToBorder(e){return this.rowSizes.reduce((a,i,o)=>o<=e?a+i:a,0)+this.gap.column*e}getChangedLayoutConfig(e){let{row:t,column:a,rowSpan:i,colSpan:o}=this.layoutConfig;const{resizeToRight:s,resizeToLeft:c,resizeToTop:m,resizeToBottom:b}=pe._getResizes(e);if(!(s||c||m||b))return null;const{colStart:T,colEnd:L,rowStart:ne,rowEnd:ze}=this._getIndex(),Rt=c?T:L,Oa=m?ne:ze,K={x:s||c,y:m||b},nt=this._gridLayoutConfigPositionResolverService.getPositionByDistance({distance:K,columnIndex:Rt,rowIndex:Oa,rowGap:this.gap.row,columnGap:this.gap.column,rowSizes:this.rowSizes,columnSizes:this.columnSizes,intersectionRatio:this.intersectRatio});return s&&(o=pe._getSize(a,nt.column,o)),c&&(o=pe._getSize(a,nt.column,o,!0),a=nt.column),b&&(i=pe._getSize(t,nt.row,i)),m&&(i=pe._getSize(t,nt.row,i,!0),t=nt.row),{row:t,rowSpan:i,column:a,colSpan:o}}validate(e){const{resizeToRight:t,resizeToLeft:a,resizeToTop:i,resizeToBottom:o}=pe._getResizes(e),s=this._getColumnMinWidth(),c=this._getRowMinHeight(),{rowEnd:m,colStart:b,colEnd:y}=this._getIndex(),T=this._getLeftWidthToBorder(y),L=this._getRightWidthToBorder(b,y),ne=this._getTopHeightToBorder(m),ze=a&&e.rectangle.width>T,Rt=t&&e.rectangle.width>L,Oa=i&&e.rectangle.height>ne,K=t||a,nt=e.rectangle.width>s,mi=i||o,ai=e.rectangle.height>c;if(Oa||Rt||ze)return!1;if(K&&mi)return nt&&ai;if(K)return nt;if(mi)return ai}}pe.\u0275fac=function(e){return new(e||pe)(n.\u0275\u0275directiveInject(n.Injector))},pe.\u0275cmp=n.\u0275\u0275defineComponent({type:pe,selectors:[["crt-designer-grid-resizable-item"]],inputs:{columnSizes:"columnSizes",rowSizes:"rowSizes",gap:"gap",intersectRatio:"intersectRatio"},features:[n.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:Nc,decls:3,vars:8,consts:[["mwlResizable","",1,"rectangle",3,"enableGhostResize","validateResize","resizeCursors","resizeStart","resizing","resizeEnd"],[4,"ngIf"],[1,"resize","border-top"],[1,"resize","border-bottom"],[1,"resize","border-right"],[1,"resize","border-left"],["class","resize resize-top","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-bottom","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-left","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-right","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-top resize-right","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-top resize-left","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-top resize-center","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-bottom resize-right","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-bottom resize-left","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-bottom resize-center","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-left resize-center","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-right resize-center","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["mwlResizeHandle","",1,"resize","resize-top",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-left",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-right",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-top","resize-right",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-top","resize-right","inner",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-top","resize-left",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-top","resize-left","inner",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-top","resize-center",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom","resize-right",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom","resize-right","inner",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom","resize-left",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom","resize-left","inner",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom","resize-center",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-left","resize-center",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-right","resize-center",3,"resizeEdges","mousedown"]],template:function(e,t){e&1&&(n.\u0275\u0275projectionDef(),n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275listener("resizeStart",function(){return t.onResizeStart()})("resizing",function(i){return t.onResizing(i)})("resizeEnd",function(i){return t.onResizeEnd(i)}),n.\u0275\u0275projection(1),n.\u0275\u0275template(2,Fc,17,12,"ng-container",1),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275classProp("drag-active",t.dragActive)("focused",t.focused),n.\u0275\u0275property("enableGhostResize",!0)("validateResize",t.validate.bind(t))("resizeCursors",t.cursors),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",t.hovered||t.focused))},dependencies:[f.NgIf,re.ResizableDirective,re.ResizeHandleDirective],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;min-height:0;min-width:0;flex-grow:1}.rectangle[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;min-height:0;min-width:0;flex-grow:1}.rectangle[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:first-child{min-height:0;min-width:0}.rectangle.resize-active[_ngcontent-%COMP%] > .resize-top.resize-right[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-top.resize-left[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-top.resize-center[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-top.resize-right[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-top.resize-left[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-top.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.resize-active[_ngcontent-%COMP%] > .resize-left.resize-center[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-right.resize-center[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-left.resize-center[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-right.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.resize-active[_ngcontent-%COMP%] > .resize-bottom.resize-right[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-bottom.resize-left[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-bottom.resize-center[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-bottom.resize-right[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-bottom.resize-left[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-bottom.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.resize-active[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-top[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-bottom[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-left[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-right[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-top[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-bottom[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-left[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-right[_ngcontent-%COMP%]{opacity:1}.rectangle.resize-active[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%]{border-top-style:dashed}.rectangle.resize-active[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%]{border-bottom-style:dashed}.rectangle.resize-active[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%]{border-left-style:dashed}.rectangle.resize-active[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%]{border-right-style:dashed}.rectangle.focused[_ngcontent-%COMP%] > .resize-top.resize-right[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-top.resize-left[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-top.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.focused[_ngcontent-%COMP%] > .resize-left.resize-center[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-right.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.focused[_ngcontent-%COMP%] > .resize-bottom.resize-right[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-bottom.resize-left[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-bottom.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.focused[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-top[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-bottom[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-left[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-right[_ngcontent-%COMP%]{opacity:1}.rectangle.focused[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%]{border-top-style:solid}.rectangle.focused[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%]{border-bottom-style:solid}.rectangle.focused[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%]{border-left-style:solid}.rectangle.focused[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%]{border-right-style:solid}.border-top[_ngcontent-%COMP%], .border-bottom[_ngcontent-%COMP%], .border-left[_ngcontent-%COMP%], .border-right[_ngcontent-%COMP%]{box-sizing:border-box;background-color:transparent}.resize-top[_ngcontent-%COMP%], .resize-bottom[_ngcontent-%COMP%], .resize-left[_ngcontent-%COMP%], .resize-right[_ngcontent-%COMP%]{background-color:transparent}.resize-top[_ngcontent-%COMP%], .resize-bottom[_ngcontent-%COMP%], .border-top[_ngcontent-%COMP%], .border-bottom[_ngcontent-%COMP%]{position:absolute;height:5px;width:100%}.resize-top[_ngcontent-%COMP%], .resize-bottom[_ngcontent-%COMP%]{cursor:ns-resize}.border-top[_ngcontent-%COMP%]{top:0;border-top-width:1px}.resize-top[_ngcontent-%COMP%]{top:0}.resize-top.resize-right[_ngcontent-%COMP%], .resize-top.resize-left[_ngcontent-%COMP%], .resize-top.resize-center[_ngcontent-%COMP%]{margin-top:-2px;width:5px;height:5px;border-width:0;border-style:solid}.resize-top.resize-right.inner[_ngcontent-%COMP%], .resize-top.resize-left.inner[_ngcontent-%COMP%], .resize-top.resize-center.inner[_ngcontent-%COMP%]{width:16px;height:16px;margin:0;top:-1px;background-color:transparent;border:none}.resize-top.resize-right[_ngcontent-%COMP%]{margin-right:-2px;margin-top:-2px;cursor:nesw-resize}.resize-top.resize-right.inner[_ngcontent-%COMP%]{right:-1px}.resize-top.resize-left[_ngcontent-%COMP%]{margin-left:-2px;margin-top:-2px;cursor:nwse-resize}.resize-top.resize-left.inner[_ngcontent-%COMP%]{left:-1px}.resize-top.resize-center[_ngcontent-%COMP%]{cursor:ns-resize;left:calc(50% - 2px)}.border-bottom[_ngcontent-%COMP%]{bottom:0;border-bottom-width:1px}.resize-bottom[_ngcontent-%COMP%]{bottom:0}.resize-bottom.resize-right[_ngcontent-%COMP%], .resize-bottom.resize-left[_ngcontent-%COMP%], .resize-bottom.resize-center[_ngcontent-%COMP%]{width:5px;height:5px;margin-bottom:-3px;border-width:0;border-style:solid}.resize-bottom.resize-right.inner[_ngcontent-%COMP%], .resize-bottom.resize-left.inner[_ngcontent-%COMP%], .resize-bottom.resize-center.inner[_ngcontent-%COMP%]{width:16px;height:16px;margin:0;background-color:transparent;border:none;top:-10px}.resize-bottom.resize-right[_ngcontent-%COMP%]{margin-right:-2px;cursor:nwse-resize;top:calc(100% - 3px)}.resize-bottom.resize-right.inner[_ngcontent-%COMP%]{right:-1px}.resize-bottom.resize-left[_ngcontent-%COMP%]{margin-left:-2px;cursor:nesw-resize;top:calc(100% - 3px)}.resize-bottom.resize-left.inner[_ngcontent-%COMP%]{left:-1px}.resize-bottom.resize-center[_ngcontent-%COMP%]{cursor:ns-resize;left:calc(50% - 2px)}.resize-left[_ngcontent-%COMP%], .resize-right[_ngcontent-%COMP%], .border-left[_ngcontent-%COMP%], .border-right[_ngcontent-%COMP%]{position:absolute;height:100%;width:5px;top:0}.resize-left[_ngcontent-%COMP%], .resize-right[_ngcontent-%COMP%]{cursor:ew-resize}.resize-left.resize-center[_ngcontent-%COMP%], .resize-right.resize-center[_ngcontent-%COMP%]{width:5px;height:5px;top:calc(50% - 2px);border-width:0;border-style:solid;cursor:ew-resize}.border-left[_ngcontent-%COMP%]{left:0;border-left-width:1px}.resize-left[_ngcontent-%COMP%]{left:0}.resize-left.resize-center[_ngcontent-%COMP%]{margin-left:-2px}.border-right[_ngcontent-%COMP%]{right:0;border-right-width:1px}.resize-right[_ngcontent-%COMP%]{right:0}.resize-right.resize-center[_ngcontent-%COMP%]{margin-right:-2px}.resize-active[_ngcontent-%COMP%]{z-index:3}.resize[_ngcontent-%COMP%]{z-index:2}.drag-active[_ngcontent-%COMP%]   .resize-active[_ngcontent-%COMP%]:not(.resize-ghost-element)   .resize[_ngcontent-%COMP%]{display:none}.resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .resize-top[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .resize-bottom[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .resize-left[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .resize-right[_ngcontent-%COMP%]{opacity:1}.resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%]{border-top-style:solid}.resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%]{border-bottom-style:solid}.resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%]{border-left-style:solid}.resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%]{border-right-style:solid}.resize-ghost-element[_ngcontent-%COMP%]   .rectangle.focused[_ngcontent-%COMP%] > .resize[_ngcontent-%COMP%]{opacity:0}.resize-ghost-element[_ngcontent-%COMP%]   .settings-list[_ngcontent-%COMP%]{opacity:0}"],changeDetection:0});class oi{constructor(e){this.injector=e}}oi.\u0275fac=function(e){return new(e||oi)(n.\u0275\u0275directiveInject(n.Injector))},oi.\u0275dir=n.\u0275\u0275defineDirective({type:oi,inputs:{layoutConfig:"layoutConfig",columnSizes:"columnSizes",rowSizes:"rowSizes",columnGap:"columnGap",rowGap:"rowGap",dragActive:"dragActive",name:"name",intersectRatio:"intersectRatio"}});class rn extends S.CrtBaseComponent{}rn.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(rn)))(t||rn)}}(),rn.\u0275cmp=n.\u0275\u0275defineComponent({type:rn,selectors:[["crt-designer-grid-hovered-cell"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:1,vars:0,consts:[[1,"selected-grid-item"]],template:function(e,t){e&1&&n.\u0275\u0275element(0,"div",0)},styles:[".selected-grid-item[_ngcontent-%COMP%]{height:100%;border-radius:7px}"],changeDetection:0});function Rc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",1),n.\u0275\u0275listener("mouseenter",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd())}class ve{set item({type:e}){const t=h.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos.get(e);this.visible=t&&!t.designControlConfig?.allowDesignContent}}ve.\u0275fac=function(e){return new(e||ve)},ve.\u0275cmp=n.\u0275\u0275defineComponent({type:ve,selectors:[["crt-block-events-layer"]],inputs:{visible:"visible",item:"item"},decls:1,vars:1,consts:[["class","block-events-layer",3,"mouseenter",4,"ngIf"],[1,"block-events-layer",3,"mouseenter"]],template:function(e,t){e&1&&n.\u0275\u0275template(0,Rc,1,0,"div",0),e&2&&n.\u0275\u0275property("ngIf",t.visible)},dependencies:[f.NgIf],styles:[".block-events-layer[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;top:0;left:0}"]});function bi(r){return class extends r{constructor(...e){super(...e),this.initDependencies(),this._subscribeKeyEvents()}_subscribeKeyEvents(){this._handleKeyDown=e=>this._onKeyDown(e),this.zone.runOutsideAngular(()=>{this.window.addEventListener("keydown",this._handleKeyDown)})}_unsubscribeKeyEvents(){this.zone.runOutsideAngular(()=>{this.window.removeEventListener("keydown",this._handleKeyDown)})}_onKeyDown({code:e,ctrlKey:t,metaKey:a,altKey:i,shiftKey:o}){if(document.activeElement!==document.body)return;const s=(t||a)&&!i&&!o;s&&e==="KeyC"&&(this._copyElementInfo=this.copy()),s&&this._copyElementInfo?.name&&e==="KeyV"&&this.paste(this._copyElementInfo),e==="Delete"&&this.delete()}initDependencies(){this.zone=this.injector.get(n.NgZone),this.window=this.injector.get(G.WINDOW_TOKEN)}ngOnDestroy(){this._unsubscribeKeyEvents()}delete(){throw new Error("Method not implemented.")}copy(){throw new Error("Method not implemented.")}paste(e){throw new Error("Method not implemented.")}}}function Io(r){return e=>r(e)}const si=Io(r=>class extends r{constructor(...t){super(...t),this._$destroyed$=new d.Subject,this._$designerSchemaService=this.injector.get(g.DesignerSchemaService),this._$subscribeDesignSchemaChanged()}_$handle(t){switch(t.changes.operation){case _.MetaItemDesignSettingChangesOperation.Insert:this.handleInsertChanges(t);break;case _.MetaItemDesignSettingChangesOperation.Update:this.handleUpdateChanges(t);break;case _.MetaItemDesignSettingChangesOperation.Rename:this.handleRenameChanges(t);break}}_$subscribeDesignSchemaChanged(){this._$designerSchemaService.schemaChanged$.pipe((0,l.filter)(t=>this.filterSchemaChanges(t)),this.filterSchemaChangesOperator(),(0,l.takeUntil)(this._$destroyed$)).subscribe({next:t=>{this._$handle(t)}})}filterSchemaChanges(t){return!1}handleInsertChanges(t){}handleUpdateChanges(t){}handleRenameChanges(t){}filterSchemaChangesOperator(){return t=>t}ngOnDestroy(){super.ngOnDestroy?.(),this._$destroyed$.next(),this._$destroyed$.complete()}});class zc{}const _i=Io(r=>{class e extends r{constructor(...a){super(...a),this._designerContainerService=this.injector.get(z)}handleRenameChanges(a){const{viewConfig:i,oldName:o}=a.changes,s=this.getCollection(),c=s.findIndex(m=>m.name===o);s[c]={...s[c],...i},this.detectChangesAsync(()=>{this._designerContainerService.select(i.name)})}}return e}),ci=32;var kc=v(67202);class Ua{constructor(e,t,a){this._designerOverlayService=e,this._templateRef=t,this._elementRef=a,this.visible=!1}ngOnChanges(e){const t=e.visible;t.previousValue===!0&&t.currentValue===!1&&this._designerOverlayService.remove(this._templateRef),this.visible&&this._designerOverlayService.add(this._elementRef,this._templateRef)}ngOnDestroy(){this._designerOverlayService.remove(this._templateRef)}}Ua.\u0275fac=function(e){return new(e||Ua)(n.\u0275\u0275directiveInject(be),n.\u0275\u0275directiveInject(n.TemplateRef),n.\u0275\u0275directiveInject(n.ElementRef))},Ua.\u0275dir=n.\u0275\u0275defineDirective({type:Ua,selectors:[["","crtDesignerOverlayContainer",""]],inputs:{visible:["crtDesignerOverlayContainer","visible"]},features:[n.\u0275\u0275NgOnChangesFeature]});function Bc(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",4),n.\u0275\u0275listener("mousedown",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(c.onSettingsElementClick(i,s.type))}),n.\u0275\u0275element(1,"mat-icon",5),n.\u0275\u0275elementEnd()}if(r&2){const t=e.$implicit;n.\u0275\u0275advance(1),n.\u0275\u0275property("svgIcon",t.iconName)("title",t.title),n.\u0275\u0275attribute("data-item-marker",t.type)}}function Lc(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",2),n.\u0275\u0275template(1,Bc,2,3,"div",3),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.items)}}const jc=["*"];class Ge{get items(){const e=[{iconName:"gears-icon",type:Z.Edit,title:this._translateService.instant("InterfaceDesigner.DesignElementSetting.SettingsTitle")},{iconName:"delete-icon",type:Z.Delete,title:this._translateService.instant("InterfaceDesigner.DesignElementSetting.DeleteTitle")}];return this.canCopy&&e.splice(1,0,{iconName:"copy-icon",type:Z.Copy,title:this._translateService.instant("InterfaceDesigner.DesignElementSetting.DuplicateTitle")}),e}constructor(e,t,a,i,o){this._matIconRegistry=e,this._domSanitizer=t,this._platform=a,this._translateService=i,this._abstractThemeProvider=o,this.visible=!1,this.canCopy=!0,this.action=new n.EventEmitter,this.focusChange=new n.EventEmitter,this._initCurrentTheme()}_registerIcons(){this.items.forEach(e=>{this._matIconRegistry.addSvgIconLiteral(e.iconName,this._domSanitizer.bypassSecurityTrustHtml(v(35106)(`./${e.iconName}.svg`)))})}_initCurrentTheme(){this.currentThemeClass$=this._abstractThemeProvider.getCurrentTheme().pipe((0,l.map)(e=>e.cssSelector))}ngOnInit(){this._registerIcons()}onSettingsElementClick(e,t){e.stopPropagation(),this.action.emit(t)}onDoubleElementClick(e){e.stopPropagation(),this.action.emit(Z.Edit)}onMouseDown(e){e.stopPropagation()}}Ge.\u0275fac=function(e){return new(e||Ge)(n.\u0275\u0275directiveInject(E.MatIconRegistry),n.\u0275\u0275directiveInject(ri.DomSanitizer),n.\u0275\u0275directiveInject(kc.Platform),n.\u0275\u0275directiveInject(D.TranslateService),n.\u0275\u0275directiveInject(C.AbstractThemeProvider))},Ge.\u0275cmp=n.\u0275\u0275defineComponent({type:Ge,selectors:[["crt-design-element-setting"]],inputs:{visible:"visible",canCopy:"canCopy",item:"item"},outputs:{action:"action",focusChange:"focusChange"},ngContentSelectors:jc,decls:4,vars:4,consts:[[1,"settings-container",3,"ngClass","dblclick"],["class","settings-list",4,"crtDesignerOverlayContainer"],[1,"settings-list"],["class","settings-element",3,"mousedown",4,"ngFor","ngForOf"],[1,"settings-element",3,"mousedown"],[1,"settings-element-icon",3,"svgIcon","title"]],template:function(e,t){e&1&&(n.\u0275\u0275projectionDef(),n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275listener("dblclick",function(i){return t.onDoubleElementClick(i)}),n.\u0275\u0275pipe(1,"async"),n.\u0275\u0275template(2,Lc,2,1,"div",1),n.\u0275\u0275projection(3),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275property("ngClass",n.\u0275\u0275pipeBind1(1,2,t.currentThemeClass$)),n.\u0275\u0275advance(2),n.\u0275\u0275property("crtDesignerOverlayContainer",t.visible))},dependencies:[f.NgClass,f.NgForOf,E.MatIcon,Ua,f.AsyncPipe],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;min-height:0;min-width:0;flex-grow:1}.settings-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;min-height:0;min-width:0;flex-grow:1}.settings-list[_ngcontent-%COMP%]{top:-48px;position:absolute;right:0;padding:2px;height:auto;min-height:36px;text-align:right;border-radius:4px;opacity:.92;display:flex;align-items:flex-end;justify-content:flex-end}.settings-list[_ngcontent-%COMP%]   .settings-element[_ngcontent-%COMP%]{padding:10px;border-radius:3px;cursor:pointer;width:36px;height:36px}.settings-list[_ngcontent-%COMP%]   .settings-element[_ngcontent-%COMP%]   .settings-element-icon[_ngcontent-%COMP%]{width:16px;height:16px}"],changeDetection:0});var Ha;const Gc=["canvas"],$c=["hoveredCell"],Uc=["designerElement"];function Hc(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-designer-grid-column",7),r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngStyle",a.getItemLayout(t==null?null:t.layoutConfig))}}function Wc(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-designer-grid-row",7),r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngStyle",a.getItemLayout(t==null?null:t.layoutConfig))}}function Qc(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-designer-grid-cell",8),r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngStyle",a.getItemLayout(t==null?null:t.layoutConfig))("row",t.layoutConfig.row)("column",t.layoutConfig.column)("minHeight",a.minCellHeight)("visibility",a.isVisibleCell(t==null?null:t.layoutConfig))}}function qc(r,e){r&1&&n.\u0275\u0275element(0,"div")}function Kc(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",9,10),n.\u0275\u0275listener("cdkDragStarted",function(){const o=n.\u0275\u0275restoreView(t).$implicit,s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onDragStarted(o))})("cdkDragEntered",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onDragEntered(i))})("cdkDragDropped",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragDropped(i,s))})("cdkDragMoved",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragMoved(i,s))})("cdkDragExited",function(){const o=n.\u0275\u0275restoreView(t).$implicit,s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onDragExited(o))})("cdkDragEnded",function(){const o=n.\u0275\u0275restoreView(t).$implicit,s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onDragEnded(o))})("mouseover",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragMouseOver(i,s))})("mouseleave",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onDragMouseLeave())})("mousedown",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragMouseDown(i,s))}),n.\u0275\u0275template(2,qc,1,0,"div",11),n.\u0275\u0275elementStart(3,"crt-design-element-setting",12),n.\u0275\u0275listener("action",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.handleElementSettingAction(i,s))}),n.\u0275\u0275elementStart(4,"crt-designer-grid-resizable-item",13),n.\u0275\u0275listener("resizeStart",function(){const o=n.\u0275\u0275restoreView(t).$implicit,s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onResizeStart(o))})("resizing",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onResizing(i,s))})("resizeEnd",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onLayoutConfigChanged(i,s))}),n.\u0275\u0275elementContainer(5,14),n.\u0275\u0275element(6,"crt-block-events-layer",15),n.\u0275\u0275elementEnd()()()}if(r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275classProp("focused",t.selected)("drag-active",a.dragActive),n.\u0275\u0275property("ngStyle",a.dragItemStyle())("cdkDragData",a.getDragData(t)),n.\u0275\u0275attribute("item-name",t.name)("data-flip-key",t.name),n.\u0275\u0275advance(3),n.\u0275\u0275property("item",t)("visible",t.selected),n.\u0275\u0275advance(1),n.\u0275\u0275property("layoutConfig",t==null?null:t.layoutConfig)("name",t==null?null:t.name)("columnSizes",a.columnSizes)("rowSizes",a.rowSizes)("intersectRatio",a.intersectionRatio)("gap",a.gapData)("dragActive",a.dragActive)("focused",t.selected||t.resizing),n.\u0275\u0275advance(1),n.\u0275\u0275property("crtViewElement",t),n.\u0275\u0275advance(1),n.\u0275\u0275property("item",t)}}class Jc extends _i(si(bi(P.GridContainerComponent))){}let ht=Ha=class extends Jc{constructor(e){super(e),this.injector=e,this._defaultGap=0,this._additionalRowCount=5,this._animationDuration=250,this._affectedItems=new Set,this._disableGridAnimation=!1,this._oldDesignerItems=[],this._selectionChanged$=new d.Subject,this._droppedNewItem$=new d.Subject,this._placeholderCache=null,this._dragging=!1,this._resizing=!1,this._alwaysVisibleCell=!1,this.columnSizes=[],this.rowSizes=[],this.intersectionRatio=.4,this.auxRowItems=[],this.auxColumnItems=[],this.auxCellItems=[],this.designerItems=[],this.connectedDropList=[],this.fillRowsMode=!1,this.visibilityCells=!1,this._getCopyLayoutConfig=t=>({column:t.column,colSpan:t.colSpan,rowSpan:t.rowSpan,row:t.row+t.rowSpan}),this._positionApplierService=this.injector.get(zn),this._auxiliaryItemsService=this.injector.get(kn),this._metaItemDesignerService=this.injector.get(J),this._designerGridMatrixService=this.injector.get(Bn),this._shouldLiftGridElements=this.injector.get(Ni),this._designerSchemaService=this.injector.get(g.DesignerSchemaService),this._commandFactoryService=this.injector.get(g.DesignerCommandFactoryService),this._connectedDropListService=this.injector.get(g.ConnectedDropListService),this._gridLayoutConfigPositionResolverService=this.injector.get(tn),this._designerContainerService=this.injector.get(z),this._designerOverlayService=this.injector.get(be),this._viewCommandExecutor=this.injector.get(g.ViewItemCommandExecutor),this._measurePerformanceService=this.injector.get(C.MeasurePerformanceService)}get _canvasElement(){return this.canvasElRef.nativeElement}get rowGap(){return this._getRowGap()||0}get columnGap(){return this._getColumnGap()||0}get dragActive(){return Boolean(this.selection)}set selection(e){this._selection=e,this._applyHoveredCellLayoutStyle()}get selection(){return this._selection}get visibleDesignerItems(){return this.designerItems.filter(e=>!e.hidden)}static _isLayoutConfigChanged(e,t){return!e||!t?!1:t.row!==void 0&&e.row!==t.row||t.column!==void 0&&e.column!==t.column||t.rowSpan!==void 0&&e.rowSpan!==t.rowSpan||t.colSpan!==void 0&&e.colSpan!==t.colSpan}static _applyElementStyles(e,t){for(const[a,i]of Object.entries(t))e.style[a]=i}_initFeatures(){var e=this;return(0,F.Z)(function*(){let t;[t,e._disableGridAnimation,e._disableNewResolveConflicts]=yield(0,d.lastValueFrom)(e.featureService.getFeaturesState(["DisableLiftGridElements","DisableGridAnimation","DisableNewResolveConflicts"]),{defaultValue:null}),e._shouldLiftGridElements=!t&&e._shouldLiftGridElements})()}_initConnectedDropList(){this._connectedDropListService.connectedDropList$.pipe((0,l.map)(e=>e.filter(t=>t!==this.id))).subscribe({next:e=>this._replace(this.connectedDropList,e)}),this._connectedDropListService.add(this.id)}_setGridItemSizes(){const e=this.columnsElements.map(a=>a.nativeElement.getBoundingClientRect().width),t=this.rowsElements.map(a=>a.nativeElement.getBoundingClientRect().height);this._replace(this.columnSizes,e),this._replace(this.rowSizes,t)}_getColumnGap(){return this.gapData.column}_getRowGap(){return this.gapData.row}_replace(e,t){e.splice(0,e.length,...t)}_setAuxiliaryElements(e,t){this._replace(this.auxRowItems,this._auxiliaryItemsService.getAuxiliaryRowConfig(t)),this._replace(this.auxColumnItems,this._auxiliaryItemsService.getAuxiliaryColumnsConfig(e)),this._replace(this.auxCellItems,this._auxiliaryItemsService.getAuxiliaryCellsConfig(t,e))}_getDragElementCenter(e){const{width:t,height:a}=e.source.element.nativeElement.getBoundingClientRect(),i=this.rowSizes[0],o=this.columnSizes[0],s=t/2,c=a/2;return{horizontal:Math.abs(o-s),vertical:Math.abs(i-c)}}_getNewContainerItemPosition(e){const{left:t,top:a}=this._canvasElement.getBoundingClientRect(),{x:i,y:o}=e.pointerPosition;let s=i-t,c=o-a+this._canvasElement.scrollTop;const{vertical:m,horizontal:b}=this._getDragElementCenter(e);s-=b,c-=m;const y=Ca({currentIndex:0,moved:s,itemsSize:this.columnSizes,gap:this.columnGap,autogenerateSizes:!1,intersectionRatio:this.intersectionRatio})+1;return{row:Ca({currentIndex:0,moved:c,itemsSize:this.rowSizes,gap:this.rowGap,autogenerateSizes:!0,intersectionRatio:this.intersectionRatio})+1,column:y}}_getNewItemPosition(e){const{left:t,top:a}=this._canvasElement.getBoundingClientRect(),{x:i,y:o}=e.pointerPosition,[s,c]=[i-t,o-a+this._canvasElement.scrollTop],m=$i({point:s,itemsSize:this.columnSizes,gap:this.columnGap})+1;return{row:$i({point:c,itemsSize:this.rowSizes,gap:this.rowGap,autogenerateSizes:!0})+1,column:m}}_hasDesignerItem(e){return this.designerItems.some(t=>t.name===e)}_selectItemByName(e){const t=this.designerItems.find(a=>a.name===e);t&&this._selectItem(t)}_selectItem(e){e&&!e.selected&&this._designerContainerService.select(e.name),this._designerOverlayService.show()}_clearSelected(){this._designerContainerService.select(null)}_getDOMGridLayoutInfo(){const e=this.window.getComputedStyle(this._canvasElement),t=e.getPropertyValue("grid-template-rows"),a=e.getPropertyValue("grid-template-columns"),i=e.getPropertyValue("row-gap"),o=e.getPropertyValue("column-gap");return{columnCount:a.split(" ").length,rowCount:t.split(" ").length,columnGap:parseFloat(o),rowGap:parseFloat(i)}}_updateGap(e,t){this.gapData={row:t||this._defaultGap,column:e||this._defaultGap}}_getCanvasElHeight(){const e=this.window.getComputedStyle(this._canvasElement);return parseFloat(e.getPropertyValue("height"))}_getPossibleAuxiliaryRowCount(){const e=this._getCanvasElHeight(),t=this.rowSizes.reduce((o,s)=>o+s,0),a=this._getRowGap()*(this.rowSizes.length-1),i=e-(t+a);return Math.ceil(i/(this.rowSizes[this.rowSizes.length-1]+this._getRowGap()))}_addAuxiliaryRows(e){if(e<=0)return;const t=[],a=this.auxRowItems[this.auxRowItems.length-1];for(let o=1;o<=e;o++){const s=(0,x.cloneDeep)(a);s.layoutConfig.row+=o,t.push(s)}const i=this._auxiliaryItemsService.getAdditionAuxiliaryCellsConfig(t,this.columnsElements.length);this.auxRowItems.push(...t),this.auxCellItems.push(...i)}_updateItemsPosition(){const e=[...this._affectedItems];this._affectedItems.clear();for(const t of this.designerItems)e?.includes(t.name)&&this._designerSchemaService.move(t.name,t.layoutConfig)}_updateItemsOrder(){this._designerGridMatrixService.updateItemsOrder(this.name,this.auxRowItems.length,this.auxColumnItems.length,this.designerItems,this.items)}_addAffectedItems(e){e&&this._affectedItems.add(e)}_resolveElementsConflict(e){const t=[];let a="";this._addAffectedItems(e.name);let i={...e.layoutConfig};for(;i;){const o=this._designerGridMatrixService.buildMatrix(this.auxRowItems.length,this.auxColumnItems.length,this.designerItems,e.name,a,this._selectionName);t.splice(0,0,...this._designerGridMatrixService.getIntersectionElements(o,i)),this._resolveElementConflict(i,o),a=t.shift(),a?(i=this.designerItems.find(c=>c.name===a).layoutConfig,this._addAffectedItems(a)):i=null}this._updateGridMatrix()}_setInitialElementPosition(){if(this._beforeDragDesignerItems)for(const e of this._beforeDragDesignerItems){const t=this.designerItems.find(a=>a.name===e.name);t?.name!==this._selectionName&&this._setItemLayoutConfig(t,e.layoutConfig)}}_resolveElementConflict(e,t){this._designerGridMatrixService.iterateLayoutConfigCell(e,(a,i)=>{const o=t[a-1]?.[i-1];if(!o)return;const s=this.designerItems.find(y=>y.name===o),c={...s.layoutConfig},m=e.rowSpan+(e.row-c.row);let b=c.row-1+c.rowSpan;if(this.fillRowsMode&&(b+=this._additionalRowCount),m>0&&(b+=m),b>t.length){const y=b-t.length,T=b-this.auxRowItems.length;this._addAuxiliaryRows(T),t.push(...Ui(y,this.auxColumnItems.length))}for(let y=0;y<m;y++)c.row++,this._resolveElementsConflict({name:o,layoutConfig:{...c}});this._designerGridMatrixService.moveMatrixElement(s.layoutConfig,c,o,t),this._setItemLayoutConfig(s,c)})}_getLayoutConfigsMaxRow(e){const i=e.map(o=>o.layoutConfig).map(o=>o&&o.row+o.rowSpan-1||1);return i.length>0?Math.max(...i):1}_getValidSelection(e){if(!e)return null;const t=this.columnSizes?.length;let a=e.column;const i=e.colSpan;return a+i-1>t&&(a=t-e.colSpan+1),{column:a,colSpan:i,row:e.row,rowSpan:e.rowSpan}}_initAuxiliaryCells(){this._replace(this.auxCellItems,[{name:"DesignerGridCell",type:"DesignerGridCell",layoutConfig:{row:this._getLayoutConfigsMaxRow(this.items),column:1,rowSpan:1,colSpan:1}}])}_getMovingAuxiliaryRows(e){const t=this.fillRowsMode?2:1,a=this.fillRowsMode?this._additionalRowCount:0,i=(e?.row+e?.rowSpan||1)-1,o=this.auxRowItems.length,s=o-i||0,c=i-o+t,m=c>a?c:a;return s<t?m:0}_getFreeRowsAbove(e,t,a){const i=this._designerGridMatrixService.buildMatrix(this.auxRowItems.length,this.auxColumnItems.length,t,...a);return this._designerGridMatrixService.getFreeRowsAbove(e,i)}_setUpdatedDesignerItems(e,t){this.designerItems.forEach(a=>{if(t||a.name!==this._selectionName){const i=e.find(({name:o})=>o===a.name);this._setItemLayoutConfig(a,i.layoutConfig)}})}_processLiftingOnMoving(){if(!this.dragActive)return;const e=(0,x.cloneDeep)(this.designerItems),t=e.find(({name:s})=>s===this._selectionName);let a=this._getFreeRowsIgnoringIntersection(this._selectionName,this.selection,e);this.selection={...this.selection,row:this.selection.row-a},t&&this._setItemLayoutConfig(t,this.selection);const i=this._moveItemsAbove(e),o=!1;this._setUpdatedDesignerItems(i,o),a=this._getFreeRowsIgnoringIntersection(this._selectionName,this.selection,i),this.selection={...this.selection,row:this.selection.row-a},this._beforeDragDesignerItems=(0,x.cloneDeep)(this.designerItems)}_moveItemsAbove(e){const t=this._designerGridMatrixService.moveItemsAbove(this.auxRowItems.length,this.auxColumnItems.length,e);return this._affectedItems=new Set([...this._affectedItems,...t.affectedItems]),t.layoutConfigs}_getFreeRowsIgnoringIntersection(e,t,a){const i=this._getIntersectionElements(a,e,t);return this._getFreeRowsAbove(t,a,[...i,e])}_getIntersectionElements(e,t,a){return this._designerGridMatrixService.getIntersectionElements(this.auxRowItems.length,this.auxColumnItems.length,e,t,a)}_isResizedFromTopWithLifting(e){const t=e.row>this.selection?.row;return this._shouldLiftGridElements&&t}_setItemLayoutConfig(e,t){e.layoutConfig={...t},this._applyItemLayoutStyle(e)}_applyItemsLayoutStyle(){for(const e of this.designerItems)this._applyItemLayoutStyle(e)}_applyItemLayoutStyle(e){const t=this._findDesignerElementByName(e.name);if(t){const a=this.getItemLayout(e.layoutConfig);Ha._applyElementStyles(t,a)}}_findDesignerElementByName(e){return this.designerElements.find(t=>t.nativeElement.getAttribute("item-name")===e)?.nativeElement}_applyHoveredCellLayoutStyle(){const e=this.hoveredCell.nativeElement;let t;this.selection?t={...this.getItemLayout(this.selection),display:"block"}:t={display:"none"},Ha._applyElementStyles(e,t)}_initGridAnimation(){this._disableGridAnimation||(this._flipping=new(vc())({selector:()=>{const e=this.designerElements.map(t=>t.nativeElement);return this._selectionName?e.filter(t=>t.getAttribute("item-name")!==this._selectionName):e},parent:this._canvasElement,easing:"ease-in-out",fill:"forwards",duration:this._animationDuration}))}_prepareGridAnimation(){this._oldDesignerItems=this.designerItems.map(e=>({name:e.name,layoutConfig:(0,x.cloneDeep)(e.layoutConfig)})),this._flipping?.read()}_executeGridAnimation(){this._designerItemsChanged()&&(this._flipping?.flip(),this._updateDesignerOverlay())}_updateDesignerOverlay(){setTimeout(()=>{this.window.requestAnimationFrame(()=>{this._designerOverlayService.show()})},this._animationDuration)}_designerItemsChanged(){return this.designerItems.length!==this._oldDesignerItems.length?!0:!this.designerItems.every((t,a)=>{const i=this._oldDesignerItems[a];return t.name===i.name&&(0,x.isEqual)(t.layoutConfig,i.layoutConfig)})}filterSchemaChanges(e){const{viewConfig:t,parentName:a}=e.changes;return a===this.name||this._hasDesignerItem(t.name)}_subscribeSchemaChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(e=>this.filterSchemaChanges(e)),(0,l.takeUntil)(this.destroyed$)).subscribe({next:({changes:{viewConfig:e,operation:t,parentName:a,selectOnCanvas:i}})=>{switch(t){case _.MetaItemDesignSettingChangesOperation.Insert:this._onAfterInsertViewConfig(e);break;case _.MetaItemDesignSettingChangesOperation.Update:this._onAfterUpdateViewConfig(e,i);break;case _.MetaItemDesignSettingChangesOperation.Move:this._onAfterMoveViewConfig(e);break;case _.MetaItemDesignSettingChangesOperation.Remove:this._onAfterDeleteViewConfig(e);break;case _.MetaItemDesignSettingChangesOperation.MoveToIndex:return;case _.MetaItemDesignSettingChangesOperation.MoveToContainer:this._onAfterMoveToContainerViewConfig(e,a);break}[_.MetaItemDesignSettingChangesOperation.Insert,_.MetaItemDesignSettingChangesOperation.Move,_.MetaItemDesignSettingChangesOperation.Remove,_.MetaItemDesignSettingChangesOperation.MoveToContainer].includes(t)&&(this._updateItemsPosition(),this._updateItemsOrder()),this._afterLayoutConfigChanged(),this._updateGridMatrix()}})}_onAfterInsertViewConfig(e){const t=e.layoutConfig,a=this._getMovingAuxiliaryRows(t);if(this._addAuxiliaryRows(a),this._shouldLiftGridElements){const i=this._getFreeRowsIgnoringIntersection(e.name,t,this.designerItems);t.row-=i}this._resolveElementsConflict({name:e.name,layoutConfig:t}),e.layoutConfig={...t},this.designerItems.push({...e,selected:!1}),this._selectItemByName(e.name),this.detectChangesAsync()}_onAfterUpdateViewConfig(e,t=!0){const a=this.designerItems.findIndex(i=>i.name===e.name);this.designerItems[a]={...this.designerItems[a],...e},t&&this._selectItemByName(e.name),this.detectChangesAsync()}_onAfterMoveViewConfig(e){const t=this.designerItems.find(a=>a.name===e.name);t.layoutConfig=e.layoutConfig}_onAfterDeleteViewConfig(e){this._prepareGridAnimation();const t=this.designerItems.findIndex(a=>a.name===e.name);this.designerItems.splice(t,1),this._clearSelected(),this._liftDesignerItems(),this._executeGridAnimation(),this.detectChanges()}_onAfterMoveToContainerViewConfig(e,t){if(t===this.name)this.designerItems.push({...e,selected:!0});else{const i=this.designerItems.findIndex(o=>o.name===e.name);i>=0&&(this._prepareGridAnimation(),this.designerItems.splice(i,1),this._liftDesignerItems(),this._executeGridAnimation())}this.detectChangesAsync()}_subscribeSchemaSelfChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{viewConfig:e,operation:t}})=>e.name===this.name&&t===_.MetaItemDesignSettingChangesOperation.Update),(0,l.takeUntil)(this.destroyed$)).subscribe(({changes:{viewConfig:e}})=>{this.setValuesFromConfig(e),this.detectChanges(),this._setGridItemSizes();const{columns:t}=e,a=Array.isArray(t)?t.length:1,{rowCount:i,rowGap:o,columnGap:s}=this._getDOMGridLayoutInfo();this._updateGap(s,o),this.columnsElements.length!==a&&this._setAuxiliaryElements(a,i),this.detectChanges()})}_liftDesignerItems(){if(this._shouldLiftGridElements){const e=this._moveItemsAbove(this.designerItems),t=!0;this._setUpdatedDesignerItems(e,t)}}_initDesignerItems(){const e=this.injector.get(S.VIEW_ELEMENT_CONFIG);this.fillRowsMode=this._designerSchemaService.isRootContainer(this.name)&&this.injector.get(ho,!1);const t=e?.items??[];let a;if(this.gridContainerAllowOverlapFeature===!0){const i=this.columnsElements.length;a=this._positionApplierService.applyExplicitPositions(t,i)}else{const i=this.fixItemsOverlap(t,this._canvasElement);a=i.items,this._affectedItems=new Set([...this._affectedItems,...i.affectedItems])}this.designerItems=me(a,{selected:!1}),this.detectChanges(),this._initMinCellHeight(),this._measurePerformanceService.measure("_getDOMGridLayoutInfo",()=>{const{columnCount:i,rowCount:o,rowGap:s,columnGap:c}=this._getDOMGridLayoutInfo();this._updateGap(c,s),this._setAuxiliaryElements(i,o)}),this._shouldLiftGridElements&&(a=this._moveItemsAbove(this.designerItems),this.designerItems=me(a,{selected:!1})),this.detectChanges(),this._subscribeSchemaChanged()}_subscribeSelectedChanged(){this._designerContainerService.selectedChanged$.pipe((0,l.takeUntil)(this.destroyed$)).subscribe({next:({name:e})=>{ii(this.designerItems,e)&&this.detectChanges()}})}_subscribeElementDesignVisibilityChanges(){this._designerContainerService.designVisibility$.pipe((0,l.takeUntil)(this.destroyed$)).subscribe({next:({name:e,visible:t})=>{const a=this.designerItems.find(i=>i.name===e);a&&(a.hidden=!t,this.detectChanges())}})}_subscribeAlwaysVisibleCellChange(){this._designerContainerService.alwaysVisibleCell$.pipe((0,l.takeUntil)(this.destroyed$)).subscribe({next:e=>{this._alwaysVisibleCell=e,this.detectChanges()}})}_subscribeDesignerElementsChanges(){this.designerElements.changes.pipe((0,l.takeUntil)(this.destroyed$)).subscribe({next:()=>{this._applyItemsLayoutStyle()}})}_subscribeRowElementsChanges(){this.rowsElements.changes.pipe((0,l.tap)(()=>{this._setGridItemSizes()}),(0,l.delay)(0),(0,l.takeUntil)(this.destroyed$)).subscribe({next:()=>{this.fillRowsMode&&(this._fillCanvasEmptyRows(),this.detectChanges())}})}_fillCanvasEmptyRows(){const e=this._getPossibleAuxiliaryRowCount();this._addAuxiliaryRows(e)}_removeEmptyRows(e){if(this.fillRowsMode)return;const a=[...e?.name?this.designerItems.filter(o=>o.name!==e.name):this.designerItems];e?.layoutConfig&&a.push({layoutConfig:{...e.layoutConfig}});const i=this._getLayoutConfigsMaxRow(a);this.auxRowItems.length>i&&(this.auxRowItems.splice(i),this.auxCellItems.splice(i*this.auxColumnItems.length),this.detectChanges())}_getPlaceholder(){return document.querySelector(".cdk-drag-placeholder")}_syncPlaceholderPosition(){const e=this.hoveredCell.nativeElement.getBoundingClientRect();if(!e)return;const t=this._getPlaceholder();if(!t)return;const a=this._canvasElement.getBoundingClientRect(),i=Math.round(e.x-a.x),o=Math.round(e.y-a.y);t.style.transform=`translate3d(${i}px, ${o}px, 0)`,this._setPlaceholderSize(e)}_setPlaceholderSize(e){const t=this._getPlaceholder();if(!t)return;const{width:a,height:i}=e;t.style.minWidth=`${a}px`,t.style.minHeight=`${i}px`,this._placeholderCache||(this._placeholderCache={width:a,height:i,containerId:this.id})}_resetPlaceholderSize(){const e=ci;this._setPlaceholderSize({height:e,width:e})}_clearPlaceholderCache(){this._placeholderCache=null}_clearTransformStyle(e){const t=e&&this._findDesignerElementByName(e);t&&Ha._applyElementStyles(t,{transform:""})}_afterLayoutConfigChanged(){this.selection=null,this._changeSelectionName(null),this._updateContainersVisibility(!1),this._removeEmptyRows()}_onStopMovingItemIntoContainer({container:e,item:t}){const a=(0,d.merge)(this.destroyed$,e.exited,e.dropped),i=t.data?.name;t.moved.pipe((0,l.takeUntil)(a)).subscribe({next:o=>{const s=this._getMovingItemPosition(o,t),c=this._getMovingItemLayoutConfig(s,i);this.onMoving({layoutConfig:c,name:t.data?.name})}})}_getMovingItemLayoutConfig(e,t){const a=this._getItemLayoutConfigByName(t),i={column:e?.column,row:e?.row};return a?(i.colSpan=a.colSpan,i.rowSpan=a.rowSpan):(i.colSpan=1,i.rowSpan=1),i}_getItemLayoutConfigByName(e){return this.designerItems.find(t=>t.name===e)?.layoutConfig}_getMovingItemPosition(e,{data:t}){let a;if(!t)a=this._getNewItemPosition(e);else{const o=t.name;!this.designerItems.some(c=>c.name===o)?a=this._getNewContainerItemPosition(e):a=this._getExistingItemPosition(e,o)}return a}_getExistingItemPosition({distance:e},t){const a=this._getItemLayoutConfigByName(t),i=a.column-1,o=a.row-1,s=this._gridLayoutConfigPositionResolverService.getPositionByDistance({columnIndex:i,rowIndex:o,distance:e,columnSizes:this.columnSizes,columnGap:this.columnGap,rowGap:this.rowGap,rowSizes:this.rowSizes,intersectionRatio:this.intersectionRatio});return{column:this._gridLayoutConfigPositionResolverService.getConstrainedColumn({columnsLength:this.columnSizes.length,column:s.column,columnWidth:a.colSpan}),row:s.row}}_processMove(e){this.selection={...e},this._selectionChanged$.next(!0),this._prepareGridAnimation();const t=this._getMovingAuxiliaryRows(this.selection);this._addAuxiliaryRows(t),this._setInitialElementPosition(),this._shouldLiftGridElements&&this._processLiftingOnMoving();const a={name:this._selectionName,layoutConfig:this.selection};this._resolveElementsConflict(a),this._removeEmptyRows(a),this._syncPlaceholderPosition(),this._executeGridAnimation(),this.detectChanges()}_getIntersectionContainer(e){const t=this._getIntersectionElements(this.designerItems,e.name,e.layoutConfig),a=h.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos;return t.map(o=>this.designerItems.find(s=>s.name===o)).find(o=>a.get(o.type)?.designControlConfig?.allowDesignContent)?.name}_runProcessMove({layoutConfig:e,name:t}){if(this._disableNewResolveConflicts){this._processMove(e);return}if(this._getIntersectionContainer({layoutConfig:e,name:t})){this._selectionChanged$.next(!0);const i=(0,d.merge)(this._selectionChanged$,this._droppedNewItem$);(0,d.of)(null).pipe((0,l.delay)(this._animationDuration),(0,l.takeUntil)(i)).subscribe({next:()=>{this._processMove(e)}})}else this._processMove(e)}_runCopyCommand(e){const t={...e};return t.layoutConfig=this._getCopyLayoutConfig(e.layoutConfig),(0,d.lastValueFrom)(this._viewCommandExecutor.copy({viewElement:t}).pipe((0,l.switchMap)(a=>a.execute()),(0,l.takeUntil)(this.destroyed$)),{defaultValue:null})}_getNewLayoutConfig(e,t){const a=t.layoutConfig.column-1,i=t.layoutConfig.row-1,o=this._gridLayoutConfigPositionResolverService.getPositionByDistance({columnIndex:a,rowIndex:i,distance:e,columnSizes:this.columnSizes,columnGap:this.columnGap,rowGap:this.rowGap,rowSizes:this.rowSizes,intersectionRatio:this.intersectionRatio});return{column:this._gridLayoutConfigPositionResolverService.getConstrainedColumn({columnsLength:this.columnSizes.length,column:o.column,columnWidth:t.layoutConfig.colSpan}),row:o.row,rowSpan:t.layoutConfig.rowSpan,colSpan:t.layoutConfig.colSpan}}_changeSelectionName(e){const t=this._selectionName;this._selectionName=e,(t!==this._selectionName||!e)&&this._selectionChanged$.next(!0)}_updateContainersVisibility(e){this._designerContainerService.visibility=e}_updateGridMatrix(){this._matrix=this._designerGridMatrixService.buildMatrix(this.auxRowItems.length,this.auxColumnItems.length,this.designerItems,this._selectionName)}_subscribeAuxCellVisibility(){this._designerContainerService.visibility$.pipe((0,l.takeUntil)(this.destroyed$)).subscribe(e=>{!this._alwaysVisibleCell&&this.visibilityCells!==e&&(this.visibilityCells=e,this.detectChangesAsync())})}_getAuxCellItemName(e){let t="";const a=this._matrix[e.row-1];return a&&(t=a[e.column-1]),t}_isVisibleAuxCell(e){return e===""&&this.visibilityCells}_subscribeContainerScrolling(){(0,d.fromEvent)(this._canvasElement,"scroll").pipe((0,l.distinctUntilChanged)(),(0,l.takeUntil)(this.destroyed$)).subscribe(()=>{this.onScroll()})}_initMinCellHeight(){const t=((Array.isArray(this.rows)?this.rows.slice(-1)[0]:this.rows)?.match(/\d+px/g)||[]).slice(-1)[0];t&&(this.minCellHeight=t)}_subscribeResize(){this.resizeObserver=this._designerOverlayService.subscribeElementResize(this._canvasElement,()=>{this._setGridItemSizes()})}onScroll(){this._designerOverlayService.hide()}getCollection(){return this.designerItems}copy(){return(0,x.cloneDeep)(this.designerItems.find(e=>e.selected))}paste(e){this._hasDesignerItem(e?.name)&&this._runCopyCommand(e)}delete(){const e=this.designerItems.filter(t=>t.selected);(0,d.concat)(e.map(t=>this._viewCommandExecutor.remove(t).pipe((0,l.switchMap)(a=>a.execute())))).pipe((0,l.concatAll)()).subscribe()}ngAfterViewInit(){var e=this;return(0,F.Z)(function*(){yield e._initFeatures(),e._subscribeRowElementsChanges(),e._subscribeDesignerElementsChanges(),e._subscribeContainerScrolling(),e._initDesignerItems(),e._updateItemsPosition(),e._initGridAnimation(),e._subscribeAuxCellVisibility(),e._updateGridMatrix(),e._subscribeResize()})()}ngOnInit(){super.ngOnInit(),this._initAuxiliaryCells(),this._subscribeSchemaSelfChanged(),this._subscribeSelectedChanged(),this._subscribeAlwaysVisibleCellChange(),this._subscribeElementDesignVisibilityChanges();const e=this.injector.get(S.VIEW_ELEMENT_CONFIG);this.id=e.id||e.name||this.id||this.name,this.setValuesFromConfig(e),this._initConnectedDropList(),this._designerContainerService.togglePadding$.subscribe({next:()=>{this.visiblePadding=!this.visiblePadding,this.detectChanges()}})}onDropListDropped(e){var t=this;return(0,F.Z)(function*(){t._dragging=!1;const a=e.previousContainer?.data,i=e.item?.data?.name;if(t._clearTransformStyle(i),t._droppedNewItem$.next(),!t.selection)return;t._beforeDragDesignerItems=null;const o={column:t.selection.column,row:t.selection.row,colSpan:1,rowSpan:1};if(!a){if(t.designerItems.every(y=>y.name!==i)){const y="crt.MoveToContainerCommand",T={name:i,index:e.currentIndex,parentName:t.name,layoutConfig:o};yield(0,g.executeCommand)(t._commandFactoryService,y,T,t.destroyed$),t._updateGridMatrix()}return}const s=a[e.previousIndex],c=s.addCommandTypeName,m={defaultViewConfig:{layoutConfig:o},containerName:t.name,designerTool:s};yield(0,g.executeCommand)(t._commandFactoryService,c,m,t.destroyed$),t._updateContainersVisibility(!1),t._updateGridMatrix()})()}onDropListEntered(e){if(!e.item)return;this._designerContainerService.setHoveredItemName(this.name),this._dragging=!0,this._beforeDragDesignerItems=(0,x.cloneDeep)(this.designerItems),e.item&&!e.item.data&&this._clearSelected(),this._onStopMovingItemIntoContainer(e),this._updateContainersVisibility(!0)}onDropListExited(){this._shouldLiftGridElements&&(this._prepareGridAnimation(),this._processLiftingOnMoving(),this._executeGridAnimation()),this._removeEmptyRows({name:this._selectionName}),this._updateGridMatrix(),this.selection=null,this._changeSelectionName(null),this._resetPlaceholderSize(),this._updateContainersVisibility(!1),this._dragging=!1}onResizeStart(e){this._beforeDragDesignerItems=(0,x.cloneDeep)(this.designerItems),e&&(this._selectItem(e),e.resizing=!0),this._resizing=!0,this._designerContainerService.setHoveredItemName(this.id)}onResizing(e,t){this.visibilityCells=!0,t.selected=!1,this._changeSelectionName(t.name),e=this._getValidSelection(e),!(0,x.isEqual)(this.selection,e)&&this._processMove(e)}getDragData(e){return{name:e.name}}onDragStarted(e){e.dragging=!0,this._dragging=!0,this._updateContainersVisibility(!0),this._beforeDragDesignerItems=(0,x.cloneDeep)(this.designerItems),this._selectItem(e),this.selection=e.layoutConfig,this._syncPlaceholderPosition(),this._changeSelectionName(e.name)}onDragEntered(e){const t=this._placeholderCache;t?.containerId===e.container.id&&this._setPlaceholderSize(t),this._updateContainersVisibility(!0)}onDragMoved(e,t){const a=this._getNewLayoutConfig(e.distance,t);(0,x.isEqual)(t.currentLayoutConfig,a)||(t.currentLayoutConfig=a,t.dragging&&this.onMoving({layoutConfig:a,name:t.name}))}onDragEnded(e){this._clearPlaceholderCache(),e.dragging=!1}onDragExited(e){this._resetPlaceholderSize(),e.dragging=!1}onMoving({layoutConfig:e,name:t}){e=this._getValidSelection(e),this._changeSelectionName(t),!(0,x.isEqual)(this.selection,e)&&this._runProcessMove({layoutConfig:e,name:t})}onDragDropped(e,t){if(e.container.id===e.previousContainer.id){const a=this._getNewLayoutConfig(e.distance,t);this.onLayoutConfigChanged(a,t)}this._updateGridMatrix(),this._updateContainersVisibility(!1)}onLayoutConfigChanged(e,t){if(this._beforeDragDesignerItems=null,this._isResizedFromTopWithLifting(e)&&(e.row=this.selection.row),this.visibilityCells=!1,this._resizing=!1,t.resizing=!1,this._selectItem(t),!Ha._isLayoutConfigChanged(t.layoutConfig,e)){this._afterLayoutConfigChanged(),this._updateGridMatrix();return}if(t.layoutConfig={...e},this._shouldLiftGridElements){e={...t.layoutConfig};const o=this._getFreeRowsIgnoringIntersection(t.name,e,this.designerItems);e.row-=o,this._resolveElementsConflict({name:t.name,layoutConfig:t.layoutConfig})}this._setItemLayoutConfig(t,e);const i={...t,layoutConfig:t.layoutConfig};this._affectedItems.delete(i.name),this._designerSchemaService.move(t.name,t.layoutConfig),this._updateGridMatrix()}handleElementSettingAction(e,t){switch(e){case Z.Delete:this._viewCommandExecutor.remove(t).pipe((0,l.switchMap)(a=>a.execute())).subscribe();break;case Z.Edit:t?this._metaItemDesignerService.openMetaItemDesigner(t.type,X.Edit,{itemConfig:t,type:g.DesignType.ViewElement}):this._metaItemDesignerService.openMetaItemDesigner();break;case Z.Copy:this._runCopyCommand(t);break}}viewItemIdentifier(e,t){return t.name+t.type}onDesignElementSettingClick(e,t){e.stopPropagation(),this._selectItem(t)}onContainerMouseDown(){this._designerSchemaService.isRootContainer(this.name)&&this._clearSelected()}onContainerDblClick(e){var t=this;return(0,F.Z)(function*(){t._designerSchemaService.isRootContainer(t.name)&&(e.stopPropagation(),yield t.handleElementSettingAction(Z.Edit,null))})()}onDragMouseDown(e,t){e.stopPropagation(),this._selectItem(t)}isVisibleCell(e){if(this._alwaysVisibleCell)return!0;if(this._matrix){const t=this._getAuxCellItemName(e);return this._isVisibleAuxCell(t)}return!1}onDragMouseOver(e,t){!this._dragging&&!this._resizing&&(e.stopPropagation(),this._designerContainerService.setHoveredItemName(t.name))}onDragMouseLeave(){this._resizing||this._designerContainerService.setHoveredItemName(null)}dragItemStyle(){if(!this.visiblePadding)return{overflow:"hidden"}}onBindingInitialized(){this.detectChangesAsync()}};ht.\u0275fac=function(e){return new(e||ht)(n.\u0275\u0275directiveInject(n.Injector))},ht.\u0275cmp=n.\u0275\u0275defineComponent({type:ht,selectors:[["crt-designer-grid-container"]],viewQuery:function(e,t){if(e&1&&(n.\u0275\u0275viewQuery(Gc,7),n.\u0275\u0275viewQuery($c,7,n.ElementRef),n.\u0275\u0275viewQuery(Uc,5,n.ElementRef),n.\u0275\u0275viewQuery(gt,5,n.ElementRef),n.\u0275\u0275viewQuery(ut,5,n.ElementRef)),e&2){let a;n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.canvasElRef=a.first),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.hoveredCell=a.first),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.designerElements=a),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.columnsElements=a),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.rowsElements=a)}},features:[n.\u0275\u0275InheritDefinitionFeature],decls:8,vars:11,consts:[["cdkDropList","","cdkDropListAutoScrollStep","5","cdkDropListSortingDisabled","",1,"crt-grid",3,"cdkDropListConnectedTo","id","ngStyle","ngClass","cdkDropListDropped","cdkDropListEntered","cdkDropListExited","mousedown","dblclick"],["canvas",""],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle","row","column","minHeight","visibility",4,"ngFor","ngForOf"],[1,"hovered-cell"],["hoveredCell",""],["class","drag-item","cdkDrag","","crtDragCursor","","data-flip-no-scale","",3,"ngStyle","focused","drag-active","cdkDragData","cdkDragStarted","cdkDragEntered","cdkDragDropped","cdkDragMoved","cdkDragExited","cdkDragEnded","mouseover","mouseleave","mousedown",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngStyle"],[3,"ngStyle","row","column","minHeight","visibility"],["cdkDrag","","crtDragCursor","","data-flip-no-scale","",1,"drag-item",3,"ngStyle","cdkDragData","cdkDragStarted","cdkDragEntered","cdkDragDropped","cdkDragMoved","cdkDragExited","cdkDragEnded","mouseover","mouseleave","mousedown"],["designerElement",""],[4,"cdkDragPlaceholder"],[3,"item","visible","action"],[3,"layoutConfig","name","columnSizes","rowSizes","intersectRatio","gap","dragActive","focused","resizeStart","resizing","resizeEnd"],["crtViewModel","",3,"crtViewElement"],[3,"item"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0,1),n.\u0275\u0275listener("cdkDropListDropped",function(i){return t.onDropListDropped(i)})("cdkDropListEntered",function(i){return t.onDropListEntered(i)})("cdkDropListExited",function(){return t.onDropListExited()})("mousedown",function(){return t.onContainerMouseDown()})("dblclick",function(i){return t.onContainerDblClick(i)}),n.\u0275\u0275template(2,Hc,1,1,"crt-designer-grid-column",2),n.\u0275\u0275template(3,Wc,1,1,"crt-designer-grid-row",2),n.\u0275\u0275template(4,Qc,1,5,"crt-designer-grid-cell",3),n.\u0275\u0275element(5,"crt-designer-grid-hovered-cell",4,5),n.\u0275\u0275template(7,Kc,7,20,"div",6),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275classProp("visible-padding",t.visiblePadding),n.\u0275\u0275property("cdkDropListConnectedTo",t.connectedDropList)("id",t.id)("ngStyle",t.gridStyles)("ngClass",t.classes),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngForOf",t.auxColumnItems),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.auxRowItems),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.auxCellItems),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngForOf",t.visibleDesignerItems)("ngForTrackBy",t.viewItemIdentifier))},dependencies:[f.NgClass,f.NgForOf,f.NgStyle,O.CdkDropList,O.CdkDrag,O.CdkDragPlaceholder,S.ViewModelDirective,S.ViewElementDirective,ve,Ge,Un,gt,rn,pe,ut,je],styles:[`.drag-item{position:relative}.drag-item:not(.drag-active){cursor:move}.drag-item.cdk-drag-preview{display:flex;border-style:solid;border-width:1px;box-sizing:content-box;opacity:.8;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.drag-item.cdk-drag-preview .rectangle>*:first-child{overflow:hidden}.drag-item.cdk-drag-dragging{height:0;width:0}.cdk-drag.drag-item.cdk-drag-preview crt-design-element-setting settings-list,.cdk-drag.drag-item.cdk-drag-preview .resize{visibility:hidden!important}.canvas-panel>crt-designer-grid-container{height:100%;position:relative;overflow:hidden}.canvas-panel>crt-designer-grid-container>.crt-grid{position:absolute;height:100%;min-height:0;min-width:0;overflow:auto}@supports (overflow: overlay){.canvas-panel>crt-designer-grid-container>.crt-grid{overflow:overlay}}.visible-padding{padding:6px}crt-designer-grid-container{min-height:0;min-width:0;overflow:auto}@supports (overflow: overlay){crt-designer-grid-container{overflow:overlay}}crt-designer-grid-container>.crt-grid{display:grid;width:100%;height:100%;min-height:0;min-width:0;overflow:auto;box-sizing:border-box;transition:padding .25s ease}@supports (background: -webkit-named-image(i)){crt-designer-grid-container>.crt-grid{height:initial}}@supports (overflow: overlay){crt-designer-grid-container>.crt-grid{overflow:overlay}}crt-designer-grid-container>.crt-grid>.cdk-drag-placeholder{visibility:hidden;position:fixed}crt-designer-grid-container>.crt-grid>.drag-item{display:flex;flex-direction:column}crt-designer-grid-container>.crt-grid>.drag-item .rectangle>*:first-child{flex-grow:1;min-height:0;min-width:0;overflow:auto}@supports (overflow: overlay){crt-designer-grid-container>.crt-grid>.drag-item .rectangle>*:first-child{overflow:overlay}}crt-designer-grid-container.stretch>.crt-grid>.drag-item{min-height:0;min-width:0}crt-designer-grid-container.fit-content{min-height:auto;min-width:auto;overflow:visible}@media screen and (max-width: 600px){.crt-grid{grid-template-columns:1fr!important}}crt-designer-grid-cell{z-index:0}crt-designer-grid-hovered-cell{z-index:1}.hovered-cell{display:none}
`],encapsulation:2,changeDetection:0}),ht=Ha=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerGridContainer",overrideType:"crt.GridContainer"}),(0,p.__metadata)("design:paramtypes",[n.Injector])],ht);let j=class{};j.\u0275fac=function(e){return new(e||j)},j.\u0275mod=n.\u0275\u0275defineNgModule({type:j}),j.\u0275inj=n.\u0275\u0275defineInjector({providers:[kn,Bn,zn,tn,Ln,z,{provide:Ni,useValue:!0}],imports:[P.CdkModule,f.CommonModule,O.DragDropModule,Q.FormsModule,E.MatIconModule,Q.ReactiveFormsModule,re.ResizableModule,S.ViewModule]}),j=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[ht]})],j),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(j,{declarations:[ve,Ge,Un,gt,ht,rn,pe,ut,je,lt,Ua],imports:[P.CdkModule,f.CommonModule,O.DragDropModule,Q.FormsModule,E.MatIconModule,Q.ReactiveFormsModule,re.ResizableModule,S.ViewModule],exports:[ve,Ge,Un,gt,ht,rn,ut,je]})}();const Po=function(){return{top:!0}};function Zc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",18),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,Po))}const Eo=function(){return{bottom:!0}};function Xc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",19),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,Eo))}const To=function(){return{left:!0}};function Yc(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",20),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,To))}const Oo=function(){return{right:!0}};function el(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",21),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,Oo))}const Ao=function(){return{top:!0,right:!0}};function tl(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",22),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementStart(1,"div",23),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()()),r&2&&(n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(2,Ao)),n.\u0275\u0275advance(1),n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(3,Ao)))}const Vo=function(){return{top:!0,left:!0}};function nl(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",24),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementStart(1,"div",25),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()()),r&2&&(n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(2,Vo)),n.\u0275\u0275advance(1),n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(3,Vo)))}function al(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",26),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,Po))}const Fo=function(){return{bottom:!0,right:!0}};function il(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",27),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementStart(1,"div",28),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()()),r&2&&(n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(2,Fo)),n.\u0275\u0275advance(1),n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(3,Fo)))}const No=function(){return{bottom:!0,left:!0}};function rl(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",29),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementStart(1,"div",30),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()()),r&2&&(n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(2,No)),n.\u0275\u0275advance(1),n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(3,No)))}function ol(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",31),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,Eo))}function sl(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",32),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,To))}function cl(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",33),n.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()}),n.\u0275\u0275elementEnd()),r&2&&n.\u0275\u0275property("resizeEdges",n.\u0275\u0275pureFunction0(1,Oo))}function ll(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275element(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),n.\u0275\u0275template(5,Zc,1,2,"div",6),n.\u0275\u0275template(6,Xc,1,2,"div",7),n.\u0275\u0275template(7,Yc,1,2,"div",8),n.\u0275\u0275template(8,el,1,2,"div",9),n.\u0275\u0275template(9,tl,2,4,"div",10),n.\u0275\u0275template(10,nl,2,4,"div",11),n.\u0275\u0275template(11,al,1,2,"div",12),n.\u0275\u0275template(12,il,2,4,"div",13),n.\u0275\u0275template(13,rl,2,4,"div",14),n.\u0275\u0275template(14,ol,1,2,"div",15),n.\u0275\u0275template(15,sl,1,2,"div",16),n.\u0275\u0275template(16,cl,1,2,"div",17),n.\u0275\u0275elementContainerEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(5),n.\u0275\u0275property("ngIf",t.canResize("top")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("bottom")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("left")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("right")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("top right")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("top left")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("top")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("bottom right")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("bottom left")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("bottom")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("left")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.canResize("right"))}}const dl=["*"];class Wa extends Sa{get _isRevert(){return this.justifyContent==="end"}constructor(e){super(e),this.injector=e,this._resizableElements=["crt.ChartWidget","crt.IndicatorWidget","crt.FunnelWidget","crt.GaugeWidget","crt.FullPipelineWidget","crt.FolderTree"]}_isValidWith(e,t,a){const i=e>=ci,o=!this._isRevert&&this.containerDimension.width>=a,s=this._isRevert&&this.containerDimension.left<=t;return i&&(o||s)}_isValidHeight(e,t){const a=e>=ci,i=this._isRevert&&this.containerDimension.top<=t;return a&&(i||!this._isRevert)}_canResizeElement(){return this._resizableElements.includes(this.elementType)}isVisibleEdge(e){switch(e){case"top":return this._isRevert&&this.verticalFlex;case"bottom":return!this._isRevert&&this.verticalFlex;case"right":return!this._isRevert&&!this.verticalFlex;case"left":return this._isRevert&&!this.verticalFlex;default:return!1}}getChangedLayoutConfig(e){return e.rectangle?this.verticalFlex?{height:e.rectangle.height}:{width:e.rectangle.width}:null}validate(e){return this.verticalFlex?this._isValidHeight(e.rectangle.height,e.rectangle.top):this._isValidWith(e.rectangle.width,e.rectangle.left,e.rectangle.right)}canResize(e){return super.canResize(e)&&this._canResizeElement()}}Wa.\u0275fac=function(e){return new(e||Wa)(n.\u0275\u0275directiveInject(n.Injector))},Wa.\u0275cmp=n.\u0275\u0275defineComponent({type:Wa,selectors:[["crt-designer-flex-resizable-item"]],inputs:{verticalFlex:"verticalFlex",justifyContent:"justifyContent",containerDimension:"containerDimension",elementType:"elementType"},features:[n.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:dl,decls:3,vars:8,consts:[["mwlResizable","",1,"rectangle",3,"enableGhostResize","validateResize","resizeCursors","resizeStart","resizing","resizeEnd"],[4,"ngIf"],[1,"resize","border-top"],[1,"resize","border-bottom"],[1,"resize","border-right"],[1,"resize","border-left"],["class","resize resize-top","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-bottom","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-left","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-right","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-top resize-right","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-top resize-left","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-top resize-center","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-bottom resize-right","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-bottom resize-left","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-bottom resize-center","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-left resize-center","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["class","resize resize-right resize-center","mwlResizeHandle","",3,"resizeEdges","mousedown",4,"ngIf"],["mwlResizeHandle","",1,"resize","resize-top",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-left",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-right",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-top","resize-right",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-top","resize-right","inner",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-top","resize-left",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-top","resize-left","inner",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-top","resize-center",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom","resize-right",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom","resize-right","inner",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom","resize-left",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom","resize-left","inner",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-bottom","resize-center",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-left","resize-center",3,"resizeEdges","mousedown"],["mwlResizeHandle","",1,"resize","resize-right","resize-center",3,"resizeEdges","mousedown"]],template:function(e,t){e&1&&(n.\u0275\u0275projectionDef(),n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275listener("resizeStart",function(){return t.onResizeStart()})("resizing",function(i){return t.onResizing(i)})("resizeEnd",function(i){return t.onResizeEnd(i)}),n.\u0275\u0275projection(1),n.\u0275\u0275template(2,ll,17,12,"ng-container",1),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275classProp("drag-active",t.dragActive)("focused",t.focused),n.\u0275\u0275property("enableGhostResize",!0)("validateResize",t.validate.bind(t))("resizeCursors",t.cursors),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",t.hovered||t.focused))},dependencies:[f.NgIf,re.ResizableDirective,re.ResizeHandleDirective],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;min-height:0;min-width:0;flex-grow:1}.rectangle[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;min-height:0;min-width:0;flex-grow:1}.rectangle[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:first-child{min-height:0;min-width:0}.rectangle.resize-active[_ngcontent-%COMP%] > .resize-top.resize-right[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-top.resize-left[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-top.resize-center[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-top.resize-right[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-top.resize-left[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-top.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.resize-active[_ngcontent-%COMP%] > .resize-left.resize-center[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-right.resize-center[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-left.resize-center[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-right.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.resize-active[_ngcontent-%COMP%] > .resize-bottom.resize-right[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-bottom.resize-left[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-bottom.resize-center[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-bottom.resize-right[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-bottom.resize-left[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-bottom.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.resize-active[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-top[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-bottom[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-left[_ngcontent-%COMP%], .rectangle.resize-active[_ngcontent-%COMP%] > .resize-right[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-top[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-bottom[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-left[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .resize-right[_ngcontent-%COMP%]{opacity:1}.rectangle.resize-active[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%]{border-top-style:dashed}.rectangle.resize-active[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%]{border-bottom-style:dashed}.rectangle.resize-active[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%]{border-left-style:dashed}.rectangle.resize-active[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%], .rectangle.hovered[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%]{border-right-style:dashed}.rectangle.focused[_ngcontent-%COMP%] > .resize-top.resize-right[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-top.resize-left[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-top.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.focused[_ngcontent-%COMP%] > .resize-left.resize-center[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-right.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.focused[_ngcontent-%COMP%] > .resize-bottom.resize-right[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-bottom.resize-left[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-bottom.resize-center[_ngcontent-%COMP%]{border-width:1px}.rectangle.focused[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-top[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-bottom[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-left[_ngcontent-%COMP%], .rectangle.focused[_ngcontent-%COMP%] > .resize-right[_ngcontent-%COMP%]{opacity:1}.rectangle.focused[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%]{border-top-style:solid}.rectangle.focused[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%]{border-bottom-style:solid}.rectangle.focused[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%]{border-left-style:solid}.rectangle.focused[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%]{border-right-style:solid}.border-top[_ngcontent-%COMP%], .border-bottom[_ngcontent-%COMP%], .border-left[_ngcontent-%COMP%], .border-right[_ngcontent-%COMP%]{box-sizing:border-box;background-color:transparent}.resize-top[_ngcontent-%COMP%], .resize-bottom[_ngcontent-%COMP%], .resize-left[_ngcontent-%COMP%], .resize-right[_ngcontent-%COMP%]{background-color:transparent}.resize-top[_ngcontent-%COMP%], .resize-bottom[_ngcontent-%COMP%], .border-top[_ngcontent-%COMP%], .border-bottom[_ngcontent-%COMP%]{position:absolute;height:5px;width:100%}.resize-top[_ngcontent-%COMP%], .resize-bottom[_ngcontent-%COMP%]{cursor:ns-resize}.border-top[_ngcontent-%COMP%]{top:0;border-top-width:1px}.resize-top[_ngcontent-%COMP%]{top:0}.resize-top.resize-right[_ngcontent-%COMP%], .resize-top.resize-left[_ngcontent-%COMP%], .resize-top.resize-center[_ngcontent-%COMP%]{margin-top:-2px;width:5px;height:5px;border-width:0;border-style:solid}.resize-top.resize-right.inner[_ngcontent-%COMP%], .resize-top.resize-left.inner[_ngcontent-%COMP%], .resize-top.resize-center.inner[_ngcontent-%COMP%]{width:16px;height:16px;margin:0;top:-1px;background-color:transparent;border:none}.resize-top.resize-right[_ngcontent-%COMP%]{margin-right:-2px;margin-top:-2px;cursor:nesw-resize}.resize-top.resize-right.inner[_ngcontent-%COMP%]{right:-1px}.resize-top.resize-left[_ngcontent-%COMP%]{margin-left:-2px;margin-top:-2px;cursor:nwse-resize}.resize-top.resize-left.inner[_ngcontent-%COMP%]{left:-1px}.resize-top.resize-center[_ngcontent-%COMP%]{cursor:ns-resize;left:calc(50% - 2px)}.border-bottom[_ngcontent-%COMP%]{bottom:0;border-bottom-width:1px}.resize-bottom[_ngcontent-%COMP%]{bottom:0}.resize-bottom.resize-right[_ngcontent-%COMP%], .resize-bottom.resize-left[_ngcontent-%COMP%], .resize-bottom.resize-center[_ngcontent-%COMP%]{width:5px;height:5px;margin-bottom:-3px;border-width:0;border-style:solid}.resize-bottom.resize-right.inner[_ngcontent-%COMP%], .resize-bottom.resize-left.inner[_ngcontent-%COMP%], .resize-bottom.resize-center.inner[_ngcontent-%COMP%]{width:16px;height:16px;margin:0;background-color:transparent;border:none;top:-10px}.resize-bottom.resize-right[_ngcontent-%COMP%]{margin-right:-2px;cursor:nwse-resize;top:calc(100% - 3px)}.resize-bottom.resize-right.inner[_ngcontent-%COMP%]{right:-1px}.resize-bottom.resize-left[_ngcontent-%COMP%]{margin-left:-2px;cursor:nesw-resize;top:calc(100% - 3px)}.resize-bottom.resize-left.inner[_ngcontent-%COMP%]{left:-1px}.resize-bottom.resize-center[_ngcontent-%COMP%]{cursor:ns-resize;left:calc(50% - 2px)}.resize-left[_ngcontent-%COMP%], .resize-right[_ngcontent-%COMP%], .border-left[_ngcontent-%COMP%], .border-right[_ngcontent-%COMP%]{position:absolute;height:100%;width:5px;top:0}.resize-left[_ngcontent-%COMP%], .resize-right[_ngcontent-%COMP%]{cursor:ew-resize}.resize-left.resize-center[_ngcontent-%COMP%], .resize-right.resize-center[_ngcontent-%COMP%]{width:5px;height:5px;top:calc(50% - 2px);border-width:0;border-style:solid;cursor:ew-resize}.border-left[_ngcontent-%COMP%]{left:0;border-left-width:1px}.resize-left[_ngcontent-%COMP%]{left:0}.resize-left.resize-center[_ngcontent-%COMP%]{margin-left:-2px}.border-right[_ngcontent-%COMP%]{right:0;border-right-width:1px}.resize-right[_ngcontent-%COMP%]{right:0}.resize-right.resize-center[_ngcontent-%COMP%]{margin-right:-2px}.resize-active[_ngcontent-%COMP%]{z-index:3}.resize[_ngcontent-%COMP%]{z-index:2}.drag-active[_ngcontent-%COMP%]   .resize-active[_ngcontent-%COMP%]:not(.resize-ghost-element)   .resize[_ngcontent-%COMP%]{display:none}.resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .resize-top[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .resize-bottom[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .resize-left[_ngcontent-%COMP%], .resize-ghost-element.rectangle[_ngcontent-%COMP%] > .resize-right[_ngcontent-%COMP%]{opacity:1}.resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-top[_ngcontent-%COMP%]{border-top-style:solid}.resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-bottom[_ngcontent-%COMP%]{border-bottom-style:solid}.resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-left[_ngcontent-%COMP%]{border-left-style:solid}.resize-ghost-element.rectangle[_ngcontent-%COMP%] > .border-right[_ngcontent-%COMP%]{border-right-style:solid}.resize-ghost-element[_ngcontent-%COMP%]   .rectangle.focused[_ngcontent-%COMP%] > .resize[_ngcontent-%COMP%]{opacity:0}.resize-ghost-element[_ngcontent-%COMP%]   .settings-list[_ngcontent-%COMP%]{opacity:0}"],changeDetection:0});const ml=["canvas"],pl=["designerElement"];function gl(r,e){r&1&&n.\u0275\u0275element(0,"div")}function ul(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",3,4),n.\u0275\u0275listener("cdkDragStarted",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragStarted(i,s))})("cdkDragEntered",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onDragEntered(i))})("cdkDragDropped",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragDropped(i,s))})("cdkDragExited",function(){const o=n.\u0275\u0275restoreView(t).$implicit,s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onDragExited(o))})("cdkDragEnded",function(){const o=n.\u0275\u0275restoreView(t).$implicit,s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onDragEnded(o))})("mousedown",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragMouseDown(i,s))})("mouseover",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragMouseOver(i,s))})("mouseleave",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onDragMouseLeave())}),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275template(3,gl,1,0,"div",5),n.\u0275\u0275elementStart(4,"crt-design-element-setting",6),n.\u0275\u0275listener("action",function(i){const o=n.\u0275\u0275restoreView(t),s=o.$implicit,c=o.index,m=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(m.handleElementSettingAction(i,s,c))}),n.\u0275\u0275elementStart(5,"crt-designer-flex-resizable-item",7),n.\u0275\u0275listener("resizeStart",function(){const o=n.\u0275\u0275restoreView(t).$implicit,s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onResizeStart(o.name))})("resizing",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onResizing(i,s))})("resizeEnd",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onResizeEnd(i,s))}),n.\u0275\u0275elementStart(6,"div",8),n.\u0275\u0275elementContainer(7,9),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(8,"crt-block-events-layer",10),n.\u0275\u0275elementEnd()()()}if(r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275classProp("focused",t.selected)("hovered",n.\u0275\u0275pipeBind1(2,22,a.hoveredItemName$)===t.name)("stretch",a.getItemStretch(t))("fit-content",a.getIsFitContent(t)),n.\u0275\u0275property("cdkDragData",a.getDragData(t))("ngStyle",a.getDragStyle(t)),n.\u0275\u0275attribute("item-name",t.name),n.\u0275\u0275advance(4),n.\u0275\u0275property("item",t)("visible",t.selected),n.\u0275\u0275advance(1),n.\u0275\u0275property("focused",t.selected)("name",t.name)("layoutConfig",t.layoutConfig)("verticalFlex",a.isVertical)("containerDimension",a.dimension)("elementType",t.type)("justifyContent",a.justifyContent),n.\u0275\u0275advance(2),n.\u0275\u0275property("crtViewElement",t),n.\u0275\u0275advance(1),n.\u0275\u0275property("item",t)}}class hl extends _i(si(bi(P.FlexContainerComponent))){}let on=class extends hl{constructor(e){super(e),this.injector=e,this._placeholderCache=null,this._dragging=!1,this.connectedDropList=[],this.designerItems=[],this.dimension={top:0,left:0,width:0,height:0},this.visibleFlexPadding=!1,this._connectedDropListService=this.injector.get(g.ConnectedDropListService),this._designerSchemaService=this.injector.get(g.DesignerSchemaService),this._metaItemDesignerService=this.injector.get(J),this._commandFactoryService=this.injector.get(g.DesignerCommandFactoryService),this._designerContainerService=this.injector.get(z),this._designerOverlayService=this.injector.get(be),this._viewCommandExecutor=this.injector.get(g.ViewItemCommandExecutor),this._measurePerformanceService=this.injector.get(C.MeasurePerformanceService)}get _canvasElement(){return this.canvasElRef.nativeElement}get dropListOrientation(){return this.flexDirection?.includes("row")?"horizontal":"vertical"}get visibleDesignerItems(){return this.designerItems.filter(e=>!e.hidden)}_setComputedContainerPadding(){const{paddingLeft:e,paddingRight:t,paddingTop:a,paddingBottom:i}=this.window.getComputedStyle(this._canvasElement);this._containerPadding={top:parseFloat(a),left:parseFloat(e),right:parseFloat(t),bottom:parseFloat(i)}}_updateContainerPadding(){if(!this.padding)return;const e=(0,P.containerPaddingConverter)(this.padding);if(this.visiblePadding)for(const t in e)e[t]||(e[t]=P.CONTAINER_VISIBLE_PADDING_PX);this._containerPadding=e}_setContainerDimension(){const{top:e,left:t,right:a,bottom:i}=this._canvasElement.getBoundingClientRect();this.dimension={top:e+this._containerPadding?.top,left:t+this._containerPadding?.left,width:a-this._containerPadding?.right,height:i-this._containerPadding?.bottom}}_setInitialContainerDimension(){this._measurePerformanceService.measure("_setComputedContainerPadding",()=>{this._setComputedContainerPadding()}),this._measurePerformanceService.measure("_setContainerDimension",()=>{this._setContainerDimension()})}_updateContainerDimension(){this._updateContainerPadding(),this._setContainerDimension()}_initConnectedDropList(){this._connectedDropListService.add(this.id),this._connectedDropListService.connectedDropList$.pipe((0,l.map)(e=>e.filter(t=>t!==this.id))).subscribe(e=>this.connectedDropList.splice(0,this.connectedDropList.length,...e))}_hasDesignerItem(e){return this.designerItems.some(t=>t.name===e)}_subscribeSchemaSelfChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{viewConfig:e,operation:t}})=>e.name===this.name&&t===_.MetaItemDesignSettingChangesOperation.Update),(0,l.takeUntil)(this.destroyed$)).subscribe(({changes:{viewConfig:e}})=>{if(e?.direction!==this.direction){const t=e?.direction==="column"?"width":"height";e?.items?.forEach(i=>{i.layoutConfig?.[t]&&this._deleteLayoutConfigProp(i,t)})}this.setValuesFromConfig(e),this.detectChanges(),this._updateContainerDimension()})}_deleteLayoutConfigProp(e,t){delete e.layoutConfig[t],this._designerSchemaService.update({itemConfig:e,applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.layoutConfig"}],selectOnCanvas:!1})}filterSchemaChanges(e){const{viewConfig:t,parentName:a}=e.changes;return a===this.name||this._hasDesignerItem(t.name)}_subscribeSchemaChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(e=>this.filterSchemaChanges(e)),(0,l.takeUntil)(this.destroyed$)).subscribe({next:({changes:{viewConfig:e,operation:t,parentName:a,index:i,selectOnCanvas:o}})=>{switch(t){case _.MetaItemDesignSettingChangesOperation.Insert:this._onAfterInsertViewConfig(e,i);break;case _.MetaItemDesignSettingChangesOperation.Update:case _.MetaItemDesignSettingChangesOperation.Move:this._onAfterUpdateViewConfig(e,o);break;case _.MetaItemDesignSettingChangesOperation.MoveToContainer:this._onAfterMoveToContainerViewConfig(e,a,i);break;case _.MetaItemDesignSettingChangesOperation.Remove:this._onAfterDeleteViewConfig(e);break}this._updateContainerDimension()}})}_onAfterInsertViewConfig(e,t){this.designerItems.splice(t,0,{...e,selected:!1}),this._selectItem(e.name),this.detectChangesAsync()}_onAfterMoveToContainerViewConfig(e,t,a){if(t===this.name)this.designerItems.splice(a,0,{...e,selected:!0});else{const o=this.designerItems.findIndex(s=>s.name===e.name);o>=0&&this.designerItems.splice(o,1)}this.detectChangesAsync()}_onAfterDeleteViewConfig(e){const t=this.designerItems.findIndex(a=>a.name===e.name);this.designerItems.splice(t,1),this._clearSelected(),this.detectChanges()}_onAfterUpdateViewConfig(e,t=!0){const a=this.designerItems.findIndex(i=>i.name===e.name);this.designerItems[a]={...this.designerItems[a],...e},t&&this._selectItem(e.name),this.detectChangesAsync()}_selectItem(e){const t=this.designerItems.find(a=>a.name===e);t&&!t.selected&&this._designerContainerService.select(t.name),this._designerOverlayService.show()}_subscribeSelectedChanged(){this._designerContainerService.selectedChanged$.pipe((0,l.takeUntil)(this.destroyed$)).subscribe({next:({name:e})=>{ii(this.designerItems,e)&&this.detectChanges()}})}_subscribeElementDesignVisibilityChanges(){this._designerContainerService.designVisibility$.pipe((0,l.takeUntil)(this.destroyed$)).subscribe({next:({name:e,visible:t})=>{const a=this.designerItems.find(i=>i.name===e);a&&(a.hidden=!t,this.detectChanges())}})}_initDesignerItems(){const t=this.injector.get(S.VIEW_ELEMENT_CONFIG)?.items??[];this.designerItems=me(t,{selected:!1})}_clearSelected(){this._designerContainerService.select(null)}_runCopyCommand(e,t){return(0,d.lastValueFrom)(this._viewCommandExecutor.copy({viewElement:e,index:t}).pipe((0,l.switchMap)(a=>a.execute()),(0,l.takeUntil)(this.destroyed$)),{defaultValue:null})}_getPlaceholder(){return document.querySelector(".cdk-drag-placeholder")}_setPlaceholderSize(e){const t=this._getPlaceholder();if(!t)return;const{width:a,height:i}=e;t.style.minWidth=`${a}px`,t.style.minHeight=`${i}px`,this._placeholderCache||(this._placeholderCache={width:a,height:i,containerId:this.id})}_resetPlaceholderSize(){const e=ci;this._setPlaceholderSize({height:e,width:e})}_clearPlaceholderCache(){this._placeholderCache=null}_setVisibleFlexPadding(e){this.visiblePadding||(this.visibleFlexPadding=e)}_updateContainersVisibility(e){this._designerContainerService.visibility=e}_subscribeContainerScrolling(){(0,d.fromEvent)(this._canvasElement,"scroll").pipe((0,l.distinctUntilChanged)(),(0,l.takeUntil)(this.destroyed$)).subscribe(()=>{this.onScroll()})}_updateItemLayoutConfig(e,t){t.layoutConfig={...t.layoutConfig,...e}}_initDesignerContainerSubscriptions(){this.hoveredItemName$=this._designerContainerService.hoveredItemName$,this.highlight$=this._designerContainerService.visibility$,this._designerContainerService.togglePadding$.subscribe(()=>{this.visiblePadding=!this.visiblePadding,this.detectChanges(),this._updateContainerDimension()})}onScroll(){this._designerOverlayService.hide()}getCollection(){return this.designerItems}copy(){return(0,x.cloneDeep)(this.designerItems.find(e=>e.selected))}paste(e){if(this._hasDesignerItem(e?.name)){const t=this.designerItems.findIndex(a=>a.name===e?.name)+1;this._runCopyCommand(e,t)}}delete(){const e=this.designerItems.filter(t=>t.selected);(0,d.concat)(e.map(t=>this._viewCommandExecutor.remove(t).pipe((0,l.switchMap)(a=>a.execute())))).pipe((0,l.concatAll)()).subscribe()}ngOnInit(){super.ngOnInit(),this._subscribeSchemaChanged(),this._subscribeSchemaSelfChanged(),this._subscribeSelectedChanged(),this._subscribeElementDesignVisibilityChanges(),this._initDesignerItems();const e=this.injector.get(S.VIEW_ELEMENT_CONFIG);this.id=e.id||e.name||this.id||this.name,this.setValuesFromConfig(e),this._initConnectedDropList(),this._initDesignerContainerSubscriptions()}ngAfterViewInit(){super.ngAfterViewInit(),this._subscribeContainerScrolling(),this._setInitialContainerDimension(),this._subscribeResize(),this.detectChangesAsync()}_subscribeResize(){this.resizeObserver=this._designerOverlayService.subscribeElementResize(this._canvasElement)}onDropListExited(){this._updateContainersVisibility(!1),this._setVisibleFlexPadding(!1),this._dragging=!1}onDropListEntered(e){this._designerContainerService.setHoveredItemName(this.name),this._dragging=!0,this._setVisibleFlexPadding(!0),e.item&&!e.item.data&&this._clearSelected();const a=this._placeholderCache;a?.containerId===e.container.id&&this._setPlaceholderSize(a),this._updateContainersVisibility(!0)}onDropListDropped(e){var t=this;return(0,F.Z)(function*(){t._dragging=!1,t._updateContainersVisibility(!1);const a=e.previousContainer.data,i=e.item?.data?.name;if(!a){if(t.designerItems.every(b=>b.name!==i)){const b="crt.MoveToContainerCommand",y={name:i,index:e.currentIndex,parentName:t.name,layoutConfig:{}};yield(0,g.executeCommand)(t._commandFactoryService,b,y,t.destroyed$)}return}const o=a[e.previousIndex],s=o.addCommandTypeName,c={containerName:t.name,index:e.currentIndex,designerTool:o};yield(0,g.executeCommand)(t._commandFactoryService,s,c,t.destroyed$),t._updateContainersVisibility(!1)})()}viewItemIdentifier(e,t){return t.name+t.type}handleElementSettingAction(e,t,a){switch(e){case Z.Delete:this._viewCommandExecutor.remove(t).pipe((0,l.switchMap)(i=>i.execute())).subscribe();break;case Z.Edit:t?this._metaItemDesignerService.openMetaItemDesigner(t.type,X.Edit,{itemConfig:t,type:g.DesignType.ViewElement}):this._metaItemDesignerService.openMetaItemDesigner();break;case Z.Copy:this._runCopyCommand(t,a+1);break}}onDragMouseDown(e,t){e.stopPropagation(),this._selectItem(t.name)}onDraggableItemDragDropped({name:e,previousIndex:t,currentIndex:a}){this._designerSchemaService.moveToIndex(e,a),(0,O.moveItemInArray)(this.designerItems,t,a),this._selectItem(e),this._updateContainersVisibility(!1)}onContainerMouseDown(){this._designerSchemaService.isRootContainer(this.name)&&this._clearSelected()}onContainerDblClick(e){var t=this;return(0,F.Z)(function*(){t._designerSchemaService.isRootContainer(t.name)&&(e.stopPropagation(),yield t.handleElementSettingAction(Z.Edit,null))})()}getDragData(e){return{name:e.name}}onDragStarted(e,t){this._setVisibleFlexPadding(!0),this._dragging=!0;const a=e.source._dragRef._preview;t.dragging=!0;const i=a.offsetHeight-2,o=a.offsetWidth-2;this._setPlaceholderSize({width:o,height:i}),this._selectItem(t.name),this._updateContainersVisibility(!0)}onDragEntered(e){this._setVisibleFlexPadding(!0);const t=this._placeholderCache;t?.containerId===e.container.id&&this._setPlaceholderSize(t),this._updateContainersVisibility(!0)}onDragDropped(e,t){e.container.id===e.previousContainer.id&&this.onDraggableItemDragDropped({name:t.name,previousIndex:e.previousIndex,currentIndex:e.currentIndex}),this._updateContainersVisibility(!1)}onDragEnded(e){this._setVisibleFlexPadding(!1),this._clearPlaceholderCache(),e.dragging=!1}onDragExited(e){this._setVisibleFlexPadding(!1),this._resetPlaceholderSize(),e.dragging=!1}getDragStyle(e){return{...this.getItemLayout(e.layoutConfig),gap:this.gap}}onDragMouseOver(e,t){this._dragging||(e.stopPropagation(),this._designerContainerService.setHoveredItemName(t.name))}onDragMouseLeave(){this._designerContainerService.setHoveredItemName(null)}onResizeStart(e){this._selectItem(e)}onResizing(e,t){t.selected=!1,this._updateItemLayoutConfig(e,t)}onResizeEnd(e,t){this._updateItemLayoutConfig(e,t),this._designerSchemaService.move(t.name,t.layoutConfig)}getItemStretch(e){const i=h.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos.get(e.type)?.designControlConfig?.defaultValues||{};return Boolean(e.stretch??i.stretch)}getIsFitContent(e){h.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos.get(e.type);const a=e.fitContent!==void 0?e.fitContent:!0;return Boolean(a)}};on.\u0275fac=function(e){return new(e||on)(n.\u0275\u0275directiveInject(n.Injector))},on.\u0275cmp=n.\u0275\u0275defineComponent({type:on,selectors:[["crt-designer-flex-container"]],viewQuery:function(e,t){if(e&1&&(n.\u0275\u0275viewQuery(ml,7),n.\u0275\u0275viewQuery(pl,5,n.ElementRef)),e&2){let a;n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.canvasElRef=a.first),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.designerElements=a)}},features:[n.\u0275\u0275InheritDefinitionFeature],decls:4,vars:18,consts:[["cdkDropList","",1,"crt-flex",3,"cdkDropListConnectedTo","id","ngStyle","ngClass","cdkDropListOrientation","cdkDropListEntered","cdkDropListDropped","cdkDropListExited","mousedown","dblclick"],["canvas",""],["class","drag-item","cdkDrag","","crtDragCursor","",3,"focused","hovered","cdkDragData","ngStyle","stretch","fit-content","cdkDragStarted","cdkDragEntered","cdkDragDropped","cdkDragExited","cdkDragEnded","mousedown","mouseover","mouseleave",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","","crtDragCursor","",1,"drag-item",3,"cdkDragData","ngStyle","cdkDragStarted","cdkDragEntered","cdkDragDropped","cdkDragExited","cdkDragEnded","mousedown","mouseover","mouseleave"],["designerElement",""],[4,"cdkDragPlaceholder"],[3,"item","visible","action"],[3,"focused","name","layoutConfig","verticalFlex","containerDimension","elementType","justifyContent","resizeStart","resizing","resizeEnd"],[1,"view-element"],["crtViewModel","",3,"crtViewElement"],[3,"item"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0,1),n.\u0275\u0275listener("cdkDropListEntered",function(i){return t.onDropListEntered(i)})("cdkDropListDropped",function(i){return t.onDropListDropped(i)})("cdkDropListExited",function(){return t.onDropListExited()})("mousedown",function(){return t.onContainerMouseDown()})("dblclick",function(i){return t.onContainerDblClick(i)}),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275template(3,ul,9,24,"div",2),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275styleProp("flex-direction",t.flexDirection),n.\u0275\u0275classProp("highlight",n.\u0275\u0275pipeBind1(2,16,t.highlight$))("visible-padding",t.visiblePadding)("visible-flex-padding",t.visibleFlexPadding),n.\u0275\u0275property("cdkDropListConnectedTo",t.connectedDropList)("id",t.id)("ngStyle",t.flexStyles)("ngClass",t.classes)("cdkDropListOrientation",t.dropListOrientation),n.\u0275\u0275attribute("flex-direction",t.flexDirection),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngForOf",t.visibleDesignerItems)("ngForTrackBy",t.viewItemIdentifier))},dependencies:[f.NgClass,f.NgForOf,f.NgStyle,ve,Ge,je,O.CdkDropList,O.CdkDrag,O.CdkDragPlaceholder,S.ViewModelDirective,S.ViewElementDirective,Wa,f.AsyncPipe],styles:[`.drag-item{position:relative}.drag-item:not(.drag-active){cursor:move}.drag-item.cdk-drag-preview{display:flex;border-style:solid;border-width:1px;box-sizing:content-box;opacity:.8;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.drag-item.cdk-drag-preview .rectangle>*:first-child{overflow:hidden}.drag-item.cdk-drag-dragging{height:0;width:0}.cdk-drag.drag-item.cdk-drag-preview crt-design-element-setting settings-list,.cdk-drag.drag-item.cdk-drag-preview .resize{visibility:hidden!important}.canvas-panel>crt-designer-flex-container>.crt-flex{padding-top:0;padding-bottom:0;background-clip:content-box}crt-designer-flex-container{width:100%;height:100%;min-height:0;min-width:0;overflow:auto}@supports (background: -webkit-named-image(i)){crt-designer-flex-container{height:initial}}@supports (overflow: overlay){crt-designer-flex-container{overflow:overlay}}crt-designer-flex-container.fit-content{min-height:auto;min-width:auto;overflow:visible}crt-designer-flex-container>.crt-flex[flex-direction*=row].stretch{width:100%}crt-designer-flex-container>.crt-flex[flex-direction*=row]>.drag-item.stretch{min-width:auto}crt-designer-flex-container>.crt-flex>.stretch{flex-grow:1}.visible-padding{padding:6px}.crt-flex{display:flex;width:100%;height:100%;min-width:32px;min-height:32px;box-sizing:border-box;transition:padding .25s ease;position:relative;overflow:auto}@supports (background: -webkit-named-image(i)){.crt-flex{height:initial}}@supports (overflow: overlay){.crt-flex{overflow:overlay}}.crt-flex.highlight{outline-width:1px;outline-style:solid}.crt-flex:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;transition:background-color .3s ease}.crt-flex>.cdk-drag-placeholder{display:block}.crt-flex>.drag-item{display:flex;box-sizing:content-box;min-height:0;min-width:0;overflow:auto}@supports (overflow: overlay){.crt-flex>.drag-item{overflow:overlay}}.crt-flex>.drag-item.fit-content{min-height:auto;min-width:auto;overflow:visible}.crt-flex[flex-direction*=row]>.drag-item{flex-direction:row;min-height:0}.crt-flex[flex-direction*=row]>.drag-item>.cdk-drag-placeholder{min-height:100%!important}.crt-flex[flex-direction*=row].visible-flex-padding{padding:0 6px}.crt-flex[flex-direction*=column]>.drag-item{flex-direction:column;min-width:0}.crt-flex[flex-direction*=column]>.drag-item>.cdk-drag-placeholder{min-width:100%!important}.crt-flex[flex-direction*=column].visible-flex-padding{padding-top:6px;padding-bottom:6px}.crt-flex.cdk-drop-list-dragging .drag-item:not(.cdk-drag-placeholder),.crt-flex.cdk-drop-list-dragging .cdk-drag-placeholder{transition:transform .25s cubic-bezier(0,0,.2,1)}.view-element{height:100%;width:100%;display:flex;flex-direction:column;min-height:0;min-width:0;flex-grow:1}.view-element>*:first-child{flex-grow:1}.canvas-panel .crt-flex>.draggable-tile-element-placeholder,.canvas-panel .crt-flex>.draggable-row-element-placeholder{position:static;visibility:visible;min-height:32px;min-width:32px}
`],encapsulation:2,changeDetection:0}),on=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerFlexContainer",overrideType:"crt.FlexContainer"}),(0,p.__metadata)("design:paramtypes",[n.Injector])],on);var bl=v(3127);function fi(r,e,t){let{top:a,bottom:i,left:o,right:s}=r;return a=Math.floor(a),s=Math.floor(s),o=Math.floor(o),i=Math.floor(i),t>=a&&t<=i&&e>=o&&e<=s}function Ro(r,e){return e&&e!="none"?r+" "+e:r}function zo(r,e,t){r.top+=e,r.bottom=r.top+r.height,r.left+=t,r.right=r.left+r.width}class $e{constructor(){this._fixed=!1}sort(e){e.sort=function(t,a,i,o){const s=this._itemPositions,c=this._getItemIndexFromPointerPosition(t,a,i,o);if(c===-1&&s.length>0)return null;const m=this.orientation==="horizontal",b=s.findIndex(K=>K.drag===t),y=s[c],T=s[b].clientRect,L=y.clientRect,ne=b>c?1:-1,ze=this._getItemOffsetPx(T,L,ne),Rt=this._getSiblingOffsetPx(b,s,ne),Oa=s.slice();return(0,O.moveItemInArray)(s,b,c),s.forEach((K,nt)=>{if(Oa[nt]===K)return;const mi=K.drag===t,ai=mi?ze:Rt,Yo=mi?t.getPlaceholderElement():K.drag.getRootElement();K.offset+=ai,m?(Yo.style.transform=Ro(`translate3d(${Math.round(K.offset)}px, 0, 0)`,K.initialTransform),zo(K.clientRect,0,ai)):(Yo.style.transform=Ro(`translate3d(0, ${Math.round(K.offset)}px, 0)`,K.initialTransform),zo(K.clientRect,ai,0))}),this._previousSwap.overlaps=fi(L,a,i),this._previousSwap.drag=y.drag,this._previousSwap.delta=m?o.x:o.y,{previousIndex:b,currentIndex:c}}}_isOverContainer(){O.DropListRef.prototype._isOverContainer=function(e,t){return this._clientRect!=null&&fi(this._clientRect,e,t)}}_getSiblingContainerFromPosition(){O.DropListRef.prototype._getSiblingContainerFromPosition=function(e,t,a){const i=O.DropListRef.registeredContainers,o=O.CdkDropList._dropLists.filter(b=>e.data?.dropContainer?.connectedTo?.includes(b.id)||b.id===this.data.id).map(b=>b._dropListRef);if(!i)return o.find(function(b){return b._canReceive(e,t,a)});const s=o.filter(b=>{const y=b.element.getBoundingClientRect();return y&&fi(y,t,a)});if(s.length===0)return;const m=s.sort((b,y)=>{const T=i.indexOf(b.data.id),L=i.indexOf(y.data.id);return T>L?1:-1})[0];return m!==this?m:null}}_canReceive(){O.DropListRef.prototype._canReceive=function(e,t,a){if(!this._clientRect||!fi(this._clientRect,t,a)||!this.enterPredicate(e,this))return!1;const i=this._getShadowRoot().elementFromPoint(t,a);if(!i)return!1;const o=(0,bl.coerceElement)(this.element);return i===o||o.contains(i)}}_getItemIndexFromPointerPosition(e){const t=e._getItemIndexFromPointerPosition;e._getItemIndexFromPointerPosition=function(a,i,o,s){let c=t.call(this,a,i,o,s);return c===-1&&(c=this._getItemIndexBetweenItemPositions(a,i,o,s)),c}}_getItemIndexBetweenItemPositions(e){e._getItemIndexBetweenItemPositions=function(t,a,i,o){const s=this._itemPositions.filter(({drag:L})=>L!==t),c=s.length;if(c===0)return-1;const m=this.orientation==="horizontal",b=s[0].clientRect,y=s[c-1].clientRect;let T=-1;return m&&a<b.left||!m&&i<b.top?T=0:m&&y.right<a||!m&&y.bottom<i?T=-1:c>1&&(T=s.findIndex(({drag:L},ne)=>{if(o){const ze=m?o.x:o.y;if(L===this._previousSwap.drag&&this._previousSwap.overlaps&&ze===this._previousSwap.delta)return!1}if(ne>0){const ze=s[ne-1].clientRect,Rt=s[ne].clientRect;return m?Math.floor(ze.right)<a&&a<Math.floor(Rt.left):Math.floor(ze.bottom)<i&&i<Math.floor(Rt.top)}})),T}}_handleEvents(){const e=O.CdkDropList.prototype._handleEvents;O.CdkDropList.prototype._handleEvents=function(t){e.call(this,t),t.beforeStarted.subscribe(()=>{this.entered.emit({container:this})})}}_subscribeCreateDropListRef(e){const t=O.DragDrop.prototype.createDropList;O.DragDrop.prototype.createDropList=function(a){const i=t.call(this,a);return e(i),O.DragDrop.prototype.createDropList=t,i}}fix(){this._fixed||(this._fixed=!0,this._isOverContainer(),this._getSiblingContainerFromPosition(),this._canReceive(),this._handleEvents(),this._subscribeCreateDropListRef(e=>{const a=e._sortStrategy.constructor.prototype;this.sort(a),this._getItemIndexFromPointerPosition(a),this._getItemIndexBetweenItemPositions(a)}))}}$e.\u0275fac=function(e){return new(e||$e)},$e.\u0275prov=n.\u0275\u0275defineInjectable({token:$e,factory:$e.\u0275fac,providedIn:"root"});let Se=class{constructor(e){this._dragDropFixService=e,this._dragDropFixService.fix()}};Se.\u0275fac=function(e){return new(e||Se)(n.\u0275\u0275inject($e))},Se.\u0275mod=n.\u0275\u0275defineNgModule({type:Se}),Se.\u0275inj=n.\u0275\u0275defineInjector({providers:[$e,z],imports:[f.CommonModule,j,O.DragDropModule,S.ViewModule,re.ResizableModule]}),Se=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[on]}),(0,p.__metadata)("design:paramtypes",[$e])],Se),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Se,{declarations:[on,Wa],imports:[f.CommonModule,j,O.DragDropModule,S.ViewModule,re.ResizableModule]})}();const _l=["canvas"],fl=["designerElement"];function Cl(r,e){r&1&&n.\u0275\u0275element(0,"div")}function yl(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",3,4),n.\u0275\u0275listener("cdkDragStarted",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragStarted(i,s))})("cdkDragDropped",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragDropped(i,s))})("mousedown",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragMouseDown(i,s))})("mouseover",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onDragMouseOver(i,s))})("mouseleave",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onDragMouseLeave())}),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275template(3,Cl,1,0,"div",5),n.\u0275\u0275elementStart(4,"crt-design-element-setting",6),n.\u0275\u0275listener("action",function(i){const o=n.\u0275\u0275restoreView(t),s=o.$implicit,c=o.index,m=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(m.handleElementSettingAction(i,s,c))}),n.\u0275\u0275elementStart(5,"div",7),n.\u0275\u0275elementContainer(6,8),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(7,"crt-block-events-layer",9),n.\u0275\u0275elementEnd()()}if(r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275classProp("focused",t.selected)("hovered",n.\u0275\u0275pipeBind1(2,10,a.hoveredItemName$)===t.name),n.\u0275\u0275property("cdkDragData",a.getDragData(t)),n.\u0275\u0275attribute("item-name",t.name),n.\u0275\u0275advance(4),n.\u0275\u0275property("item",t)("visible",t.selected),n.\u0275\u0275advance(2),n.\u0275\u0275property("crtViewElement",t),n.\u0275\u0275advance(1),n.\u0275\u0275property("item",t)}}class vl extends _i(si(bi(P.BaseContainerComponent))){}class we extends vl{set parentName(e){this._parentName!==e&&(this._parentName=e)}get parentName(){return this._parentName||this.id}get visibleItems(){return this.items.filter(e=>!e.hidden)}constructor(e){super(e),this.injector=e,this._placeholderCache=null,this._dragging=!1,this._parentName="",this.connectedDropList=[],this.items=[],this.useParentClasses=!0,this._connectedDropListService=this.injector.get(g.ConnectedDropListService),this._designerSchemaService=this.injector.get(g.DesignerSchemaService),this._metaItemDesignerService=this.injector.get(J),this._commandFactoryService=this.injector.get(g.DesignerCommandFactoryService),this._designerContainerService=this.injector.get(z),this._designerOverlayService=this.injector.get(be),this._viewCommandExecutor=this.injector.get(g.ViewItemCommandExecutor),this._renderer=this.injector.get(n.Renderer2)}get _canvasElement(){return this.canvasElRef.nativeElement}_initConnectedDropList(){this._connectedDropListService.add(this.dropListId),this._connectedDropListService.connectedDropList$.pipe((0,l.map)(e=>e.filter(t=>t!==this.id))).subscribe(e=>this.connectedDropList.splice(0,this.connectedDropList.length,...e))}_hasDesignerItem(e){return this.items.some(t=>t.name===e)}filterSchemaChanges(e){const{viewConfig:t,parentName:a,propertyName:i}=e.changes;return a===this.parentName&&i===this.propertyName||this._hasDesignerItem(t.name)}_subscribeSchemaChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(e=>this.filterSchemaChanges(e)),(0,l.takeUntil)(this.destroyed$)).subscribe({next:({changes:{viewConfig:e,operation:t,parentName:a,propertyName:i,index:o,selectOnCanvas:s}})=>{switch(t){case _.MetaItemDesignSettingChangesOperation.Insert:this._onAfterInsertViewConfig(e,o);break;case _.MetaItemDesignSettingChangesOperation.Update:case _.MetaItemDesignSettingChangesOperation.Move:this._onAfterUpdateViewConfig(e,s);break;case _.MetaItemDesignSettingChangesOperation.MoveToContainer:this._onAfterMoveToContainerViewConfig(e,a,i,o);break;case _.MetaItemDesignSettingChangesOperation.Remove:this._onAfterDeleteViewConfig(e);break}}})}_onAfterInsertViewConfig(e,t){this.items.splice(t,0,{...e,selected:!1}),this._selectItem(e.name),this.detectChangesAsync()}_onAfterMoveToContainerViewConfig(e,t,a,i){if(t===this.parentName&&a===this.propertyName)this.items.splice(i,0,{...e,selected:!0});else{const s=this.items.findIndex(c=>c.name===e.name);s>=0&&this.items.splice(s,1)}this.detectChangesAsync()}_onAfterDeleteViewConfig(e){const t=this.items.findIndex(a=>a.name===e.name);this.items.splice(t,1),this._clearSelected(),this.detectChanges()}_onAfterUpdateViewConfig(e,t=!0){const a=this.items.findIndex(i=>i.name===e.name);this.items[a]={...this.items[a],...e},t&&this._selectItem(e.name),this.detectChangesAsync()}_selectItem(e){const t=this.items.find(a=>a.name===e);t&&!t.selected&&this._designerContainerService.select(t.name),this._designerOverlayService.show()}_subscribeSelectedChanged(){this._designerContainerService.selectedChanged$.pipe((0,l.takeUntil)(this.destroyed$)).subscribe({next:({name:e})=>{ii(this.items,e)&&this.detectChanges()}})}_clearSelected(){this._designerContainerService.select(null)}_runCopyCommand(e,t){return(0,d.lastValueFrom)(this._viewCommandExecutor.copy({viewElement:e,index:t,propertyName:this.propertyName}).pipe((0,l.switchMap)(a=>a.execute()),(0,l.takeUntil)(this.destroyed$)),{defaultValue:null})}_getPlaceholder(){return document.querySelector(".cdk-drag-placeholder")}_setPlaceholderSize(e){const t=this._getPlaceholder();if(!t)return;const{width:a,height:i}=e;t.style.minWidth=`${a}px`,t.style.minHeight=`${i}px`,this._placeholderCache||(this._placeholderCache={width:a,height:i,containerId:this.parentName})}_updateContainersVisibility(e){this._designerContainerService.visibility=e}_subscribeContainerScrolling(){(0,d.fromEvent)(this._canvasElement,"scroll").pipe((0,l.distinctUntilChanged)(),(0,l.takeUntil)(this.destroyed$)).subscribe(()=>{this.onScroll()})}_initDesignerContainerSubscriptions(){this.hoveredItemName$=this._designerContainerService.hoveredItemName$,this.highlight$=this._designerContainerService.visibility$}_addClassesToCanvas(){this.useParentClasses&&this.classes.forEach(e=>{this._renderer.addClass(this._canvasElement,e)})}onScroll(){this._designerOverlayService.hide()}getCollection(){return this.items}copy(){return(0,x.cloneDeep)(this.items.find(e=>e.selected))}paste(e){if(this._hasDesignerItem(e?.name)){const t=this.items.findIndex(a=>a.name===e?.name)+1;this._runCopyCommand(e,t)}}delete(){const e=this.items.filter(t=>t.selected);(0,d.concat)(e.map(t=>this._viewCommandExecutor.remove(t).pipe((0,l.switchMap)(a=>a.execute())))).pipe((0,l.concatAll)()).subscribe()}ngOnInit(){super.ngOnInit(),this._subscribeSchemaChanged(),this._subscribeSelectedChanged(),this._subscribeElementDesignVisibilityChanges();const e=this.injector.get(S.VIEW_ELEMENT_CONFIG);this.id=this.containerId||e.id||e.name||this.id,this.dropListId=this.id+"_"+this.propertyName,this.setValuesFromConfig(e),this._initConnectedDropList(),this._initDesignerContainerSubscriptions(),this._addClassesToCanvas()}_subscribeElementDesignVisibilityChanges(){this._designerContainerService.designVisibility$.pipe((0,l.takeUntil)(this.destroyed$)).subscribe({next:({name:e,visible:t})=>{const a=this.items.find(i=>i.name===e);a&&(a.hidden=!t,this.detectChanges())}})}ngAfterViewInit(){super.ngAfterViewInit(),this._subscribeContainerScrolling(),this.detectChangesAsync()}onDropListExited(){this._updateContainersVisibility(!1),this._dragging=!1}onDropListEntered(e){this._designerContainerService.setHoveredItemName(this.parentName),this._dragging=!0,e.item&&!e.item.data&&this._clearSelected();const a=this._placeholderCache;a?.containerId===e.container.id&&this._setPlaceholderSize(a),this._updateContainersVisibility(!0)}onDropListDropped(e){var t=this;return(0,F.Z)(function*(){t._dragging=!1,t._updateContainersVisibility(!1);const a=e.previousContainer.data,i=e.item?.data?.name;if(!a){if(t.items.every(b=>b.name!==i)){const b="crt.MoveToContainerCommand",y={name:i,index:e.currentIndex,parentName:t.parentName,parentPropertyName:t.propertyName};yield(0,g.executeCommand)(t._commandFactoryService,b,y,t.destroyed$)}return}const o=a[e.previousIndex],s=o.addCommandTypeName,c={containerName:t.parentName,propertyName:t.propertyName,index:e.currentIndex,designerTool:o};yield(0,g.executeCommand)(t._commandFactoryService,s,c,t.destroyed$),t._updateContainersVisibility(!1)})()}viewItemIdentifier(e,t){return t.name+t.type}handleElementSettingAction(e,t,a){var i=this;return(0,F.Z)(function*(){switch(e){case Z.Delete:i._viewCommandExecutor.remove(t).pipe((0,l.switchMap)(o=>o.execute())).subscribe();break;case Z.Edit:t?i._metaItemDesignerService.openMetaItemDesigner(t.type,X.Edit,{itemConfig:t,type:g.DesignType.ViewElement}):i._metaItemDesignerService.openMetaItemDesigner();break;case Z.Copy:yield i._runCopyCommand(t,a+1);break}})()}getDragData(e){return{name:e.name}}onDragStarted(e,t){this._dragging=!0;const a=e.source._dragRef._preview;t.dragging=!0;const i=a.offsetHeight-2,o=a.offsetWidth-2;this._setPlaceholderSize({width:o,height:i}),this._selectItem(t.name),this._updateContainersVisibility(!0)}onDragMouseDown(e,t){e.stopPropagation(),this._selectItem(t.name)}onDragMouseOver(e,t){this._dragging||(e.stopPropagation(),this._designerContainerService.setHoveredItemName(t.name))}onDragMouseLeave(){this._designerContainerService.setHoveredItemName(null)}onDragDropped(e,t){e.container.id===e.previousContainer.id&&this.onDraggableItemDragDropped(t.name,e.previousIndex,e.currentIndex),this._updateContainersVisibility(!1)}onDraggableItemDragDropped(e,t,a){this._designerSchemaService.moveToIndex(e,a),(0,O.moveItemInArray)(this.items,t,a),this._selectItem(e),this._updateContainersVisibility(!1)}}we.\u0275fac=function(e){return new(e||we)(n.\u0275\u0275directiveInject(n.Injector))},we.\u0275cmp=n.\u0275\u0275defineComponent({type:we,selectors:[["crt-droppable-list"]],viewQuery:function(e,t){if(e&1&&(n.\u0275\u0275viewQuery(_l,7),n.\u0275\u0275viewQuery(fl,5,n.ElementRef)),e&2){let a;n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.canvasElRef=a.first),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.designerElements=a)}},inputs:{items:"items",containerId:"containerId",propertyName:"propertyName",parentName:"parentName",useParentClasses:"useParentClasses"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:4,vars:8,consts:[["cdkDropList","",1,"crt-droppable-list",3,"cdkDropListConnectedTo","id","cdkDropListEntered","cdkDropListDropped","cdkDropListExited"],["canvas",""],["class","drag-item","cdkDrag","","crtDragCursor","",3,"focused","hovered","cdkDragData","cdkDragStarted","cdkDragDropped","mousedown","mouseover","mouseleave",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","","crtDragCursor","",1,"drag-item",3,"cdkDragData","cdkDragStarted","cdkDragDropped","mousedown","mouseover","mouseleave"],["designerElement",""],[4,"cdkDragPlaceholder"],[3,"item","visible","action"],[1,"view-element"],["crtViewModel","",3,"crtViewElement"],[3,"item"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0,1),n.\u0275\u0275listener("cdkDropListEntered",function(i){return t.onDropListEntered(i)})("cdkDropListDropped",function(i){return t.onDropListDropped(i)})("cdkDropListExited",function(){return t.onDropListExited()}),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275template(3,yl,8,12,"div",2),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275classProp("highlight",n.\u0275\u0275pipeBind1(2,6,t.highlight$)),n.\u0275\u0275property("cdkDropListConnectedTo",t.connectedDropList)("id",t.dropListId),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngForOf",t.visibleItems)("ngForTrackBy",t.viewItemIdentifier))},dependencies:[f.NgForOf,ve,Ge,je,O.CdkDropList,O.CdkDrag,O.CdkDragPlaceholder,S.ViewModelDirective,S.ViewElementDirective,f.AsyncPipe],styles:[".crt-droppable-list[_ngcontent-%COMP%]{width:100%;height:100%;min-width:32px;min-height:32px;overflow-y:auto;box-sizing:border-box;transition:padding .25s ease}@supports (overflow: overlay){.crt-droppable-list[_ngcontent-%COMP%]{overflow-y:overlay}}.crt-droppable-list.highlight[_ngcontent-%COMP%]{outline-width:1px;outline-style:solid}.crt-droppable-list[_ngcontent-%COMP%]   .drag-item[_ngcontent-%COMP%]{display:block;box-sizing:content-box;border:solid transparent 1px}.crt-droppable-list[_ngcontent-%COMP%]   .drag-item.hovered[_ngcontent-%COMP%]{border-style:dashed;opacity:1;border-width:1px;border-color:var(--crt-active-designer-element-border)}.crt-droppable-list[_ngcontent-%COMP%]   .drag-item.focused[_ngcontent-%COMP%]{border-style:solid;opacity:1;border-width:1px;border-color:var(--crt-active-designer-element-border)}.view-element[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0});let q=class{constructor(e){this._dragDropFixService=e,this._dragDropFixService.fix()}};q.\u0275fac=function(e){return new(e||q)(n.\u0275\u0275inject($e))},q.\u0275mod=n.\u0275\u0275defineNgModule({type:q}),q.\u0275inj=n.\u0275\u0275defineInjector({providers:[$e,z],imports:[f.CommonModule,j,O.DragDropModule,S.ViewModule]}),q=(0,p.__decorate)([(0,h.CrtModule)({viewElements:[we]}),(0,p.__metadata)("design:paramtypes",[$e])],q),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(q,{declarations:[we],imports:[f.CommonModule,j,O.DragDropModule,S.ViewModule],exports:[we]})}();function Sl(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",11),n.\u0275\u0275elementContainer(1,12),n.\u0275\u0275elementEnd()),r&2){const t=e.$implicit;n.\u0275\u0275advance(1),n.\u0275\u0275property("crtViewElement",t)}}let bt=class extends u.CrtHeaderContainerComponent{get logoImageUrl(){return this._logoImageUrl}constructor(e,t){super(e,!1),this.injector=e,this._environment=t,this._logoImageUrl=""}setLogoImageUrl(e){this._logoImageUrl=e}buildLogoImageUrl(){const e=Date.now().toString().slice(0,-5);return"img/terrasoft.axd?s=nui-binary-syssetting&r=MenuLogoImage&source_hash="+e}initDefaultLogoImageUrl(){this.setLogoImageUrl("assets/app-logo.svg")}ngOnInit(){super.ngOnInit(),this.logoImageUrl||this.setLogoImageUrl(f.Location.joinWithSlash(this._environment.workspaceBaseUrl,this.buildLogoImageUrl()))}};bt.\u0275fac=function(e){return new(e||bt)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject("environment"))},bt.\u0275cmp=n.\u0275\u0275defineComponent({type:bt,selectors:[["crt-designer-header"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:14,vars:9,consts:[[1,"designer-header-container"],[1,"header-mock"],[1,"left-header-container"],[1,"caption-class"],[1,"right-header-container"],[1,"command-line-container"],[3,"placeholder"],["alt","go","src","data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxNicgaGVpZ2h0PScxNicgdmlld0JveD0nMCAwIDE2IDE2Jz4NCgk8cGF0aCBkPSJNNyA0IGw0IDQgbC00IDQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2M4YzhjOCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQo8L3N2Zz4NCg==",1,"go"],["alt","logo image",1,"logo",3,"src","error"],[1,"designer-header-content",3,"ngClass"],["class","designer-header-content-item",4,"ngFor","ngForOf"],[1,"designer-header-content-item"],["crtViewModel","",3,"crtViewElement"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),n.\u0275\u0275text(4),n.\u0275\u0275pipe(5,"translate"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(6,"div",4)(7,"div",5),n.\u0275\u0275element(8,"input",6),n.\u0275\u0275pipe(9,"translate"),n.\u0275\u0275element(10,"img",7),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(11,"img",8),n.\u0275\u0275listener("error",function(){return t.initDefaultLogoImageUrl()}),n.\u0275\u0275elementEnd()()(),n.\u0275\u0275elementStart(12,"div",9),n.\u0275\u0275template(13,Sl,2,1,"div",10),n.\u0275\u0275elementEnd()()),e&2&&(n.\u0275\u0275advance(4),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind1(5,5,"InterfaceDesigner.MainHeader.Title")),n.\u0275\u0275advance(4),n.\u0275\u0275property("placeholder",n.\u0275\u0275pipeBind1(9,7,"InterfaceDesigner.MainHeader.CommandLinePlaceholder")),n.\u0275\u0275advance(3),n.\u0275\u0275propertyInterpolate("src",t.logoImageUrl,n.\u0275\u0275sanitizeUrl),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngClass",t.classes),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.items))},dependencies:[f.NgClass,f.NgForOf,S.ViewModelDirective,S.ViewElementDirective,D.TranslatePipe],styles:["[_nghost-%COMP%]{display:block}.designer-header-container[_ngcontent-%COMP%]{padding:6px 6px 0}.designer-header-container[_ngcontent-%COMP%]   .header-mock[_ngcontent-%COMP%]{border-radius:8px 8px 0 0;padding:0 20px;display:flex;justify-content:space-between;pointer-events:none;-webkit-user-select:none;user-select:none;border-width:1px;border-style:solid;border-bottom:none}.designer-header-container[_ngcontent-%COMP%]   .header-mock[_ngcontent-%COMP%]   .left-header-container[_ngcontent-%COMP%]   .caption-class[_ngcontent-%COMP%]{font-size:26px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal;line-height:51px}.designer-header-container[_ngcontent-%COMP%]   .header-mock[_ngcontent-%COMP%]   .right-header-container[_ngcontent-%COMP%]{display:flex;align-items:flex-start;opacity:.2;overflow:hidden}.designer-header-container[_ngcontent-%COMP%]   .header-mock[_ngcontent-%COMP%]   .right-header-container[_ngcontent-%COMP%]   .command-line-container[_ngcontent-%COMP%]{height:26px;padding-left:10px;padding-right:3px;margin-top:12px;margin-right:20px;box-sizing:border-box;width:233px;min-height:28px;display:flex}.designer-header-container[_ngcontent-%COMP%]   .header-mock[_ngcontent-%COMP%]   .right-header-container[_ngcontent-%COMP%]   .command-line-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:26px;font-size:14px;width:100%;outline:none;border:0;box-sizing:border-box}.designer-header-container[_ngcontent-%COMP%]   .header-mock[_ngcontent-%COMP%]   .right-header-container[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{max-width:127px;max-height:27px;height:27px;padding-top:10px}.designer-header-container[_ngcontent-%COMP%]   .designer-header-content[_ngcontent-%COMP%]{display:grid;grid-auto-flow:column;border-top:none;border-top-left-radius:0;border-top-right-radius:0}"]}),bt=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerHeaderContainer",overrideType:"crt.HeaderContainer"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],bt);let De=class{};De.\u0275fac=function(e){return new(e||De)},De.\u0275mod=n.\u0275\u0275defineNgModule({type:De}),De.\u0275inj=n.\u0275\u0275defineInjector({imports:[D.TranslateModule,P.CdkModule,f.CommonModule,O.DragDropModule,Q.FormsModule,E.MatIconModule,Q.ReactiveFormsModule,re.ResizableModule,S.ViewModule]}),De=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[bt]})],De),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(De,{declarations:[bt],imports:[D.TranslateModule,P.CdkModule,f.CommonModule,O.DragDropModule,Q.FormsModule,E.MatIconModule,Q.ReactiveFormsModule,re.ResizableModule,S.ViewModule],exports:[bt]})}();const wl="crt.CopyViewItemCommand";function Dl(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-placeholder",2),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("image",t.placeholderImage)}}let fe=class extends S.CrtBaseComponent{set placeholder(e){this.placeholderVisible=typeof e=="boolean"?e:Boolean(e?.display)}set sorting(e){this.dataGridSorting=this._toDataTableSortingConfigs(e)}constructor(e,t,a,i){super(e),this.designerSchemaService=t,this._designerCommandFactoryService=a,this._dataGridViewConfig=i,this.placeholderImage={type:"icon",icon:"data-table",width:null,height:null,padding:null},this.sortingChange=new n.EventEmitter,this.placeholderVisible=!this._isItemsDefined(i)}_isItemsDefined(e){const{items:t}=e;if(!t)return!1;if(!(0,_.isBindingExpression)(t))return!0;const a=(0,_.parseExpression)(t).attributePath;return this.designerSchemaService.isViewModelAttributeExists(a)}_updateDefaultSorting(e){var t=this;return(0,F.Z)(function*(){const a=t._getDataGridItemsAttributeName(t._dataGridViewConfig.name);if(!a)return!1;const i=t.designerSchemaService.getMappedDataSourceAttributePath(a);if(!i)return!1;const o={attribute:a,config:{modelConfig:{sortingConfig:{default:(0,u.toSortColumnOptionsConfigs)(e,i)}}}};return(0,d.lastValueFrom)(t._designerCommandFactoryService.create("crt.UpdateViewModelAttributeCommand",o).pipe((0,l.switchMap)(s=>s.execute()),(0,l.map)(s=>s?.success)),{defaultValue:null})})()}_toDataTableSortingConfigs(e){const t=this._getDataGridItemsAttributeName(this._dataGridViewConfig.name);if(!t)return[];const a=this.designerSchemaService.getMappedDataSourceAttributePath(t);return a?(0,u.toDataTableSortingConfigs)(e,a):[]}_getDataGridItemsAttributeName(e){const t=this.designerSchemaService.getViewConfigInfoByName(e)?.viewConfig,{items:a}=t??{};return(0,_.isBindingExpression)(a)?(0,_.parseExpression)(a).attributePath:null}onSortingChanged(e){var t=this;return(0,F.Z)(function*(){(yield t._updateDefaultSorting(e))&&(t.sortingChange.emit(e),t.dataGridSorting=e)})()}};fe.\u0275fac=function(e){return new(e||fe)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(g.DesignerSchemaService),n.\u0275\u0275directiveInject(g.DesignerCommandFactoryService),n.\u0275\u0275directiveInject(S.VIEW_ELEMENT_CONFIG))},fe.\u0275cmp=n.\u0275\u0275defineComponent({type:fe,selectors:[["crt-designer-data-grid"]],hostVars:2,hostBindings:function(e,t){e&2&&n.\u0275\u0275classProp("crt-designer-data-grid--skeleton-visible",t.placeholderVisible)},inputs:{items:"items",columns:"columns",header:"header",placeholder:"placeholder",sorting:"sorting",primaryColumnName:"primaryColumnName"},outputs:{sortingChange:"sortingChange"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:2,vars:7,consts:[[3,"items","header","columns","sorting","loading","primaryColumnName","sortingChange"],["skeleton","","title","","subhead","",3,"image",4,"ngIf"],["skeleton","","title","","subhead","",3,"image"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"crt-data-grid",0),n.\u0275\u0275listener("sortingChange",function(i){return t.onSortingChanged(i)}),n.\u0275\u0275template(1,Dl,1,1,"crt-placeholder",1),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275property("items",t.items)("header",t.header)("columns",t.columns)("sorting",t.dataGridSorting)("loading",t.loading)("primaryColumnName",t.primaryColumnName),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.placeholderVisible))},dependencies:[f.NgIf,u.CrtDataGridComponent,w.CrtPlaceholderComponent],styles:["[_nghost-%COMP%]{display:block;height:100%;box-sizing:border-box}[_nghost-%COMP%]:not(.crt-designer-data-grid--skeleton-visible){padding-bottom:10px}"]}),(0,p.__decorate)([(0,h.CrtInput)(),(0,p.__metadata)("design:type",Object)],fe.prototype,"items",void 0),fe=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerDataGrid",overrideType:"crt.DataGrid"}),(0,p.__metadata)("design:paramtypes",[n.Injector,g.DesignerSchemaService,g.DesignerCommandFactoryService,Object])],fe);let ge=class{};ge.\u0275fac=function(e){return new(e||ge)},ge.\u0275mod=n.\u0275\u0275defineNgModule({type:ge}),ge.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,u.CrtDataGridModule,w.CrtPlaceholderModule]}),ge=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[fe]})],ge),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(ge,{declarations:[fe],imports:[f.CommonModule,u.CrtDataGridModule,w.CrtPlaceholderModule],exports:[fe]})}();const Ml=function(){return{columnGap:"large",rowGap:"none"}},xl=function(){return{top:"none",right:"none",bottom:"none",left:"none"}};let _t=class extends u.CrtCommunicationOptionsComponent{constructor(e,t,a,i){super(e),this.designerSchemaService=t,this.designerCommandFactoryService=a,this.viewConfig=i,this._commOptionsEntitySchemaName="ContactCommunication",this._commOptionsEntitySchemaMapping={Contact:"ContactCommunication",Account:"AccountCommunication"},this.designerCommOptionStateHandler=e.get(ot)}_getDataSourceName(e){return`${e}${I.DATA_SOURCE_PREFIX}`}_getEntitySchemaName(){const e=this.designerSchemaService.getPrimaryDataSourceName(),t=this.designerSchemaService.getDataSourceConfigByName(e);return this._commOptionsEntitySchemaMapping[t?.entitySchemaName]||this._commOptionsEntitySchemaName}_tryAddDataSource(e){if(this.designerSchemaService.isDataSourceExists(e))return;const t=this._getEntitySchemaName();this.designerSchemaService.createDataSource(e,{type:"crt.EntityDataSource",scope:h.DataSourceScope.ViewElement,config:{entitySchemaName:t}})}ngOnInit(){const e=this._getDataSourceName(this.viewConfig.name);this._tryAddDataSource(e),this.designerCommOptionStateHandler.tryAddViewModelAttribute(this.viewConfig,e),this.designerCommOptionStateHandler.tryAddMasterRecordAttribute(this.viewConfig).pipe((0,d.switchMap)(()=>this.designerCommOptionStateHandler.needApplyColumns(this.viewConfig,e)?this.designerCommOptionStateHandler.applyEntityColumns(this.viewConfig,this._commOptionsEntitySchemaName,e):(0,d.of)(null))).subscribe(()=>{this.detectChanges()})}};_t.\u0275fac=function(e){return new(e||_t)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(g.DesignerSchemaService),n.\u0275\u0275directiveInject(g.DesignerCommandFactoryService),n.\u0275\u0275directiveInject(S.VIEW_ELEMENT_CONFIG))},_t.\u0275cmp=n.\u0275\u0275defineComponent({type:_t,selectors:[["crt-designer-communication-options"]],features:[n.\u0275\u0275ProvidersFeature([ot]),n.\u0275\u0275InheritDefinitionFeature],decls:8,vars:18,consts:[["borderRadius","none","color","transparent",3,"columns","gap","padding"],["displayAsPhone","false",3,"label","phoneAsLink","labelPosition"],[3,"label","labelPosition"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div")(1,"crt-grid",0),n.\u0275\u0275element(2,"crt-phone-input",1),n.\u0275\u0275pipe(3,"translate"),n.\u0275\u0275element(4,"crt-email-input",2),n.\u0275\u0275pipe(5,"translate"),n.\u0275\u0275element(6,"crt-web-input",2),n.\u0275\u0275pipe(7,"translate"),n.\u0275\u0275elementEnd()()),e&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275property("columns",t.columns)("gap",n.\u0275\u0275pureFunction0(16,Ml))("padding",n.\u0275\u0275pureFunction0(17,xl)),n.\u0275\u0275advance(1),n.\u0275\u0275propertyInterpolate("label",n.\u0275\u0275pipeBind1(3,10,"CommunicationOptions.DesignerPhoneLabel")),n.\u0275\u0275property("phoneAsLink",!0)("labelPosition",t.labelPosition),n.\u0275\u0275advance(2),n.\u0275\u0275propertyInterpolate("label",n.\u0275\u0275pipeBind1(5,12,"CommunicationOptions.DesignerEmailLabel")),n.\u0275\u0275property("labelPosition",t.labelPosition),n.\u0275\u0275advance(2),n.\u0275\u0275propertyInterpolate("label",n.\u0275\u0275pipeBind1(7,14,"CommunicationOptions.DesignerWebLabel")),n.\u0275\u0275property("labelPosition",t.labelPosition))},dependencies:[u.CrtWebInputComponent,u.CrtEmailInputComponent,u.CrtPhoneInputComponent,P.GridContainerComponent,D.TranslatePipe],encapsulation:2,changeDetection:0}),_t=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerCommunicationOptions",overrideType:"crt.CommunicationOptions"}),(0,p.__metadata)("design:paramtypes",[n.Injector,g.DesignerSchemaService,g.DesignerCommandFactoryService,Object])],_t);let ft=class{};ft.\u0275fac=function(e){return new(e||ft)},ft.\u0275mod=n.\u0275\u0275defineNgModule({type:ft}),ft.\u0275inj=n.\u0275\u0275defineInjector({providers:[ot],imports:[f.CommonModule,u.CrtCommunicationOptionsModule,ge,u.CrtWebInputModule,u.CrtEmailInputModule,u.CrtPhoneInputModule,P.CdkModule,D.TranslateModule]}),ft=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[_t]})],ft),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(ft,{declarations:[_t],imports:[f.CommonModule,u.CrtCommunicationOptionsModule,ge,u.CrtWebInputModule,u.CrtEmailInputModule,u.CrtPhoneInputModule,P.CdkModule,D.TranslateModule],exports:[_t]})}();var Ct=v(30955);function Il(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-skeleton-loader",2),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("styles",t.skeletonStyles)}}function Pl(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-expansion-panel-header",8),n.\u0275\u0275listener("expandedChange",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.expanded=i)})("expandedChange",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.expandedChanged(i))}),n.\u0275\u0275element(1,"crt-droppable-list",9),n.\u0275\u0275elementEnd()}if(r&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("title",t.title)("tooltip",t.tooltip)("description",t.description)("expanded",t.expanded)("togglePosition",t.togglePosition)("toggleType",t.toggleType)("labelColor",t.labelColor)("dir",t.documentDirection)("ariaLabel",t.ariaLabel)("extraStyles",t.extraStyles)("showEmptyTools",!0)("isFullWidth",t.fullWidthHeader)("titleWidthValue",t.titleWidth),n.\u0275\u0275advance(1),n.\u0275\u0275property("items",t.designerTools)}}function El(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",10)(1,"div",11),n.\u0275\u0275element(2,"crt-droppable-list",12),n.\u0275\u0275elementEnd()()),r&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(2),n.\u0275\u0275property("items",t.designerItems)}}function Tl(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",3),n.\u0275\u0275template(1,Pl,2,14,"crt-expansion-panel-header",4),n.\u0275\u0275elementStart(2,"mat-expansion-panel",5,6),n.\u0275\u0275template(4,El,3,1,"ng-template",7),n.\u0275\u0275elementEnd()()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngClass",t.classes),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.title||t.tooltip||t.description||(t.tools==null?null:t.tools.length)),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngClass",t.expansionPanelClasses)("expanded",t.expanded)("hideToggle",!0)}}let sn=class extends u.CrtExpansionPanelComponent{_getUpdateExpandedConfig(){return{viewConfig:{name:this.name,expanded:this.expanded}}}_updateViewConfig(e){this._commandFactoryService.create("crt.UpdateViewConfigCommand",e).pipe((0,l.mergeMap)(t=>t.execute())).subscribe()}_getUpdateItemsConfig(e,t){return{applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.items"}],silentMode:!0,viewConfig:{items:e,tools:t}}}_initDesignerItems(){const e=this.injector.get(S.VIEW_ELEMENT_CONFIG);let t=e?.tools??[],a=e?.items??[];const i=a.filter(o=>o.gridContainerType===u.ExpansionPanelGridContainerType.TOOLS);t?.length===0&&i?.length>0&&(a=a.filter(o=>o.gridContainerType!==u.ExpansionPanelGridContainerType.TOOLS),t=i,this.applyItemsChanges(e?.name,a,i)),this.designerItems=me(a,{selected:!1}),this.designerTools=me(t,{selected:!1})}applyItemsChanges(e,t,a){const i=this._getUpdateItemsConfig(t,a);i.viewConfig.name=e||this.name,this._updateViewConfig(i)}applyExpandedStateChanges(){const e=this._getUpdateExpandedConfig();this._updateViewConfig(e)}initDefaultPadding(){this.padding={top:P.SizeEnum.Small,bottom:P.SizeEnum.Small,left:P.SizeEnum.Medium,right:P.SizeEnum.Medium}}constructor(e){super(e),this.designerItems=[],this.designerTools=[],this._commandFactoryService=this.injector.get(g.DesignerCommandFactoryService)}ngOnInit(){super.ngOnInit(),this._initDesignerItems()}onOpened(){super.onOpened(),this.applyExpandedStateChanges()}onClosed(){super.onClosed(),this.applyExpandedStateChanges()}};sn.\u0275fac=function(e){return new(e||sn)(n.\u0275\u0275directiveInject(n.Injector))},sn.\u0275cmp=n.\u0275\u0275defineComponent({type:sn,selectors:[["crt-designer-expansion-panel"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:3,vars:2,consts:[[3,"styles",4,"ngIf","ngIfElse"],["expansion_panel_template",""],[3,"styles"],[3,"ngClass"],[3,"title","tooltip","description","expanded","togglePosition","toggleType","labelColor","dir","ariaLabel","extraStyles","showEmptyTools","isFullWidth","titleWidthValue","expandedChange",4,"ngIf"],[3,"ngClass","expanded","hideToggle"],["matExpansionPanel",""],["matExpansionPanelContent",""],[3,"title","tooltip","description","expanded","togglePosition","toggleType","labelColor","dir","ariaLabel","extraStyles","showEmptyTools","isFullWidth","titleWidthValue","expandedChange"],["propertyName","tools",3,"items"],[1,"expansion-panel-content-wrap"],[1,"content-wrap"],["propertyName","items",3,"items"]],template:function(e,t){if(e&1&&(n.\u0275\u0275template(0,Il,1,1,"crt-skeleton-loader",0),n.\u0275\u0275template(1,Tl,5,5,"ng-template",null,1,n.\u0275\u0275templateRefExtractor)),e&2){const a=n.\u0275\u0275reference(2);n.\u0275\u0275property("ngIf",t.loading)("ngIfElse",a)}},dependencies:[u.CrtExpansionPanelHeaderComponent,f.NgClass,f.NgIf,Ct.MatExpansionPanel,Ct.MatExpansionPanelContent,hi.Dir,w.SkeletonLoaderComponent,we],styles:[`crt-expansion-panel,crt-designer-expansion-panel{border-radius:8px;display:flex;flex-direction:column;box-sizing:border-box;overflow:hidden}crt-expansion-panel.stretch,crt-designer-expansion-panel.stretch{height:100%}@supports (background: -webkit-named-image(i)){crt-expansion-panel.stretch,crt-designer-expansion-panel.stretch{height:initial}}crt-expansion-panel.fit-content,crt-designer-expansion-panel.fit-content{overflow:hidden}crt-expansion-panel crt-expansion-panel,crt-expansion-panel crt-designer-expansion-panel,crt-designer-expansion-panel crt-expansion-panel,crt-designer-expansion-panel crt-designer-expansion-panel{padding-left:0;padding-right:0}crt-expansion-panel .crt-expansion-panel.mat-expansion-panel,crt-designer-expansion-panel .crt-expansion-panel.mat-expansion-panel{visibility:hidden;box-shadow:none}crt-expansion-panel .crt-expansion-panel.mat-expansion-panel .mat-expansion-panel-content,crt-designer-expansion-panel .crt-expansion-panel.mat-expansion-panel .mat-expansion-panel-content{min-height:0}crt-expansion-panel .crt-expansion-panel.mat-expansion-panel .mat-expansion-panel-content .mat-expansion-panel-body,crt-designer-expansion-panel .crt-expansion-panel.mat-expansion-panel .mat-expansion-panel-content .mat-expansion-panel-body{padding:8px 0 0;height:100%;overflow:auto;display:flex;flex-direction:column}crt-expansion-panel .crt-expansion-panel.mat-expansion-panel .mat-expansion-panel-content.ng-animating .mat-expansion-panel-body,crt-designer-expansion-panel .crt-expansion-panel.mat-expansion-panel .mat-expansion-panel-content.ng-animating .mat-expansion-panel-body{height:0;overflow:hidden}crt-expansion-panel .crt-expansion-panel.mat-expansion-panel.disable-overflow .mat-expansion-panel-body,crt-designer-expansion-panel .crt-expansion-panel.mat-expansion-panel.disable-overflow .mat-expansion-panel-body{overflow:hidden}crt-expansion-panel .crt-expansion-panel.mat-expansion-panel.mat-expanded,crt-designer-expansion-panel .crt-expansion-panel.mat-expansion-panel.mat-expanded{display:contents;visibility:visible}
`,`crt-designer-expansion-panel .crt-expansion-panel.mat-expansion-panel.mat-expanded .mat-expansion-panel-content{min-height:32px}
`],encapsulation:2,changeDetection:0}),sn=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerExpansionPanel",overrideType:"crt.ExpansionPanel"}),(0,p.__metadata)("design:paramtypes",[n.Injector])],sn);let yt=class{};yt.\u0275fac=function(e){return new(e||yt)},yt.\u0275mod=n.\u0275\u0275defineNgModule({type:yt}),yt.\u0275inj=n.\u0275\u0275defineInjector({imports:[u.CrtExpansionPanelModule,f.CommonModule,Ct.MatExpansionModule,E.MatIconModule,S.ViewModule,w.ResizableModule,w.CrtSkeletonLoaderModule,u.CrtLabelModule,u.CrtButtonModule,q]}),yt=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[sn]})],yt),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(yt,{declarations:[sn],imports:[u.CrtExpansionPanelModule,f.CommonModule,Ct.MatExpansionModule,E.MatIconModule,S.ViewModule,w.ResizableModule,w.CrtSkeletonLoaderModule,u.CrtLabelModule,u.CrtButtonModule,q],exports:[sn]})}();function Ol(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-placeholder",4),r&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("image",t.placeholderImage)}}function Al(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-data-grid",2),n.\u0275\u0275listener("sortingChange",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onSortingChanged(i))}),n.\u0275\u0275template(1,Ol,1,1,"crt-placeholder",3),n.\u0275\u0275elementEnd()}if(r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("items",t.items)("header",t.header)("columns",t.columns)("sorting",t.dataGridSorting)("loading",t.loading)("primaryColumnName",t.primaryColumnName),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.placeholderVisible)}}function Vl(r,e){r&1&&n.\u0275\u0275element(0,"crt-gallery")}let vt=class extends fe{constructor(e,t,a,i){super(e,t,a,i),this.designerSchemaService=t,this.designerCommandFactoryService=a,this.viewConfig=i,this._fileEntitySchemaName="SysFile",this.placeholderImage={type:"icon",icon:"attachments",width:null,height:null,padding:null},this.viewType=u.FileListViewTypeEnum.List,this.designerFileListStateHandler=e.get(rt),this.placeholder=!0}_getDataSourceName(e){return`${e}${I.DATA_SOURCE_PREFIX}`}_tryAddDataSource(e){this.designerSchemaService.isDataSourceExists(e)||this.designerSchemaService.createDataSource(e,{type:"crt.EntityDataSource",scope:h.DataSourceScope.ViewElement,config:{entitySchemaName:this._fileEntitySchemaName}})}ngOnInit(){const e=this._getDataSourceName(this.viewConfig.name);this._tryAddDataSource(e),this.designerFileListStateHandler.tryAddViewModelAttribute(this.viewConfig,e),this.placeholder=!this.designerSchemaService.getPrimaryDataSourceName(),this.designerFileListStateHandler.tryAddMasterRecordAttribute(this.viewConfig).pipe((0,d.switchMap)(()=>this.designerFileListStateHandler.applyEntityColumns(this.viewConfig,this._fileEntitySchemaName,e))).subscribe(()=>{this.detectChanges()})}};vt.\u0275fac=function(e){return new(e||vt)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(g.DesignerSchemaService),n.\u0275\u0275directiveInject(g.DesignerCommandFactoryService),n.\u0275\u0275directiveInject(S.VIEW_ELEMENT_CONFIG))},vt.\u0275cmp=n.\u0275\u0275defineComponent({type:vt,selectors:[["crt-designer-file-list"]],inputs:{viewType:"viewType"},features:[n.\u0275\u0275ProvidersFeature([rt]),n.\u0275\u0275InheritDefinitionFeature],decls:2,vars:2,consts:[["class","file-list",3,"items","header","columns","sorting","loading","primaryColumnName","sortingChange",4,"ngIf"],[4,"ngIf"],[1,"file-list",3,"items","header","columns","sorting","loading","primaryColumnName","sortingChange"],["skeleton","","title","","subhead","",3,"image",4,"ngIf"],["skeleton","","title","","subhead","",3,"image"]],template:function(e,t){e&1&&(n.\u0275\u0275template(0,Al,2,7,"crt-data-grid",0),n.\u0275\u0275template(1,Vl,1,0,"crt-gallery",1)),e&2&&(n.\u0275\u0275property("ngIf",t.viewType==="list"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.viewType==="gallery"))},dependencies:[f.NgIf,u.CrtDataGridComponent,u.CrtGalleryComponent,w.CrtPlaceholderComponent],styles:["[_nghost-%COMP%]{display:block;height:100%;box-sizing:border-box}[_nghost-%COMP%]:not(.crt-designer-data-grid--skeleton-visible){padding-bottom:10px}"],changeDetection:0}),vt=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerFileList",overrideType:"crt.FileList"}),(0,p.__metadata)("design:paramtypes",[n.Injector,g.DesignerSchemaService,g.DesignerCommandFactoryService,Object])],vt);let St=class{};St.\u0275fac=function(e){return new(e||St)},St.\u0275mod=n.\u0275\u0275defineNgModule({type:St}),St.\u0275inj=n.\u0275\u0275defineInjector({providers:[rt],imports:[f.CommonModule,u.CrtDataGridModule,ge,u.CrtGalleryModule,u.CrtFileListModule,w.CrtPlaceholderModule]}),St=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[vt]})],St),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(St,{declarations:[vt],imports:[f.CommonModule,u.CrtDataGridModule,ge,u.CrtGalleryModule,u.CrtFileListModule,w.CrtPlaceholderModule],exports:[vt]})}();let Ue=class extends u.CrtImageInputComponent{};Ue.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Ue)))(t||Ue)}}(),Ue.\u0275cmp=n.\u0275\u0275defineComponent({type:Ue,selectors:[["crt-designer-image-input"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:4,vars:3,consts:[[1,"image-shell"],[3,"ngClass"],[1,"placeholder-wrap","designer-mock",3,"ngStyle"],["matSuffix","",1,"image-placeholder",3,"svgIcon"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),n.\u0275\u0275element(3,"mat-icon",3),n.\u0275\u0275elementEnd()()()),e&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275property("ngClass",t.wrapClasses),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",t.imageStyles),n.\u0275\u0275advance(1),n.\u0275\u0275property("svgIcon",t.placeholder))},dependencies:[f.NgClass,f.NgStyle,E.MatIcon],styles:["[_nghost-%COMP%]   .placeholder-abbreviation[_ngcontent-%COMP%]{width:32px;height:32px}[_nghost-%COMP%]   .placeholder-abbreviation.no-photo[_ngcontent-%COMP%]{text-align:center;display:flex;flex-direction:column;justify-content:center;min-width:32px;min-height:32px;color:var(--crt-palette-background-500)}[_nghost-%COMP%]   .crt-image-input[_ngcontent-%COMP%]{position:relative;min-width:16px;min-height:16px;width:100%;border-style:none}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]{height:32px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{height:16px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]{height:48px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{height:24px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]{height:80px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{height:40px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]{height:120px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{height:60px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]{width:32px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{width:16px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]{width:48px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{width:24px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]{width:80px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{width:40px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]{width:120px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{width:60px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]{max-width:32px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{max-width:16px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]{max-width:48px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{max-width:24px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]{max-width:80px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{max-width:40px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]{max-width:120px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{max-width:60px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]{max-height:32px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{max-height:16px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]{max-height:48px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{max-height:24px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]{max-height:80px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{max-height:40px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]{max-height:120px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{max-height:60px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]{min-width:32px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{min-width:16px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]{min-width:48px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{min-width:24px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]{min-width:80px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{min-width:40px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]{min-width:120px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{min-width:60px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]{min-height:32px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{min-height:16px}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .placeholder-abbreviation.no-photo[_ngcontent-%COMP%]{font-family:var(--crt-headline-5-font-family);font-size:var(--crt-headline-5-font-size);line-height:var(--crt-headline-5-line-height);font-weight:var(--crt-headline-5-font-weight);letter-spacing:var(--crt-headline-5-letter-spacing);text-transform:var(--crt-headline-5-text-transform);-webkit-font-smoothing:antialiased}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]{min-height:48px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{min-height:24px}[_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .placeholder-abbreviation.no-photo[_ngcontent-%COMP%]{font-family:var(--crt-headline-4-font-family);font-size:var(--crt-headline-4-font-size);line-height:var(--crt-headline-4-line-height);font-weight:var(--crt-headline-4-font-weight);letter-spacing:var(--crt-headline-4-letter-spacing);text-transform:var(--crt-headline-4-text-transform);-webkit-font-smoothing:antialiased}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]{min-height:80px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{min-height:40px}[_nghost-%COMP%]   .crt-image-input.image-size-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .placeholder-abbreviation.no-photo[_ngcontent-%COMP%]{font-family:var(--crt-headline-3-font-family);font-size:var(--crt-headline-3-font-size);line-height:var(--crt-headline-3-line-height);font-weight:var(--crt-headline-3-font-weight);letter-spacing:var(--crt-headline-3-letter-spacing);text-transform:var(--crt-headline-3-text-transform);-webkit-font-smoothing:antialiased}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]{min-height:120px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .image-placeholder[_ngcontent-%COMP%]{min-height:60px}[_nghost-%COMP%]   .crt-image-input.image-size-extra-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]   .placeholder-abbreviation.no-photo[_ngcontent-%COMP%]{font-family:var(--crt-headline-1-font-family);font-size:var(--crt-headline-1-font-size);line-height:var(--crt-headline-1-line-height);font-weight:var(--crt-headline-1-font-weight);letter-spacing:var(--crt-headline-1-letter-spacing);text-transform:var(--crt-headline-1-text-transform);-webkit-font-smoothing:antialiased}[_nghost-%COMP%]   .crt-image-input.image-border-radius-small[_ngcontent-%COMP%]{border-radius:4px}[_nghost-%COMP%]   .crt-image-input.image-border-radius-small[_ngcontent-%COMP%]   .crt-image[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-image-input.image-border-radius-small[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-image-input.image-border-radius-small[_ngcontent-%COMP%]   .image-input-actions[_ngcontent-%COMP%]{border-radius:4px}[_nghost-%COMP%]   .crt-image-input.image-border-radius-medium[_ngcontent-%COMP%]{border-radius:8px}[_nghost-%COMP%]   .crt-image-input.image-border-radius-medium[_ngcontent-%COMP%]   .crt-image[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-image-input.image-border-radius-medium[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-image-input.image-border-radius-medium[_ngcontent-%COMP%]   .image-input-actions[_ngcontent-%COMP%]{border-radius:8px}[_nghost-%COMP%]   .crt-image-input.image-border-radius-large[_ngcontent-%COMP%]{border-radius:16px}[_nghost-%COMP%]   .crt-image-input.image-border-radius-large[_ngcontent-%COMP%]   .crt-image[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-image-input.image-border-radius-large[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-image-input.image-border-radius-large[_ngcontent-%COMP%]   .image-input-actions[_ngcontent-%COMP%]{border-radius:16px}[_nghost-%COMP%]   .crt-image-input[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-image-input[_ngcontent-%COMP%]   .image-input-actions[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;box-sizing:border-box;border-style:solid}[_nghost-%COMP%]   .crt-image-input[_ngcontent-%COMP%]   .placeholder-wrap[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   .crt-image-input[_ngcontent-%COMP%]   .crt-image[_ngcontent-%COMP%]{width:100%;height:100%;display:block;box-sizing:border-box;border-style:solid}[_nghost-%COMP%]   .crt-image-input.image-size-small[_ngcontent-%COMP%]   .image-input-actions[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-image-input.image-size-medium[_ngcontent-%COMP%]   .image-input-actions[_ngcontent-%COMP%]{gap:2px}[_nghost-%COMP%]   .image-input-actions[_ngcontent-%COMP%]{opacity:0;flex-direction:row;gap:8px}[_nghost-%COMP%]   .image-input-actions.actions-vertical[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .image-input-actions[_ngcontent-%COMP%]   .image-action-icon[_ngcontent-%COMP%]{width:16px;height:16px;cursor:pointer}.crt-image-input-focused[_nghost-%COMP%]   .image-input-actions[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-image-input[_ngcontent-%COMP%]:hover   .image-input-actions[_ngcontent-%COMP%]{opacity:1}","[_nghost-%COMP%]   .crt-image-input[_ngcontent-%COMP%]   .placeholder-wrap.designer-mock[_ngcontent-%COMP%]:hover{opacity:1}[_nghost-%COMP%]   .image-shell[_ngcontent-%COMP%]{overflow:hidden;width:100%}"]}),Ue=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerImageInput",overrideType:"crt.ImageInput"})],Ue);let Me=class{};Me.\u0275fac=function(e){return new(e||Me)},Me.\u0275mod=n.\u0275\u0275defineNgModule({type:Me}),Me.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,E.MatIconModule]}),Me=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[Ue]})],Me),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Me,{declarations:[Ue],imports:[f.CommonModule,E.MatIconModule],exports:[Ue]})}();class He{constructor(e,t){this._designerSchemaService=e,this._designerCommandFactoryService=t}_getSummariesViewConfig(e){return this._designerSchemaService.getViewConfigInfoByName(e)?.viewConfig}_bindExpandedStateProperty(e){const t={name:e,changes:[{path:"itemConfig.expanded",value:`$${(0,u.createSummariesExpandedAttributeName)({name:e})}`,applyPropertyStrategy:_.ApplyChangedPropertyStrategy.Override}]};return(0,d.firstValueFrom)(this._designerCommandFactoryService.create("crt.ChangeViewItemCommand",t).pipe((0,l.mergeMap)(a=>a.execute()),(0,l.map)(()=>{})))}setState(e,t){var a=this;return(0,F.Z)(function*(){if(!e)return;const i=a._getSummariesViewConfig(e);if(!i||(i.expanded==null&&(yield a._bindExpandedStateProperty(e)),!(0,_.isBindingExpression)(i.expanded)))return;const o=(0,_.parseExpression)(i.expanded).attributePath;o&&a._designerSchemaService.setViewModelAttribute(o,{value:t})})()}}He.\u0275fac=function(e){return new(e||He)(n.\u0275\u0275inject(g.DesignerSchemaService),n.\u0275\u0275inject(g.DesignerCommandFactoryService))},He.\u0275prov=n.\u0275\u0275defineInjectable({token:He,factory:He.\u0275fac});class wt{constructor(e,t){this._schemaService=e,this._viewCommandExecutor=t}_getSummaryItemViewConfigs(e){return this._schemaService.getViewConfigInfoByFilter(()=>!0).filter(t=>t?.parentName===e).map(t=>t?.viewConfig)}getItems(e){return this._schemaService.schemaChanged$.pipe((0,l.map)(t=>t?.changes??{}),(0,l.filter)(t=>t.parentName===e.name&&Boolean(e.name)),(0,l.map)(()=>this._getSummaryItemViewConfigs(e.name)))}createItem(e){var t=this;return(0,F.Z)(function*(){const{parentName:a,summaryItemSettings:i}=e??{},{resources:o,viewConfig:s}=i??{};!s||(yield(0,d.firstValueFrom)(t._viewCommandExecutor.add({containerName:a,propertyName:"items",designerTool:{defaultConfig:{type:"crt.SummaryItem",defaultPropertyValues:s}}}).pipe((0,l.take)(1),(0,l.switchMap)(c=>c.execute()))),t._schemaService.updateResources({strings:o.localizableStrings}))})()}removeItem(e){var t=this;return(0,F.Z)(function*(){yield(0,d.firstValueFrom)(t._viewCommandExecutor.remove(e).pipe((0,l.switchMap)(a=>a.execute())))})()}}wt.\u0275fac=function(e){return new(e||wt)(n.\u0275\u0275inject(g.DesignerSchemaService),n.\u0275\u0275inject(g.ViewItemCommandExecutor))},wt.\u0275prov=n.\u0275\u0275defineInjectable({token:wt,factory:wt.\u0275fac});const Fl={type:"divider"};class cn{constructor(e){this._translateService=e.get(D.TranslateService),this._designerSchemaService=e.get(g.DesignerSchemaService),this._designerDataSourceManager=e.get($),this._summaryItemsProvider=e.get(wt),this._summaryItemSetupService=e.get(u.SummaryItemSetupService),this._summaryItemMetaSettingsCreator=e.get(u.SummaryItemMetaSettingsCreator),this._quickSummaryItemCreationActionsProvider=e.get(u.QuickSummaryItemCreationActionsProvider),this._summariesExpandedStateService=e.get(He)}_createSummaryItem(e){var t=this;return(0,F.Z)(function*(){!e?.summaryItemSettings||(yield t._summaryItemsProvider.createItem(e),yield t._summariesExpandedStateService.setState(e.parentName,!0))})()}_createCustomSummaryItem(e,t){var a=this;return(0,F.Z)(function*(){const i=yield a._summaryItemSetupService.setup(t);return a._createSummaryItem({parentName:e,summaryItemSettings:i})})()}_createPredefinedSummaryItem(e,t,a){const{label:i,expression:o}=a,s=this._summaryItemMetaSettingsCreator.create({label:i,valueExpression:o,modelName:t});return this._createSummaryItem({parentName:e,summaryItemSettings:s})}_getDataSourceInfo(e){const t=this._designerSchemaService.getViewModelConfig();return I.DataSourceInfo.getFromViewModelConfig(t)?.get(e)}_createQuickSummaryItemMenuItem(e,t,a){return a?.actions?.length?this._createQuickSummaryItemMenuSubMenuItem(e,t,a):this._createQuickSummaryItemMenuActionItem(e,t,a)}_createQuickSummaryItemMenuSubMenuItem(e,t,a){const{icon:i,caption:o,actions:s}=a;return{type:"menu",icon:i,caption:o,items:s?.map(c=>this._createQuickSummaryItemMenuItem(e,t,c))}}_createQuickSummaryItemMenuActionItem(e,t,a){const{name:i,icon:o,caption:s,summaryItemOptions:c}=a;return{type:"action",code:i,icon:o,caption:s,handler:()=>this._createPredefinedSummaryItem(t,e,c)}}_createQuickSetupActions(e,t,a){const{name:i,_designOptions:{modelName:o}}=e,s=this._quickSummaryItemCreationActionsProvider.getActionsGroups(t,a);if(!s?.flat()?.length)return[];const m=s.map(b=>b.map(y=>this._createQuickSummaryItemMenuItem(o,i,y))).filter(b=>b?.length).map((b,y,T)=>y===T.length-1?b:[...b,Fl]).flat();return[{type:"label",caption:this._translateService.instant("Summaries.QuickSummaries.QuickSetup")},...m]}_createAdvancedSetupActions(e){const{name:t,_designOptions:{modelName:a}}=e;return[{type:"label",caption:this._translateService.instant("Summaries.AdvancedSetup.Title")},{type:"action",code:`${t}_AddCustomSummary`,icon:"add-button-icon",caption:this._translateService.instant("Summaries.AdvancedSetup.Actions.AddCustomSummary"),handler:()=>this._createCustomSummaryItem(t,a)}]}getMenuItems(e){const t=e?._designOptions?.modelName,a=e?.name;return!t||!a?(0,d.of)([]):this._designerDataSourceManager.getDataSourceSchemaByName$(t).pipe((0,l.map)(i=>{const o=this._getDataSourceInfo(t);if(!i||!o)return[];const s=this._createQuickSetupActions(e,i,o),c=this._createAdvancedSetupActions(e);return s.length?[...s,{type:"divider"},...c]:c}))}}cn.\u0275fac=function(e){return new(e||cn)(n.\u0275\u0275inject(n.Injector))},cn.\u0275prov=n.\u0275\u0275defineInjectable({token:cn,factory:cn.\u0275fac});class ln{constructor(e,t){this._translateService=e,this._summaryItemsProvider=t}getMenuItems(e){return[{type:"action",code:"delete",icon:"delete-button-icon",caption:this._translateService.instant("SummaryItem.Actions.Delete"),handler:()=>this._summaryItemsProvider.removeItem(e)}]}}ln.\u0275fac=function(e){return new(e||ln)(n.\u0275\u0275inject(D.TranslateService),n.\u0275\u0275inject(wt))},ln.\u0275prov=n.\u0275\u0275defineInjectable({token:ln,factory:ln.\u0275fac});class wa extends u.BaseSummaryItemColumnProvider{constructor(e){super(),this._designerDataSourceManager=e}getDataSchema(e){return this._designerDataSourceManager.getDataSourceSchemaByName$(e)}getColumnCaptionByPath(e,t){if(!e||!t)return(0,d.of)(null);const a=this._designerDataSourceManager.getDataSourceServiceByDataSourceName(e).pipe((0,l.switchMap)(i=>i?.getForwardReferenceAttributeCaptionByPath$(`${e}.${t}`)));return(0,d.forkJoin)([this.getDataSchema(e),a]).pipe((0,l.map)(([i,o])=>o?.replace(new RegExp(`^${i?.caption?.toString()}[.]`),"")??""))}}wa.\u0275fac=function(e){return new(e||wa)(n.\u0275\u0275inject($))},wa.\u0275prov=n.\u0275\u0275defineInjectable({token:wa,factory:wa.\u0275fac});function Nl(r,e){r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"span",8),n.\u0275\u0275text(2),n.\u0275\u0275pipe(3,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(4,"mat-icon",9),n.\u0275\u0275elementContainerEnd()),r&2&&(n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(3,1,"Summaries.Caption")," "))}function Rl(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"crt-button",5),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275element(3,"mat-icon",6),n.\u0275\u0275template(4,Nl,5,3,"ng-container",7),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()),r&2){const t=n.\u0275\u0275nextContext(),a=n.\u0275\u0275reference(3);let i,o;n.\u0275\u0275advance(1),n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(2,4,(i=t.title)!==null&&i!==void 0?i:"Summaries.Caption"))("disabled",(o=t.disabled)!==null&&o!==void 0?o:!t.isModelDefined)("crtMenuTriggerFor",a),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngIf",!(t.items!=null&&t.items.length))}}let ue=class extends S.CrtBaseComponent{constructor(e,t,a,i,o,s){super(e),this._summariesActionsMenuProvider=t,this._schemaService=a,this._designerContainerService=i,this._summariesExpandedStateService=o,this._destroyed$=new d.Subject,this._viewConfig$=new d.ReplaySubject(1),this.selected=!1,this.isModelDefined=!1,this._viewConfig$.next(s)}_setActions(){return this._summariesActionsMenuProvider.getMenuItems(this._viewConfig).pipe((0,l.tap)(e=>this.actions=e),(0,l.tap)(()=>this.detectChanges()))}_subscribeSchemaChanges(){this._schemaService.schemaChanged$.pipe((0,l.map)(e=>e?.changes?.viewConfig??{}),(0,l.filter)(e=>e.name===this.name),(0,l.tap)(e=>this._viewConfig$.next(e)),(0,l.takeUntil)(this._destroyed$)).subscribe()}_subscribeViewConfigChanges(){this._viewConfig$.pipe((0,l.tap)(e=>{this._viewConfig=e??{},this.isModelDefined=Boolean(this._viewConfig._designOptions?.modelName)}),(0,l.switchMap)(()=>this._setActions()),(0,l.takeUntil)(this._destroyed$)).subscribe()}_subscribeSelectedViewElementChanges(){this._designerContainerService.selectedChanged$.pipe((0,l.map)(e=>e?.name),(0,l.tap)(e=>this._onSelectedViewElementChanged(e)),(0,l.filter)(e=>e===this._viewConfig.name),(0,l.switchMap)(()=>this._setActions()),(0,l.takeUntil)(this._destroyed$)).subscribe()}_onSelectedViewElementChanged(e){this.selected=this._viewConfig?.name===e,this.detectChanges()}onExpandedChange(e){return this.expanded=e,this._summariesExpandedStateService.setState(this._viewConfig?.name,e)}ngOnInit(){this._subscribeSchemaChanges(),this._subscribeViewConfigChanges(),this._subscribeSelectedViewElementChanges()}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}};ue.\u0275fac=function(e){return new(e||ue)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(cn),n.\u0275\u0275directiveInject(_.SchemaService),n.\u0275\u0275directiveInject(z),n.\u0275\u0275directiveInject(He),n.\u0275\u0275directiveInject(S.VIEW_ELEMENT_CONFIG))},ue.\u0275cmp=n.\u0275\u0275defineComponent({type:ue,selectors:[["crt-designer-summaries"]],inputs:{items:"items",expanded:"expanded",title:"title",disabled:"disabled"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:6,vars:7,consts:[[3,"items","expanded","expandedChange"],[4,"crtSummariesActions"],[3,"menuItems"],["actionsMenu",""],[3,"visible","title"],["size","small","displayType","text",1,"crt-summaries-actions",3,"title","disabled","crtMenuTriggerFor"],["svgIcon","sum-button-icon",1,"crt-summaries-btn-icon"],[4,"ngIf"],[1,"crt-button-caption"],["svgIcon","menu-arrow",1,"crt-summaries-btn-icon"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"crt-summaries",0),n.\u0275\u0275listener("expandedChange",function(i){return t.onExpandedChange(i)}),n.\u0275\u0275template(1,Rl,5,6,"ng-container",1),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(2,"crt-menu",2,3)(4,"crt-block-events-layer",4),n.\u0275\u0275pipe(5,"translate")),e&2&&(n.\u0275\u0275property("items",t.items)("expanded",t.expanded),n.\u0275\u0275advance(2),n.\u0275\u0275property("menuItems",t.actions),n.\u0275\u0275advance(2),n.\u0275\u0275property("visible",!t.selected||!t.isModelDefined)("title",t.selected&&!t.isModelDefined?n.\u0275\u0275pipeBind1(5,5,"Summaries.Hints.NoDataSource"):""))},dependencies:[f.NgIf,u.CrtButtonComponent,u.CrtMenuComponent,u.CrtMenuTriggerDirective,u.CrtSummariesComponent,u.CrtSummariesActionsDirective,ve,E.MatIcon,D.TranslatePipe],styles:[".crt-summaries-btn-icon[_ngcontent-%COMP%]{height:16px;width:16px}.crt-button-caption[_ngcontent-%COMP%]{margin-right:4px}"],changeDetection:0}),(0,p.__decorate)([(0,h.CrtInput)(),(0,p.__metadata)("design:type",Array)],ue.prototype,"items",void 0),(0,p.__decorate)([(0,h.CrtInput)(),(0,p.__metadata)("design:type",Boolean)],ue.prototype,"expanded",void 0),(0,p.__decorate)([(0,h.CrtInput)(),(0,p.__metadata)("design:type",String)],ue.prototype,"title",void 0),(0,p.__decorate)([(0,h.CrtInput)({defaultValue:!1}),(0,p.__metadata)("design:type",Boolean)],ue.prototype,"disabled",void 0),ue=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerSummaries",overrideType:"crt.Summaries"}),(0,p.__metadata)("design:paramtypes",[n.Injector,cn,_.SchemaService,z,He,Object])],ue);let xe=class{};xe.\u0275fac=function(e){return new(e||xe)},xe.\u0275mod=n.\u0275\u0275defineNgModule({type:xe}),xe.\u0275inj=n.\u0275\u0275defineInjector({providers:[u.SummaryItemEditingService,u.SummaryItemSetupService,wt,cn,He,{provide:u.BaseSummaryItemColumnProvider,useClass:wa}],imports:[f.CommonModule,u.CrtButtonModule,u.CrtMenuModule,u.CrtSummariesModule,j,D.TranslateModule,u.QuickSummaryItemCreationActionsModule,E.MatIconModule]}),xe=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[ue]})],xe),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(xe,{declarations:[ue],imports:[f.CommonModule,u.CrtButtonModule,u.CrtMenuModule,u.CrtSummariesModule,j,D.TranslateModule,u.QuickSummaryItemCreationActionsModule,E.MatIconModule],exports:[ue]})}();let Ie=class extends S.CrtBaseComponent{constructor(e,t,a){super(e),this._summaryItemMenuActionsProvider=t,this._viewConfig=a,this.actions=this._summaryItemMenuActionsProvider.getMenuItems(this._viewConfig),this.valueDataType=this._viewConfig?._designOptions?.value?.expression?.resultDataValueType}};Ie.\u0275fac=function(e){return new(e||Ie)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(ln),n.\u0275\u0275directiveInject(S.VIEW_ELEMENT_CONFIG))},Ie.\u0275cmp=n.\u0275\u0275defineComponent({type:Ie,selectors:[["crt-designer-summary-item"]],inputs:{label:"label",value:"value"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:5,vars:10,consts:[[3,"label","value","crtMenuTriggerFor","crtMenuTriggerRestoreFocus"],["actionsMenuTrigger","crtMenuTrigger"],[3,"menuItems"],["actionsMenu",""]],template:function(e,t){if(e&1&&(n.\u0275\u0275element(0,"crt-summary-item",0,1),n.\u0275\u0275pipe(2,"toEmptyPlaceholder"),n.\u0275\u0275element(3,"crt-menu",2,3)),e&2){const a=n.\u0275\u0275reference(1),i=n.\u0275\u0275reference(4);n.\u0275\u0275classProp("crt-summary-item-actions-opened",a==null?null:a.menuOpen),n.\u0275\u0275property("label",t.label)("value",n.\u0275\u0275pipeBind2(2,7,t.value,t.valueDataType))("crtMenuTriggerFor",i)("crtMenuTriggerRestoreFocus",!0),n.\u0275\u0275advance(3),n.\u0275\u0275property("menuItems",t.actions)}},dependencies:[u.CrtMenuComponent,u.CrtMenuTriggerDirective,u.CrtSummaryItemComponent,C.ToEmptyPlaceholderPipe],styles:["[_nghost-%COMP%]{flex-shrink:1;min-width:0}"],changeDetection:0}),(0,p.__decorate)([(0,h.CrtInput)(),(0,p.__metadata)("design:type",String)],Ie.prototype,"label",void 0),(0,p.__decorate)([(0,h.CrtInput)(),(0,p.__metadata)("design:type",String)],Ie.prototype,"value",void 0),Ie=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerSummaryItem",overrideType:"crt.SummaryItem"}),(0,p.__metadata)("design:paramtypes",[n.Injector,ln,Object])],Ie);let Pe=class{};Pe.\u0275fac=function(e){return new(e||Pe)},Pe.\u0275mod=n.\u0275\u0275defineNgModule({type:Pe}),Pe.\u0275inj=n.\u0275\u0275defineInjector({providers:[ln,wt],imports:[f.CommonModule,u.CrtMenuModule,u.CrtSummaryItemModule,D.TranslateModule,C.ToEmptyPlaceholderModule]}),Pe=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[Ie]})],Pe),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Pe,{declarations:[Ie],imports:[f.CommonModule,u.CrtMenuModule,u.CrtSummaryItemModule,D.TranslateModule,C.ToEmptyPlaceholderModule],exports:[Ie]})}();var Qa=v(24141);let dn=class extends u.TabContainerComponent{constructor(e){super(e),this.injector=e,this.designerItems=[]}_initTabItems(){const t=this.injector.get(S.VIEW_ELEMENT_CONFIG)?.items??[];this.designerItems=me(t,{selected:!1})}ngOnInit(){super.ngOnInit(),this._initTabItems()}};dn.\u0275fac=function(e){return new(e||dn)(n.\u0275\u0275directiveInject(n.Injector))},dn.\u0275cmp=n.\u0275\u0275defineComponent({type:dn,selectors:[["crt-designer-tab-container"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:2,vars:2,consts:[[1,"crt-tab"],["propertyName","items",3,"parentName","items"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275element(1,"crt-droppable-list",1),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275property("parentName",t.id)("items",t.designerItems))},dependencies:[we],styles:[`.crt-tab{width:100%;height:100%;min-width:32px;min-height:32px;overflow-y:auto}@supports (overflow: overlay){.crt-tab{overflow-y:overlay}}
`],encapsulation:2,changeDetection:0}),dn=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerTabContainer",overrideType:"crt.TabContainer"}),(0,p.__metadata)("design:paramtypes",[n.Injector])],dn);var ko=v(14340);const zl=["caption_input"];class Hn{constructor(e,t){this._injector=e,this._userInfo=t,this.resourceFinderService=this._injector.get(C.ResourceFinderService),this.captionChanged=new n.EventEmitter}_getLczResource(e){const t={};return e.forEach(a=>t[a.cultureName]=a.value),t}_applyCaptionValue(e){const t=this._userInfo.cultureInfo.sysCultureName||this._userInfo.defCultureInfo.sysCultureName,a=this._localizations.find(i=>i.cultureName===t);a?a.value=e:this._localizations=new C.LocalizableStringArray([...this._localizations,{cultureName:t,value:e}]),u.TabItem.setEditMode(this.tab,!1),this.captionChanged.emit(this._localizations)}ngAfterViewInit(){this.captionInput.nativeElement.focus()}ngOnInit(){this._localizations=this.resourceFinderService.findLocalizationFromResourceString(this.tab.caption,this.resourceContext);const e=this._getLczResource(this._localizations);this.value=this.resourceFinderService.findLocalizableValue(e)}onBlur(e){if(e=e.trim(),!e&&!this.tab.icon){u.TabItem.setEditMode(this.tab,!1);return}this._applyCaptionValue(e)}onKeyDown(e,t){e.stopPropagation();const a=e.key;if(a===ko.Key.Enter){if(t=t.trim(),!t&&!this.tab.icon)return;this._applyCaptionValue(t)}a===ko.Key.Escape&&u.TabItem.setEditMode(this.tab,!1)}onClick(e){e.preventDefault(),e.stopPropagation()}onMouseDown(e){e.stopPropagation()}}Hn.\u0275fac=function(e){return new(e||Hn)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(C.UserInfo))},Hn.\u0275cmp=n.\u0275\u0275defineComponent({type:Hn,selectors:[["crt-editable-tab-header"]],viewQuery:function(e,t){if(e&1&&n.\u0275\u0275viewQuery(zl,5),e&2){let a;n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.captionInput=a.first)}},inputs:{resourceContext:"resourceContext",value:"value",tab:"tab"},outputs:{captionChanged:"captionChanged"},decls:2,vars:1,consts:[[1,"tab-caption",3,"value","blur","keydown","click","mousedown"],["caption_input",""]],template:function(e,t){if(e&1){const a=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"input",0,1),n.\u0275\u0275listener("blur",function(){n.\u0275\u0275restoreView(a);const o=n.\u0275\u0275reference(1);return n.\u0275\u0275resetView(t.onBlur(o.value))})("keydown",function(o){n.\u0275\u0275restoreView(a);const s=n.\u0275\u0275reference(1);return n.\u0275\u0275resetView(t.onKeyDown(o,s.value))})("click",function(o){return t.onClick(o)})("mousedown",function(o){return t.onMouseDown(o)}),n.\u0275\u0275elementEnd()}e&2&&n.\u0275\u0275property("value",t.value)},styles:[`crt-editable-tab-header{display:flex}crt-editable-tab-header .tab-caption{width:170px;outline:none;border:none;text-transform:uppercase;font-size:13px;font-family:var(--crt-font-family)}crt-editable-tab-header .tab-action-remove-button .crt-button{background:transparent}
`],encapsulation:2});function kl(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-skeleton-loader",2),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("styles",t.skeletonStyles)}}function Bl(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div"),n.\u0275\u0275element(1,"div",18),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext(2).index;n.\u0275\u0275classMap("tab-header-part-wrap "+(t===0?"first-tab":""))}}function Ll(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-editable-tab-header",19),n.\u0275\u0275listener("captionChanged",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(4);return n.\u0275\u0275resetView(o.onCaptionChanged(i))}),n.\u0275\u0275elementEnd()}if(r&2){const t=n.\u0275\u0275nextContext(2).$implicit,a=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("resourceContext",a.resourceContext)("tab",t)}}function jl(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",27),n.\u0275\u0275element(1,"img",28),n.\u0275\u0275pipe(2,"bypassSecurityTrust"),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext(4).$implicit;n.\u0275\u0275property("title",t.hint||""),n.\u0275\u0275advance(1),n.\u0275\u0275property("src",n.\u0275\u0275pipeBind2(2,3,t.icon,"resourceUrl"),n.\u0275\u0275sanitizeUrl)("alt",t.hint)}}function Gl(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",29),n.\u0275\u0275element(1,"mat-icon",30),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext(4).$implicit,a=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("title",t.hint||""),n.\u0275\u0275advance(1),n.\u0275\u0275styleProp("color",a.isSelectedTab(t)?a.selectedTitleColor:a.titleColor),n.\u0275\u0275property("svgIcon",t.icon||"default-tab-icon")}}function $l(r,e){r&1&&n.\u0275\u0275element(0,"div",31)}function Ul(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0,23),n.\u0275\u0275template(1,jl,3,6,"div",24),n.\u0275\u0275template(2,Gl,2,4,"div",25),n.\u0275\u0275template(3,$l,1,0,"div",26),n.\u0275\u0275elementContainerEnd()),r&2){const t=n.\u0275\u0275nextContext(3).$implicit;n.\u0275\u0275property("ngSwitch",t.iconSource),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","url"),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",t.caption&&t.iconPosition!=="only-icon")}}function Hl(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-label",32),r&2){const t=n.\u0275\u0275nextContext(3).$implicit,a=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("labelColor",a.isSelectedTab(t)?a.selectedTitleColor:a.titleColor)("caption",t.title)}}function Wl(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",20),n.\u0275\u0275listener("click",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(2).index,s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.selectTab(i,o))}),n.\u0275\u0275template(1,Ul,4,3,"ng-container",21),n.\u0275\u0275template(2,Hl,1,2,"crt-label",22),n.\u0275\u0275elementEnd()}if(r&2){const t=n.\u0275\u0275nextContext(2).$implicit;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.icon||t.iconPosition&&t.iconPosition!=="only-text"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.iconPosition!=="only-icon")}}function Ql(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",33),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext(2).$implicit,o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.onRemoveClicked(i))}),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275elementEnd()}r&2&&n.\u0275\u0275property("disableRipple",!0)("title",n.\u0275\u0275pipeBind1(1,2,"Components.TabPanel.DeleteTab"))}function ql(r,e){r&1&&(n.\u0275\u0275elementStart(0,"div",34),n.\u0275\u0275element(1,"div",35),n.\u0275\u0275elementEnd())}function Kl(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275template(0,Bl,2,3,"div",11),n.\u0275\u0275elementStart(1,"div",12),n.\u0275\u0275listener("cdkDropListDropped",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(o.onTabDrop(i))})("dblclick",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext().$implicit,s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.onCaptionEdit(i,o))}),n.\u0275\u0275elementStart(2,"div",13),n.\u0275\u0275template(3,Ll,1,2,"crt-editable-tab-header",14),n.\u0275\u0275template(4,Wl,3,2,"ng-template",null,15,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(6,Ql,2,4,"crt-button",16),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(7,ql,2,0,"div",17)}if(r&2){const t=n.\u0275\u0275reference(5),a=n.\u0275\u0275nextContext(),i=a.$implicit,o=a.index;n.\u0275\u0275nextContext();const s=n.\u0275\u0275reference(1),c=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngIf",c.styleType==="fullyColored"&&c.isSelectedTab(i)),n.\u0275\u0275advance(1),n.\u0275\u0275property("id",c.name+"-list-"+o)("ngClass",i.headerClasses)("cdkDropListData",c.items)("cdkDropListConnectedTo",c.getAllTabs(o)),n.\u0275\u0275advance(1),n.\u0275\u0275property("cdkDragData",i)("cdkDragPreviewContainer",s),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",i.editMode)("ngIfElse",t),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngIf",c.isRemoveTabButtonVisible(i)),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",c.styleType==="fullyColored"&&c.isSelectedTab(i))}}function Jl(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",42),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext(5);return n.\u0275\u0275resetView(i.onTabClose())}),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275elementEnd()}r&2&&n.\u0275\u0275property("icon","close-button-icon")("title",n.\u0275\u0275pipeBind1(1,2,"TabPanel.CloseTabHint"))}function Zl(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"div",39),n.\u0275\u0275element(2,"crt-droppable-list",40),n.\u0275\u0275template(3,Jl,2,4,"crt-button",41),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()),r&2){const t=n.\u0275\u0275nextContext(2),a=t.$implicit,i=t.index,o=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(1),n.\u0275\u0275styleProp("background",o.bodyBackground),n.\u0275\u0275advance(1),n.\u0275\u0275property("containerId",a.name+i)("parentName",a.name)("items",o.activeTabTools)("useParentClasses",!1),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",o.allowToggleClose)}}function Xl(r,e){if(r&1&&n.\u0275\u0275elementContainer(0,43),r&2){const t=n.\u0275\u0275nextContext(2).$implicit;n.\u0275\u0275property("crtViewElement",t)}}function Yl(r,e){if(r&1&&(n.\u0275\u0275template(0,Zl,4,7,"ng-container",36),n.\u0275\u0275elementStart(1,"div",37),n.\u0275\u0275template(2,Xl,1,1,"ng-container",38),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext().$implicit,a=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngIf",a.isToggleMode()&&a.isSelectedTab(t)&&a.isToggleTabHeaderVisible),n.\u0275\u0275advance(1),n.\u0275\u0275styleProp("background",a.bodyBackground),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",a.isSelectedTab(t))}}function ed(r,e){r&1&&(n.\u0275\u0275elementStart(0,"mat-tab",8),n.\u0275\u0275template(1,Kl,8,11,"ng-template",9),n.\u0275\u0275template(2,Yl,3,4,"ng-template",10),n.\u0275\u0275elementEnd())}function td(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",null,3)(2,"mat-tab-group",4),n.\u0275\u0275template(3,ed,3,0,"mat-tab",5),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(4,"div",6),n.\u0275\u0275listener("mousedown",function(i){return i.stopPropagation()})("dblclick",function(i){return i.stopPropagation()}),n.\u0275\u0275elementStart(5,"crt-button",7),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.addNewTab())}),n.\u0275\u0275pipe(6,"translate"),n.\u0275\u0275elementEnd()()()}if(r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275classMap(t.styleClasses),n.\u0275\u0275property("@.disabled",t.isToggleMode()),n.\u0275\u0275advance(2),n.\u0275\u0275property("selectedIndex",t.selectedTabIndex)("disableRipple",!0),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.tabs)("ngForTrackBy",t.trackByNgFor),n.\u0275\u0275advance(2),n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(6,10,"Components.TabPanel.AddTab"))("disableRipple",!0)}}let mn=class extends u.CrtTabPanelComponent{constructor(e,t,a,i,o){const s=e.get(n.ElementRef);super(e,t,s),this._messageDialogProvider=a,this._translateService=i,this._resourceFinderService=o,this._destroyed$=new d.Subject,this._selectedTabInitialized=!1,this._selectedTabIndexInitialized=!1,this.itemPropertiesChanged=new n.EventEmitter,this.activeTabTools=[],this._tabs=[],this._designerSchemaService=this.injector.get(g.DesignerSchemaService),this._designerContainerService=this.injector.get(z),this._commandFactoryService=this.injector.get(g.DesignerCommandFactoryService),this._macrosHandlerService=this.injector.get(C.MacrosHandlerService),this._viewCommandExecutor=this.injector.get(g.ViewItemCommandExecutor),this._openPanelAnimationService=this.injector.get(dt),this._featureService.getFeatureState("TabContainerDeleteConfirmationDialog").subscribe({next:c=>{this._isConfirmationDialogEnabled=c}})}get selectedTab(){return super.selectedTab}set selectedTab(e){!this._selectedTabInitialized&&e&&!this.selectedTab&&(super.selectedTab=e,this._selectedTabInitialized=!0)}get selectedTabIndex(){return super.selectedTabIndex}set selectedTabIndex(e){this.selectedTabIndex!==e&&!this._selectedTabIndexInitialized&&(super.selectedTabIndex=e,this._selectedTabIndexInitialized=!0)}get tabs(){return this._tabs}set tabs(e){this._tabs=e}get resourceContext(){return this._resourceContext}get selectedTabItemName(){return this.selectedTabItem?.name}_findCurrentItems(e,t){if(e.name===t)return e.items;if(e.items)for(const a of e.items){const i=this._findCurrentItems(a,t);if(i)return i}return null}_findInnerItem(e,t){if(Array.isArray(e.items)&&e.items.some(a=>a.name===t))return e.name;if(e.items)for(const a of e.items){const i=this._findInnerItem(a,t);if(i)return i}return null}_getUpdateViewConfig(){return{viewConfig:{name:this.name,items:this.tabs}}}_insertTab(e){const t={containerName:this.name,index:this.selectedTabIndex+1,designerTool:{defaultConfig:{type:e.type,defaultPropertyValues:e,defaultLocalizableStrings:{caption:"Components.TabPanel.NewTabName"}}}};this._commandFactoryService.create("crt.AddViewItemCommand",t).pipe((0,l.mergeMap)(a=>a.execute()),(0,l.takeUntil)(this._destroyed$)).subscribe()}_hasInnerItem(e,t){return this.tabs.some(a=>a.name===e||a.items?.some(i=>i.name===e||i.name===t))||this.selectedTabItem?.items?.some(a=>Array.isArray(a.items)?a.items.some(i=>i.name===t):null)}_convertTabs(e){let t=e.filter(i=>i.type==="crt.TabContainer"),a=e.filter(i=>i.type!=="crt.TabContainer");return a.length>0&&(a=a.map(i=>{const o=u.TabItemFactory.getTabConfig(i.name,i.caption,[i],i.icon);return i.name=G.NameGenerator.generateUnique("GridContainer"),delete i.caption,delete i.defaultLocalizableStrings,o}),t=t.concat(a)),t}_getUpdateItemsConfig(e){return{applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.items"}],silentMode:!0,viewConfig:{items:e}}}_initTabItems(){const e=this.injector.get(S.VIEW_ELEMENT_CONFIG);if(!e)return;const t=e?.items??[],a=this._convertTabs(t);this.tabs=a.map(o=>{const s=(0,x.cloneDeep)(o);return u.TabItem.updateTabIconSource(s),s.title=this._getCaptionByResource(s.caption),s}),this.mode=e.mode;const i=e.name;t.filter(o=>o.type!=="crt.TabContainer").length!==0&&this.applyItemsChanges(i,a),this._shouldSelectFirstTabOnInit(e)&&this.setTabSelectedInternal(0,X.Edit,!1),this._updatePanelConfig(i,!0)}_nonValidSelectedTabIndexInConfig(e){const t=e<=this.notFoundTabIndex,a=e>=this.tabs.length;return t||a}_shouldSelectFirstTabOnInit(e){const t=e.selectedTabIndex===void 0,a=this._nonValidSelectedTabIndexInConfig(e.selectedTabIndex),i=!e.selectedTab&&(t||a);return this.tabs.length>0&&i}_getDeleteConfirmationCaption(e){const t=this._translateService.instant("Components.TabPanel.DeleteTabConfirmation");return(0,Ai.formatString)(t,e)}_updateViewConfig(e){this._commandFactoryService.create("crt.UpdateViewConfigCommand",e).pipe((0,l.mergeMap)(t=>t.execute()),(0,l.takeUntil)(this._destroyed$)).subscribe()}_getCaptionByResource(e){return this._resourceFinderService.findValueFromResource(e,this._resourceContext)||e}_setOpenPanelAnimationMode(){this._openPanelAnimationService.animationMode$.next("forward")}_updatePanelConfig(e,t=!1){const a={viewConfig:{name:e},silentMode:t};this.applyStateChanges(a)}_handleCommandExecutionResult(e){e.success&&this.detectChanges()}_setActiveTabTools(){const e=this._designerSchemaService.getViewConfigInfoByName(this.selectedTabItemName).viewConfig;this.activeTabTools=me(e?.tools,{selected:!1}),this.name&&this._updatePanelConfig(this.name,!0)}_subscribeOnSchemaLoaded(){this._designerSchemaService.schemaLoaded$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(e=>{this._resourceContext=e?.resources})}_subscribeSelectedChanged(){this._designerContainerService.selectedChanged$.pipe((0,l.filter)(({name:e})=>this.tabs.some(t=>t.name===e)),(0,l.takeUntil)(this._destroyed$)).subscribe({next:({name:e})=>{const t=this.tabs.findIndex(a=>a.name===e);this.selectedTabIndex!==t&&(this._selectedTabIndexInitialized=!0,this.setTabSelectedInternal(t))}})}_subscribeOnSchemaChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{viewConfig:e,parentName:t}})=>t===this.name||this.tabs.some(a=>a.name===t)||this._hasInnerItem(e.name,t)),(0,l.takeUntil)(this._destroyed$)).subscribe({next:e=>{const{schema:t,changes:a}=e,{viewConfig:i,operation:o,parentName:s,index:c,propertyName:m}=a;switch(this._resourceContext=t?.resources,o){case _.MetaItemDesignSettingChangesOperation.Insert:this.onAfterInsert(i,s,c,m);break;case _.MetaItemDesignSettingChangesOperation.MoveToContainer:this.onAfterMoveToContainer(i,s,c,t);break;case _.MetaItemDesignSettingChangesOperation.Remove:this.onAfterDelete(i,s);break;case _.MetaItemDesignSettingChangesOperation.Update:this.onAfterUpdate(i,s,t);break;case _.MetaItemDesignSettingChangesOperation.Rename:this.onAfterRename(e);break}this.detectChanges()}})}onAfterRename(e){const{viewConfig:t,parentName:a,index:i,propertyName:o}=e.changes;o==="items"&&a===this.name&&(this.tabs[i]={...this.tabs[i],name:t.name},this.setTabSelectedInternal(i))}_selectTabOnCanvas(e){e===X.Add&&this._setOpenPanelAnimationMode(),this._designerContainerService.select(this.selectedTabItemName,e)}_selectLastTab(){const e=this.tabs.length-1;this.setTabSelectedInternal(e,void 0,!1)}applyItemsChanges(e,t){const a=this._getUpdateItemsConfig(t);a.viewConfig.name=e||this.name,this._updateViewConfig(a)}setTabSelectedInternal(e,t,a=!0){super.setTabSelectedInternal(e),this._setActiveTabTools();const i={viewConfig:{name:this.selectedTabItemName}};this.applyStateChanges(i),a&&!this.isToggleMode()&&this._selectTabOnCanvas(t)}postSetTabSelectedAction(e){u.TabItem.updateTabClasses(e)}applyStateChanges(e){e=e||this._getUpdateViewConfig(),this._commandFactoryService.create("crt.UpdateViewConfigCommand",e).pipe((0,l.mergeMap)(t=>t.execute()),(0,l.takeUntil)(this._destroyed$)).subscribe(t=>{this._handleCommandExecutionResult(t)})}onAfterInsert(e,t,a,i){if(this.name===t){const y=(0,x.cloneDeep)(e);this.tabs.splice(a,0,y),this.items?.length===0&&(this.items=this.tabs),this.setTabSelectedInternal(a,X.Add),this._setOpenPanelAnimationMode(),this._designerContainerService.select(this.selectedTabItemName,X.Add),this._updatePanelConfig(this.name,!0);return}const o=this.tabs.find(y=>y.name===t);if(o&&i==="items"&&!o.items.some(y=>y.name===e.name)){o.items.splice(a,0,e);return}const m=this.tabs.find(y=>y.items.some(T=>T.name===t))?.items.find(y=>y.name===t),b=i||"items";m&&m[b]&&!m[b].some(y=>y.name===e.name)&&m[b].splice(a,0,e)}onAfterMoveToContainer(e,t,a,i){if(this.selectedTabItem&&(this.selectedTabItemName===t||this._findInnerItem(this.selectedTabItem,e.name)||this._findInnerItem(this.selectedTabItem,t))){const o=this._findCurrentItems({items:i.viewConfig},this.selectedTabItemName);this.selectedTabItem.items=o}this._updatePanelConfig(this.name,!0)}onAfterUpdate(e,t,a){if(this.selectedTabItem&&(this.selectedTabItemName===e.name||this.selectedTabItemName===t||this._findInnerItem(this.selectedTabItem,e.name)||this._findInnerItem(this.selectedTabItem,t))){const o=this._findCurrentItems({items:a.viewConfig},this.selectedTabItemName);this.selectedTabItem.items=o}const i=this.tabs.find(o=>o.name===e.name&&o.type==="crt.TabContainer");i&&(u.TabItem.setTabIcon(i,e.icon),u.TabItem.setTabIconPosition(i,e.iconPosition),i.title=this._getCaptionByResource(e.caption))}onAfterDelete(e,t){if(this.name===t){const i=this.tabs.findIndex(m=>m.name===e.name),o=this.selectedTabIndex===i;if(this.tabs=this.tabs.filter(m=>m.name!==e.name),this.tabs.length===0)return;if(o&&(i===this.tabs.length?this._selectLastTab():this.setTabSelectedInternal(i,void 0,!1),this._designerContainerService.select(t)),i<this.selectedTabIndex){const m=this.selectedTabIndex-1;this.setTabSelectedInternal(m,void 0,!1)}return}if(this.selectedTabItemName===t){this.selectedTabItem.items=this.selectedTabItem.items?.filter(i=>i.name!==e.name);return}const a=this.selectedTabItem.items.find(i=>i.name===t);a&&(a.items=a.items.filter(i=>i.name!==e.name)),this._updatePanelConfig(this.name,!0)}getItems(){return this.tabs}selectDefaultTab(){}getAllTabs(e){const t=[];for(let a=0;a<this.tabs.length;a++)a!==e&&t.push(this.name+"-list-"+a);return t}onTabDrop(e){const t=parseInt(e.previousContainer.id.replace(this.name+"-list-","")),a=parseInt(e.container.id.replace(this.name+"-list-",""));t!==a&&(this._designerSchemaService.moveToIndex(this.tabs[t].name,a),(0,O.moveItemInArray)(this.tabs,t,a),this.setTabSelectedInternal(a))}onRemoveClicked(e){this._isConfirmationDialogEnabled&&e.items?.length>0?this.getTabCaption(e).pipe((0,l.map)(t=>this._getDeleteConfirmationCaption(t)),(0,l.mergeMap)(t=>this._messageDialogProvider.open({data:{message:t,actions:[u.DEFAULT_DIALOG_ACTIONS.CANCEL,u.DEFAULT_DIALOG_ACTIONS.DELETE]}})),(0,l.filter)(t=>t===u.DEFAULT_DIALOG_ACTIONS.DELETE.key)).subscribe(()=>{this.onRemoveClickedProcessing(e)}):this.onRemoveClickedProcessing(e)}addNewTab(){const e=G.NameGenerator.generateUnique("TabContainer"),t=u.TabItemFactory.getTabContainerConfig(e);this._insertTab(t)}onRemoveClickedProcessing(e){this._viewCommandExecutor.remove(e).pipe((0,l.switchMap)(t=>t.execute())).subscribe()}ngOnInit(){super.ngOnInit(),this._subscribeOnSchemaLoaded(),this._subscribeOnSchemaChanged(),this._initTabItems(),this._subscribeSelectedChanged()}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}selectTab(e,t){super.selectTab(e,t),this.selectedTabIndex===t&&t>=0&&t<this.getItems().length&&this._selectTabOnCanvas()}onCaptionEdit(e,t){e.stopPropagation(),this.tabs.forEach(a=>u.TabItem.setEditMode(a,!1)),u.TabItem.setEditMode(t,!0)}onCaptionChanged(e){const t={name:this.selectedTabItem.name,changes:[{path:"itemConfig.caption",value:e}]};this._commandFactoryService.create("crt.ChangeViewItemCommand",t).pipe((0,l.mergeMap)(a=>a.execute()),(0,l.takeUntil)(this._destroyed$)).subscribe(a=>{this._handleCommandExecutionResult(a)})}onEditModeBlur(e){this.selectedTabItem.caption=e,u.TabItem.setEditMode(this.selectedTabItem,!1)}isRemoveTabButtonVisible(e){return this.tabs.length>1&&e.selected&&!e.editMode}getTabCaption(e){return this._macrosHandlerService.handleResourceMacros(e,this._resourceContext).pipe((0,l.map)(t=>t.caption),(0,l.takeUntil)(this._destroyed$))}onTabClose(){this._designerContainerService.hideElement(this.name)}isSelectedTab(e){return e.selected}};mn.\u0275fac=function(e){return new(e||mn)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(ri.DomSanitizer),n.\u0275\u0275directiveInject(u.MessageDialogProvider),n.\u0275\u0275directiveInject(D.TranslateService),n.\u0275\u0275directiveInject(C.ResourceFinderService))},mn.\u0275cmp=n.\u0275\u0275defineComponent({type:mn,selectors:[["crt-designer-tab-panel"]],outputs:{itemPropertiesChanged:"itemPropertiesChanged"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:3,vars:2,consts:[[3,"styles",4,"ngIf","ngIfElse"],["tabs_template",""],[3,"styles"],["tabsContainer",""],["data-qa","tabs","animationDuration","0ms",1,"tab-group",3,"selectedIndex","disableRipple"],["data-qa","tab",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-actions-container",3,"mousedown","dblclick"],["displayType","text","icon","tab-action-add-icon",1,"tab-action-add-button",3,"title","disableRipple","clicked"],["data-qa","tab"],["mat-tab-label",""],["matTabContent",""],[3,"class",4,"ngIf"],["cdkDropList","","cdkDropListLockAxis","x","cdkDropListOrientation","horizontal",3,"id","ngClass","cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped","dblclick"],["cdkDrag","","cdkDragRootElement",".mat-tab-label",1,"tab-header-content-wrap",3,"cdkDragData","cdkDragPreviewContainer"],[3,"resourceContext","tab","captionChanged",4,"ngIf","ngIfElse"],["readonly_header",""],["class","tab-action-remove-button","icon","tab-action-remove-icon",3,"disableRipple","title","clicked",4,"ngIf"],["class","tab-header-part-wrap",4,"ngIf"],[1,"pre-tab-header","tab-header-part"],[3,"resourceContext","tab","captionChanged"],[1,"tab-header-content",3,"click"],[3,"ngSwitch",4,"ngIf"],["class","tab-label","data-qa","tab-label","labelType","headline-4","labelEllipsis","true",3,"labelColor","caption",4,"ngIf"],[3,"ngSwitch"],["class","tab-icon url",3,"title",4,"ngSwitchCase"],["class","tab-icon system",3,"title",4,"ngSwitchDefault"],["class","tab-icon-space",4,"ngIf"],[1,"tab-icon","url",3,"title"],[3,"src","alt"],[1,"tab-icon","system",3,"title"],[3,"svgIcon"],[1,"tab-icon-space"],["data-qa","tab-label","labelType","headline-4","labelEllipsis","true",1,"tab-label",3,"labelColor","caption"],["icon","tab-action-remove-icon",1,"tab-action-remove-button",3,"disableRipple","title","clicked"],[1,"tab-header-part-wrap"],[1,"post-tab-header","tab-header-part"],[4,"ngIf"],[1,"tab-body"],["crtViewModel","",3,"crtViewElement",4,"ngIf"],[1,"tab-container-header"],["propertyName","tools",3,"containerId","parentName","items","useParentClasses"],["class","close-button","size","medium","iconPosition","only-icon",3,"icon","title","clicked",4,"ngIf"],["size","medium","iconPosition","only-icon",1,"close-button",3,"icon","title","clicked"],["crtViewModel","",3,"crtViewElement"]],template:function(e,t){if(e&1&&(n.\u0275\u0275template(0,kl,1,1,"crt-skeleton-loader",0),n.\u0275\u0275template(1,td,7,12,"ng-template",null,1,n.\u0275\u0275templateRefExtractor)),e&2){const a=n.\u0275\u0275reference(2);n.\u0275\u0275property("ngIf",t.loading)("ngIfElse",a)}},dependencies:[f.NgClass,f.NgForOf,f.NgIf,f.NgSwitch,f.NgSwitchCase,f.NgSwitchDefault,u.CrtButtonComponent,u.CrtLabelComponent,w.SkeletonLoaderComponent,O.CdkDropList,O.CdkDrag,E.MatIcon,Qa.MatLegacyTabGroup,Qa.MatLegacyTabLabel,Qa.MatLegacyTab,Qa.MatLegacyTabContent,S.ViewModelDirective,S.ViewElementDirective,we,Hn,D.TranslatePipe],styles:[`crt-tab-panel,crt-tab-panel-static,crt-tab-panel-container,crt-toggle-container,crt-designer-tab-panel{display:flex;flex-direction:column;min-height:0;min-width:0;overflow:auto;position:relative}@supports (overflow: overlay){crt-tab-panel,crt-tab-panel-static,crt-tab-panel-container,crt-toggle-container,crt-designer-tab-panel{overflow:overlay}}crt-tab-panel .crt-tab-panel,crt-tab-panel-static .crt-tab-panel,crt-tab-panel-container .crt-tab-panel,crt-toggle-container .crt-tab-panel,crt-designer-tab-panel .crt-tab-panel{overflow:hidden;box-sizing:border-box;border-radius:8px;-webkit-border-radius:8px}crt-tab-panel.stretch .crt-tab-panel,crt-tab-panel.stretch .crt-toggle-container,crt-tab-panel-static.stretch .crt-tab-panel,crt-tab-panel-static.stretch .crt-toggle-container,crt-tab-panel-container.stretch .crt-tab-panel,crt-tab-panel-container.stretch .crt-toggle-container,crt-toggle-container.stretch .crt-tab-panel,crt-toggle-container.stretch .crt-toggle-container,crt-designer-tab-panel.stretch .crt-tab-panel,crt-designer-tab-panel.stretch .crt-toggle-container{flex-grow:1}crt-tab-panel.stretch .crt-tab-panel .tab-body,crt-tab-panel.stretch .crt-toggle-container .tab-body,crt-tab-panel-static.stretch .crt-tab-panel .tab-body,crt-tab-panel-static.stretch .crt-toggle-container .tab-body,crt-tab-panel-container.stretch .crt-tab-panel .tab-body,crt-tab-panel-container.stretch .crt-toggle-container .tab-body,crt-toggle-container.stretch .crt-tab-panel .tab-body,crt-toggle-container.stretch .crt-toggle-container .tab-body,crt-designer-tab-panel.stretch .crt-tab-panel .tab-body,crt-designer-tab-panel.stretch .crt-toggle-container .tab-body{min-height:0;min-width:0;overflow:auto}@supports (overflow: overlay){crt-tab-panel.stretch .crt-tab-panel .tab-body,crt-tab-panel.stretch .crt-toggle-container .tab-body,crt-tab-panel-static.stretch .crt-tab-panel .tab-body,crt-tab-panel-static.stretch .crt-toggle-container .tab-body,crt-tab-panel-container.stretch .crt-tab-panel .tab-body,crt-tab-panel-container.stretch .crt-toggle-container .tab-body,crt-toggle-container.stretch .crt-tab-panel .tab-body,crt-toggle-container.stretch .crt-toggle-container .tab-body,crt-designer-tab-panel.stretch .crt-tab-panel .tab-body,crt-designer-tab-panel.stretch .crt-toggle-container .tab-body{overflow:overlay}}crt-tab-panel .crt-tab-panel .mat-tab-header,crt-tab-panel crt-toggle-container-item .mat-tab-header,crt-tab-panel-static .crt-tab-panel .mat-tab-header,crt-tab-panel-static crt-toggle-container-item .mat-tab-header,crt-tab-panel-container .crt-tab-panel .mat-tab-header,crt-tab-panel-container crt-toggle-container-item .mat-tab-header,crt-toggle-container .crt-tab-panel .mat-tab-header,crt-toggle-container crt-toggle-container-item .mat-tab-header,crt-designer-tab-panel .crt-tab-panel .mat-tab-header,crt-designer-tab-panel crt-toggle-container-item .mat-tab-header{padding-left:8px;padding-right:8px;box-sizing:border-box;height:40px}crt-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label:hover,crt-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label-active,crt-tab-panel crt-toggle-container-item .mat-tab-header .mat-tab-label:hover,crt-tab-panel crt-toggle-container-item .mat-tab-header .mat-tab-label-active,crt-tab-panel-static .crt-tab-panel .mat-tab-header .mat-tab-label:hover,crt-tab-panel-static .crt-tab-panel .mat-tab-header .mat-tab-label-active,crt-tab-panel-static crt-toggle-container-item .mat-tab-header .mat-tab-label:hover,crt-tab-panel-static crt-toggle-container-item .mat-tab-header .mat-tab-label-active,crt-tab-panel-container .crt-tab-panel .mat-tab-header .mat-tab-label:hover,crt-tab-panel-container .crt-tab-panel .mat-tab-header .mat-tab-label-active,crt-tab-panel-container crt-toggle-container-item .mat-tab-header .mat-tab-label:hover,crt-tab-panel-container crt-toggle-container-item .mat-tab-header .mat-tab-label-active,crt-toggle-container .crt-tab-panel .mat-tab-header .mat-tab-label:hover,crt-toggle-container .crt-tab-panel .mat-tab-header .mat-tab-label-active,crt-toggle-container crt-toggle-container-item .mat-tab-header .mat-tab-label:hover,crt-toggle-container crt-toggle-container-item .mat-tab-header .mat-tab-label-active,crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label:hover,crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label-active,crt-designer-tab-panel crt-toggle-container-item .mat-tab-header .mat-tab-label:hover,crt-designer-tab-panel crt-toggle-container-item .mat-tab-header .mat-tab-label-active{padding-bottom:0;border-bottom-width:2px;border-bottom-style:solid}crt-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-header-pagination,crt-tab-panel crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination,crt-tab-panel-static .crt-tab-panel .mat-tab-header .mat-tab-header-pagination,crt-tab-panel-static crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination,crt-tab-panel-container .crt-tab-panel .mat-tab-header .mat-tab-header-pagination,crt-tab-panel-container crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination,crt-toggle-container .crt-tab-panel .mat-tab-header .mat-tab-header-pagination,crt-toggle-container crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination,crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-header-pagination,crt-designer-tab-panel crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination{min-width:24px}crt-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron,crt-tab-panel crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron,crt-tab-panel-static .crt-tab-panel .mat-tab-header .mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron,crt-tab-panel-static crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron,crt-tab-panel-container .crt-tab-panel .mat-tab-header .mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron,crt-tab-panel-container crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron,crt-toggle-container .crt-tab-panel .mat-tab-header .mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron,crt-toggle-container crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron,crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron,crt-designer-tab-panel crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron{opacity:.38}crt-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-header-pagination-chevron,crt-tab-panel crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination-chevron,crt-tab-panel-static .crt-tab-panel .mat-tab-header .mat-tab-header-pagination-chevron,crt-tab-panel-static crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination-chevron,crt-tab-panel-container .crt-tab-panel .mat-tab-header .mat-tab-header-pagination-chevron,crt-tab-panel-container crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination-chevron,crt-toggle-container .crt-tab-panel .mat-tab-header .mat-tab-header-pagination-chevron,crt-toggle-container crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination-chevron,crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-header-pagination-chevron,crt-designer-tab-panel crt-toggle-container-item .mat-tab-header .mat-tab-header-pagination-chevron{border-width:1px 1px 0 0;height:6px;width:6px}crt-tab-panel .crt-tab-panel .mat-tab-header .mat-ink-bar,crt-tab-panel crt-toggle-container-item .mat-tab-header .mat-ink-bar,crt-tab-panel-static .crt-tab-panel .mat-tab-header .mat-ink-bar,crt-tab-panel-static crt-toggle-container-item .mat-tab-header .mat-ink-bar,crt-tab-panel-container .crt-tab-panel .mat-tab-header .mat-ink-bar,crt-tab-panel-container crt-toggle-container-item .mat-tab-header .mat-ink-bar,crt-toggle-container .crt-tab-panel .mat-tab-header .mat-ink-bar,crt-toggle-container crt-toggle-container-item .mat-tab-header .mat-ink-bar,crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-ink-bar,crt-designer-tab-panel crt-toggle-container-item .mat-tab-header .mat-ink-bar{display:none}crt-tab-panel .crt-tab-panel .mat-tab-label,crt-tab-panel .crt-tab-panel .mat-tab-label-active,crt-tab-panel crt-toggle-container-item .mat-tab-label,crt-tab-panel crt-toggle-container-item .mat-tab-label-active,crt-tab-panel-static .crt-tab-panel .mat-tab-label,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active,crt-tab-panel-static crt-toggle-container-item .mat-tab-label,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active,crt-tab-panel-container .crt-tab-panel .mat-tab-label,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active,crt-tab-panel-container crt-toggle-container-item .mat-tab-label,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active,crt-toggle-container .crt-tab-panel .mat-tab-label,crt-toggle-container .crt-tab-panel .mat-tab-label-active,crt-toggle-container crt-toggle-container-item .mat-tab-label,crt-toggle-container crt-toggle-container-item .mat-tab-label-active,crt-designer-tab-panel .crt-tab-panel .mat-tab-label,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active{min-width:0;max-width:280px;height:36px;box-sizing:border-box;padding:0 0 2px;margin:0 12px}crt-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content,crt-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content,crt-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content,crt-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-static .crt-tab-panel .mat-tab-label .mat-tab-label-content,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-static crt-toggle-container-item .mat-tab-label .mat-tab-label-content,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-container .crt-tab-panel .mat-tab-label .mat-tab-label-content,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content,crt-toggle-container .crt-tab-panel .mat-tab-label .mat-tab-label-content,crt-toggle-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content,crt-toggle-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content,crt-toggle-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content,crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content{justify-content:left;overflow:hidden;padding:2px 0 0}crt-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header,crt-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header,crt-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-static .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-static crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header,crt-toggle-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header,crt-toggle-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header,crt-toggle-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header,crt-toggle-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header,crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header{display:flex;align-items:center;overflow:hidden;padding:16px 4px 14px}crt-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel-static .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel-static .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel-static crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel-static crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content,crt-toggle-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-toggle-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content,crt-toggle-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-toggle-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content,crt-toggle-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-toggle-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content,crt-toggle-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-toggle-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content,crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-header-content,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content{align-items:center}crt-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel-static .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel-static crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon,crt-toggle-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon,crt-toggle-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon,crt-toggle-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon,crt-toggle-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon,crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon{display:flex;align-items:center;width:16px;height:100%;pointer-events:none}crt-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel-static .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel-static .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel-static crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel-static crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.url img,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.url img,crt-toggle-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-toggle-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.url img,crt-toggle-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-toggle-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.url img,crt-toggle-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-toggle-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.url img,crt-toggle-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-toggle-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.url img,crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.url img,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.url img,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon.url img,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.system mat-icon,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon.url img{width:16px;height:16px}crt-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel-static .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel-static crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon-space,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon-space,crt-toggle-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon-space,crt-toggle-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon-space,crt-toggle-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon-space,crt-toggle-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon-space,crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-icon-space,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon-space,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-icon-space,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-icon-space{display:block;width:8px}crt-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-label,crt-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label,crt-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-label,crt-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label,crt-tab-panel-static .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-label,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label,crt-tab-panel-static crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-label,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label,crt-tab-panel-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-label,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label,crt-tab-panel-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-label,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label,crt-toggle-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-label,crt-toggle-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label,crt-toggle-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-label,crt-toggle-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label,crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-label,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-label,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label{overflow:hidden;pointer-events:none}crt-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel-static .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel-static .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel-static crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel-static crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-label .crt-label,crt-tab-panel-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label .crt-label,crt-toggle-container .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-label .crt-label,crt-toggle-container .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label .crt-label,crt-toggle-container crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-label .crt-label,crt-toggle-container crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label .crt-label,crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header .tab-label .crt-label,crt-designer-tab-panel .crt-tab-panel .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label .crt-label,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label .mat-tab-label-content .tab-header .tab-label .crt-label,crt-designer-tab-panel crt-toggle-container-item .mat-tab-label-active .mat-tab-label-content .tab-header .tab-label .crt-label{border-width:0}crt-tab-panel .crt-tab-panel .mat-tab-body-wrapper,crt-tab-panel crt-toggle-container-item .mat-tab-body-wrapper,crt-tab-panel-static .crt-tab-panel .mat-tab-body-wrapper,crt-tab-panel-static crt-toggle-container-item .mat-tab-body-wrapper,crt-tab-panel-container .crt-tab-panel .mat-tab-body-wrapper,crt-tab-panel-container crt-toggle-container-item .mat-tab-body-wrapper,crt-toggle-container .crt-tab-panel .mat-tab-body-wrapper,crt-toggle-container crt-toggle-container-item .mat-tab-body-wrapper,crt-designer-tab-panel .crt-tab-panel .mat-tab-body-wrapper,crt-designer-tab-panel crt-toggle-container-item .mat-tab-body-wrapper{height:100%;min-height:0}crt-tab-panel .crt-tab-panel>.mat-tab-group,crt-tab-panel crt-toggle-container-item>.mat-tab-group,crt-tab-panel-static .crt-tab-panel>.mat-tab-group,crt-tab-panel-static crt-toggle-container-item>.mat-tab-group,crt-tab-panel-container .crt-tab-panel>.mat-tab-group,crt-tab-panel-container crt-toggle-container-item>.mat-tab-group,crt-toggle-container .crt-tab-panel>.mat-tab-group,crt-toggle-container crt-toggle-container-item>.mat-tab-group,crt-designer-tab-panel .crt-tab-panel>.mat-tab-group,crt-designer-tab-panel crt-toggle-container-item>.mat-tab-group{height:100%;width:100%}crt-tab-panel .crt-tab-panel .tab-body,crt-tab-panel crt-toggle-container-item .tab-body,crt-tab-panel-static .crt-tab-panel .tab-body,crt-tab-panel-static crt-toggle-container-item .tab-body,crt-tab-panel-container .crt-tab-panel .tab-body,crt-tab-panel-container crt-toggle-container-item .tab-body,crt-toggle-container .crt-tab-panel .tab-body,crt-toggle-container crt-toggle-container-item .tab-body,crt-designer-tab-panel .crt-tab-panel .tab-body,crt-designer-tab-panel crt-toggle-container-item .tab-body{padding:5px 24px;height:calc(100% + 2px);box-sizing:content-box}crt-tab-panel .crt-tab-panel .tab-body>.stretch,crt-tab-panel crt-toggle-container-item .tab-body>.stretch,crt-tab-panel-static .crt-tab-panel .tab-body>.stretch,crt-tab-panel-static crt-toggle-container-item .tab-body>.stretch,crt-tab-panel-container .crt-tab-panel .tab-body>.stretch,crt-tab-panel-container crt-toggle-container-item .tab-body>.stretch,crt-toggle-container .crt-tab-panel .tab-body>.stretch,crt-toggle-container crt-toggle-container-item .tab-body>.stretch,crt-designer-tab-panel .crt-tab-panel .tab-body>.stretch,crt-designer-tab-panel crt-toggle-container-item .tab-body>.stretch{flex-grow:1}crt-tab-panel .crt-tab-panel.style-default>.tab-group>.mat-tab-header,crt-tab-panel .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel crt-toggle-container-item.style-default>.tab-group>.mat-tab-header,crt-tab-panel crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-static .crt-tab-panel.style-default>.tab-group>.mat-tab-header,crt-tab-panel-static .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-static crt-toggle-container-item.style-default>.tab-group>.mat-tab-header,crt-tab-panel-static crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-container .crt-tab-panel.style-default>.tab-group>.mat-tab-header,crt-tab-panel-container .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-container crt-toggle-container-item.style-default>.tab-group>.mat-tab-header,crt-tab-panel-container crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-toggle-container .crt-tab-panel.style-default>.tab-group>.mat-tab-header,crt-toggle-container .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-toggle-container crt-toggle-container-item.style-default>.tab-group>.mat-tab-header,crt-toggle-container crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-designer-tab-panel .crt-tab-panel.style-default>.tab-group>.mat-tab-header,crt-designer-tab-panel .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-designer-tab-panel crt-toggle-container-item.style-default>.tab-group>.mat-tab-header,crt-designer-tab-panel crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header{border-top-width:3px;border-top-style:solid}crt-tab-panel .crt-tab-panel.style-default>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel .crt-tab-panel.style-default>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel crt-toggle-container-item.style-default>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel crt-toggle-container-item.style-default>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-static .crt-tab-panel.style-default>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-static .crt-tab-panel.style-default>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-static .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-static .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-static crt-toggle-container-item.style-default>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-static crt-toggle-container-item.style-default>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-static crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-static crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-container .crt-tab-panel.style-default>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-container .crt-tab-panel.style-default>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-container .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-container .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-container crt-toggle-container-item.style-default>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-container crt-toggle-container-item.style-default>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-container crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-container crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-toggle-container .crt-tab-panel.style-default>.tab-group>.mat-tab-header .mat-tab-label,crt-toggle-container .crt-tab-panel.style-default>.tab-group>.mat-tab-header .mat-tab-label-active,crt-toggle-container .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-toggle-container .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-toggle-container crt-toggle-container-item.style-default>.tab-group>.mat-tab-header .mat-tab-label,crt-toggle-container crt-toggle-container-item.style-default>.tab-group>.mat-tab-header .mat-tab-label-active,crt-toggle-container crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-toggle-container crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-designer-tab-panel .crt-tab-panel.style-default>.tab-group>.mat-tab-header .mat-tab-label,crt-designer-tab-panel .crt-tab-panel.style-default>.tab-group>.mat-tab-header .mat-tab-label-active,crt-designer-tab-panel .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-designer-tab-panel .crt-tab-panel.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-designer-tab-panel crt-toggle-container-item.style-default>.tab-group>.mat-tab-header .mat-tab-label,crt-designer-tab-panel crt-toggle-container-item.style-default>.tab-group>.mat-tab-header .mat-tab-label-active,crt-designer-tab-panel crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-designer-tab-panel crt-toggle-container-item.style-default>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active{height:36px}crt-tab-panel .crt-tab-panel.style-partially-colored>.tab-group>.mat-tab-header,crt-tab-panel .crt-tab-panel.style-partially-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel crt-toggle-container-item.style-partially-colored>.tab-group>.mat-tab-header,crt-tab-panel crt-toggle-container-item.style-partially-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-static .crt-tab-panel.style-partially-colored>.tab-group>.mat-tab-header,crt-tab-panel-static .crt-tab-panel.style-partially-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-static crt-toggle-container-item.style-partially-colored>.tab-group>.mat-tab-header,crt-tab-panel-static crt-toggle-container-item.style-partially-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-container .crt-tab-panel.style-partially-colored>.tab-group>.mat-tab-header,crt-tab-panel-container .crt-tab-panel.style-partially-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-container crt-toggle-container-item.style-partially-colored>.tab-group>.mat-tab-header,crt-tab-panel-container crt-toggle-container-item.style-partially-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-toggle-container .crt-tab-panel.style-partially-colored>.tab-group>.mat-tab-header,crt-toggle-container .crt-tab-panel.style-partially-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-toggle-container crt-toggle-container-item.style-partially-colored>.tab-group>.mat-tab-header,crt-toggle-container crt-toggle-container-item.style-partially-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-designer-tab-panel .crt-tab-panel.style-partially-colored>.tab-group>.mat-tab-header,crt-designer-tab-panel .crt-tab-panel.style-partially-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-designer-tab-panel crt-toggle-container-item.style-partially-colored>.tab-group>.mat-tab-header,crt-designer-tab-panel crt-toggle-container-item.style-partially-colored>crt-tab-panel-header>.tab-group>.mat-tab-header{box-sizing:border-box;border-top-width:3px;border-top-style:solid;border-top-left-radius:8px;border-top-right-radius:8px}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header{padding:0;border-bottom:none;box-sizing:border-box}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label{padding:0;height:40px}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label:hover,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label:hover{border:none}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label .mat-tab-label-content{height:40px;box-sizing:border-box}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active{margin:0;padding:0;border-bottom:none}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content{padding:0}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap{height:40px;width:8px}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part{width:100%;height:100%}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header{border-radius:0 0 8px}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header{border-radius:0 0 0 8px}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header{margin-top:3px;padding:8px 16px;height:37px;box-sizing:border-box;border-radius:5px 5px 0 0}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before{padding:0}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron{margin-left:8px}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after{padding:0}crt-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel-static .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel-static .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel-static crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-toggle-container .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-toggle-container .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-toggle-container crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-toggle-container crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-designer-tab-panel .crt-tab-panel.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-designer-tab-panel crt-toggle-container-item.style-fully-colored>crt-tab-panel-header>.tab-group>.mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{margin-left:-8px}crt-tab-panel .crt-tab-panel.mode-toggle>.mat-tab-group>.mat-tab-header,crt-tab-panel crt-toggle-container-item.mode-toggle>.mat-tab-group>.mat-tab-header,crt-tab-panel-static .crt-tab-panel.mode-toggle>.mat-tab-group>.mat-tab-header,crt-tab-panel-static crt-toggle-container-item.mode-toggle>.mat-tab-group>.mat-tab-header,crt-tab-panel-container .crt-tab-panel.mode-toggle>.mat-tab-group>.mat-tab-header,crt-tab-panel-container crt-toggle-container-item.mode-toggle>.mat-tab-group>.mat-tab-header,crt-toggle-container .crt-tab-panel.mode-toggle>.mat-tab-group>.mat-tab-header,crt-toggle-container crt-toggle-container-item.mode-toggle>.mat-tab-group>.mat-tab-header,crt-designer-tab-panel .crt-tab-panel.mode-toggle>.mat-tab-group>.mat-tab-header,crt-designer-tab-panel crt-toggle-container-item.mode-toggle>.mat-tab-group>.mat-tab-header{display:none}crt-tab-panel .crt-tab-panel.mode-toggle .tab-container-header,crt-tab-panel crt-toggle-container-item.mode-toggle .tab-container-header,crt-tab-panel-static .crt-tab-panel.mode-toggle .tab-container-header,crt-tab-panel-static crt-toggle-container-item.mode-toggle .tab-container-header,crt-tab-panel-container .crt-tab-panel.mode-toggle .tab-container-header,crt-tab-panel-container crt-toggle-container-item.mode-toggle .tab-container-header,crt-toggle-container .crt-tab-panel.mode-toggle .tab-container-header,crt-toggle-container crt-toggle-container-item.mode-toggle .tab-container-header,crt-designer-tab-panel .crt-tab-panel.mode-toggle .tab-container-header,crt-designer-tab-panel crt-toggle-container-item.mode-toggle .tab-container-header{padding:12px 24px}crt-tab-panel .crt-tab-panel.mode-toggle .mat-tab-body-wrapper,crt-tab-panel crt-toggle-container-item.mode-toggle .mat-tab-body-wrapper,crt-tab-panel-static .crt-tab-panel.mode-toggle .mat-tab-body-wrapper,crt-tab-panel-static crt-toggle-container-item.mode-toggle .mat-tab-body-wrapper,crt-tab-panel-container .crt-tab-panel.mode-toggle .mat-tab-body-wrapper,crt-tab-panel-container crt-toggle-container-item.mode-toggle .mat-tab-body-wrapper,crt-toggle-container .crt-tab-panel.mode-toggle .mat-tab-body-wrapper,crt-toggle-container crt-toggle-container-item.mode-toggle .mat-tab-body-wrapper,crt-designer-tab-panel .crt-tab-panel.mode-toggle .mat-tab-body-wrapper,crt-designer-tab-panel crt-toggle-container-item.mode-toggle .mat-tab-body-wrapper{height:100%}crt-tab-panel .crt-tab-panel.mode-toggle .mat-tab-body-wrapper .mat-tab-body-content,crt-tab-panel crt-toggle-container-item.mode-toggle .mat-tab-body-wrapper .mat-tab-body-content,crt-tab-panel-static .crt-tab-panel.mode-toggle .mat-tab-body-wrapper .mat-tab-body-content,crt-tab-panel-static crt-toggle-container-item.mode-toggle .mat-tab-body-wrapper .mat-tab-body-content,crt-tab-panel-container .crt-tab-panel.mode-toggle .mat-tab-body-wrapper .mat-tab-body-content,crt-tab-panel-container crt-toggle-container-item.mode-toggle .mat-tab-body-wrapper .mat-tab-body-content,crt-toggle-container .crt-tab-panel.mode-toggle .mat-tab-body-wrapper .mat-tab-body-content,crt-toggle-container crt-toggle-container-item.mode-toggle .mat-tab-body-wrapper .mat-tab-body-content,crt-designer-tab-panel .crt-tab-panel.mode-toggle .mat-tab-body-wrapper .mat-tab-body-content,crt-designer-tab-panel crt-toggle-container-item.mode-toggle .mat-tab-body-wrapper .mat-tab-body-content{display:flex;flex-direction:column}crt-tab-panel .crt-tab-panel .tab-container-header,crt-tab-panel .crt-tab-panel .toggle-container-header,crt-tab-panel crt-toggle-container-item .tab-container-header,crt-tab-panel crt-toggle-container-item .toggle-container-header,crt-tab-panel-static .crt-tab-panel .tab-container-header,crt-tab-panel-static .crt-tab-panel .toggle-container-header,crt-tab-panel-static crt-toggle-container-item .tab-container-header,crt-tab-panel-static crt-toggle-container-item .toggle-container-header,crt-tab-panel-container .crt-tab-panel .tab-container-header,crt-tab-panel-container .crt-tab-panel .toggle-container-header,crt-tab-panel-container crt-toggle-container-item .tab-container-header,crt-tab-panel-container crt-toggle-container-item .toggle-container-header,crt-toggle-container .crt-tab-panel .tab-container-header,crt-toggle-container .crt-tab-panel .toggle-container-header,crt-toggle-container crt-toggle-container-item .tab-container-header,crt-toggle-container crt-toggle-container-item .toggle-container-header,crt-designer-tab-panel .crt-tab-panel .tab-container-header,crt-designer-tab-panel .crt-tab-panel .toggle-container-header,crt-designer-tab-panel crt-toggle-container-item .tab-container-header,crt-designer-tab-panel crt-toggle-container-item .toggle-container-header{display:flex;justify-content:space-between;padding:8px 0;align-items:center}crt-tab-panel .crt-tab-panel .tab-container-header .tab-tools,crt-tab-panel .crt-tab-panel .toggle-container-header .tab-tools,crt-tab-panel crt-toggle-container-item .tab-container-header .tab-tools,crt-tab-panel crt-toggle-container-item .toggle-container-header .tab-tools,crt-tab-panel-static .crt-tab-panel .tab-container-header .tab-tools,crt-tab-panel-static .crt-tab-panel .toggle-container-header .tab-tools,crt-tab-panel-static crt-toggle-container-item .tab-container-header .tab-tools,crt-tab-panel-static crt-toggle-container-item .toggle-container-header .tab-tools,crt-tab-panel-container .crt-tab-panel .tab-container-header .tab-tools,crt-tab-panel-container .crt-tab-panel .toggle-container-header .tab-tools,crt-tab-panel-container crt-toggle-container-item .tab-container-header .tab-tools,crt-tab-panel-container crt-toggle-container-item .toggle-container-header .tab-tools,crt-toggle-container .crt-tab-panel .tab-container-header .tab-tools,crt-toggle-container .crt-tab-panel .toggle-container-header .tab-tools,crt-toggle-container crt-toggle-container-item .tab-container-header .tab-tools,crt-toggle-container crt-toggle-container-item .toggle-container-header .tab-tools,crt-designer-tab-panel .crt-tab-panel .tab-container-header .tab-tools,crt-designer-tab-panel .crt-tab-panel .toggle-container-header .tab-tools,crt-designer-tab-panel crt-toggle-container-item .tab-container-header .tab-tools,crt-designer-tab-panel crt-toggle-container-item .toggle-container-header .tab-tools{width:100%}crt-tab-panel .crt-tab-panel .tab-container-header .tab-tools>ng-component,crt-tab-panel .crt-tab-panel .toggle-container-header .tab-tools>ng-component,crt-tab-panel crt-toggle-container-item .tab-container-header .tab-tools>ng-component,crt-tab-panel crt-toggle-container-item .toggle-container-header .tab-tools>ng-component,crt-tab-panel-static .crt-tab-panel .tab-container-header .tab-tools>ng-component,crt-tab-panel-static .crt-tab-panel .toggle-container-header .tab-tools>ng-component,crt-tab-panel-static crt-toggle-container-item .tab-container-header .tab-tools>ng-component,crt-tab-panel-static crt-toggle-container-item .toggle-container-header .tab-tools>ng-component,crt-tab-panel-container .crt-tab-panel .tab-container-header .tab-tools>ng-component,crt-tab-panel-container .crt-tab-panel .toggle-container-header .tab-tools>ng-component,crt-tab-panel-container crt-toggle-container-item .tab-container-header .tab-tools>ng-component,crt-tab-panel-container crt-toggle-container-item .toggle-container-header .tab-tools>ng-component,crt-toggle-container .crt-tab-panel .tab-container-header .tab-tools>ng-component,crt-toggle-container .crt-tab-panel .toggle-container-header .tab-tools>ng-component,crt-toggle-container crt-toggle-container-item .tab-container-header .tab-tools>ng-component,crt-toggle-container crt-toggle-container-item .toggle-container-header .tab-tools>ng-component,crt-designer-tab-panel .crt-tab-panel .tab-container-header .tab-tools>ng-component,crt-designer-tab-panel .crt-tab-panel .toggle-container-header .tab-tools>ng-component,crt-designer-tab-panel crt-toggle-container-item .tab-container-header .tab-tools>ng-component,crt-designer-tab-panel crt-toggle-container-item .toggle-container-header .tab-tools>ng-component{display:flex;flex-direction:column}crt-tab-panel .crt-tab-panel .tab-container-header .close-button,crt-tab-panel .crt-tab-panel .toggle-container-header .close-button,crt-tab-panel crt-toggle-container-item .tab-container-header .close-button,crt-tab-panel crt-toggle-container-item .toggle-container-header .close-button,crt-tab-panel-static .crt-tab-panel .tab-container-header .close-button,crt-tab-panel-static .crt-tab-panel .toggle-container-header .close-button,crt-tab-panel-static crt-toggle-container-item .tab-container-header .close-button,crt-tab-panel-static crt-toggle-container-item .toggle-container-header .close-button,crt-tab-panel-container .crt-tab-panel .tab-container-header .close-button,crt-tab-panel-container .crt-tab-panel .toggle-container-header .close-button,crt-tab-panel-container crt-toggle-container-item .tab-container-header .close-button,crt-tab-panel-container crt-toggle-container-item .toggle-container-header .close-button,crt-toggle-container .crt-tab-panel .tab-container-header .close-button,crt-toggle-container .crt-tab-panel .toggle-container-header .close-button,crt-toggle-container crt-toggle-container-item .tab-container-header .close-button,crt-toggle-container crt-toggle-container-item .toggle-container-header .close-button,crt-designer-tab-panel .crt-tab-panel .tab-container-header .close-button,crt-designer-tab-panel .crt-tab-panel .toggle-container-header .close-button,crt-designer-tab-panel crt-toggle-container-item .tab-container-header .close-button,crt-designer-tab-panel crt-toggle-container-item .toggle-container-header .close-button{margin-left:auto}crt-tab-panel .crt-tab-panel .toggle-container-header,crt-tab-panel crt-toggle-container-item .toggle-container-header,crt-tab-panel-static .crt-tab-panel .toggle-container-header,crt-tab-panel-static crt-toggle-container-item .toggle-container-header,crt-tab-panel-container .crt-tab-panel .toggle-container-header,crt-tab-panel-container crt-toggle-container-item .toggle-container-header,crt-toggle-container .crt-tab-panel .toggle-container-header,crt-toggle-container crt-toggle-container-item .toggle-container-header,crt-designer-tab-panel .crt-tab-panel .toggle-container-header,crt-designer-tab-panel crt-toggle-container-item .toggle-container-header{padding:12px 24px}crt-tab-panel[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel-static[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-tab-panel-container[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-toggle-container[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header,crt-designer-tab-panel[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.pre-tab-header{border-radius:0 0 0 8px}crt-tab-panel[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel-static[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-tab-panel-container[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-toggle-container[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header,crt-designer-tab-panel[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header-part-wrap .tab-header-part.post-tab-header{border-radius:0 0 8px}crt-tab-panel[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel-static[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-tab-panel-container[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-toggle-container[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,crt-designer-tab-panel[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron{margin-left:0}crt-tab-panel[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel-static[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-tab-panel-container[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-toggle-container[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron,crt-designer-tab-panel[dir=rtl] .crt-tab-panel.style-fully-colored .mat-tab-header .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{margin-left:8px}crt-tab-panel[dir=rtl] .tab-container-header .close-button,crt-tab-panel-static[dir=rtl] .tab-container-header .close-button,crt-tab-panel-container[dir=rtl] .tab-container-header .close-button,crt-toggle-container[dir=rtl] .tab-container-header .close-button,crt-designer-tab-panel[dir=rtl] .tab-container-header .close-button{margin-right:auto;margin-left:0}
`,`@keyframes wait_fadein{0%{pointer-events:none}to{pointer-events:auto}}crt-designer-tab-panel.stretch{height:100%}crt-designer-tab-panel .crt-tab-panel{display:flex;flex-direction:row}crt-designer-tab-panel .crt-tab-panel .mat-tab-header{height:40px;padding-right:0;border-bottom-color:var(--crt-palette-border-500);border-bottom-width:1px;border-bottom-style:solid}crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label .mat-tab-label-content{padding:0}crt-designer-tab-panel .crt-tab-panel .mat-tab-header .cdk-drag-placeholder.mat-tab-label-active .mat-tab-label-content,crt-designer-tab-panel .crt-tab-panel .mat-tab-header .cdk-drag-placeholder.mat-tab-label .mat-tab-label-content:hover{border-bottom-width:0}crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label.cdk-drag-placeholder{background-color:#9ac1eb;cursor:move;border-bottom-width:0;transition:transform .25s cubic-bezier(0,0,.2,1)}crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label.cdk-drag-placeholder .tab-header{opacity:0}crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label.cdk-drag-placeholder .crt-label label{cursor:move}crt-designer-tab-panel .crt-tab-panel .tab-group{display:flex;flex-direction:column;min-width:calc(100% - 40px);max-width:calc(100% - 40px)}crt-designer-tab-panel .crt-tab-panel .tab-container-header{padding:8px 0 16px}crt-designer-tab-panel .crt-tab-panel .tab-container-header>crt-droppable-list{width:100%}crt-designer-tab-panel .crt-tab-panel .tab-container-header>crt-droppable-list>.cdk-drop-list{width:calc(100% - 8px);min-height:24px}crt-designer-tab-panel .crt-tab-panel .tab-body{--width: calc(100% - var(--scroll-width));--scroll-width: 8px;width:var(--width);min-width:var(--width);max-width:var(--width)}crt-designer-tab-panel .crt-tab-panel .tab-actions-container{box-sizing:border-box;height:40px;min-width:40px;text-align:right;border-top-right-radius:8px;padding-right:16px;border-bottom-width:1px;border-bottom-style:solid}crt-designer-tab-panel .crt-tab-panel .tab-action-add-button{margin:4px 0}crt-designer-tab-panel .crt-tab-panel .tab-action-add-button .crt-button .mat-icon{height:16px;width:16px;vertical-align:middle}crt-designer-tab-panel .crt-tab-panel .tab-action-add-button .crt-button .mat-icon #tab-action-add{display:block}crt-designer-tab-panel .crt-tab-panel .tab-action-remove-button .crt-button{background:transparent}crt-designer-tab-panel .crt-tab-panel .tab-header .tab-header-content-wrap,crt-designer-tab-panel .crt-tab-panel .tab-header .tab-header-content{display:flex;width:100%}crt-designer-tab-panel .crt-tab-panel .tab-header .tab-header-content-wrap .tab-icon-space,crt-designer-tab-panel .crt-tab-panel .tab-header .tab-header-content .tab-icon-space{display:block;width:8px}crt-designer-tab-panel .crt-tab-panel .tab-header .tab-header-content{padding:12px 4px 10px}crt-designer-tab-panel .crt-tab-panel .mat-tab-label .mat-tab-label-content .tab-header{padding:5px 0}crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header.tab-editing{border-bottom-width:1px;border-bottom-style:solid}crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content-wrap,crt-designer-tab-panel .crt-tab-panel .mat-tab-header .mat-tab-label-active .mat-tab-label-content .tab-header .tab-header-content{max-width:220px}crt-designer-tab-panel .crt-tab-panel .mat-tab-label .tab-action-remove-button{animation:1s wait_fadein;height:18px;margin-left:8px}crt-designer-tab-panel .crt-tab-panel .mat-tab-label .tab-action-remove-button .crt-button{max-height:18px;padding:0}crt-designer-tab-panel .crt-tab-panel .mat-tab-label .tab-action-remove-button .mat-icon{width:16px;height:16px}crt-designer-tab-panel .crt-tab-panel .cdk-drag-preview.mat-tab-label{opacity:.7;padding:0}crt-designer-tab-panel .crt-tab-panel .cdk-drag-preview.mat-tab-label .mat-tab-label-content{padding:0}crt-designer-tab-panel .crt-tab-panel .cdk-drag-preview.mat-tab-label .tab-header{padding:0 8px}crt-designer-tab-panel .crt-tab-panel .cdk-drag-preview.mat-tab-label .tab-header crt-label{text-transform:uppercase;text-overflow:ellipsis}crt-designer-tab-panel .crt-tab-panel .cdk-drag-preview.mat-tab-label .tab-header crt-label .crt-label{display:inline-grid}crt-designer-tab-panel .crt-tab-panel .cdk-drag-preview.mat-tab-label .tab-header .tab-label,crt-designer-tab-panel .crt-tab-panel .cdk-drag-preview.mat-tab-label .tab-header .tab-icon{padding:8px 0}crt-designer-tab-panel .crt-tab-panel .cdk-drag-preview.mat-tab-label .tab-action-remove-button{display:none}crt-designer-tab-panel .crt-tab-panel.style-default .mat-tab-header .mat-tab-label,crt-designer-tab-panel .crt-tab-panel.style-default .mat-tab-header .mat-tab-label-active{height:36px}crt-designer-tab-panel .crt-tab-panel.style-partially-colored>.tab-actions-container{border-top-style:solid;border-top-width:3px;border-top-right-radius:8px}crt-designer-tab-panel .crt-tab-panel.style-partially-colored>.tab-group>.mat-tab-header{border-top-right-radius:0}crt-designer-tab-panel .crt-tab-panel.style-partially-colored>.tab-group>.mat-tab-header .mat-tab-label,crt-designer-tab-panel .crt-tab-panel.style-partially-colored>.tab-group>.mat-tab-header .mat-tab-label-active{height:36px}crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-actions-container{border-bottom:none}crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label.cdk-drag-placeholder{background-color:#9ac1eb;cursor:move;border-bottom-width:0;transition:transform .25s cubic-bezier(0,0,.2,1)}crt-designer-tab-panel .crt-tab-panel.style-fully-colored>.tab-group>.mat-tab-header .mat-tab-label.cdk-drag-placeholder .mat-tab-label-content{opacity:0}crt-designer-tab-panel .crt-tab-panel.mode-toggle>.tab-group{min-width:100%;max-width:100%}crt-designer-tab-panel .crt-tab-panel.mode-toggle>.tab-group .mat-tab-body-wrapper .tab-body{width:100%;min-width:100%;max-width:100%;box-sizing:border-box}crt-designer-tab-panel .crt-tab-panel.mode-toggle .mode-tab>.tab-group>.mat-tab-body-wrapper>.mat-tab-body>.mat-tab-body-content>.tab-body{min-width:calc(100% + 40px);max-width:calc(100% + 40px)}crt-designer-tab-panel .crt-tab-panel.mode-toggle>.tab-actions-container{display:none}.drag-active.resize-active .mat-tab-header .mat-ink-bar{visibility:hidden!important}
`],encapsulation:2,changeDetection:0}),mn=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerTabPanel",overrideType:"crt.TabPanel"}),(0,p.__metadata)("design:paramtypes",[n.Injector,ri.DomSanitizer,u.MessageDialogProvider,D.TranslateService,C.ResourceFinderService])],mn);let Ee=class{constructor(e){this._materialIconsRegistrator=e,this._materialIconsRegistrator.addIcons([{name:"tab-action-add-icon",icon:v(70494)},{name:"tab-action-remove-icon",icon:v(42702)}])}};Ee.\u0275fac=function(e){return new(e||Ee)(n.\u0275\u0275inject(w.MaterialIconsRegistrator))},Ee.\u0275mod=n.\u0275\u0275defineNgModule({type:Ee}),Ee.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,u.CrtButtonModule,u.CrtLabelModule,u.CrtInputModule,w.CrtSkeletonLoaderModule,u.CrtTabPanelModule,O.DragDropModule,P.LocalizableTextModule,E.MatIconModule,Qa.MatLegacyTabsModule,en.MatLegacyTooltipModule,w.ResizableModule,D.TranslateModule,S.ViewModule,q]}),Ee=(0,p.__decorate)([(0,h.CrtModule)({includes:[u.CrtTabPanelModule],viewElements:[u.CrtTabPanelComponent],designTimeViewElements:[mn,dn]}),(0,p.__metadata)("design:paramtypes",[w.MaterialIconsRegistrator])],Ee),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Ee,{declarations:[mn,dn,Hn,C.ResourceMacrosHandlerPipe],imports:[f.CommonModule,u.CrtButtonModule,u.CrtLabelModule,u.CrtInputModule,w.CrtSkeletonLoaderModule,u.CrtTabPanelModule,O.DragDropModule,P.LocalizableTextModule,E.MatIconModule,Qa.MatLegacyTabsModule,en.MatLegacyTooltipModule,w.ResizableModule,D.TranslateModule,S.ViewModule,q],exports:[mn,Hn]})}();var Dt=v(30738);function nd(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-base-input-width-holder",10),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("label",t.label)("minWidth",180)}}function ad(r,e){if(r&1&&n.\u0275\u0275element(0,"mat-icon",11),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("crtTooltip",t.tooltip)}}const id=function(r){return{"crt-input-required":r}};let Mt=class extends u.CrtInputComponent{constructor(e,t){super(e,t),this._destroyed$=new d.Subject}ngOnDestroy(){super.ngOnDestroy(),this._destroyed$.next(),this._destroyed$.complete()}};Mt.\u0275fac=function(e){return new(e||Mt)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(n.ChangeDetectorRef))},Mt.\u0275cmp=n.\u0275\u0275defineComponent({type:Mt,selectors:[["crt-designer-rich-text-editor"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:11,vars:9,consts:[[3,"label","minWidth",4,"ngIf"],[1,"crt-designer-base-input-container","crt-base-input-container"],["crtResizable","",1,"crt-input",3,"ngClass","crtResizableDisabled","resized"],[1,"crt-input-label-container"],[1,"crt-input-label",3,"ngClass"],["floatLabel","never",1,"crt-input-control-container","designer-rich-text-editor-container"],[1,"crt-input-control"],["matInput","",3,"placeholder"],["matSuffix","","svgIcon","toggle-default"],["matSuffix","","svgIcon","info-icon","class","tooltip-icon",3,"crtTooltip",4,"ngIf"],[3,"label","minWidth"],["matSuffix","","svgIcon","info-icon",1,"tooltip-icon",3,"crtTooltip"]],template:function(e,t){e&1&&(n.\u0275\u0275template(0,nd,1,2,"crt-base-input-width-holder",0),n.\u0275\u0275elementStart(1,"div",1)(2,"div",2),n.\u0275\u0275listener("resized",function(i){return t.onResized(i)}),n.\u0275\u0275elementStart(3,"div",3)(4,"label",4),n.\u0275\u0275text(5),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(6,"mat-form-field",5)(7,"div",6),n.\u0275\u0275element(8,"input",7)(9,"mat-icon",8),n.\u0275\u0275template(10,ad,1,1,"mat-icon",9),n.\u0275\u0275elementEnd()()()()),e&2&&(n.\u0275\u0275property("ngIf",t.displayLabelPosition==="auto"),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngClass","label-position-"+t.displayLabelPosition+" appearance-"+t.appearance)("crtResizableDisabled",!t.isAutoLabelPosition||t.containerQueryMechanismAvailable),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(7,id,t.isShownRequiredMark)),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate(t.label),n.\u0275\u0275advance(3),n.\u0275\u0275property("placeholder",t.placeholder),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",t.tooltip))},dependencies:[f.NgClass,f.NgIf,w.ResizableDirective,se.MatLegacyFormField,se.MatLegacySuffix,Dt.MatLegacyInput,E.MatIcon,w.TooltipDirective,w.CrtBaseInputWidthHolderComponent],styles:["[_nghost-%COMP%]{height:52px}.crt-base-edit-input-responsible[_nghost-%COMP%]   .crt-base-input-container[_ngcontent-%COMP%]{container-type:inline-size}@container (width <= 320px){[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]{min-height:52px;flex-direction:column;padding-top:0}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:8px}[_nghost-%COMP%]   .crt-input.label-position-auto.appearance-outline[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-bottom:8px}}@container (width > 320px){[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]{min-height:32px;flex-direction:row;padding-top:8px}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%]{align-self:baseline}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-inline-end:10px;display:flex;align-items:flex-start;align-self:baseline;width:136px;min-width:136px}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{text-align:right;width:100%;margin:9px 0 4px;overflow:hidden;display:-webkit-box;line-height:18px;-webkit-line-clamp:2;-webkit-box-orient:vertical}}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]{overflow:hidden;padding-bottom:1px}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .inner-icon[_ngcontent-%COMP%]{width:16px;height:16px;min-width:16px;min-height:16px}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]     label.mat-form-field-empty span{max-width:calc(100% - 20px);text-overflow:ellipsis;white-space:nowrap;overflow:hidden}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]{min-height:32px;flex-direction:row;padding-top:8px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%]{align-self:baseline}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-inline-end:10px;display:flex;align-items:flex-start;align-self:baseline;width:136px;min-width:136px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{text-align:right;width:100%;margin:9px 0 4px;overflow:hidden;display:-webkit-box;line-height:18px;-webkit-line-clamp:2;-webkit-box-orient:vertical}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]{min-height:52px;flex-direction:column;padding-top:0}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:8px}[_nghost-%COMP%]   .crt-input.label-position-above.appearance-outline[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{width:0;min-width:0;margin:0}[_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{height:0;color:transparent}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]:not(:hover)   .readonly-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]{align-items:center;padding-inline-end:2px}"]}),Mt=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerRichTextEditor",overrideType:"crt.RichTextEditor"}),(0,p.__metadata)("design:paramtypes",[n.Injector,n.ChangeDetectorRef])],Mt);let Te=class{constructor(e){this._materialIconsRegistrator=e,this._materialIconsRegistrator.addIcons([{name:"toggle-default",icon:v(16153)},{name:"toggle-selected",icon:v(49619)}])}};Te.\u0275fac=function(e){return new(e||Te)(n.\u0275\u0275inject(w.MaterialIconsRegistrator))},Te.\u0275mod=n.\u0275\u0275defineNgModule({type:Te}),Te.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,w.ResizableModule,Dt.MatLegacyInputModule,E.MatIconModule,en.MatLegacyTooltipModule,w.TooltipModule,w.CrtBaseInputWidthHolderModule]}),Te=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[Mt]}),(0,p.__metadata)("design:paramtypes",[w.MaterialIconsRegistrator])],Te),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Te,{declarations:[Mt],imports:[f.CommonModule,w.ResizableModule,Dt.MatLegacyInputModule,E.MatIconModule,en.MatLegacyTooltipModule,w.TooltipModule,w.CrtBaseInputWidthHolderModule],exports:[Mt]})}();class Wn{constructor(e,t,a,i,o,s){if(this._injector=e,this._resourceFinderService=t,this._relatedViewElementsService=a,this._designerSchemaService=i,this._relatedComponentStore=o,this._viewConfig=s,this._destroyed$=new d.Subject,this._tabPanelToToggleGroupPropertiesMap=new Map([["allowToggleClose","allowUntoggle"]]),this.designToggleItems$=new d.ReplaySubject(1),this.buttonToggleGroupInfo$=new d.ReplaySubject(1),this._relatedElementName=this._viewConfig.for,this._hasItems(this._viewConfig))this.designToggleItems$.next({items:this._viewConfig.items});else{const c=this._getDefaultSelectedItemName();this._emitDesignerToggleItems(c),this._subscribeOnSchemaChanged()}this._emitInitialAllowUntoggle()}_emitInitialAllowUntoggle(){if(this._isTabPanelRelated()){const t=this._getRelatedElementViewConfig()?.allowToggleClose??!0;this.buttonToggleGroupInfo$.next({allowUntoggle:t})}}_emitDesignerToggleItems(e){this._emitDesignerToggleItemsSubscription?.unsubscribe(),this._emitDesignerToggleItemsSubscription=this._getToggleItems(this._viewConfig.name).pipe((0,l.takeUntil)(this._destroyed$)).subscribe(t=>{this.designToggleItems$.next({items:t,selectedItemName:e})})}_subscribeOnSchemaChanged(){this._subscribeRelatedElementItemChange(),this._subscribeRelatedElementRename(),this._subscribeRelatedElementChange()}_subscribeRelatedElementItemChange(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{parentName:e}})=>e===this.getRelatedElementName()),(0,l.takeUntil)(this._destroyed$)).subscribe(({changes:{viewConfig:e}})=>{this._emitDesignerToggleItems(e.name)})}_subscribeRelatedElementRename(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{parentName:e,oldName:t,operation:a}})=>t===this.getRelatedElementName()&&a===_.MetaItemDesignSettingChangesOperation.Rename),(0,l.takeUntil)(this._destroyed$)).subscribe(({changes:{viewConfig:e}})=>{this._relatedElementName=e.name})}_subscribeRelatedElementChange(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{operation:e,viewConfig:t}})=>e===_.MetaItemDesignSettingChangesOperation.Update&&t?.name===this.getRelatedElementName()&&this._isTabPanelRelated()),(0,l.takeUntil)(this._destroyed$)).subscribe(({changes:{viewConfig:e}})=>{this._emitButtonToggleGroupInfo(e)})}_emitButtonToggleGroupInfo(e){const t={};[...this._tabPanelToToggleGroupPropertiesMap.keys()].forEach(o=>{const s=e[o];if(s!==void 0){const c=this._tabPanelToToggleGroupPropertiesMap.get(o);t[c]=s}}),Object.keys(t).length>0&&this.buttonToggleGroupInfo$.next(t)}_formToggleValues(e){return this._hasItems(e)?e.items.map(a=>({value:a.name,displayValue:this._resourceFinderService.findValueFromResource(a.caption,this._designerSchemaService.resources),icon:a?.icon,iconPosition:a?.iconPosition})):[]}_hasItems(e){return!!(0,x.get)(e,"items",[]).length}_getToggleItems(e){return this._relatedViewElementsService.getRelatedForViewConfig(e).pipe((0,d.switchMap)(t=>t?(0,d.of)(this._formToggleValues(t)):(0,d.of)([])))}_getDefaultSelectedItemName(){if(this._isTabPanelRelated()){const e=this.getRelatedElementName();return this._relatedComponentStore.get(e)?.selectedTabItemName}return null}_isTabPanelRelated(){return this._getRelatedElementViewConfig()?.type==="crt.TabPanel"}_getRelatedElementViewConfig(){const e=this.getRelatedElementName();return this._designerSchemaService.getViewConfigInfoByName(e)?.viewConfig}getRelatedElementName(){return this._relatedElementName}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}Wn.\u0275fac=function(e){return new(e||Wn)(n.\u0275\u0275inject(n.Injector),n.\u0275\u0275inject(C.ResourceFinderService),n.\u0275\u0275inject(_.RelatedViewElementsService),n.\u0275\u0275inject(g.DesignerSchemaService),n.\u0275\u0275inject(Qt),n.\u0275\u0275inject(S.VIEW_ELEMENT_CONFIG))},Wn.\u0275prov=n.\u0275\u0275defineInjectable({token:Wn,factory:Wn.\u0275fac});class Da{constructor(e,t){this._designButtonToggleGroupService=e,this._designerContainerService=t}_changeRelatedElementVisible(e){const t=this._designButtonToggleGroupService.getRelatedElementName();e?this._designerContainerService.showElement(t):this._designerContainerService.hideElement(t)}handleChangeDesignValue(e){this._designButtonToggleGroupService.getRelatedElementName()&&this._changeRelatedElementVisible(Boolean(e))}}Da.\u0275fac=function(e){return new(e||Da)(n.\u0275\u0275inject(Wn),n.\u0275\u0275inject(z))},Da.\u0275prov=n.\u0275\u0275defineInjectable({token:Da,factory:Da.\u0275fac});function rd(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",3)(1,"crt-button",4),n.\u0275\u0275listener("clicked",function(){const o=n.\u0275\u0275restoreView(t).$implicit,s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onToggleItemClick(o))}),n.\u0275\u0275elementEnd()()}if(r&2){const t=e.$implicit,a=e.index,i=n.\u0275\u0275nextContext();n.\u0275\u0275classProp("before-selected",i.isItemBeforeSelected(t))("selected",i.isItemSelected(t))("after-selected",i.isItemFirstAfterSelected(t)),n.\u0275\u0275attribute("data-qa","button-toggle-"+a),n.\u0275\u0275advance(1),n.\u0275\u0275styleProp("background-color",t.backgroundColor)("color",t.color),n.\u0275\u0275property("shape",i.getShape())("title",t.tooltipTitle)("caption",t.displayValue)("disableRipple",!0)("icon",t.icon)("iconPosition",i.getIconPosition(t.iconPosition))("size",i.size)("iconSize",i.iconSize)("contentAlign",i.contentAlign)("menuItems",t.menuItems)("disabled",t.disabled)("allowMenuOnDisabled",!0)("clickMode",i.menuButtonsMode&&(t.menuItems==null?null:t.menuItems.length)?"menu":"default"),n.\u0275\u0275attribute("data-item-marker",t==null?null:t.displayValue)}}let xt=class extends u.CrtButtonToggleGroupComponent{constructor(e,t){super(e,t),this._destroyed$=new d.Subject,this._initDependencies(),this._subscribeToContainerChanges(),this._subscribeElementDesignVisibilityChanges()}_subscribeButtonToggleGroupInfo(){this._designButtonToggleGroupService.buttonToggleGroupInfo$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(e=>{Object.keys(e).forEach(a=>{this[a]=e[a]})})}_subscribeElementDesignVisibilityChanges(){this._designerContainerService.designVisibility$.pipe((0,l.filter)(({name:e,visible:t})=>this._designButtonToggleGroupService.getRelatedElementName()===e&&!t),(0,l.takeUntil)(this._destroyed$)).subscribe({next:()=>{this.value=null,this.changeDetectorRef.detectChanges()}})}_subscribeToContainerChanges(){this._designerContainerService.selectedChanged$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(e=>{const t=this.items?.find(a=>a.value===e.name);t&&(this.value=t)})}_initDependencies(){this._designButtonToggleGroupService=this.injector.get(Wn),this._designerContainerService=this.injector.get(z),this._designButtonToggleGroupChangeValueService=this.injector.get(Da)}_subscribeDesignToggleItems(){this._designButtonToggleGroupService.designToggleItems$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(({items:e,selectedItemName:t})=>{this.items=e,t?this.value=this.items.find(a=>a.value===t):this.value=this.items[0],this.changeDetectorRef.detectChanges()})}ngOnInit(){this._subscribeDesignToggleItems(),this._subscribeButtonToggleGroupInfo()}ngOnDestroy(){super.ngOnDestroy(),this._destroyed$.next(),this._destroyed$.complete()}handleToggleItemClickQueue(e){super.handleToggleItemClickQueue(e),this._designerContainerService.select(this.value?.value),this._designButtonToggleGroupChangeValueService.handleChangeDesignValue(this.value)}};xt.\u0275fac=function(e){return new(e||xt)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(n.ChangeDetectorRef))},xt.\u0275cmp=n.\u0275\u0275defineComponent({type:xt,selectors:[["crt-designer-button-toggle-group"]],features:[n.\u0275\u0275ProvidersFeature([Wn,Da]),n.\u0275\u0275InheritDefinitionFeature],decls:3,vars:1,consts:[[1,"button-toggle-group"],["btnToggleGroup",""],["class","button-toggle",3,"before-selected","selected","after-selected",4,"ngFor","ngForOf"],[1,"button-toggle"],["color","default",3,"shape","title","caption","disableRipple","icon","iconPosition","size","iconSize","contentAlign","menuItems","disabled","allowMenuOnDisabled","clickMode","clicked"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0,1),n.\u0275\u0275template(2,rd,2,25,"div",2),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275advance(2),n.\u0275\u0275property("ngForOf",t.items))},dependencies:[f.NgForOf,u.CrtButtonComponent],styles:["[_nghost-%COMP%]{max-height:100%;max-width:100%;width:100%;height:100%;min-height:0;min-width:0;overflow:auto}@supports (background: -webkit-named-image(i)){[_nghost-%COMP%]{height:initial}}@supports (overflow: overlay){[_nghost-%COMP%]{overflow:overlay}}.fit-content[_nghost-%COMP%]{min-height:auto;min-width:auto;overflow:visible}.button-toggle-group[_ngcontent-%COMP%]{display:flex;max-width:100%;max-height:100%;overflow:auto}.button-toggle-group.column-direction[_ngcontent-%COMP%]{flex-direction:column;min-width:0}.button-toggle-group.column-direction[_ngcontent-%COMP%]   crt-button[_ngcontent-%COMP%]{width:100%;display:flex;align-items:stretch;flex-direction:column}.button-toggle-group.gap-none[_ngcontent-%COMP%]{gap:0}.button-toggle-group.gap-small[_ngcontent-%COMP%]{gap:4px}.button-toggle-group.gap-medium[_ngcontent-%COMP%]{gap:8px}.button-toggle-group.gap-large[_ngcontent-%COMP%]{gap:16px}"],changeDetection:0}),xt=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerButtonToggleGroup",overrideType:"crt.ButtonToggleGroup"}),(0,p.__metadata)("design:paramtypes",[n.Injector,n.ChangeDetectorRef])],xt);let Oe=class{};Oe.\u0275fac=function(e){return new(e||Oe)},Oe.\u0275mod=n.\u0275\u0275defineNgModule({type:Oe}),Oe.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,u.CrtButtonToggleGroupModule,u.CrtButtonModule]}),Oe=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[xt]})],Oe),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Oe,{declarations:[xt],imports:[f.CommonModule,u.CrtButtonToggleGroupModule,u.CrtButtonModule],exports:[xt]})}();function od(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-base-input-width-holder",10),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("label",t.label)("minWidth",180)}}function sd(r,e){if(r&1&&n.\u0275\u0275element(0,"mat-icon",11),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("crtTooltip",t.tooltip)}}const cd=function(r){return{"crt-input-required":r}};let We=class extends u.CrtPhoneInputComponent{};We.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(We)))(t||We)}}(),We.\u0275cmp=n.\u0275\u0275defineComponent({type:We,selectors:[["crt-designer-phone-input"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:11,vars:9,consts:[[3,"label","minWidth",4,"ngIf"],[1,"crt-designer-base-input-container","crt-base-input-container"],["crtResizable","",1,"crt-input",3,"ngClass","crtResizableDisabled","resized"],[1,"crt-input-label-container"],[1,"crt-input-label",3,"ngClass"],["floatLabel","never",1,"crt-input-control-container"],[1,"crt-input-control"],["matSuffix","","svgIcon","call-icon"],["matInput","",3,"placeholder"],["matSuffix","","svgIcon","info-icon","class","tooltip-icon",3,"crtTooltip",4,"ngIf"],[3,"label","minWidth"],["matSuffix","","svgIcon","info-icon",1,"tooltip-icon",3,"crtTooltip"]],template:function(e,t){e&1&&(n.\u0275\u0275template(0,od,1,2,"crt-base-input-width-holder",0),n.\u0275\u0275elementStart(1,"div",1)(2,"div",2),n.\u0275\u0275listener("resized",function(i){return t.onResized(i)}),n.\u0275\u0275elementStart(3,"div",3)(4,"label",4),n.\u0275\u0275text(5),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(6,"mat-form-field",5)(7,"div",6),n.\u0275\u0275element(8,"mat-icon",7)(9,"input",8),n.\u0275\u0275template(10,sd,1,1,"mat-icon",9),n.\u0275\u0275elementEnd()()()()),e&2&&(n.\u0275\u0275property("ngIf",t.displayLabelPosition==="auto"),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngClass","label-position-"+t.displayLabelPosition+" appearance-"+t.appearance)("crtResizableDisabled",!t.isAutoLabelPosition||t.containerQueryMechanismAvailable),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(7,cd,t.isShownRequiredMark)),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate(t.label),n.\u0275\u0275advance(4),n.\u0275\u0275property("placeholder",t.placeholder),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.tooltip))},dependencies:[f.NgClass,f.NgIf,w.ResizableDirective,se.MatLegacyFormField,se.MatLegacySuffix,Dt.MatLegacyInput,E.MatIcon,w.TooltipDirective,w.CrtBaseInputWidthHolderComponent],styles:["[_nghost-%COMP%]{height:50px}.crt-base-edit-input-responsible[_nghost-%COMP%]   .crt-base-input-container[_ngcontent-%COMP%]{container-type:inline-size}@container (width <= 320px){[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]{min-height:48px;flex-direction:column;padding-top:0}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:8px}[_nghost-%COMP%]   .crt-input.label-position-auto.appearance-outline[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-bottom:8px}}@container (width > 320px){[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]{min-height:32px;flex-direction:row;padding-top:8px}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%]{align-self:baseline}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-inline-end:10px;display:flex;align-items:flex-start;align-self:baseline;width:136px;min-width:136px}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{text-align:right;width:100%;margin:9px 0 4px;overflow:hidden;display:-webkit-box;line-height:18px;-webkit-line-clamp:2;-webkit-box-orient:vertical}}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]{overflow:hidden;padding-bottom:1px}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .inner-icon[_ngcontent-%COMP%]{width:16px;height:16px;min-width:16px;min-height:16px}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]     label.mat-form-field-empty{display:inline-flex}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]     label.mat-form-field-empty span{max-width:calc(100% - 20px);display:inline-block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%]{align-self:flex-end}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%]     .mat-form-field-label-wrapper{margin-left:26px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]{min-height:32px;flex-direction:row;padding-top:8px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%]{align-self:baseline}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-inline-end:10px;display:flex;align-items:flex-start;align-self:baseline;width:136px;min-width:136px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{text-align:right;width:100%;margin:9px 0 4px;overflow:hidden;display:-webkit-box;line-height:18px;-webkit-line-clamp:2;-webkit-box-orient:vertical}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]{min-height:48px;flex-direction:column;padding-top:0}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:8px}[_nghost-%COMP%]   .crt-input.label-position-above.appearance-outline[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{width:0;min-width:0;margin:0}[_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{height:0;color:transparent}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]:not(:hover)   .readonly-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]{align-items:center;padding-inline-end:2px}"]}),We=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerPhoneInput",overrideType:"crt.PhoneInput"})],We);let Ae=class{};Ae.\u0275fac=function(e){return new(e||Ae)},Ae.\u0275mod=n.\u0275\u0275defineNgModule({type:Ae}),Ae.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,w.ResizableModule,Dt.MatLegacyInputModule,E.MatIconModule,en.MatLegacyTooltipModule,w.TooltipModule,w.CrtBaseInputWidthHolderModule]}),Ae=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[We]})],Ae),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Ae,{declarations:[We],imports:[f.CommonModule,w.ResizableModule,Dt.MatLegacyInputModule,E.MatIconModule,en.MatLegacyTooltipModule,w.TooltipModule,w.CrtBaseInputWidthHolderModule],exports:[We]})}();var Qe=v(14535),Wi=v(86146);function ld(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-skeleton-loader",3),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("styles",t.skeletonStyles)}}function dd(r,e){r&1&&n.\u0275\u0275elementContainer(0)}function md(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"button",6),n.\u0275\u0275listener("click",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.onClick(i))})("focus",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.onFocus(i))})("blur",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.onBlur(i))}),n.\u0275\u0275template(2,dd,1,0,"ng-container",7),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()}if(r&2){const t=n.\u0275\u0275nextContext(2),a=n.\u0275\u0275reference(4);n.\u0275\u0275advance(1),n.\u0275\u0275styleProp("text-transform",t.textTransform),n.\u0275\u0275classProp("icon-mode",t.isIconMode)("crt-button--text",t.displayType==="text")("crt-button--contained",t.displayType==="contained"),n.\u0275\u0275property("color",t.colorThemePalette)("disabled",t.disabled)("disableRipple",t.disableRipple)("ngClass",t.classes)("title",t.getTitle()),n.\u0275\u0275attribute("aria-label",t.ariaLabel)("type",t.type)("tabIndex",t.tabIndex),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngTemplateOutlet",a)}}function pd(r,e){r&1&&n.\u0275\u0275elementContainer(0)}const Bo=function(r){return{$implicit:r}};function gd(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"div",9)(2,"button",10),n.\u0275\u0275listener("click",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(o.onClick(i))})("focus",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(o.onFocus(i))})("blur",function(i){n.\u0275\u0275restoreView(t);const o=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(o.onBlur(i))}),n.\u0275\u0275template(3,pd,1,0,"ng-container",7),n.\u0275\u0275element(4,"mat-divider",11),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(5,"button",12),n.\u0275\u0275listener("click",function(i){return i.preventDefault(),i.stopPropagation()})("menuOpened",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(i.onMenuOpened())})("menuClosed",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(i.onMenuClosed())}),n.\u0275\u0275element(6,"mat-icon",13),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(7,"crt-menu",14,15),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()}if(r&2){const t=n.\u0275\u0275reference(8),a=n.\u0275\u0275nextContext(3),i=n.\u0275\u0275reference(4);n.\u0275\u0275advance(2),n.\u0275\u0275styleProp("text-transform",a.textTransform),n.\u0275\u0275classProp("crt-button--text",a.displayType==="text")("crt-button--contained",a.displayType==="contained")("icon-mode",a.isIconMode),n.\u0275\u0275property("color",a.colorThemePalette)("disabled",a.disabled)("disableRipple",a.disableRipple)("ngClass",a.classes)("title",a.getTitle()),n.\u0275\u0275attribute("aria-label",a.ariaLabel)("type",a.type)("tabIndex",a.tabIndex),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngTemplateOutlet",i),n.\u0275\u0275advance(1),n.\u0275\u0275property("vertical",!0),n.\u0275\u0275advance(1),n.\u0275\u0275classProp("crt-button--text",a.displayType==="text")("crt-button--contained",a.displayType==="contained")("crt-button-menu-opened",a.isMenuOpened),n.\u0275\u0275property("ngClass",a.classes)("color",a.colorThemePalette)("disabled",a.menuDisabled)("disableRipple",a.disableRipple)("crtMenuTriggerFor",t)("crtMenuTriggerData",n.\u0275\u0275pureFunction1(33,Bo,a.menuItems)),n.\u0275\u0275advance(2),n.\u0275\u0275property("items",a.menuItems)("panelClass",a.menuPanelClass)("useGlassmorphism",a.useGlassmorphism)}}function ud(r,e){r&1&&n.\u0275\u0275elementContainer(0)}function hd(r,e){r&1&&n.\u0275\u0275element(0,"mat-icon",13)}function bd(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"button",16),n.\u0275\u0275listener("menuOpened",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(i.onMenuOpened())})("menuClosed",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(i.onMenuClosed())}),n.\u0275\u0275template(1,ud,1,0,"ng-container",7),n.\u0275\u0275template(2,hd,1,0,"mat-icon",17),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(3,"crt-menu",14,15)}if(r&2){const t=n.\u0275\u0275reference(4),a=n.\u0275\u0275nextContext(3),i=n.\u0275\u0275reference(4);n.\u0275\u0275styleProp("text-transform",a.textTransform),n.\u0275\u0275classProp("crt-button--text",a.displayType==="text")("crt-button--contained",a.displayType==="contained")("crt-button-menu-opened",a.isMenuOpened)("icon-mode",a.isIconMode),n.\u0275\u0275property("color",a.colorThemePalette)("disabled",a.menuDisabled)("disableRipple",a.disableRipple)("ngClass",a.classes)("title",a.getTitle())("crtMenuTriggerFor",t)("crtMenuTriggerData",n.\u0275\u0275pureFunction1(25,Bo,a.menuItems)),n.\u0275\u0275attribute("aria-label",a.ariaLabel)("type",a.type)("tabIndex",a.tabIndex),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngTemplateOutlet",i),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",a.isTextVisible),n.\u0275\u0275advance(1),n.\u0275\u0275property("items",a.menuItems)("panelClass",a.menuPanelClass)("useGlassmorphism",a.useGlassmorphism)}}function _d(r,e){if(r&1&&(n.\u0275\u0275template(0,gd,9,35,"ng-container",4),n.\u0275\u0275template(1,bd,5,27,"ng-template",null,8,n.\u0275\u0275templateRefExtractor)),r&2){const t=n.\u0275\u0275reference(2),a=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngIf",a.isDividerShown())("ngIfElse",t)}}function fd(r,e){if(r&1&&(n.\u0275\u0275template(0,md,3,17,"ng-container",4),n.\u0275\u0275template(1,_d,3,2,"ng-template",null,5,n.\u0275\u0275templateRefExtractor)),r&2){const t=n.\u0275\u0275reference(2),a=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngIf",!(a.menuItems!=null&&a.menuItems.length))("ngIfElse",t)}}function Cd(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"span",22),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()),r&2){const t=n.\u0275\u0275nextContext(3);n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate1(" ",t.caption," ")}}function yd(r,e){r&1&&n.\u0275\u0275projection(0)}function vd(r,e){if(r&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Cd,3,1,"ng-container",4),n.\u0275\u0275template(2,yd,1,0,"ng-template",null,21,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementContainerEnd()),r&2){const t=n.\u0275\u0275reference(3),a=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",a.caption)("ngIfElse",t)}}function Sd(r,e){if(r&1&&n.\u0275\u0275element(0,"mat-icon",23),r&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("svgIcon",t.icon)("ngClass",t.iconClasses)}}function wd(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"span",18),n.\u0275\u0275template(1,vd,4,2,"ng-container",19),n.\u0275\u0275template(2,Sd,1,2,"mat-icon",20),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngClass",t.contentAlignClasses),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.isTextVisible),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.isIconVisible)}}const Dd=["*"];let pn=class extends u.CrtButtonComponent{constructor(e){super(e),this._destroyed$=new d.Subject,this._designerSchemaService=e.get(g.DesignerSchemaService)}_onAfterInsertViewConfig(e){this.menuItems.push(e)}_onAfterDeleteViewConfig(e){const t=this.menuItems.findIndex(a=>a.name===e.name);this.menuItems.splice(t,1)}_subscribeSchemaChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{parentName:e}})=>e===this.name),(0,l.takeUntil)(this._destroyed$)).subscribe({next:({changes:{viewConfig:e,operation:t}})=>{switch(t){case _.MetaItemDesignSettingChangesOperation.Insert:this._onAfterInsertViewConfig(e);break;case _.MetaItemDesignSettingChangesOperation.Remove:this._onAfterDeleteViewConfig(e);break;default:return}this.detectChanges()}})}ngOnInit(){this._subscribeSchemaChanged()}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}};pn.\u0275fac=function(e){return new(e||pn)(n.\u0275\u0275directiveInject(n.Injector))},pn.\u0275cmp=n.\u0275\u0275defineComponent({type:pn,selectors:[["crt-button"]],features:[n.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:Dd,decls:5,vars:2,consts:[[3,"styles",4,"ngIf","ngIfElse"],["button",""],["defaultBtnContent",""],[3,"styles"],[4,"ngIf","ngIfElse"],["btnWithMenu",""],["mat-flat-button","",1,"crt-button",3,"color","disabled","disableRipple","ngClass","title","click","focus","blur"],[4,"ngTemplateOutlet"],["btnWithMenuClickMode",""],[1,"crt-button-wrapper"],["mat-flat-button","",1,"crt-button","crt-button-with-menu","crt-menu-with-default-action",3,"color","disabled","disableRipple","ngClass","title","click","focus","blur"],[3,"vertical"],["mat-flat-button","",1,"crt-button","crt-button-menu-trigger-icon",3,"ngClass","color","disabled","disableRipple","crtMenuTriggerFor","crtMenuTriggerData","click","menuOpened","menuClosed"],["svgIcon","menu-arrow"],[3,"items","panelClass","useGlassmorphism"],["itemsMenu",""],["mat-flat-button","",1,"crt-button","crt-button-with-menu",3,"color","disabled","disableRipple","ngClass","title","crtMenuTriggerFor","crtMenuTriggerData","menuOpened","menuClosed"],["svgIcon","menu-arrow",4,"ngIf"],[1,"btn-reversible-content",3,"ngClass"],[4,"ngIf"],["matSuffix","",3,"svgIcon","ngClass",4,"ngIf"],["content",""],[1,"crt-button-caption"],["matSuffix","",3,"svgIcon","ngClass"]],template:function(e,t){if(e&1&&(n.\u0275\u0275projectionDef(),n.\u0275\u0275template(0,ld,1,1,"crt-skeleton-loader",0),n.\u0275\u0275template(1,fd,3,2,"ng-template",null,1,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275template(3,wd,3,3,"ng-template",null,2,n.\u0275\u0275templateRefExtractor)),e&2){const a=n.\u0275\u0275reference(2);n.\u0275\u0275property("ngIf",t.loading)("ngIfElse",a)}},dependencies:[f.NgClass,f.NgIf,f.NgTemplateOutlet,E.MatIcon,Qe.MatLegacyButton,Wi.MatDivider,u.CrtMenuComponent,u.CrtMenuTriggerDirective],styles:["[_nghost-%COMP%]{display:inline-block;height:-moz-fit-content;height:fit-content;width:-moz-fit-content;width:fit-content;max-width:100%}.crt-button[_ngcontent-%COMP%]{display:block;max-width:100%;min-width:0}.crt-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{height:16px;width:16px;display:flex;min-width:8px;flex-shrink:0}.crt-button[_ngcontent-%COMP%]   .mat-icon.button-icon-size-small[_ngcontent-%COMP%]{height:8px}.crt-button[_ngcontent-%COMP%]   .mat-icon.button-icon-size-medium[_ngcontent-%COMP%]{height:12px}.crt-button[_ngcontent-%COMP%]   .mat-icon.button-icon-size-large[_ngcontent-%COMP%]{height:16px}.crt-button[_ngcontent-%COMP%]   .mat-icon.button-icon-size-extra-large[_ngcontent-%COMP%]{height:24px}.crt-button[_ngcontent-%COMP%]   .mat-icon.button-icon-size-small[_ngcontent-%COMP%]{width:8px}.crt-button[_ngcontent-%COMP%]   .mat-icon.button-icon-size-medium[_ngcontent-%COMP%]{width:12px}.crt-button[_ngcontent-%COMP%]   .mat-icon.button-icon-size-large[_ngcontent-%COMP%]{width:16px}.crt-button[_ngcontent-%COMP%]   .mat-icon.button-icon-size-extra-large[_ngcontent-%COMP%]{width:24px}.crt-button.icon-mode[_ngcontent-%COMP%]{width:100%;padding:0 4px}.crt-button.crt-button-with-menu.crt-button--contained[_ngcontent-%COMP%]{padding-inline-end:8px}.crt-button.crt-button-with-menu.crt-button--contained.crt-menu-with-default-action[_ngcontent-%COMP%]{padding:0;margin-inline-end:-2px}.crt-button.crt-button-with-menu.crt-button--contained.crt-menu-with-default-action[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{margin-inline-end:2px}.crt-button.crt-button-with-menu.crt-button--contained.crt-menu-with-default-action[_ngcontent-%COMP%]   .btn-reversible-content[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0;padding-inline-start:16px;padding-inline-end:8px}.crt-button.crt-button-with-menu.crt-button--contained[_ngcontent-%COMP%]:not(.button-icon-position-only-icon)   .btn-reversible-content[_ngcontent-%COMP%]{padding-inline-end:8px}.crt-button.crt-button-with-menu.crt-button--text.crt-menu-with-default-action[_ngcontent-%COMP%]{padding:0;margin-inline-end:-2px}.crt-button.crt-button-with-menu.crt-button--text.crt-menu-with-default-action[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{margin-inline-end:2px}.crt-button.crt-button-with-menu.crt-button--text.crt-menu-with-default-action[_ngcontent-%COMP%]   .btn-reversible-content[_ngcontent-%COMP%]{padding-inline-end:4px}.crt-button.crt-button-with-menu.crt-button--text[_ngcontent-%COMP%]:not(.button-icon-position-only-icon)   .btn-reversible-content[_ngcontent-%COMP%]{padding-inline-end:8px}.crt-button[_ngcontent-%COMP%]   .btn-reversible-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.crt-button[_ngcontent-%COMP%]   .btn-reversible-content.button-content-align-start[_ngcontent-%COMP%]{justify-content:start}.crt-button[_ngcontent-%COMP%]   .btn-reversible-content.button-content-align-center[_ngcontent-%COMP%]{justify-content:center}.crt-button[_ngcontent-%COMP%]   .btn-reversible-content.button-content-align-end[_ngcontent-%COMP%]{justify-content:end}.crt-button.crt-button--text[_ngcontent-%COMP%]{padding:0}.crt-button[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{border-color:currentColor;border-width:1px;height:16px}.crt-button.button-size-small[_ngcontent-%COMP%]{line-height:18px}.crt-button.button-size-medium[_ngcontent-%COMP%]{line-height:24px}.crt-button.button-size-large[_ngcontent-%COMP%]{line-height:32px}.crt-button.button-size-extra-large[_ngcontent-%COMP%]{line-height:40px}.crt-button.button-size-small[_ngcontent-%COMP%]{height:18px}.crt-button.button-size-medium[_ngcontent-%COMP%]{height:24px}.crt-button.button-size-large[_ngcontent-%COMP%]{height:32px}.crt-button.button-size-extra-large[_ngcontent-%COMP%]{height:40px}.crt-button.button-size-small[_ngcontent-%COMP%]{font-size:10px}.crt-button.button-size-medium[_ngcontent-%COMP%]{font-size:12px}.crt-button.button-size-large[_ngcontent-%COMP%], .crt-button.button-size-extra-large[_ngcontent-%COMP%]{font-size:14px}.crt-button.crt-button--contained.button-size-small[_ngcontent-%COMP%]{padding:0 4px}.crt-button.crt-button--contained.button-size-medium[_ngcontent-%COMP%]{padding:0 12px}.crt-button.crt-button--contained.button-size-large[_ngcontent-%COMP%], .crt-button.crt-button--contained.button-size-extra-large[_ngcontent-%COMP%]{padding:0 16px}.crt-button.crt-button--contained.button-icon-position-only-icon.button-size-small[_ngcontent-%COMP%]{padding:0 5px}.crt-button.crt-button--contained.button-icon-position-only-icon.button-size-medium[_ngcontent-%COMP%]{padding:0 6px}.crt-button.crt-button--contained.button-icon-position-only-icon.button-size-large[_ngcontent-%COMP%], .crt-button.crt-button--contained.button-icon-position-only-icon.button-size-extra-large[_ngcontent-%COMP%]{padding:0 8px}.crt-button[_ngcontent-%COMP%]   .crt-button-caption[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.crt-button-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center}.crt-button-wrapper[_ngcontent-%COMP%]   .crt-button.crt-button--contained.crt-button-menu-trigger-icon[_ngcontent-%COMP%]{width:32px;padding:0 8px}.crt-button-wrapper[_ngcontent-%COMP%]   .crt-button.crt-button--text.crt-button-menu-trigger-icon[_ngcontent-%COMP%]{padding-inline-start:4px}"],changeDetection:0}),pn=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerButton",overrideType:"crt.Button"}),(0,p.__metadata)("design:paramtypes",[n.Injector])],pn);const Md=["class","component"];function xd(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-skeleton-loader",2),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("styles",t.skeletonStyles)}}function Id(r,e){r&1&&(n.\u0275\u0275element(0,"crt-compact-profile-placeholder",3),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275pipe(3,"translate")),r&2&&(n.\u0275\u0275propertyInterpolate("name",n.\u0275\u0275pipeBind1(1,3,"AccountCompactProfile.DesignerNamePlaceholder")),n.\u0275\u0275propertyInterpolate("subheading",n.\u0275\u0275pipeBind1(2,5,"AccountCompactProfile.AlternativeNamePlaceholder")),n.\u0275\u0275propertyInterpolate("text",n.\u0275\u0275pipeBind1(3,7,"AccountCompactProfile.CountryPlaceholder")))}let qe=class extends u.CrtAccountCompactProfileComponent{};qe.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(qe)))(t||qe)}}(),qe.\u0275cmp=n.\u0275\u0275defineComponent({type:qe,selectors:[["crt-designer-account-compact-profile",8,"component"]],features:[n.\u0275\u0275InheritDefinitionFeature],attrs:Md,decls:3,vars:2,consts:[[3,"styles",4,"ngIf","ngIfElse"],["profile_template",""],[3,"styles"],["icon","account-compact-profile-icon-placeholder",3,"name","subheading","text"]],template:function(e,t){if(e&1&&(n.\u0275\u0275template(0,xd,1,1,"crt-skeleton-loader",0),n.\u0275\u0275template(1,Id,4,9,"ng-template",null,1,n.\u0275\u0275templateRefExtractor)),e&2){const a=n.\u0275\u0275reference(2);n.\u0275\u0275property("ngIf",t.loading)("ngIfElse",a)}},dependencies:[u.CrtCompactProfilePlaceholderComponent,f.NgIf,w.SkeletonLoaderComponent,D.TranslatePipe],styles:[`.profile-header{display:flex;flex-direction:row;overflow:hidden;border-radius:8px}.profile-header .profile-photo{min-width:80px}.profile-header .profile-photo .crt-image-input .image-placeholder{height:30px}.profile-header .profile-info{width:100%;height:100%;overflow:hidden}.profile-header crt-local-time{display:inline-block;vertical-align:bottom;text-overflow:ellipsis;overflow:hidden}.profile-header .block-ellipsis,.profile-header .profile-block{display:block;display:-webkit-box;max-width:100%;max-height:62px;margin:0 auto;line-height:1;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}.profile-header .profile-block{margin-top:4px}.profile-header .one-line{max-height:19px;-webkit-line-clamp:1}.profile-header .two-lines{max-height:38px;-webkit-line-clamp:2}@media screen and (max-width: 600px){.profile-header{flex-direction:column;align-content:center;align-items:center;text-align:-webkit-center;gap:8px}}
`],encapsulation:2,changeDetection:0}),qe=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerAccountCompactProfile",overrideType:"crt.AccountCompactProfile"})],qe);let It=class{};It.\u0275fac=function(e){return new(e||It)},It.\u0275mod=n.\u0275\u0275defineNgModule({type:It}),It.\u0275inj=n.\u0275\u0275defineInjector({imports:[u.CrtCompactProfileModule,f.CommonModule,w.ResizableModule,E.MatIconModule,D.TranslateModule,S.ViewModule,u.CrtImageInputModule,u.CrtLabelModule,w.CrtSkeletonLoaderModule]}),It=(0,p.__decorate)([(0,h.CrtModule)({includes:[u.CrtCompactProfileModule],designTimeViewElements:[qe]})],It),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(It,{declarations:[qe],imports:[u.CrtCompactProfileModule,f.CommonModule,w.ResizableModule,E.MatIconModule,D.TranslateModule,S.ViewModule,u.CrtImageInputModule,u.CrtLabelModule,w.CrtSkeletonLoaderModule],exports:[qe]})}();const Pd=["class","component"];function Ed(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-skeleton-loader",2),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("styles",t.skeletonStyles)}}function Td(r,e){r&1&&(n.\u0275\u0275element(0,"crt-compact-profile-placeholder",3),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275pipe(3,"translate")),r&2&&(n.\u0275\u0275propertyInterpolate("name",n.\u0275\u0275pipeBind1(1,3,"ContactCompactProfile.DesignerNamePlaceholder")),n.\u0275\u0275propertyInterpolate("subheading",n.\u0275\u0275pipeBind1(2,5,"ContactCompactProfile.DesignerBirthDatePlaceholder")),n.\u0275\u0275propertyInterpolate("text",n.\u0275\u0275pipeBind1(3,7,"ContactCompactProfile.CountryPlaceholder")))}let Ke=class extends u.CrtContactCompactProfileComponent{};Ke.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Ke)))(t||Ke)}}(),Ke.\u0275cmp=n.\u0275\u0275defineComponent({type:Ke,selectors:[["crt-designer-contact-compact-profile",8,"component"]],features:[n.\u0275\u0275InheritDefinitionFeature],attrs:Pd,decls:3,vars:2,consts:[[3,"styles",4,"ngIf","ngIfElse"],["profile_template",""],[3,"styles"],["icon","contact-compact-profile-icon-placeholder",3,"name","subheading","text"]],template:function(e,t){if(e&1&&(n.\u0275\u0275template(0,Ed,1,1,"crt-skeleton-loader",0),n.\u0275\u0275template(1,Td,4,9,"ng-template",null,1,n.\u0275\u0275templateRefExtractor)),e&2){const a=n.\u0275\u0275reference(2);n.\u0275\u0275property("ngIf",t.loading)("ngIfElse",a)}},dependencies:[u.CrtCompactProfilePlaceholderComponent,f.NgIf,w.SkeletonLoaderComponent,D.TranslatePipe],styles:[`.profile-header{display:flex;flex-direction:row;overflow:hidden;border-radius:8px}.profile-header .profile-photo{min-width:80px}.profile-header .profile-photo .crt-image-input .image-placeholder{height:30px}.profile-header .profile-info{width:100%;height:100%;overflow:hidden}.profile-header crt-local-time{display:inline-block;vertical-align:bottom;text-overflow:ellipsis;overflow:hidden}.profile-header .block-ellipsis,.profile-header .profile-block{display:block;display:-webkit-box;max-width:100%;max-height:62px;margin:0 auto;line-height:1;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}.profile-header .profile-block{margin-top:4px}.profile-header .one-line{max-height:19px;-webkit-line-clamp:1}.profile-header .two-lines{max-height:38px;-webkit-line-clamp:2}@media screen and (max-width: 600px){.profile-header{flex-direction:column;align-content:center;align-items:center;text-align:-webkit-center;gap:8px}}
`],encapsulation:2,changeDetection:0}),Ke=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerContactCompactProfile",overrideType:"crt.ContactCompactProfile"})],Ke);let Pt=class{};Pt.\u0275fac=function(e){return new(e||Pt)},Pt.\u0275mod=n.\u0275\u0275defineNgModule({type:Pt}),Pt.\u0275inj=n.\u0275\u0275defineInjector({imports:[u.CrtCompactProfileModule,f.CommonModule,w.ResizableModule,E.MatIconModule,D.TranslateModule,S.ViewModule,u.CrtImageInputModule,u.CrtLabelModule,w.CrtSkeletonLoaderModule]}),Pt=(0,p.__decorate)([(0,h.CrtModule)({includes:[u.CrtCompactProfileModule],designTimeViewElements:[Ke]})],Pt),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Pt,{declarations:[Ke],imports:[u.CrtCompactProfileModule,f.CommonModule,w.ResizableModule,E.MatIconModule,D.TranslateModule,S.ViewModule,u.CrtImageInputModule,u.CrtLabelModule,w.CrtSkeletonLoaderModule],exports:[Ke]})}();var Ci=v(33569);function Od(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",1)(1,"div",2)(2,"crt-label",3),n.\u0275\u0275text(3),n.\u0275\u0275pipe(4,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(5,"crt-label",4),n.\u0275\u0275text(6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(7,"div",5)(8,"div",6),n.\u0275\u0275element(9,"crt-timeline-icon",7),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(10,"div",8)(11,"div",9),n.\u0275\u0275element(12,"div",10)(13,"div",10)(14,"div",10),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(15,"div",9),n.\u0275\u0275element(16,"div",10),n.\u0275\u0275elementEnd()()()()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate1("",n.\u0275\u0275pipeBind1(4,5,"Components.Timeline.Tile.TileObjectTitle")," "),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate(t.entity.caption),n.\u0275\u0275advance(3),n.\u0275\u0275property("tileKey",t.getTileKey())("photoImageId",t.getPhotoId())("tileIconId",t.getIconId())}}let Et=class extends S.CrtBaseComponent{constructor(e){super(e),this._injector=e,this._tilesWithPhoto=["call","feed","email","omnichat"],this.designerItems=[],this._tileViewCofig=this.injector.get(S.VIEW_ELEMENT_CONFIG)}set data(e){this.entity||(this.entity=e)}getTileKey(){return(this.entity.schemaType||this.entity.schemaName).toLowerCase()}getPhotoId(){return this._tilesWithPhoto.includes(this.getTileKey())?h.EMPTY_GUID:""}getIconId(){return this._tileViewCofig?.iconId}};Et.\u0275fac=function(e){return new(e||Et)(n.\u0275\u0275directiveInject(n.Injector))},Et.\u0275cmp=n.\u0275\u0275defineComponent({type:Et,selectors:[["crt-designer-timeline-tile"]],inputs:{data:"data"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["class","timeline-tile",4,"ngIf"],[1,"timeline-tile"],[1,"header"],["labelType","body-1",1,"object-title"],["labelType","body-1",1,"object-caption"],[1,"tile-container"],[1,"icon-container"],[3,"tileKey","photoImageId","tileIconId"],[1,"field-mask-container"],[1,"row"],[1,"field-mask"]],template:function(e,t){e&1&&n.\u0275\u0275template(0,Od,17,7,"div",0),e&2&&n.\u0275\u0275property("ngIf",t.entity)},dependencies:[f.NgIf,u.CrtLabelComponent,u.CrtTimelineIconComponent,D.TranslatePipe],styles:[".timeline-tile[_ngcontent-%COMP%]{border-radius:8px}.timeline-tile[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding:8px 0 8px 16px;margin-bottom:16px}.timeline-tile[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .object-title[_ngcontent-%COMP%], .timeline-tile[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .object-caption[_ngcontent-%COMP%]{display:inline-block}.timeline-tile[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .object-title[_ngcontent-%COMP%]{margin-right:10px}.timeline-tile[_ngcontent-%COMP%]   .tile-container[_ngcontent-%COMP%]{display:flex}.timeline-tile[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{display:inline-block;padding:0 16px 0 24px}.timeline-tile[_ngcontent-%COMP%]   .object-icon[_ngcontent-%COMP%]{display:inline-block;padding-left:16px;padding-right:8px}.timeline-tile[_ngcontent-%COMP%]   .field-mask-container[_ngcontent-%COMP%]{display:inline-block;width:100%}.timeline-tile[_ngcontent-%COMP%]   .field-mask-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:nth-child(1)   .field-mask[_ngcontent-%COMP%]:nth-child(1){width:30%}.timeline-tile[_ngcontent-%COMP%]   .field-mask-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:nth-child(1)   .field-mask[_ngcontent-%COMP%]:nth-child(2){width:15%}.timeline-tile[_ngcontent-%COMP%]   .field-mask-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:nth-child(1)   .field-mask[_ngcontent-%COMP%]:nth-child(3){width:25%}.timeline-tile[_ngcontent-%COMP%]   .field-mask-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:nth-child(2){display:flex;margin-bottom:16px}.timeline-tile[_ngcontent-%COMP%]   .field-mask-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:nth-child(2)   .field-mask[_ngcontent-%COMP%]:nth-child(1){width:95%}.timeline-tile[_ngcontent-%COMP%]   .field-mask[_ngcontent-%COMP%]{display:inline-block;height:25px;border-radius:4px}.timeline-tile[_ngcontent-%COMP%]   .field-mask[_ngcontent-%COMP%]:not(:last-child){margin-right:2%}"]}),Et=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerTimelineTile",overrideType:"crt.TimelineTile"}),(0,p.__metadata)("design:paramtypes",[n.Injector])],Et);let Ve=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.config=t}innerExecute(){const{defaultViewConfig:e,designerTool:t,index:a,containerName:i,propertyName:o}=this.config,s=this.designerSchemaService.create({defaultConfig:t.defaultConfig,parentName:i,propertyName:o,defaultViewConfig:e,index:a});return(0,d.of)({success:!0,createdViewElement:s})}};Ve=(0,p.__decorate)([M({type:"crt.AddViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Ve);let Qi=class extends Ve{_getAttributeName(e,t){const a=`${e}.${t}`;let i=this.designerSchemaService.findAttributeByDataSourceAttributePath(a);return i||(i=this._designerSchemaService.generateUniqueAttributeNameByType(t),this._designerSchemaService.createViewModelAttribute(i,{modelConfig:{path:a}})),i}_setSchemaProperties(e){const t=this._designerSchemaService.getPrimaryDataSourceName(),a=this._getAttributeName(t,"Result"),i=this._getAttributeName(t,"AllowedResult"),o=this._getAttributeName(t,"ActivityCategory");e.activityResultControl=`$${a}`,e.allowedResults=`$${i}`,e.activityCategory=`$${o}`,e.label=`$Resources.Strings.${a}`}injectDependencies(){return this._designerSchemaService=this.injector.get(g.DesignerSchemaService),super.injectDependencies()}innerExecute(){return super.innerExecute().pipe((0,l.tap)(e=>{const t=e.createdViewElement;t&&(!t.activityResultControl||!t.allowedResults||!t.activityCategory)&&this._setSchemaProperties(t)}))}};Qi=(0,p.__decorate)([M({type:"crt.AddAllowedResultsCommand"})],Qi);let qi=class extends Ve{_findExpansionPanel(e){return this.designerSchemaService.getViewConfigInfoByName(e).viewConfig}_findApprovalList(e){const t=C.MetadataSchemaUtils.getViewConfigInfoByFilter(a=>a.type==="crt.ApprovalList",[e]);return t.length&&t[0]}_findButtonWithRequest(e,t){const a=C.MetadataSchemaUtils.getViewConfigInfoByFilter(i=>i.type==="crt.Button"&&i.clicked?.request===t,[e]);return a.length&&a[0]}_findSearchComponent(e){const t=C.MetadataSchemaUtils.getViewConfigInfoByFilter(a=>a.type==="crt.SearchFilter",[e]);return t.length&&t[0]}_updateExpansionPanelElements(e){const t=this._findExpansionPanel(e);if(!t)return;const a=this._findApprovalList(t);if(!a)return;const i=this._findButtonWithRequest(t,"crt.LoadDataRequest");if(i&&i.viewConfig.clicked){const s=i.viewConfig.clicked.params||{};s.dataSourceName=a.viewConfig.name+I.DATA_SOURCE_PREFIX,i.viewConfig.clicked.params=s}const o=this._findSearchComponent(t);o&&!o.viewConfig.targetAttributes&&(o.viewConfig.targetAttributes=[a.viewConfig.name])}innerExecute(){return super.innerExecute().pipe((0,l.tap)(e=>{this._updateExpansionPanelElements(e.createdViewElement?.name)}))}};qi=(0,p.__decorate)([M({type:"crt.AddApprovalListCommand"})],qi);let Ki=class extends Ve{_findAttachments(e){return this.designerSchemaService.getViewConfigInfoByName(e).viewConfig}_findFileList(e){const t=C.MetadataSchemaUtils.getViewConfigInfoByFilter(a=>a.type==="crt.FileList",[e]);return t.length&&t[0]}_findButtonWithRequest(e,t){const a=C.MetadataSchemaUtils.getViewConfigInfoByFilter(i=>i.type==="crt.Button"&&i.clicked?.request===t,[e]);return a.length&&a[0]}_findSearchComponent(e){const t=C.MetadataSchemaUtils.getViewConfigInfoByFilter(a=>a.type==="crt.SearchFilter",[e]);return t.length&&t[0]}_connectActionsToFileList(e){const t=this._findAttachments(e);if(!t)return;const a=this._findFileList(t);if(!a)return;const i=this._findButtonWithRequest(t,"crt.UploadFileRequest");if(i&&i.viewConfig.clicked){const c=i.viewConfig.clicked.params||{};c.viewElementName=a.viewConfig.name,i.viewConfig.clicked.params=c}const o=this._findButtonWithRequest(t,"crt.LoadDataRequest");if(o&&o.viewConfig.clicked){const c=o.viewConfig.clicked.params||{};c.dataSourceName=a.viewConfig.name+I.DATA_SOURCE_PREFIX,o.viewConfig.clicked.params=c}const s=this._findSearchComponent(t);s&&!s.viewConfig.targetAttributes&&(s.viewConfig.targetAttributes=[a.viewConfig.name])}innerExecute(){return super.innerExecute().pipe((0,l.tap)(e=>{this._connectActionsToFileList(e.createdViewElement?.name)}))}};Ki=(0,p.__decorate)([M({type:"crt.AddAttachmentsCommand"})],Ki);let Ji=class extends Ve{_setSchemaProperties(e){const t=this._designerFeedService.getDefaultDataSource(),a=`${t}.Id`,i=this.designerSchemaService.findAttributeByDataSourceAttributePath(a);e.primaryColumnValue=`$${i||this.designerSchemaService.getOrAddViewModelAttribute("Id","#PrimaryDataSourceName()#")}`,e.entitySchemaName=this._designerFeedService.getDefaultEntitySchema(),e.dataSourceName=t}_sendGTMData(){const e={moduleName:"ModuleDesigner",schemaName:"InterfaceDesigner",action:"FeedAdded"};this._googleTagManager.track(e)}injectDependencies(){return this._googleTagManager=this.injector.get(ae.GoogleTagManagerService),this._designerFeedService=this.injector.get(Ht),super.injectDependencies()}innerExecute(){return super.innerExecute().pipe((0,l.tap)(e=>{const t=e.createdViewElement;t&&(!t.primaryColumnValue||!t.entitySchemaName||!t.dataSourceName)&&this._setSchemaProperties(t),this._sendGTMData()}))}};Ji=(0,p.__decorate)([M({type:"crt.AddFeedCommand"})],Ji);let Zi=class extends Ve{_getExpansionPanelConfig(e){return this.designerSchemaService.getViewConfigInfoByName(e).viewConfig}_getNextStepsConfig(e){const t=C.MetadataSchemaUtils.getViewConfigInfoByFilter(a=>a.type==="crt.NextSteps",[e]);return t.length&&t[0]?.viewConfig}_linkWithEntitySchemaRecord(e){const t=this._getExpansionPanelConfig(e);if(!t)return;const a=this._getNextStepsConfig(t);a&&(!a.masterSchemaName||!a.masterSchemaId)&&this._setSchemaProperties(a)}_setSchemaProperties(e){e.masterSchemaName=this._designerFeedService.getDefaultEntitySchema()||"#DataSourceEntityName()#",e.masterSchemaId="$Id"}injectDependencies(){return this._designerFeedService=this.injector.get(Ht),super.injectDependencies()}innerExecute(){return super.innerExecute().pipe((0,l.tap)(e=>{this._linkWithEntitySchemaRecord(e.createdViewElement?.name)}))}};Zi=(0,p.__decorate)([M({type:"crt.AddNextStepsCommand"})],Zi);let Xi=class extends g.BaseDesignerCommand{get designerName(){throw new Error("Designer name is not defined")}constructor(e,t){super(e),this.injector=e,this.config=t,this._subscription=new d.Subscription}injectDependencies(){return super.injectDependencies().pipe((0,d.tap)(()=>{this._notifyService=this.injector.get(w.NotifyService),this._location=this.injector.get(f.Location)}))}showNotification(){this.config.saveResponse.success&&this._notifyService.show({message:"InterfaceDesigner.Messages.SuccessfullySaved"})}changeLocationState(){if(this.config.saveResponse.success){const{schema:e}=this.config.schemaDesignItem,t=`${this.designerName}/${e.uId}?packageUId=${e.package.uId}`;this._location.replaceState(t)}}innerExecute(){return this.showNotification(),this.changeLocationState(),(0,d.of)({success:!0})}ngOnDestroy(){this._subscription.unsubscribe()}};Xi=(0,p.__decorate)([M({type:"crt.AfterDesignerItemSaved"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Xi);let qa=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t,this.useMacrosTemplate=t.useMacrosTemplate}_changeConfigItems(e,t,a){(0,x.each)(e,(i,o)=>{if((0,x.isPlainObject)(i)){const s=this._getPropertyName(a,o);this._changeConfigItems(i,t,s);return}this._hasLocalizations(i)?this._changeLocalizableItem(e,t,a,i,o):this._changeNotLocalizableItem(e,a,i,o)})}_changeLocalizableItem(e,t,a,i,o){const s=this._getPropertyName(a,o);this._saveResource(t,s,i),e[o]=this.useMacrosTemplate?`#MacrosTemplateString(#ResourceString(${s})#)#`:`#ResourceString(${s})#`}_changeNotLocalizableItem(e,t,a,i){if(i==="label"){const o=this.designerSchemaService.getViewConfigInfoByName(t),s=this._getBoundAttributeName(o);e.label=`$Resources.Strings.${s}`}else a instanceof C.LocalizableStringArray&&(e[i]="")}_getPropertyName(e,t){return e.split(/[.-]/).join("")+"_"+t}_hasLocalizations(e){return(0,x.isArray)(e)&&!![...e].find(t=>t.cultureName&&t.value)}_getAttributeName(e){return e.startsWith("$")?e.slice(1):null}_getBoundAttributeName(e){const t=e.viewConfig.control;return t?this._getAttributeName(t):null}_saveResource(e,t,a){e.strings[t]=a.filter(i=>i.value).reduce((i,o)=>Object.assign(i,{[o.cultureName]:o.value}),{})}getChangesConfig(){const e={};return this.config.changes.forEach(t=>(0,x.set)(e,t.path,t.value)),e}getApplyPropertiesStrategies(){return this.config.changes.filter(e=>e.applyPropertyStrategy!=null).map(e=>({propertyPath:e.path,value:e.applyPropertyStrategy}))}innerExecute(){var e;const t=this.config.name,a=this.getChangesConfig(),i=this.getApplyPropertiesStrategies(),o=a.itemConfig.name;(e=a.itemConfig).name??(e.name=t);const s={strings:{}};return this._changeConfigItems(a.itemConfig,s,t),(this.config.resourceChanges||[]).forEach(m=>{this._saveResource(s,m.name,m.value)}),o?this.designerSchemaService.rename(t,o):this.designerSchemaService.update({...a,resources:s,applyPropertiesStrategies:i,selectOnCanvas:this.config.selectOnCanvas}),(0,d.of)({success:!0})}};qa=(0,p.__decorate)([M({type:"crt.ChangeViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],qa);var Tt=v(78094);let gn=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.config=t}innerExecute(){const e=this.designerSchemaService.copy(this.config.name,this.config.layoutConfig,this.config.propertyName,this.config.index,this.config.copyMetadata,this.config.parentName);return(0,d.of)({success:!0,copiedViewElement:e})}};gn=(0,p.__decorate)([M({type:"crt.CopyViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],gn);let Yi=class extends gn{constructor(e,t){super(e,t),this._designerSchemaService=this.injector.get(g.DesignerSchemaService),this._widgetDataProvidingMetadataGenerator=this.injector.get(Tt.ChartWidgetDataProvidingMetadataGenerator),this._widgetDataProvidingMetadataCompressor=this.injector.get(Tt.ChartWidgetDataProvidingMetadataCompressor),this._featureValues=this.injector.get(C.FEATURE_VALUES)}_clearSeriesMetadata(e){!e||(delete e.seriesData,delete e.seriesConfigsChanged,this._clearSeriesDataProvidingAttribute(e?.config?.series),this._clearSeriesDataProvidingFilterAttributes(e?.config?.series))}_clearSeriesDataProvidingAttribute(e){(e??[]).map(t=>t?.data?.providing).filter(t=>t?.attribute).forEach(t=>delete t.attribute)}_clearSeriesDataProvidingFilterAttributes(e){(e??[]).map(t=>t?.data?.providing?.filters).filter(t=>t?.filterAttributes).forEach(t=>delete t.filterAttributes)}_generateSeriesDataProvidingMetadata(e){const t=this._designerSchemaService.schema,a=this._widgetDataProvidingMetadataGenerator.generate(e,t);(0,x.defaultsDeep)(t,a),this._designerSchemaService.update({itemConfig:e,modelConfig:t.modelConfig,viewModelConfig:t.viewModelConfig,applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.config"},{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.seriesData"},{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.seriesChange"}]})}_actualizeWidgetViewConfig(e){const t={...this.designerSchemaService.schema};this._widgetDataProvidingMetadataCompressor?.compress(e,t);const a=C.MetadataSchemaUtils.getViewConfigInfoByProperty("name",e,t?.viewConfig)?.pop()?.viewConfig;this._designerSchemaService.update({itemConfig:a,applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.config"}]})}innerExecute(){return this._featureValues[Tt.DISABLE_SUPPORT_WIDGET_DATA_SOURCE_FEATURE_NAME]?super.innerExecute():(this._actualizeWidgetViewConfig(this.config.name),super.innerExecute().pipe((0,d.map)(e=>{const t=e?.copiedViewElement;return this._clearSeriesMetadata(t),this._generateSeriesDataProvidingMetadata(t),e})))}};Yi=(0,p.__decorate)([M({type:"crt.CopyChartWidgetViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Yi);let er=class extends gn{constructor(e,t){super(e,t),this._designerSchemaService=this.injector.get(g.DesignerSchemaService),this._widgetDataProvidingMetadataGenerator=this.injector.get(Tt.IndicatorWidgetDataProvidingMetadataGenerator),this._widgetDataProvidingMetadataCompressor=this.injector.get(Tt.IndicatorWidgetDataProvidingMetadataCompressor),this._featureValues=this.injector.get(C.FEATURE_VALUES)}_clearWidgetMetadata(e){!e||(delete e.data,e.config?.data?.providing?.attribute&&delete e.config.data.providing.attribute,e.config?.data?.providing?.filters?.filterAttributes&&delete e.config.data.providing.filters.filterAttributes)}_generateSeriesDataProvidingMetadata(e){const t=this._designerSchemaService.schema,a=this._widgetDataProvidingMetadataGenerator.generate(e,t);(0,x.defaultsDeep)(t,a),this._designerSchemaService.update({itemConfig:e,modelConfig:t.modelConfig,viewModelConfig:t.viewModelConfig,applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.config"},{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.data"}]})}_actualizeWidgetViewConfig(e){const t={...this.designerSchemaService.schema};this._widgetDataProvidingMetadataCompressor?.compress(e,t);const a=C.MetadataSchemaUtils.getViewConfigInfoByProperty("name",e,t?.viewConfig)?.pop()?.viewConfig;this._designerSchemaService.update({itemConfig:a,applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.config"}]})}innerExecute(){return this._featureValues[Tt.DISABLE_SUPPORT_WIDGET_DATA_SOURCE_FEATURE_NAME]?super.innerExecute():(this._actualizeWidgetViewConfig(this.config.name),super.innerExecute().pipe((0,d.map)(e=>{const t=e?.copiedViewElement;return this._clearWidgetMetadata(t),this._generateSeriesDataProvidingMetadata(t),e})))}};er=(0,p.__decorate)([M({type:"crt.CopyIndicatorWidgetViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],er);const Ad=r=>(r.itemConfig.disabled===!1&&delete r.itemConfig.disabled,r),Vd=r=>r.filter(e=>e.path==="itemConfig.disabled").map(e=>({propertyPath:e.path,value:_.ApplyChangedPropertyStrategy.Override}));let tr=class extends qa{getChangesConfig(){const e=super.getChangesConfig();return Ad(e)}getApplyPropertiesStrategies(){return[...super.getApplyPropertiesStrategies(),...Vd(this.config.changes)]}};tr=(0,p.__decorate)([M({type:"crt.CheckboxChangeViewItemCommand"}),M({type:"crt.SliderChangeViewItemCommand"})],tr);let nr=class extends qa{constructor(e,t){super(e,{...t,useMacrosTemplate:!0}),this.injector=e,this.config=t}};nr=(0,p.__decorate)([M({type:"crt.LabelChangeViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],nr);let ar=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.config=t}innerExecute(){return this.designerSchemaService.moveToContainer(this.config),(0,d.of)({success:!0})}};ar=(0,p.__decorate)([M({type:"crt.MoveToContainerCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],ar);var ir;let Je=ir=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.config=t,this._viewCommandExecutor=e.get(g.ViewItemCommandExecutor)}static _hasCustomRemoveCommand(e){const t=h.InterfaceDesignerItemRegistry.get(e);return Boolean(t?.designViewItemCommands?.delete)}_removeDataSourceAttribute(e){const t=this.getMappedDataSourceName(e);if(t){const a=this.designerSchemaService.getViewConfigsByViewModelAttribute(e),i=this.designerSchemaService.getMappedDataSourceAttributePath(e),o=i.split(".").slice(1).join("."),s=this.designerSchemaService.findAllAttributesByDataSourceAttributePath(i);if(a.length===1)return this._dsManager.getDataSourceServiceByDataSourceName(t).pipe((0,d.switchMap)(c=>c.getIsNewAttribute(t,o).pipe((0,l.tap)(m=>{m&&this.designerSchemaService.removeViewModelAttribute(e)}),(0,l.map)(()=>c))),(0,d.switchMap)(c=>s.length===1?c.removeAttributeOnViewElementDelete(e):(0,d.of)(void 0)))}return(0,d.of)(void 0)}_removeViewModelAttribute(e){const t=this.getBoundAttributeName(e);return t?this._removeDataSourceAttribute(t):(0,d.of)(null)}_getNestedElementsWithCustomDeleteCommand(e){const t=new Array;return(0,C.getViewElementContentSlots)(e.type).forEach(i=>{const o=e[i];Array.isArray(o)&&o.forEach(s=>{ir._hasCustomRemoveCommand(s.type)&&t.unshift(s),t.unshift(...this._getNestedElementsWithCustomDeleteCommand(s))})}),t}_removeNestedItems(e){if(e.length===0)return(0,d.of)([]);const t=e.map(a=>this._viewCommandExecutor.remove(a).pipe((0,d.switchMap)(i=>i.execute())));return(0,d.forkJoin)(t)}getBoundAttributeName(e){return e&&e.startsWith("$")?e.slice(1):null}getMappedDataSourceName(e){const t=this.designerSchemaService.getMappedDataSourceAttributePath(e);return t?t.split(".").shift():null}injectDependencies(){return super.injectDependencies().pipe((0,l.tap)(()=>{this._dsManager=this.injector.get($)}))}innerExecute(){const e=this.designerSchemaService.getViewConfigInfoByName(this.config.itemName);if(!e.viewConfig)return(0,d.of)({success:!0});const t=this._getNestedElementsWithCustomDeleteCommand(e.viewConfig),a=h.ViewElementRegistry.getFormControlRelatesAttribute(e.viewConfig.type),i=e.viewConfig[a];return this._removeNestedItems(t).pipe((0,d.switchMap)(()=>this._removeViewModelAttribute(i)),(0,l.tap)(o=>this.designerSchemaService.remove(this.config.itemName)),(0,l.map)(o=>({success:!0})))}};Je=ir=(0,p.__decorate)([M({type:"crt.RemoveViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Je);let rr=class extends Je{constructor(e,t){super(e,t),this.filterViewElementConfigProvider=this.injector.get(oe),this._widgetDataProvidingMetadataCompressor=this.injector.get(Tt.ChartWidgetDataProvidingMetadataCompressor),this._featureValues=this.injector.get(C.FEATURE_VALUES)}_removeSeriesFilterAttributesBinding(e){(0,x.cloneDeep)(this.designerSchemaService.getViewConfigInfoByName(e)).viewConfig?.config?.series?.forEach(i=>this._removeFiltersFromCollection(i))}_removeFiltersFromCollection(e){if(!e.data?.providing?.filters?.filterAttributes)return;const t=e.data.providing.filters.filterAttributes.map(a=>a.attribute);this.filterViewElementConfigProvider.removeFiltersFromCollection(e.data.providing.attribute,t)}_compressWidgetMetadata(e){const t=this.designerSchemaService.schema;this._widgetDataProvidingMetadataCompressor.compress(e,t);const a=C.MetadataSchemaUtils.getViewConfigInfoByProperty("name",this.config.itemName,t.viewConfig)?.pop()?.viewConfig;this.designerSchemaService.update({itemConfig:a,modelConfig:t.modelConfig,viewModelConfig:t.viewModelConfig})}innerExecute(){if(this._featureValues[Tt.DISABLE_SUPPORT_WIDGET_DATA_SOURCE_FEATURE_NAME])return super.innerExecute();const e=this.config.itemName;return this._compressWidgetMetadata(e),this._removeSeriesFilterAttributesBinding(e),super.innerExecute()}};rr=(0,p.__decorate)([M({type:"crt.RemoveChartWidgetViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],rr);let yi=class extends Je{constructor(e,t){super(e,t),this._filterTargetsService=this.injector.get($t),this.filterViewElementConfigProvider=this.injector.get(oe)}_getViewElementConfig(e){return this.designerSchemaService.getViewConfigInfoByName(e)?.viewConfig}_getBoundCollectionAttributeName(e){const a=this._getViewElementConfig(e)?.items;if(typeof a=="string")return this.getBoundAttributeName(a)}_removeCollectionMetadata(e){const t=this.designerSchemaService.getViewModelAttribute(e);if(!e||!t)return;const a=this.getMappedDataSourceName(e);this.designerSchemaService.removeUnboundViewModelAttribute(e),this._removeCollectionFilterAttributes(e,t),this._removeCollectionPagingAttributes(t),this._removeCollectionSortingAttributes(t),this.designerSchemaService.removeDependedRelationConfigs(a),this.designerSchemaService.removeDataSourceDependencies(a),this.designerSchemaService.removeUnboundDataSource(a)}_removeCollectionFilterAttributes(e,t){const a=(t?.modelConfig?.filterAttributes??[]).map(i=>i?.name).filter(Boolean);!a.length||(this.filterViewElementConfigProvider.removeFiltersFromCollection(e,a),a.forEach(i=>this.designerSchemaService.removeUnboundViewModelAttribute(i)))}_removeCollectionPagingAttributes(e){const t=e.modelConfig?.pagingConfig?.rowsOffset;t&&this.designerSchemaService.removeUnboundViewModelAttribute(t)}_removeCollectionSortingAttributes(e){const t=e.modelConfig?.sortingConfig?.attributeName;t&&this.designerSchemaService.removeUnboundViewModelAttribute(t)}innerExecute(){const e=this.config.itemName,t=this._getBoundCollectionAttributeName(e);return this._filterTargetsService.removeBindingInQuickFilterViewItems(e),this._filterTargetsService.removeBindingInSearchFilterViewItems(e),super.innerExecute().pipe((0,d.tap)(()=>this._removeCollectionMetadata(t)))}};yi=(0,p.__decorate)([M({type:"crt.RemoveCollectionViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],yi);let or=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}innerExecute(){const e={itemConfig:this.config.viewConfig,resources:{strings:{}},viewModelConfig:this.designerSchemaService.getViewModelConfig(!0),applyPropertiesStrategies:this.config.applyPropertiesStrategies,...this.config.silentMode&&{selectOnCanvas:!1}};return this.designerSchemaService.update(e),(0,d.of)({success:!0})}};or=(0,p.__decorate)([M({type:"crt.UpdateViewConfigCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],or);let sr=class extends Je{constructor(e,t){super(e,t),this.filterViewElementConfigProvider=this.injector.get(oe),this._dataProvidingMetadataCompressor=this.injector.get(Tt.IndicatorWidgetDataProvidingMetadataCompressor),this._featureValues=this.injector.get(C.FEATURE_VALUES)}_removeFilterAttributesBinding(e){const t=this.designerSchemaService.getViewConfigInfoByName(e)?.viewConfig,{attribute:a,filters:i}=t?.config?.data?.providing??{},o=(i?.filterAttributes??[]).map(s=>s.attribute);this.filterViewElementConfigProvider.removeFiltersFromCollection(a,o)}_compressWidgetMetadata(e){const t=this.designerSchemaService.schema;this._dataProvidingMetadataCompressor.compress(e,t);const a=C.MetadataSchemaUtils.getViewConfigInfoByProperty("name",this.config.itemName,t.viewConfig)?.pop()?.viewConfig;this.designerSchemaService.update({itemConfig:a,modelConfig:t.modelConfig,viewModelConfig:t.viewModelConfig,applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig.config"}]})}innerExecute(){if(this._featureValues[Tt.DISABLE_SUPPORT_WIDGET_DATA_SOURCE_FEATURE_NAME])return super.innerExecute();const e=this.config.itemName;return this._compressWidgetMetadata(e),this._removeFilterAttributesBinding(e),super.innerExecute()}};sr=(0,p.__decorate)([M({type:"crt.RemoveIndicatorWidgetViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],sr);let cr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.config=t}innerExecute(){const a=(this.designerSchemaService.getViewConfigInfoByName(this.config.containerName)?.viewConfig??{}).items??[],i=this.injector.get(g.DesignerCommandFactoryService),o=a.map(s=>i.create("crt.RemoveViewItemCommand",{itemName:s.name}).pipe((0,d.switchMap)(c=>c.execute())));return(0,d.forkJoin)(o).pipe((0,l.defaultIfEmpty)(null),(0,l.map)(s=>({success:!0})))}};cr=(0,p.__decorate)([M({type:"crt.ClearViewContainerCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],cr);let lr=class extends Ve{_setSchemaProperties(e){const t=`${e.name}_showWeekends`;this.designerSchemaService.createViewModelAttribute(t,{value:!0}),e.useAutoScrollToCurrentTime=!0,e.showWeekends=`$${t}`,e.lightweightModeLimit=null,this._createHighlightedAreaAttrs(e)}_createHighlightedAreaAttrs(e){const t=`${e.name}_highlightedStartDate`,a=`${e.name}_highlightedEndDate`;this.designerSchemaService.createViewModelAttribute(t,{value:""}),this.designerSchemaService.createViewModelAttribute(a,{value:""}),e.highlightedStartDate=t,e.hightlightedEndDate=a}innerExecute(){return super.innerExecute().pipe((0,l.tap)(e=>{const t=e.createdViewElement;this._setSchemaProperties(t)}))}};lr=(0,p.__decorate)([M({type:"crt.AddCalendarCommand"})],lr);let vi=class extends yi{innerExecute(){return this.filterViewElementConfigProvider.removeFiltersByFilterViewElement(this.config.itemName),super.innerExecute()}};vi=(0,p.__decorate)([M({type:"crt.RemoveDataGridViewItemCommand"})],vi);let dr=class extends vi{_removeAttributes(){const e=`${this.config.itemName}_showWeekends`;this.designerSchemaService.removeViewModelAttribute(e)}_removeHighlightedAreaAttrs(){const e=`${this.config.itemName}_highlightedStartDate`,t=`${this.config.itemName}_highlightedEndDate`;this.designerSchemaService.removeViewModelAttribute(e),this.designerSchemaService.removeViewModelAttribute(t)}innerExecute(){return this._removeAttributes(),this._removeHighlightedAreaAttrs(),super.innerExecute()}};dr=(0,p.__decorate)([M({type:"crt.RemoveCalendarCommand"})],dr);let Si=class extends Ve{constructor(e,t){super(e,t),this.config=t,this._features=e.get(C.FEATURE_VALUES),this._commandFactoryService=e.get(g.DesignerCommandFactoryService)}_setInitialFeatures(e){if(Boolean(this._features[pi.DISABLE_DATA_GRID_MULTIPLE_ROWS_SELECTION_FEATURE_CODE]))return;const a=e.features??(e.features={});(0,_.isBindingExpression)(a)||this._setInitialRowsFeatures(a)}_setInitialRowsFeatures(e){if(e.rows?.selection!==void 0)return;const t={rows:{selection:{enable:!0,multiple:!0}}};(0,x.defaultsDeep)(e,t)}_setInitialFilterOptions(e){if(!(0,x.isEmpty)(e._filterOptions))return(0,d.of)(void 0);const a=this._createInitialFilterOptions(e);if(!a)return(0,d.of)(void 0);const i={viewConfig:e,filterOptions:a};return(0,g.executeCommand$)(this._commandFactoryService,"crt.SetFilterViewElementOptionsCommand",i).pipe((0,l.map)(()=>{}))}_createInitialFilterOptions(e){return(0,u.canDataGridContainsFilterOptions)(e)?(e.items??(e.items=`$${(0,u.createDataGridItemsAttributeName)(e)}`),e.activeRow??(e.activeRow=`$${(0,u.createDataGridActiveRowAttributeName)(e)}`),(0,u.createDataGridInitialFilterOptions)(e)):null}_setInitialSelectionOptions(e){if(!(0,x.isEmpty)(e._selectionOptions))return(0,d.of)(void 0);const a=this._createInitialSelectionOptions(e);if(!a)return(0,d.of)(void 0);const i={viewConfig:e,selectionOptions:a};return(0,g.executeCommand$)(this._commandFactoryService,"crt.SetSelectionViewElementOptionsCommand",i).pipe((0,l.map)(()=>{}))}_createInitialSelectionOptions(e){return(0,u.canDataGridContainsSelectionOptions)(e)?(e.selectionState??(e.selectionState=`$${(0,u.createDataGridSelectionStateAttributeName)(e)}`),(0,u.createDataGridInitialSelectionOptions)(e)):null}getCreatedDataGridViewConfig(e){return e.createdViewElement}innerExecute(){return super.innerExecute().pipe((0,d.switchMap)(e=>{const t=this.getCreatedDataGridViewConfig(e);this._setInitialFeatures(t);const a=this._setInitialFilterOptions(t),i=this._setInitialSelectionOptions(t);return(0,d.forkJoin)([a,i]).pipe((0,l.map)(()=>e))}))}};Si=(0,p.__decorate)([M({type:"crt.CreateDataGridItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Si);let mr=class extends Si{constructor(e,t){super(e,t)}getCreatedDataGridViewConfig(e){return C.MetadataSchemaUtils.getViewConfigInfoByFilter(t=>t.type==="crt.DataGrid",[e.createdViewElement])?.[0]?.viewConfig}};mr=(0,p.__decorate)([M({type:"crt.CreateExpandedDataGridItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],mr);let pr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this._config=t,this._commandFactoryService=this.injector.get(g.DesignerCommandFactoryService),this._designerSchemaService=this.injector.get(g.DesignerSchemaService),this._userInfo=this.injector.get(C.UserInfo),this._resourceFinderService=this.injector.get(C.ResourceFinderService),this._translateService=this.injector.get(D.TranslateService)}_getViewConfigByRequestName(e,t,a){return C.MetadataSchemaUtils.getViewConfigInfoByFilter(o=>o.name?.includes(u.EXPANDED_LIST_DATA_GRID_PREFIX)&&o.type===t&&o.clicked?.request===a,[e])?.[0]}_updateCreateRecordButton(e){const t=this._getViewConfigByRequestName(e,"crt.Button","crt.CreateRecordRequest")?.viewConfig;if(!t)return;const a={clicked:{params:{entityName:this._config.entitySchemaName}}},i=(0,x.merge)(t,a);this._updateViewConfig(i)}_updateReloadRecordsButton(e){const t=this._getViewConfigByRequestName(e,"crt.Button","crt.LoadDataRequest")?.viewConfig;if(!t)return;const a={clicked:{params:{dataSourceName:this._config.dataSourceName}}},i=(0,x.merge)(t,a);this._updateViewConfig(i)}_updateExportToExelButton(e){const t=this._getViewConfigByRequestName(e,"crt.MenuItem","crt.ExportDataGridToExcelRequest")?.viewConfig;if(!t)return;const a={clicked:{params:{viewName:this._config.dataGridViewElementName}}},i=(0,x.merge)(t,a);this._updateViewConfig(i)}_updateImportDataButton(e){const t=this._getViewConfigByRequestName(e,"crt.MenuItem","crt.ImportDataRequest")?.viewConfig;if(!t)return;const a={clicked:{params:{entitySchemaName:this._config.entitySchemaName}}},i=(0,x.merge)(t,a);this._updateViewConfig(i)}_updateSearchComponent(e){const a=C.MetadataSchemaUtils.getViewConfigInfoByFilter(i=>i.name?.includes(u.EXPANDED_LIST_DATA_GRID_PREFIX)&&i.type==="crt.SearchFilter",[e])?.[0];!a||this._updateViewConfig({...a.viewConfig,targetAttributes:[this._config.dataGridViewElementName]})}_getExpantionPanelViewConfig(){const e=this._designerSchemaService.getViewConfigInfoByName(this._config.dataGridViewElementName),t=this._designerSchemaService.getViewConfigInfoByName(e?.parentName??""),a=this._designerSchemaService.getViewConfigInfoByName(t?.parentName??"")?.viewConfig;return!a||a.type!=="crt.ExpansionPanel"?null:a}_updateViewConfig(e){const t={silentMode:!0,viewConfig:e};this._commandFactoryService.create("crt.UpdateViewConfigCommand",t).pipe((0,d.mergeMap)(a=>a.execute()),(0,d.take)(1)).subscribe()}_updateExpantionPanelCaption(e){const t=e.title,a=this._resourceFinderService.findLocalizationFromResourceString(t,this._config.resources),i=a.findIndex(T=>T.cultureName===this._userInfo.cultureInfo.sysCultureName),o=this._translateService.instant(u.EXPANDED_LIST_DEFAULT_CAPTION_KEY),s=a[i].value,c=t.replace(new RegExp("\\#ResourceString\\(([a-zA-Z0-9.-_]+)\\)\\#"),"$1"),m=this._config.oldEntitySchemaCaption||"";if(!(s===m||s===o))return;a[i].value=this._config.entitySchemaCaption;const y={selectOnCanvas:!1,name:e.name,resourceChanges:[{name:c,value:a}],changes:[{path:"itemConfig.title",value:t}]};this._commandFactoryService.create("crt.ChangeViewItemCommand",y).pipe((0,d.mergeMap)(T=>T.execute()),(0,d.take)(1)).subscribe()}innerExecute(){const e=this._getExpantionPanelViewConfig();return e?(this._updateExpantionPanelCaption(e),this._updateCreateRecordButton(e),this._updateReloadRecordsButton(e),this._updateExportToExelButton(e),this._updateImportDataButton(e),this._updateSearchComponent(e),(0,d.of)({success:!0})):(0,d.of)({success:!0})}};pr=(0,p.__decorate)([M({type:"crt.ConfigureExpandedListRelatedElementsCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],pr);let gr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}injectDependencies(){return this._schemaService=this.injector.get(_.SchemaService),super.injectDependencies()}innerExecute(){return this._schemaService.setPrimaryDataSource(this.config.dataSourceName),(0,d.of)({success:!0})}};gr=(0,p.__decorate)([M({type:"crt.ChangePrimaryDataSource"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],gr);class Ka extends gn{constructor(e,t){super(e,t),this.config=t}_copyViewConfig(){const e=this._getCurrentViewConfigInfo(),t=(0,x.cloneDeep)(e.viewConfig);return this.prepareViewConfig(t),t}_getNewItemsAttribute(e,t){if(!t||!(0,_.isBindingExpression)(t))return{changedViewModelAttributesMap:null,newItems:t};const a=(0,_.parseExpression)(t).attributePath,i=this.designerSchemaService.getViewModelAttribute(a),o=e;if(!i)return{newItems:`$${o}`,changedViewModelAttributesMap:null};const s=`${e}${I.DATA_SOURCE_PREFIX}`,c=i.modelConfig?.path;this._copyDataSource(s,a),this._copyDependencies(s,c);const{newViewModelAttributes:m,changedViewModelAttributesMap:b}=this._copyViewModelAttributes(c,s,i.viewModelConfig.attributes),y=this.getViewModelAttributeConfig(s);return y.viewModelConfig.attributes=m,this.designerSchemaService.createViewModelAttribute(o,y),{changedViewModelAttributesMap:b,newItems:`$${o}`,newDataSourceName:s}}_copyDataSource(e,t){const a=this.designerSchemaService.getMappedDataSourceAttributePath(t),i=this.designerSchemaService.getDataSourceConfigByName(a);!i||this.designerSchemaService.createDataSource(e,{type:"crt.EntityDataSource",scope:h.DataSourceScope.ViewElement,config:(0,x.cloneDeep)(i)})}_copyDependencies(e,t){const a=this.designerSchemaService.getModelDependencies()||{},i=a[t];a[e]=i,this.designerSchemaService.setModelDependencies(a)}_copyViewModelAttributes(e,t,a){const i=new Map,o=Object.entries(a).reduce((s,[c,m])=>{const b=c.replace(e,t);i.set(c,b);let y;return(0,I.isModelAttributeConfig)(m)&&(y=m.modelConfig.path.replace(e,t)),s[b]={modelConfig:{path:y}},s},{});return{changedViewModelAttributesMap:i,newViewModelAttributes:o}}_saveNewViewConfig(e,t){const a=this.config.index??this.designerSchemaService.getViewConfigInfoByName(this.config.name)?.index;this.designerSchemaService.create({parentName:this.config.parentName??this._getCurrentViewConfigInfo().parentName,defaultViewConfig:(0,x.pickBy)(e,i=>i!=null),defaultConfig:{type:this.viewItemType,defaultPropertyValues:{name:t}},propertyName:this.config.propertyName,index:a})}_getCurrentViewConfigInfo(){return this.designerSchemaService.getViewConfigInfoByProperty("name",this.config.name)[0]}getViewModelAttributeConfig(e){return{isCollection:!0,modelConfig:{path:e},viewModelConfig:{attributes:{}}}}innerExecute(){const e=this._copyViewConfig(),t=G.NameGenerator.generateUnique(this.viewItemName),{changedViewModelAttributesMap:a,newItems:i,newDataSourceName:o}=this._getNewItemsAttribute(t,e.items);return e.items=i,e.name=t,this.setupAdditionalViewConfigOptions(e,a,o),this._saveNewViewConfig(e,t),(0,d.of)({success:!0})}}Ka.\u0275fac=function(e){n.\u0275\u0275invalidFactory()},Ka.\u0275dir=n.\u0275\u0275defineDirective({type:Ka,features:[n.\u0275\u0275InheritDefinitionFeature]});let Ja=class extends Ka{constructor(e,t){super(e,t),this.viewItemName="DataGrid",this.viewItemType="crt.DataGrid"}_getNewPrimaryColumnName(e,t){return e?.get(t)||t}_getNewColumns(e,t){return!t||typeof t=="string"?t:t.map(i=>{delete i.cellView;const o=e?.get(i.code)||i.code;return{...i,id:(0,h.generateGuid)(),code:o,caption:i.caption?.replace(new RegExp(i.code,"g"),o)}})}prepareViewConfig(e){delete e.sorting,delete e.sortingChange,delete e.paginationChange,delete e.selectedRowsChange,delete e.placeholder}_resetActiveRow(e){(0,_.isBindingExpression)(e.activeRow)&&(e.activeRow=`$${(0,u.createDataGridActiveRowAttributeName)(e)}`)}_resetSelectedRows(e){const t=e;(0,_.isBindingExpression)(t.selectedRows)&&(t.selectedRows=`$${(0,u.createDataGridSelectedRowsAttributeName)(e)}`)}_resetSelectionState(e){(0,_.isBindingExpression)(e.selectionState)&&(e.selectionState=`$${(0,u.createDataGridSelectionStateAttributeName)(e)}`)}_resetFilterOptions(e){e._filterOptions&&(e._filterOptions=(0,u.createDataGridInitialFilterOptions)(e))}_resetSelectionOptions(e){e._selectionOptions&&(e._selectionOptions=(0,u.createDataGridInitialSelectionOptions)(e))}_resetBulkActions(e,t){const a=this.injector.get(u.DataGridDefaultBulkActionsCreator);e.bulkActions=a.createDefaultBulkActions(t,e)}setupAdditionalViewConfigOptions(e,t,a){e.primaryColumnName=this._getNewPrimaryColumnName(t,e.primaryColumnName),e.columns=this._getNewColumns(t,e.columns),this._resetActiveRow(e),this._resetSelectedRows(e),this._resetFilterOptions(e),this._resetSelectionState(e),this._resetSelectionOptions(e),this._resetBulkActions(e,a)}};Ja=(0,p.__decorate)([M({type:"crt.CopyDataGridItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Ja);let ur=class extends Ja{constructor(e,t){super(e,t),this._defaultSorting={columnName:"CreatedOn",direction:"desc"},this.viewItemName="ApprovalList",this.viewItemType="crt.ApprovalList"}getViewModelAttributeConfig(e){const t=super.getViewModelAttributeConfig(e),a={sortingConfig:{default:[this._defaultSorting]}};return t.modelConfig={...t.modelConfig,...a},t}};ur=(0,p.__decorate)([M({type:"crt.CopyApprovalListItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],ur);let hr=class extends Je{constructor(e,t){super(e,t),this.config=t,this._relatedViewElementsService=e.get(_.RelatedViewElementsService),this._viewItemCommandExecutor=e.get(g.ViewItemCommandExecutor)}_setTabPanelMode(e){if(!e)return(0,d.of)(null);const t={path:"itemConfig.mode",value:"tab"};return this._viewItemCommandExecutor.change(e,[t]).pipe((0,l.switchMap)(a=>a.execute()))}innerExecute(){return this._relatedViewElementsService.getRelatedForViewConfig(this.config.itemName).pipe((0,l.switchMap)(e=>(0,d.forkJoin)([(0,d.of)(e),this._relatedViewElementsService.getRelatedToViewElementConfig(e.name)])),(0,l.switchMap)(([e,t])=>t.length===1?this._setTabPanelMode(e):(0,d.of)(null)),(0,l.switchMap)(()=>super.innerExecute()))}};hr=(0,p.__decorate)([M({type:"crt.RemoveButtonToggleGroupViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],hr);let br=class extends Je{innerExecute(){const t=this.designerSchemaService.getViewConfigInfoByName(this.config.itemName).viewConfig.items,a=this.getBoundAttributeName(t);return a&&this.designerSchemaService.getViewConfigInfoByProperty("items",t).length===1&&this.designerSchemaService.removeViewModelAttribute(a),super.innerExecute()}};br=(0,p.__decorate)([M({type:"crt.RemoveComboBoxViewItemCommand"})],br);class _r extends Ve{findReferencedItemComponent(e){return this.designerSchemaService.getViewConfigInfoByName(e)?.viewConfig}getReferenceColumnForEntity(e){return this.entitySchemaName===e?e:""}applyComponentProperties(e,t,a){e.referenceColumn=`$${t}`,e.readonly=!1}trySetRefereceColumn(e){const t=this.findReferencedItemComponent(e);if(!t)return;const a=this.designerSchemaService.getPrimaryDataSourceName();if(!a)return;const i=this.designerSchemaService.getDataSourceConfigByName(a),o=this.getReferenceColumnForEntity(i?.entitySchemaName);if(!o)return;const s=`${a}.Id`,c=this.designerSchemaService.findAllAttributesByDataSourceAttributePath(s);let m=c&&c.length>0?c[0]:null;m=m||this.designerSchemaService.getOrAddViewModelAttribute("Id","#PrimaryDataSourceName()#"),this.applyComponentProperties(t,m,o)}innerExecute(){return super.innerExecute().pipe((0,l.tap)(e=>{this.trySetRefereceColumn(e.createdViewElement?.name)}))}}let fr=class extends _r{constructor(){super(...arguments),this.allowedEntityNames={Contact:"Contact",Account:"Account"}}_findExpansionPanel(e){return this.designerSchemaService.getViewConfigInfoByName(e).viewConfig}_findCommOptions(e){const t=C.MetadataSchemaUtils.getViewConfigInfoByFilter(a=>a.type==="crt.CommunicationOptions",[e]);return t.length&&t[0]}_findButtonWithRequest(e,t){const a=C.MetadataSchemaUtils.getViewConfigInfoByFilter(i=>i.type==="crt.Button"&&i.clicked?.request===t,[e]);return a.length&&a[0]}_updateExpansionPanelElements(e){const t=this._findExpansionPanel(e);if(!t)return;const a=this._findCommOptions(t);if(!a)return;const i=this._findButtonWithRequest(t,"crt.AddCommunicationOptionsRequest");if(i&&i.viewConfig.clicked){const o=i.viewConfig.clicked.params||{};o.viewElementName=a.viewConfig.name,i.viewConfig.clicked.params=o}}innerExecute(){return super.innerExecute().pipe((0,l.tap)(e=>{this._updateExpansionPanelElements(e.createdViewElement?.name||"")}))}getReferenceColumnForEntity(e){return this.allowedEntityNames[e]}findReferencedItemComponent(e){const t=this._findExpansionPanel(e);if(!!t)return this._findCommOptions(t)?.viewConfig}applyComponentProperties(e,t,a){e.masterRecordColumnValue=`$${t}`,e.masterRecordColumnName=a,e.readonly=!1}};fr=(0,p.__decorate)([M({type:"crt.AddCommunicationOptionsCommand"})],fr);let Cr=class extends Ja{constructor(e,t){super(e,t),this.viewItemName="CommunicationOptions",this.viewItemType="crt.CommunicationOptions"}};Cr=(0,p.__decorate)([M({type:"crt.CopyCommunicationOptionsItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Cr);let yr=class extends _r{constructor(){super(...arguments),this.entitySchemaName="Account"}};yr=(0,p.__decorate)([M({type:"crt.AddAccountCompactProfileCommand"})],yr);let vr=class extends _r{constructor(){super(...arguments),this.entitySchemaName="Contact"}};vr=(0,p.__decorate)([M({type:"crt.AddContactCompactProfileCommand"})],vr);let wi=class extends Ve{get controlName(){return this.config?.designerTool?.dataValueType===h.DataValueType.IMAGELOOKUP?"value":"control"}constructor(e,t){super(e,t)}_addViewModelAttribute(e,t,a){return this.designerSchemaService.createDefaultAttribute(e),this.designerSchemaService.bindViewModelAttribute(e,t,a),(0,d.of)({success:!0})}_specifyImageLookupDesignerToolConfig(e){const t=e.defaultConfig;t.defaultPropertyValues={...t.defaultPropertyValues,size:P.SizeEnum.Large,borderRadius:P.SizeEnum.Medium,positioning:"cover"},delete t.defaultPropertyValues.label}_specifyLookupDesignerToolConfig(e){const t=e.defaultConfig;t.defaultPropertyValues={...t.defaultPropertyValues,listActions:[{...u.defaultAddRecordActionConfig,name:"addRecord_"+C.GENERATE_GUID_MACRO,defaultLocalizableStrings:{caption:"Components.Combobox.AddNewRecord"}}],showValueAsLink:!0}}updateDesignerToolConfigs(e,t){const a=e.dataSourceConfig,i=e.defaultConfig;a.viewModelAttributeName=t,i.defaultPropertyValues={...i.defaultPropertyValues,label:`$Resources.Strings.${t}`,labelPosition:i.defaultPropertyValues?.labelPosition||"auto"};const o=this.controlName;i.defaultPropertyValues[o]=`$${t}`,e.dataValueType===h.DataValueType.IMAGELOOKUP&&this._specifyImageLookupDesignerToolConfig(e),e.dataValueType===h.DataValueType.Lookup&&this._specifyLookupDesignerToolConfig(e)}innerExecute(){const e=this.config.designerTool,t=e.dataSourceConfig,a=t.dataSourceName,i=t.dataSourceAttributeName,o=`${a}_${i}`,s=this.designerSchemaService.generateUniqueAttributeNameByType(o);return this.updateDesignerToolConfigs(e,s),this._addViewModelAttribute(s,a,i).pipe((0,l.mergeMap)(()=>super.innerExecute()))}};wi=(0,p.__decorate)([M({type:"crt.AddDataSourceItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],wi);let Sr=class extends wi{constructor(e,t){super(e,t)}_createAttribute(e,t){return e.createAttribute(t).pipe((0,l.mergeMap)(a=>(t.dataSourceConfig.dataSourceAttributeName=a,super.innerExecute())))}injectDependencies(){return super.injectDependencies().pipe((0,l.tap)(()=>{this._designerDataSourceManager=this.injector.get($)}))}innerExecute(){const e=this.config.designerTool,a=e.dataSourceConfig.dataSourceName;return this._designerDataSourceManager.getDataSourceServiceByDataSourceName(a).pipe((0,l.mergeMap)(i=>this._createAttribute(i,e)))}};Sr=(0,p.__decorate)([M({type:"crt.AddNewDataSourceItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Sr);let wr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t,this.dataSourceManager=this.injector.get($)}_generateViewModelAttributeData(e){const t=e.split(".");let a,i;return t.length>2?(a=this._createDataSourceConfigAttribute(t),i=`${t[0]}.${a}`):(a=this.designerSchemaService.generateUniqueAttributeNameByType("Parameter"),i=e),{viewModelAttributeName:a,viewModelAttributePath:i}}_findOrCreateViewModelAttribute(e){const t=this._findViewModelAttributeByDataSourcePath(e);if(t)return(0,d.of)(t);{const{viewModelAttributeName:a,viewModelAttributePath:i}=this._generateViewModelAttributeData(e);return this._createViewModelAttribute(a,i).pipe((0,l.map)(()=>a))}}_findAttributeByDataSourceAttributePath(e){const t=this.designerSchemaService.findAllAttributesByDataSourceAttributePath(e);return t&&t.length>0?t[0]:null}_findViewModelAttributeByDataSourcePath(e){if(this.designerSchemaService.getIsPrimaryDataSourceAttributePath(e)){const t=this.designerSchemaService.toPrimaryDataSourceMacrosAttributePath(e);return this._findAttributeByDataSourceAttributePath(e)||this._findAttributeByDataSourceAttributePath(t)}return this._findAttributeByDataSourceAttributePath(e)}_createViewModelAttribute(e,t){if(!this.designerSchemaService.isViewModelAttributeExists(e)){const a=t.split("."),i=a[0],o=a[1];this.designerSchemaService.createDefaultAttribute(e),this.designerSchemaService.bindViewModelAttribute(e,i,o)}return(0,d.of)(null)}_createDataSourceConfigAttribute(e){const t=e[0],a=this.designerSchemaService.getDataSourceConfigByName(t);a.attributes||(a.attributes={});const i=e.slice(1),o=i.join(""),s={path:i.join("."),type:"ForwardReference"};return a.attributes={...a.attributes,[o]:s},this.designerSchemaService.bindDataSource(t,a),o}innerExecute(){const e=this.config.changes[0]?.value;return this._findOrCreateViewModelAttribute(e).pipe((0,l.map)(t=>({success:!0,viewModelAttributeName:t})))}};wr=(0,p.__decorate)([M({type:"crt.ChangeRequestParameterBindingCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],wr);let Dr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}_updateDataSourceAttributePathOnNameChange(e,t,a){const i=this.config.changes.find(s=>s.path==="name"),o=this._getViewModelAttributeNamesByPath(e,t);i&&o&&o.length>0&&o.forEach(s=>{if(this.designerSchemaService.bindViewModelAttribute(s,e,i.value),a){const c=`${e}_${i.value}`,m=this.designerSchemaService.generateUniqueAttributeNameByType(c);this.designerSchemaService.renameViewModelAttribute(s,m)}else this.designerSchemaService.getViewConfigInfoByFilter(m=>{const b=h.ViewElementRegistry.getFormControlRelatesAttribute(m.type);return m[b]?.startsWith(`$${s}`)}).forEach(m=>{this.designerSchemaService.update({itemConfig:{name:m.viewConfig.name},selectOnCanvas:!1})})})}_getViewModelAttributeNamesByPath(e,t){return this.designerSchemaService.findAllAttributesByDataSourceAttributePath(`${e}.${t}`)}_getControlType(e,t){return e&&this._attributeConfigProvider.getControlTypeToReplace(e,t)||t}_updateViewElements(e,t){const a=this.injector.get(g.AttributeControlExtraConfigProvider);e.forEach(i=>{const o=this.config.changes.some(b=>["type"].includes(b.path)),s=o?this._getControlType(t.dataValueType,i.viewConfig.type):i.viewConfig.type,c=a.getControlExtraConfig(s,t.dataValueType,Boolean(t.isMultiLineText))||{};o&&(c.type=s);const m=this.config.changes.some(b=>["caption","requirementType"].includes(b.path));(c||m||o)&&this.designerSchemaService.update({itemConfig:{name:i.viewConfig.name,...c},selectOnCanvas:!1})})}_changeAttribute(e,t,a){const i=this.config.changes.find(s=>s.path==="name"),o=i?i.value:a;return e.changeAttribute(t,a,this.config.changes).pipe((0,l.tap)(s=>{if(!s)return null;this._getViewModelAttributeNamesByPath(t,a).forEach(m=>{const b=this.designerSchemaService.getViewConfigsByViewModelAttribute(m);b&&this._updateViewElements(b,s)})}),(0,d.switchMap)(()=>e.getIsNewAttribute(t,o)),(0,l.tap)(s=>this._updateDataSourceAttributePathOnNameChange(t,a,s)),(0,l.map)(()=>({success:!0})))}injectDependencies(){return super.injectDependencies().pipe((0,l.tap)(()=>{this._designerDataSourceManager=this.injector.get($),this._attributeConfigProvider=this.injector.get(g.AttributeConfigProvider)}))}innerExecute(){const e=this.config.name.split("."),t=e[0],a=e[1];return this._designerDataSourceManager.getDataSourceServiceByDataSourceName(t).pipe((0,d.switchMap)(i=>this._changeAttribute(i,t,a)))}};Dr=(0,p.__decorate)([M({type:"crt.ChangeDataSourceItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Dr);let Mr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}_getRemoveViewItemCommand(e){return this._viewItemCommandExecutor.remove(e)}_removeAttribute(e,t){return this._designerDataSourceManager.getDataSourceSchemaByName$(e).pipe((0,l.switchMap)(a=>{const o=a.findAttributeByName(t)?.caption||t;return this._designerDataSourceManager.getDataSourceServiceByDataSourceName(e).pipe((0,d.mergeMap)(s=>s.removeAttribute(t)),(0,d.map)(()=>(this._showNotification(o),{success:!0})))}))}_getDataSourceAttributePath(e,t){return`${e}.${t}`}_getViewElementConfigs(e,t){const a=this._getDataSourceAttributePath(e,t),i=this.designerSchemaService.findAttributeByDataSourceAttributePath(a),o=[];return i&&this.designerSchemaService.getViewConfigsByViewModelAttribute(i).forEach(c=>{c.viewConfig&&c.viewConfig.name&&o.push(c.viewConfig)}),o}_showNotification(e){const t="InterfaceDesigner.Commands.RemoveDataSourceItem.SuccessfullyRemoved",a=this._translateService.instant(t,{parameterCaption:e});this._notifyService.show({message:a})}injectDependencies(){return super.injectDependencies().pipe((0,d.tap)(()=>{this._designerDataSourceManager=this.injector.get($),this._notifyService=this.injector.get(w.NotifyService),this._viewItemCommandExecutor=this.injector.get(g.ViewItemCommandExecutor),this._translateService=this.injector.get(D.TranslateService)}))}innerExecute(){const e=this.config.dataSourceConfig,t=this._getViewElementConfigs(e.dataSourceName,this.config.name),a={success:!0},i=t.map(o=>this._getRemoveViewItemCommand(o).pipe((0,l.switchMap)(c=>c.execute())));return i.length===0?this._removeAttribute(e.dataSourceName,this.config.name):(0,d.forkJoin)(i).pipe((0,d.mergeMap)(o=>o.every(s=>s.success)?this._removeAttribute(e.dataSourceName,this.config.name):(a.success=!1,(0,d.of)(a))))}};Mr=(0,p.__decorate)([M({type:"crt.RemoveDataSourceItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Mr);let xr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t,this.controlName="control"}injectDependencies(){return super.injectDependencies().pipe((0,l.tap)(()=>{this._dsManager=this.injector.get($)}))}_generateViewModelAttributeData(e,t){const a=e.split(".");let i,o;if(a.length>2){const s=this._createDataSourceConfigAttribute(a);i=`${a[0]}_${s}`,o=`${a[0]}.${s}`}else i=this.designerSchemaService.generateUniqueAttributeNameByType(`${a[0]}_${a[1]}`),o=e;return{viewModelAttributeName:i,viewModelAttributePath:o}}_createViewModelAttribute(e,t){const{viewModelAttributeName:a,viewModelAttributePath:i}=this._generateViewModelAttributeData(e,t);if(!this.designerSchemaService.isViewModelAttributeExists(a)){const o=i.split("."),s=o[0],c=o[1];this.designerSchemaService.createDefaultAttribute(a),this.designerSchemaService.bindViewModelAttribute(a,s,c)}return(0,d.of)(a)}_createDataSourceConfigAttribute(e){const t=e[0],a=this.designerSchemaService.getDataSourceConfigByName(t);a.attributes||(a.attributes={});const i=e.slice(1),o=i.join(""),s={path:i.join("."),type:"ForwardReference"};return a.attributes={...a.attributes,[o]:s},this.designerSchemaService.bindDataSource(t,a),o}_generateItemConfig(e,t,a){let i={};return i={name:this.config.name,label:`$Resources.Strings.${t}`},i[this.controlName]="$"+t,a===g.AttributeControlDataValueTypeDesignConfig.Combobox.controlType&&(i={...i}),i}_getExtraConfig(e,t){const a=e.split("."),i=a.shift(),o=a.join(".");return this._dsManager.getDataSourceServiceByDataSourceName(i).pipe((0,l.switchMap)(s=>s.getControlConfig(t,i,o)))}_removeDataSourceAttributeIfNeeded(){const e=this.designerSchemaService.getViewConfigInfoByName(this.config.name),t=e.viewConfig[this.controlName]?.slice(1);if(!t||!e.viewConfig[this.controlName]?.startsWith("$"))return(0,d.of)(null);const a=this.designerSchemaService.getMappedDataSourceAttributePath(t);if(!a)return(0,d.of)(null);const i=a.split(".").shift(),o=a.split(".").slice(1).join("."),s=this.designerSchemaService.getViewConfigsByViewModelAttribute(t),c=this.designerSchemaService.findAllAttributesByDataSourceAttributePath(a);return s.length>1?(0,d.of)(null):this._dsManager.getDataSourceServiceByDataSourceName(i).pipe((0,l.mergeMap)(m=>m.getIsNewAttribute(i,o).pipe((0,l.tap)(b=>{b&&this.designerSchemaService.removeViewModelAttribute(t)}),(0,l.mergeMap)(()=>c.length===1?m.removeAttributeOnViewElementDelete(t):(0,d.of)(void 0)))))}innerExecute(){const e=this.config.changes.find(y=>y.useForBinding===!0);this.controlName=e?.path??this.controlName;const t=this.config.changes.find(y=>y.path===this.controlName).value,a=this.config.changes.find(y=>y.path==="readOnlyConfig").value,o=this.designerSchemaService.getViewConfigInfoByName(this.config.name).viewConfig,s=o[this.controlName]?.toString();let c={...a};if(!t)return s?.startsWith("$")&&(this.designerSchemaService.removeDataSourceAttributePath(s.slice(1)),this.designerSchemaService.update({itemConfig:{...c}})),(0,d.of)({success:!0});const b=t.split(".")[1];return this._removeDataSourceAttributeIfNeeded().pipe((0,l.switchMap)(()=>(0,d.forkJoin)([this._createViewModelAttribute(t,o.type),this._getExtraConfig(t,o.type)])),(0,l.tap)(([y,T])=>{y&&(c={...c,...T,...this._generateItemConfig(b,y,o.type)}),this.designerSchemaService.update({itemConfig:{...c}})}),(0,l.map)(()=>({success:!0})))}};xr=(0,p.__decorate)([M({type:"crt.ChangeViewItemBinding"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],xr);let Ir=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}innerExecute(){const e=this.injector.get(B);return this.config.oldName?e.updateEntity(this.config.oldName,[{path:"caption",value:this.config.caption},{path:"name",value:this.config.name}]).pipe((0,l.map)(t=>({success:!0,lookupSchemaUId:t.uId}))):e.createLookupDesignItem(this.config.caption,this.config.name).pipe((0,l.map)(t=>({success:!0,lookupSchemaUId:t.uId})))}};Ir=(0,p.__decorate)([M({type:"crt.CreateOrEditLookupEntityCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Ir);let Pr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}innerExecute(){const{columns:e,dataSourceName:t,dataSourceAttributePaths:a}=this.config,i=this.designerSchemaService.getEntityDataSourceConfigService(t);let o=[];if(i){let s=a.map(c=>({name:c,path:c}));e?.length>0&&(s=a.map(c=>{const m=e.filter(L=>L.code===`${t}_${c}`)[0];let b;m.aggregationConfig?.aggregationFunction&&(b=h.DataSchemaAttributeType.AggregationAttribute);const y=m.code.split(`${t}_`).pop(),T=m.path||c;return{name:y,path:T,type:b,aggregationConfig:m.aggregationConfig,caption:m.caption}})),i.setAttributes(s),o=i.getAttributeNames(),i.apply()}return(0,d.of)({dataSourceAttributeNames:o,success:!0})}};Pr=(0,p.__decorate)([M({type:"crt.UpdateEntityDataSourceAttributes"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Pr);let Er=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}_addColumn(e,t){(this.config.columnConfigs||[]).forEach(a=>{const i=(e||"")+a.name,o=ie.OwnEntitySchemaColumn.create(i,a.dataValueType);o.caption=a.caption,a.requirementType&&(o.requirementType=a.requirementType),t.addColumn(o),this.config.primaryDisplayColumnName===a.name&&(t.primaryDisplayColumn=o)})}innerExecute(){const e=this.injector.get(B);return(0,d.forkJoin)([e.schemaNamePrefix,e.createDesignItem(this.config.caption,this.config.description)]).pipe((0,l.tap)(([t,a])=>this._addColumn(t,a)),(0,l.map)(([t,a])=>({success:!0,entitySchemaName:a.name})))}};Er=(0,p.__decorate)([M({type:"crt.AddEntityCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Er);let Tr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t,this._designerLoaderService=e.get(g.DesignerLoaderService),this._commandFactoryService=e.get(g.DesignerCommandFactoryService)}_createEntity(){return(0,g.executeCommand$)(this._commandFactoryService,"crt.AddEntityCommand",this.config)}_createEntityDataSource(e){const t=e+I.DATA_SOURCE_PREFIX,a={type:"crt.EntityDataSource",scope:this.config.scope,config:{entitySchemaName:e}};return this.designerSchemaService.createDataSource(t,a),{success:!0,dataSourceName:t,entitySchemaName:e}}innerExecute(){return this._designerLoaderService.resetLoadingPart(g.LoadingPart.DataSourceLoaded),this._createEntity().pipe((0,l.map)(e=>e.success?this._createEntityDataSource(e.entitySchemaName):{...e,dataSourceName:void 0}))}};Tr=(0,p.__decorate)([M({type:"crt.AddEntityDataSourceCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Tr);let Or=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}_updateDSConfigEntitySchemaNameOnNameChange(){const e=this.config.changes.find(t=>t.path==="name");if(e){const t=this.config.name,a=this.designerSchemaService.getDataSourceConfigByName(t);a.entitySchemaName=e.value,this.designerSchemaService.bindDataSource(t,a)}}innerExecute(){const e=this.injector.get(le),t=this.injector.get(B);return e.getDataSourcesInfo$().pipe((0,l.take)(1),(0,l.mergeMap)(a=>{const i=this.config.name,o=a.find(s=>s.dataSourceName===i);return t.updateEntity(o.entitySchemaName,this.config.changes).pipe((0,l.tap)(()=>this._updateDSConfigEntitySchemaNameOnNameChange()))}),(0,l.mergeMap)(()=>(0,d.of)({success:!0})))}};Or=(0,p.__decorate)([M({type:"crt.ChangeEntityDataSourceCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Or);let Ar=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.config=t,this._errorHandler=e.get(C.RestAccumulatingErrorHandler),this._featureValues=e.get(C.FEATURE_VALUES)}innerExecute(){const e=this.injector.get(Aa.EntitySchemaDesignerService),t=this.injector.get(le);let a=[];return t.getDataSourcesInfo$().pipe((0,l.take)(1),(0,l.mergeMap)(i=>(a=i.filter(o=>o.scope==="page").map(o=>o.entitySchemaName).filter(o=>e.getIsSchemaModified(o)),this._errorHandler.handleRequestWithAccumulation(e.saveDesignItems((0,x.uniq)(i.map(o=>o.entitySchemaName)))).pipe((0,l.tap)(()=>{if(!!this._featureValues?.UseRequireEntitySchema8x)for(const o of a)t.invalidateRuntimeSchemaCache(o)}),(0,l.map)(o=>({success:o.success}))))))}};Ar=(0,p.__decorate)([M({type:"crt.SaveEntityDataSourcesCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Ar);let Vr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}innerExecute(){const e={type:"crt.EntityDataSource",scope:h.DataSourceScope.Page,config:{entitySchemaName:this.config.entitySchemaName}},t=this.config.entitySchemaName+I.DATA_SOURCE_PREFIX;try{return this.designerSchemaService.createDataSource(t,e),(0,d.of)({success:!0})}catch{return(0,d.of)({success:!1})}}};Vr=(0,p.__decorate)([M({type:"crt.SetEntityDataSourceCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Vr);let Fr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}innerExecute(){return this.injector.get(B).createOrUpdateEntityAddon(this.config.entitySchemaName,C.AddonName.BusinessRule,this.config.addonMetadata).pipe((0,l.map)(()=>({success:!0})))}};Fr=(0,p.__decorate)([M({type:"crt.CreateOrUpdateEntityBusinessRulesAddonsCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Fr);class Lo{constructor(){this.typeName=C.RELATED_PAGE_TYPE_NAME}}let Nr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t,this._relatedPageFactory=e.get(g.RelatedPagesFactory)}innerExecute(){const e=this.injector.get(B),t=this.config.entitySchemaName;return e.getByName(t).pipe((0,l.take)(1),(0,l.map)(a=>a.addons.find(i=>i.addonName===C.AddonName.RelatedPage)),(0,l.switchMap)(a=>a.addonConfig.pipe((0,l.switchMap)(i=>{const o=this._relatedPageFactory.create(i.Pages);o.setPageSchemaUIdByAction(this.config?.pageSchemaUId,this.config?.action,this.config?.roleId||C.ALL_EMPLOYEES_SYSADMINUNIT_ID);const s=o.getMetaData();return a.addonConfig=(0,d.of)({typeName:i.typeName,Pages:s})}))),(0,l.switchMap)(()=>e.updateEntity(t)),(0,l.map)(()=>({success:!0})))}};Nr=(0,p.__decorate)([M({type:"crt.UpdateEntityRelatedPageAddonCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Lo])],Nr);let Rr=class extends Ja{constructor(e,t){super(e,t),this._defaultSorting={columnName:"CreatedOn",direction:"desc"},this.viewItemName="FileList",this.viewItemType="crt.FileList"}getViewModelAttributeConfig(e){const t=super.getViewModelAttributeConfig(e),a={sortingConfig:{default:[this._defaultSorting]}};return t.modelConfig={...t.modelConfig,...a},t}};Rr=(0,p.__decorate)([M({type:"crt.CopyFileListItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Rr);let Di=class extends qa{constructor(){super(...arguments),this._changeItemConfigPath="itemConfig"}findMetaItemPropertyChangeByPath(e,t){return e.find(a=>a.path===`${this._changeItemConfigPath}.${t}`)}injectDependencies(){return super.injectDependencies().pipe((0,d.tap)(()=>this._filterAttributeService=this.injector.get(Pn)))}innerExecute(){return super.innerExecute().pipe((0,d.mergeMap)(e=>{const t=this.findMetaItemPropertyChangeByPath(this.config.changes,"name");if(t){const a=this.config.name,i=t.value;return this._filterAttributeService.renameViewElement(a,i).pipe((0,l.map)(()=>e))}return(0,d.of)(e)}))}};Di=(0,p.__decorate)([M({type:"crt.ChangeFilterViewItemCommand"})],Di);let li=class extends gn{_replaceFilterOptionAttribute(e,t,a){const i=a?._filterOptions;return i&&(i.expose=this._replaceFilterOptionExposeAttribute(i.expose,e,t),i.from=this._replaceFilterOptionFromAttribute(i.from,e,t)),a}_replaceFilterOptionExposeAttribute(e,t,a){return e?.forEach(i=>{i.attribute=i.attribute.replace(t,a)}),e}_replaceFilterOptionFromAttribute(e,t,a){return typeof e=="string"?e.replace(t,a):e?.map(i=>i.replace(t,a))}injectDependencies(){return super.injectDependencies().pipe((0,d.tap)(()=>{this._filterViewElementConfigProvider=this.injector.get(oe)}))}innerExecute(){return super.innerExecute().pipe((0,d.map)(e=>{if(!e?.copiedViewElement?.name)return e;const t=this._replaceFilterOptionAttribute(this.config.name,e.copiedViewElement.name,e.copiedViewElement);return this._filterViewElementConfigProvider.createCopiedFilterInCollections(this.config.name,e.copiedViewElement.name),{...e,copiedViewElement:t}}))}};li=(0,p.__decorate)([M({type:"crt.CopyFilterViewItemCommand"})],li);let Mi=class extends Je{injectDependencies(){return super.injectDependencies().pipe((0,d.tap)(()=>{this._filterViewElementConfigProvider=this.injector.get(oe)}))}innerExecute(){return this._filterViewElementConfigProvider.removeFiltersByFilterViewElement(this.config.itemName),super.innerExecute()}};Mi=(0,p.__decorate)([M({type:"crt.RemoveFilterViewItemCommand"})],Mi);let zr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.config=t,this._filterTargetsService=this.injector.get($t),this._filterViewElementConfigProvider=this.injector.get(oe),this._folderTreeService=this.injector.get(st)}_resetFilterOptionsExposeFiltersArgs(e){"target"in e&&(e.target={viewAttributeName:e.target.viewAttributeName})}resetFilterOptionsExposeArgs(e){e.forEach(t=>{this._resetFilterOptionsExposeFiltersArgs(t)})}innerExecute(){return this._filterViewElementConfigProvider.resetFilterOptionsExposeArgs(this.config.collectionAttributeName,this.resetFilterOptionsExposeArgs.bind(this)),this._filterTargetsService.resetBindingInQuickFilterViewItems(this.config.viewAttributeName),this._folderTreeService.removeFolderTreeCollectionBindings(this.config.collectionAttributeName),(0,d.of)({success:!0})}};zr=(0,p.__decorate)([M({type:"crt.ResetFilterTargetsCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],zr);let kr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.config=t}innerExecute(){const{viewConfig:e,filterOptions:t}=this.config??{};return!e||!t?(0,d.of)({success:!1}):(this.designerSchemaService.update({itemConfig:{...e,_filterOptions:t},applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig._filterOptions"}],selectOnCanvas:!1}),(0,d.of)({success:!0}))}};kr=(0,p.__decorate)([M({type:"crt.SetFilterViewElementOptionsCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],kr);let Br=class extends Di{_removeFolderTreeAttributes(e){this._folderTreeService.removeFolderTreeAttributes(e)}_removePreviousFilterBindings(e){this._filterViewElementConfigProvider.removeFiltersByFilterViewElement(e)}_changeActionButtonBindings(e,t){this._folderTreeService.changeActionButtonBindings(e,t)}injectDependencies(){return super.injectDependencies().pipe((0,l.tap)(()=>{this._filterViewElementConfigProvider=this.injector.get(oe),this._folderTreeService=this.injector.get(st)}))}innerExecute(){return super.innerExecute().pipe((0,l.tap)(()=>this._removeFolderTreeAttributes(this.config.name)),(0,l.mergeMap)(e=>{this.findMetaItemPropertyChangeByPath(this.config.changes,"rootSchemaName")&&this._removePreviousFilterBindings(this.config.name);const t=this.findMetaItemPropertyChangeByPath(this.config.changes,"name");return t&&this._changeActionButtonBindings(this.config.name,t.value),(0,d.of)(e)}))}};Br=(0,p.__decorate)([M({type:"crt.ChangeFolderTreeViewItemCommand"})],Br);let Lr=class extends li{};Lr=(0,p.__decorate)([M({type:"crt.CopyFolderTreeViewItemCommand"})],Lr);let jr=class extends Mi{_removeFolderTreeAttributes(e){this._folderTreeService.removeFolderTreeAttributes(e)}_resetActionButtonBindings(e){this._folderTreeService.changeActionButtonBindings(e,null)}injectDependencies(){return super.injectDependencies().pipe((0,d.tap)(()=>{this._folderTreeService=this.injector.get(st)}))}innerExecute(){return super.innerExecute().pipe((0,d.tap)(()=>this._removeFolderTreeAttributes(this.config.itemName)),(0,d.tap)(()=>this._resetActionButtonBindings(this.config.itemName)))}};jr=(0,p.__decorate)([M({type:"crt.RemoveFolderTreeViewItemCommand"})],jr);let Gr=class extends Ka{constructor(e,t){super(e,t),this.config=t,this.viewItemName="Gallery",this.viewItemType="crt.Gallery"}_getNewTemplateValuesMapping(e,t){if(!t)return t;const a={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=e?.get(t[i]));return a}_getNewItemConfig(e,t){return t&&{...t,templateValuesMapping:this._getNewTemplateValuesMapping(e,t.templateValuesMapping)}}prepareViewConfig(e){}setupAdditionalViewConfigOptions(e,t){e.itemConfig=this._getNewItemConfig(t,e.itemConfig)}};Gr=(0,p.__decorate)([M({type:"crt.CopyGalleryItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Gr);class Fd{_replaceFilterOptionsAttribute(e,t){const a=t?._filterOptions;return a&&this._replaceDependencyFiltersAttribute(a.expose,e,t.name),t}_replaceDependencyFiltersAttribute(e,t,a){e?.forEach(i=>{i.converters.forEach(o=>{o?.args?.map(m=>m.target)?.forEach(m=>this._replaceTargetDependencyFilter(m,t,a))})})}_replaceTargetDependencyFilter(e,t,a){e?.dependencyFilters?.forEach(i=>{i.attributeName=i.attributeName?.replace(t,a)})}execute(e,t){return this._replaceFilterOptionsAttribute(e,t)}}let $r=class extends li{_executePostCommand(e){const t=this._getPostCommand(this.config.name);return t?{...e,copiedViewElement:t.execute(this.config.name,e.copiedViewElement)}:e}_getPostCommand(e){switch(this.designerSchemaService.getViewConfigInfoByName(e)?.viewConfig?.filterType){case u.QuickFilterType.Custom:return new Fd;default:return null}}innerExecute(){return super.innerExecute().pipe((0,d.map)(e=>this._executePostCommand(e)))}};$r=(0,p.__decorate)([M({type:"crt.CopyQuickFilterViewItemCommand"})],$r);let Ur=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.config=t}innerExecute(){const{viewConfig:e,selectionOptions:t}=this.config??{};return e?(this.designerSchemaService.update({itemConfig:{...e,_selectionOptions:t},applyPropertiesStrategies:[{value:_.ApplyChangedPropertyStrategy.Override,propertyPath:"itemConfig._selectionOptions"}],selectOnCanvas:!1}),(0,d.of)({success:!0})):(0,d.of)({success:!1,errorMessage:"Fail to set selection options for a view element: view element config is not defined."})}};Ur=(0,p.__decorate)([M({type:"crt.SetSelectionViewElementOptionsCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Ur);let Hr=class extends gn{constructor(e,t){super(e,t),this.config=t,this._summariesExpandedStateService=this.injector.get(He)}_setExpandedStateAttributeName(e){var t=this;return(0,F.Z)(function*(){if(!e)return;const{name:a,expanded:i}=e;if(i==null||(delete e.expanded,!(0,_.isBindingExpression)(i)))return;const o=(0,_.parseExpression)(i)?.attributePath;if(!o)return;const s=t.designerSchemaService.getViewModelAttribute(o);s&&"value"in s&&(yield t._summariesExpandedStateService.setState(a,Boolean(s.value)))})()}innerExecute(){return super.innerExecute().pipe((0,G.switchMapWithout)(e=>(0,d.from)(this._setExpandedStateAttributeName(e.copiedViewElement))))}};Hr=(0,p.__decorate)([M({type:"crt.CopySummariesCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Hr);let Wr=class extends gn{constructor(e,t){super(e,t),this.config=t}_setValueAttributeName(e){const t=e?._designOptions?.value?.attribute;t&&typeof t=="string"&&(e._designOptions.value.attribute=(0,u.createSummaryItemValueAttributeName)(e))}innerExecute(){return super.innerExecute().pipe((0,l.tap)(e=>this._setValueAttributeName(e.copiedViewElement)))}};Wr=(0,p.__decorate)([M({type:"crt.CopySummaryItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Wr);let Qr=class extends Je{_getSummariesViewConfig(){return this.designerSchemaService.getViewConfigInfoByName(this.config.itemName)?.viewConfig}_removeSummariesExpansionStateAttribute(e){const{expanded:t}=e;if(t==null||!(0,_.isBindingExpression)(t))return;const a=(0,_.parseExpression)(t)?.attributePath;if(!a)return;this.designerSchemaService.isViewModelAttributeBound(a)||this.designerSchemaService.removeViewModelAttribute(a)}innerExecute(){const e=this._getSummariesViewConfig();return e?super.innerExecute().pipe((0,l.tap)(()=>this._removeSummariesExpansionStateAttribute(e))):(0,d.of)({success:!0})}};Qr=(0,p.__decorate)([M({type:"crt.RemoveSummariesCommand"})],Qr);let qr=class extends Je{constructor(e,t){super(e,t),this.config=t,this._relatedViewElementsService=e.get(_.RelatedViewElementsService),this._viewItemCommandExecutor=e.get(g.ViewItemCommandExecutor)}_removeRelatedViewItems(e){return e?.length>0?(0,d.forkJoin)(e.map(t=>this._viewItemCommandExecutor.remove(t).pipe((0,l.switchMap)(a=>a.execute())))):(0,d.of)([])}innerExecute(){return this._relatedViewElementsService.getRelatedToViewElementConfig(this.config.itemName).pipe((0,l.switchMap)(e=>this._removeRelatedViewItems(e)),(0,l.switchMap)(()=>super.innerExecute()))}};qr=(0,p.__decorate)([M({type:"crt.RemoveTabPanelViewItemCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],qr);let Kr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}innerExecute(){return typeof this.config.value=="string"?this.designerSchemaService.bindViewModelAttribute(this.config.attribute,this.config.dataSourceName,this.config.value):this.designerSchemaService.bindViewModelAttributeCollection(this.config.attribute,this.config.dataSourceName,this.config.value,this.config.collectionAttributePrefix,this.config.strategy||_.ApplyChangedPropertyStrategy.Merge),(0,d.of)({success:!0})}};Kr=(0,p.__decorate)([M({type:"crt.BindViewModelAttributeCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Kr);let Jr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}innerExecute(){return this.designerSchemaService.setViewModelAttribute(this.config.attribute,this.config.config),(0,d.of)({success:!0})}};Jr=(0,p.__decorate)([M({type:"crt.SetViewModelAttributeCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Jr);let Zr=class extends g.BaseDesignerCommand{constructor(e,t){super(e),this.injector=e,this.config=t}innerExecute(){return this.designerSchemaService.updateViewModelAttribute(this.config.attribute,this.config.config),(0,d.of)({success:!0})}};Zr=(0,p.__decorate)([M({type:"crt.UpdateViewModelAttributeCommand"}),(0,p.__metadata)("design:paramtypes",[n.Injector,Object])],Zr);var Nd=v(17684);const Rd=["canvas"],zd=["designerElement"];function kd(r,e){if(r&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",3,4),n.\u0275\u0275listener("mousedown",function(i){const s=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(c.onMouseDown(i,s))})("mouseleave",function(){n.\u0275\u0275restoreView(t);const i=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(i.onMouseLeave())}),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275elementStart(3,"crt-design-element-setting",5),n.\u0275\u0275listener("action",function(i){const o=n.\u0275\u0275restoreView(t),s=o.$implicit,c=o.index,m=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(m.handleElementSettingAction(i,s,c))}),n.\u0275\u0275elementStart(4,"div",6),n.\u0275\u0275elementContainer(5,7),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(6,"crt-block-events-layer",8),n.\u0275\u0275elementEnd()()}if(r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext();n.\u0275\u0275classProp("focused",t.selected)("hovered",n.\u0275\u0275pipeBind1(2,10,a.hoveredItemName$)===t.name),n.\u0275\u0275attribute("item-name",t.name),n.\u0275\u0275advance(3),n.\u0275\u0275property("item",t)("visible",t.selected)("canCopy",!1),n.\u0275\u0275advance(2),n.\u0275\u0275property("crtViewElement",t),n.\u0275\u0275advance(1),n.\u0275\u0275property("item",t)}}class Qn extends P.BaseContainerComponent{constructor(e){super(e),this.injector=e,this.connectedList=[],this.items=[],this._connectedDropListService=this.injector.get(g.ConnectedDropListService),this._metaItemDesignerService=this.injector.get(J),this._designerContainerService=this.injector.get(z),this._designerOverlayService=this.injector.get(be),this._viewCommandExecutor=this.injector.get(g.ViewItemCommandExecutor)}get _canvasElement(){return this.canvasElRef.nativeElement}_initConnectedList(){this._connectedDropListService.add(this.selectListId),this._connectedDropListService.connectedDropList$.pipe((0,l.map)(e=>e.filter(t=>t!==this.id))).subscribe(e=>this.connectedList.splice(0,this.connectedList.length,...e))}_hasDesignerItem(e){return this.items.some(t=>t.name===e)}_selectItem(e){const t=this.items.find(a=>a.name===e);t&&!t.selected&&this._designerContainerService.select(t.name),this._designerOverlayService.show()}_subscribeSelectedChanged(){this._designerContainerService.selectedChanged$.pipe((0,l.takeUntil)(this.destroyed$)).subscribe({next:({name:e})=>{ii(this.items,e)&&this.detectChanges()}})}_subscribeContainerScrolling(){(0,d.fromEvent)(this._canvasElement,"scroll").pipe((0,l.distinctUntilChanged)(),(0,l.takeUntil)(this.destroyed$)).subscribe(()=>{this.onScroll()})}_initDesignerContainerSubscriptions(){this.hoveredItemName$=this._designerContainerService.hoveredItemName$,this.highlight$=this._designerContainerService.visibility$}onScroll(){this._designerOverlayService.hide()}ngOnInit(){super.ngOnInit(),this._subscribeSelectedChanged(),this.config=this.injector.get(S.VIEW_ELEMENT_CONFIG),this.id=this.config.name||this.id,this.selectListId=this.id+"_"+this.propertyName,this.setValuesFromConfig(this.config),this._initConnectedList(),this._initDesignerContainerSubscriptions()}ngAfterViewInit(){super.ngAfterViewInit(),this._subscribeContainerScrolling(),this.detectChangesAsync()}viewItemIdentifier(e,t){return t.name}handleElementSettingAction(e,t,a){var i=this;return(0,F.Z)(function*(){switch(e){case Z.Delete:i._viewCommandExecutor.remove(t).pipe((0,l.switchMap)(o=>o.execute())).subscribe();break;case Z.Edit:t?i._metaItemDesignerService.openMetaItemDesigner(t.type,X.Edit,{itemConfig:t,type:g.DesignType.ViewElement}):i._metaItemDesignerService.openMetaItemDesigner();break}})()}onMouseDown(e,t){e.stopPropagation(),this._selectItem(t.name)}onMouseLeave(){this._designerContainerService.setHoveredItemName(null)}}Qn.\u0275fac=function(e){return new(e||Qn)(n.\u0275\u0275directiveInject(n.Injector))},Qn.\u0275cmp=n.\u0275\u0275defineComponent({type:Qn,selectors:[["crt-selectable-list"]],viewQuery:function(e,t){if(e&1&&(n.\u0275\u0275viewQuery(Rd,7),n.\u0275\u0275viewQuery(zd,5,n.ElementRef)),e&2){let a;n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.canvasElRef=a.first),n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t.designerElements=a)}},inputs:{propertyName:"propertyName",items:"items"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:4,vars:8,consts:[[1,"crt-selectable-list",3,"id","ngClass"],["canvas",""],["class","select-item",3,"focused","hovered","mousedown","mouseleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"select-item",3,"mousedown","mouseleave"],["designerElement",""],[3,"item","visible","canCopy","action"],[1,"view-element"],["crtViewModel","",3,"crtViewElement"],[3,"item"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0,1),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275template(3,kd,7,12,"div",2),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275classProp("highlight",n.\u0275\u0275pipeBind1(2,6,t.highlight$)),n.\u0275\u0275property("id",t.selectListId)("ngClass",t.classes),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngForOf",t.items)("ngForTrackBy",t.viewItemIdentifier))},dependencies:[f.NgClass,f.NgForOf,ve,Ge,S.ViewModelDirective,S.ViewElementDirective,f.AsyncPipe],styles:[".crt-selectable-list[_ngcontent-%COMP%]{width:100%;height:100%;min-width:32px;min-height:32px;overflow-y:auto;box-sizing:border-box;transition:padding .25s ease}.crt-selectable-list.highlight[_ngcontent-%COMP%]{outline-width:1px;outline-style:none}.crt-selectable-list[_ngcontent-%COMP%]   .select-item[_ngcontent-%COMP%]{display:block;box-sizing:content-box;border:solid transparent 1px}.crt-selectable-list[_ngcontent-%COMP%]   .select-item.hovered[_ngcontent-%COMP%]{border-style:dashed;opacity:1;border-width:1px;border-color:var(--crt-active-designer-element-border)}.crt-selectable-list[_ngcontent-%COMP%]   .select-item.focused[_ngcontent-%COMP%]{border-style:solid;opacity:1;border-width:1px;border-color:var(--crt-active-designer-element-border)}.view-element[_ngcontent-%COMP%]{height:100%;width:100%}"]});function Bd(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-selectable-list",12),r&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("items",t.designerTools)}}function Ld(r,e){r&1&&n.\u0275\u0275element(0,"div",13)}function jd(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",14),n.\u0275\u0275element(1,"mat-icon",11),n.\u0275\u0275elementEnd()),r&2){const t=e.$implicit,a=n.\u0275\u0275nextContext(2);n.\u0275\u0275classMap(t.name+"-filter"),n.\u0275\u0275advance(1),n.\u0275\u0275property("svgIcon",a.getFilterIcon(t.name))}}function Gd(r,e){if(r&1&&(n.\u0275\u0275elementStart(0,"div",2,3),n.\u0275\u0275template(2,Bd,1,1,"crt-selectable-list",4),n.\u0275\u0275template(3,Ld,1,0,"div",5),n.\u0275\u0275elementStart(4,"div",6)(5,"div",7),n.\u0275\u0275template(6,jd,2,3,"div",8),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(7,"div",9),n.\u0275\u0275element(8,"mat-icon",10)(9,"mat-icon",11),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(10,"crt-selectable-list",12),n.\u0275\u0275elementEnd()),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",t.designerTools==null?null:t.designerTools.length),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.designerTools==null?null:t.designerTools.length),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngForOf",t.getVisibleFilters()),n.\u0275\u0275advance(2),n.\u0275\u0275property("svgIcon","search"),n.\u0275\u0275advance(1),n.\u0275\u0275property("svgIcon","arrow-down-heavy"),n.\u0275\u0275advance(1),n.\u0275\u0275property("items",t.visibleDesignerItems)}}function $d(r,e){r&1&&n.\u0275\u0275element(0,"crt-timeline-skeleton")}let Ot=class extends u.CrtTimelineComponent{get designerTimelineViewConfig(){if(!this._designerTimelineViewConfig){const e=this.injector.get(S.VIEW_ELEMENT_CONFIG);this._designerTimelineViewConfig=this._designerSchemaService.getViewConfigInfoByName(e.name).viewConfig,this._designerTimelineViewConfig.items=this._designerTimelineViewConfig.items.filter(t=>!t.data.isDefault||t.data.isDeleted)}return this._designerTimelineViewConfig}get visibleDesignerItems(){return this.designerItems.filter(e=>!e.hidden&&!e.data.isDeleted)}constructor(e,t,a,i,o){super(e,t),this.injector=e,this.service=t,this._designerSchemaService=a,this._timelineService=i,this._designerConfigService=o,this._destroyed$=new d.Subject,this._defaultTools=[{type:"crt.MessageComposerSelector"}],this.designerItems=[],this.designerTools=[],this.isLoaded=!1,this._viewCommandExecutor=this.injector.get(g.ViewItemCommandExecutor),this._designerContainerService=this.injector.get(z)}_subscribeToSchemaChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{parentName:e,operation:t}})=>e===this.name&&[_.MetaItemDesignSettingChangesOperation.Remove,_.MetaItemDesignSettingChangesOperation.Rename,_.MetaItemDesignSettingChangesOperation.Update].includes(t))).subscribe(({changes:{viewConfig:e,operation:t,oldName:a}})=>{switch(t){case _.MetaItemDesignSettingChangesOperation.Remove:this.onItemDeleted(e);break;case _.MetaItemDesignSettingChangesOperation.Rename:this.onItemRenamed(e,a);break;case _.MetaItemDesignSettingChangesOperation.Update:this.onItemUpdated(e);break;default:break}}),this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{viewConfig:e,operation:t}})=>t===_.MetaItemDesignSettingChangesOperation.CreateDataSource||e.name===this.name&&t===_.MetaItemDesignSettingChangesOperation.Update)).subscribe(({changes:{viewConfig:e}})=>{this._initDesignerTimeline(e.masterEntitySchemaName,!0)})}_hasNoTiles(){return this.designerTimelineViewConfig.items.filter(e=>!e.data.isDeleted).length===0}_removeTimeline(){this._viewCommandExecutor.remove(this.designerTimelineViewConfig).pipe((0,l.switchMap)(e=>e.execute())).subscribe()}_initDesignerTimeline(e,t=!1){this._sourceSchemaName&&this._sourceSchemaName===e||(this._sourceSchemaName=e||this._getSourceSchemaName(),this._sourceSchemaName&&(t&&(this.designerTimelineViewConfig.items=[]),this._initDesignerItems(),this._initDesignerTools()))}_getSourceSchemaName(){return this._designerSchemaService.getDataSources().find(t=>t.type===C.DataSourceType.EntityDataSource&&t.scope===h.DataSourceScope.Page)?.config?.entitySchemaName}_updateView(){this._updateItemsView(),this._updateToolsView()}_updateItemsView(){const e=me(this.designerTimelineViewConfig?.items,{selected:!1});e?.length<=0||this._designerConfigService.getCaptions(e.map(t=>t.data)).pipe((0,l.map)(t=>{e.forEach(a=>{const i=a.data.schemaType||a.data.schemaName,o=t.find(s=>s.schemaName===i).caption;a.data.caption=o})})).subscribe(()=>{this.designerItems=this._sortItemsByCaption(e),this.isLoaded=!0,this.detectChanges()})}_updateToolsView(){this.designerTools=me(this.designerTimelineViewConfig?.tools,{selected:!1}),this.detectChanges()}_updateToolView(e,t){const a=me(this.designerTimelineViewConfig?.tools.filter(o=>o.name===e),{selected:!0})[0],i=this.designerTools.findIndex(o=>o.name===t);this.designerTools[i]=a}_updateSingleTile(e,t){const a=me(this.designerTimelineViewConfig?.items.filter(i=>i.name===e),{selected:!0})[0];this._designerConfigService.getCaption(a.data).subscribe(i=>{a.data.caption=i;const o=this.designerItems.findIndex(s=>s.name===t);this.designerItems[o]=a})}_initDesignerItems(){const e=this.designerTimelineViewConfig.items.filter(t=>!t.data.isDefault||t.data.isDeleted);if(e.length===0)this.isLoaded=!1,this._timelineService.getPredefinedObjects(this._sourceSchemaName).pipe((0,l.mergeMap)(t=>(0,d.zip)(this._timelineService.warmUpSchemesLoading(t.map(a=>a.schemaName||a.schemaType)),(0,d.of)(t)))).subscribe(([,t])=>{this._addItems(t),this._updateView()});else{const t=e.map(i=>i.data.schemaName).filter((i,o,s)=>i&&s.indexOf(i)===o),a=e.map(i=>i.data.schemaType||i.data.schemaName);this.timelineService.loadTimelineConfig(this.getMasterSchemaName(),a).pipe((0,l.map)(i=>{const o=[];return i.values.forEach(s=>{o.push({columns:s.predefinedColumns.map(c=>({columnName:c.ColumnName,columnLayout:c.ColumnLayout})),linkedColumn:s.defaultMasterEntityColumnName,schemaName:s.schemaName,sortedByColumn:s.sortColumn,ownerColumn:s.ownerColumn,iconId:s.iconId,isDefault:!0})}),o})).subscribe(i=>{this._addItems(i),this._updateView()}),this._timelineService.warmUpSchemesLoading(t).pipe((0,l.take)(1)).subscribe()}this.initFilters()}_initDesignerTools(){const e=this.designerTimelineViewConfig.tools=this.designerTimelineViewConfig.tools||[],t=this.designerTimelineViewConfig.hideTools;e.length!==0||t===void 0||t||(0,d.from)(this._defaultTools).pipe((0,l.concatMap)(a=>this._viewCommandExecutor.add({containerName:this.designerTimelineViewConfig.name,propertyName:"tools",designerTool:{defaultConfig:{type:a.type,defaultPropertyValues:{type:a.type,items:[],classes:["view-element"]}}}}).pipe((0,l.switchMap)(i=>i.execute()))),(0,l.last)()).subscribe(()=>this._updateToolsView())}_addItems(e){const t=this.designerTimelineViewConfig;(0,d.from)(e).pipe((0,l.concatMap)(a=>this._viewCommandExecutor.add(this._designerConfigService.getNewViewItemConfig(a,t)).pipe((0,l.switchMap)(i=>i.execute()))),(0,l.last)()).subscribe(()=>this._updateItemsView())}_isTile(e){return e.type==="crt.TimelineTile"}_subscribeElementDesignVisibilityChanges(){this._designerContainerService.designVisibility$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe({next:({name:e,visible:t})=>{const a=this.designerItems.find(i=>i.name===e);a&&(a.hidden=!t,this.detectChanges())}})}_changeIsDefaultTile(e){if(this._isTile(e)){const t=e;t.data.isDefault&&!t.data.isDeleted&&(t.data.isDefault=!1)}}handleFinishLoadViewModelAttributes(){}_sortItemsByCaption(e){return e.sort((t,a)=>t.data.caption>a.data.caption?1:t.data.caption<a.data.caption?-1:0)}onItemRenamed(e,t){this._defaultTools.find(a=>a.type===e.type)?this._updateToolView(e.name,t):this._updateSingleTile(e.name,t)}onItemUpdated(e){this._changeIsDefaultTile(e)}onItemDeleted(e){if(this._isTile(e)){const t=e;if(t.data.isDeleted=!0,this.designerTimelineViewConfig.items.push(t),this._hasNoTiles()){this._removeTimeline();return}}this._updateView()}initFilters(){this.designerTimelineViewConfig.filters||(this.designerTimelineViewConfig.filters=[]);const e=this.designerTimelineViewConfig.filters,t=this.getQuickFiltersDefaultConfig();for(let a=0;a<t.length;a++)e.filter(i=>i.name===t[a].name).length<1&&e.splice(a,0,{name:t[a].name,visible:t[a].visible})}ngOnInit(){this._subscribeToSchemaChanged(),this._initDesignerTimeline(this.designerTimelineViewConfig.masterEntitySchemaName),this._subscribeElementDesignVisibilityChanges()}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}getVisibleFilters(){return this.designerTimelineViewConfig.filters?.filter(e=>e.visible)}getFilterIcon(e){return this.getQuickFiltersDefaultConfig().find(a=>a.name===e)?.icon||""}};Ot.\u0275fac=function(e){return new(e||Ot)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(u.TimelineService),n.\u0275\u0275directiveInject(g.DesignerSchemaService),n.\u0275\u0275directiveInject(Wt),n.\u0275\u0275directiveInject(Be))},Ot.\u0275cmp=n.\u0275\u0275defineComponent({type:Ot,selectors:[["crt-designer-timeline"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:3,vars:2,consts:[["cdkScrollable","","class","properties-panel-wrap timeline",4,"ngIf","ngIfElse"],["timelineSkeleton",""],["cdkScrollable","",1,"properties-panel-wrap","timeline"],["timelineContainer",""],[3,"items",4,"ngIf"],["class","timeline-tools-border-container",4,"ngIf"],[1,"filters-container"],[1,"timeline-quick-filters"],["class","quick-filter-item",3,"class",4,"ngFor","ngForOf"],[1,"right-filter-container"],[1,"filter-icon","search-icon",3,"svgIcon"],[1,"filter-icon",3,"svgIcon"],[3,"items"],[1,"timeline-tools-border-container"],[1,"quick-filter-item"]],template:function(e,t){if(e&1&&(n.\u0275\u0275template(0,Gd,11,6,"div",0),n.\u0275\u0275template(1,$d,1,0,"ng-template",null,1,n.\u0275\u0275templateRefExtractor)),e&2){const a=n.\u0275\u0275reference(2);n.\u0275\u0275property("ngIf",t.isLoaded&&t.visibleDesignerItems)("ngIfElse",a)}},dependencies:[f.NgForOf,f.NgIf,E.MatIcon,Nd.CdkScrollable,Qn,u.CrtTimelineSkeletonComponent],styles:["[_nghost-%COMP%]   .timeline-tools-border-container[_ngcontent-%COMP%]{border-bottom:1px solid var(--crt-palette-border-700);margin:1em 24px}[_nghost-%COMP%]   .filters-container[_ngcontent-%COMP%]{padding:4px 24px;line-height:16px;height:30px}[_nghost-%COMP%]   .filters-container[_ngcontent-%COMP%]   .timeline-quick-filters[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .filters-container[_ngcontent-%COMP%]   .timeline-quick-filters[_ngcontent-%COMP%]   .quick-filter-item[_ngcontent-%COMP%]{display:inline-block;margin-right:16px}[_nghost-%COMP%]   .filters-container[_ngcontent-%COMP%]   .right-filter-container[_ngcontent-%COMP%]{display:inline-block;position:absolute;margin-right:36px;right:0}[_nghost-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-icon[_ngcontent-%COMP%]{width:16px;height:16px}[_nghost-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-icon.search-icon[_ngcontent-%COMP%]{margin-right:28px}"]}),Ot=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerTimeline",overrideType:"crt.Timeline"}),(0,p.__metadata)("design:paramtypes",[n.Injector,u.TimelineService,g.DesignerSchemaService,Wt,Be])],Ot);let he=class{};he.\u0275fac=function(e){return new(e||he)},he.\u0275mod=n.\u0275\u0275defineNgModule({type:he}),he.\u0275inj=n.\u0275\u0275defineInjector({providers:[z],imports:[f.CommonModule,j,S.ViewModule]}),he=(0,p.__decorate)([(0,h.CrtModule)({viewElements:[Qn]})],he),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(he,{declarations:[Qn],imports:[f.CommonModule,j,S.ViewModule],exports:[Qn]})}();let Fe=class{};Fe.\u0275fac=function(e){return new(e||Fe)},Fe.\u0275mod=n.\u0275\u0275defineNgModule({type:Fe}),Fe.\u0275inj=n.\u0275\u0275defineInjector({providers:[g.DesignerSchemaService,Wt,u.TimelineService,B,Be],imports:[f.CommonModule,E.MatIconModule,Yt.MatLegacyMenuModule,D.TranslateModule,q,he,S.ViewModule,Ct.MatExpansionModule,j,P.CdkModule,w.DialogModule,N.MatLegacyDialogModule,Qe.MatLegacyButtonModule,Ci.MatLegacyCheckboxModule,w.MaskModule,se.MatLegacyFormFieldModule,Dt.MatLegacyInputModule,u.CrtComponentsModule,w.CrtSkeletonLoaderModule,u.CrtTimelineModule]}),Fe=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[Ot,Et]})],Fe),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Fe,{declarations:[Ot,Et],imports:[f.CommonModule,E.MatIconModule,Yt.MatLegacyMenuModule,D.TranslateModule,q,he,S.ViewModule,Ct.MatExpansionModule,j,P.CdkModule,w.DialogModule,N.MatLegacyDialogModule,Qe.MatLegacyButtonModule,Ci.MatLegacyCheckboxModule,w.MaskModule,se.MatLegacyFormFieldModule,Dt.MatLegacyInputModule,u.CrtComponentsModule,w.CrtSkeletonLoaderModule,u.CrtTimelineModule],exports:[Ot,Et]})}();let At=class{constructor(e,t,a,i,o){this._injector=e,this._designerSchemaService=t,this._designerEntityDataSourceService=a,this._designerCommandFactoryService=i,this._messageDialogProvider=o,this.stages=[{id:"0",color:"#0B8500",caption:"",disabled:!1},{id:"1",color:"#0B8500",caption:"",disabled:!1},{id:"2",color:"#4F43C2",caption:"",disabled:!1},{id:"3",color:"#FF4013",caption:"",disabled:!1},{id:"4",color:"#FF4013",caption:"",disabled:!1}],this.currentStage=this.stages[1]}_checkDataSourceExists(){return!!this._designerSchemaService.getDataSources()[0]?.config?.entitySchemaName}_getPrimaryDataSource(e){if(!e?.length)return null;const t=this._designerSchemaService.getPrimaryDataSourceName();return e.find(a=>a.dataSourceName===t)}_updateEntityNameCommandRequest(e){const t={name:this._viewItemConfig.name,changes:[{path:"itemConfig.entityName",value:e,applyPropertyStrategy:_.ApplyChangedPropertyStrategy.Override}]};return this._designerCommandFactoryService.create("crt.ChangeViewItemCommand",t).pipe((0,d.mergeMap)(a=>a.execute()))}_updateEntityName(){this._designerEntityDataSourceService.getDataSources$().pipe((0,d.first)(),(0,d.switchMap)(e=>{const t=this._getPrimaryDataSource(e);return t?t.getSchema().pipe((0,d.first)(),(0,d.map)(a=>a.name)):(0,d.of)()}),(0,d.switchMap)(e=>{if(!!e)return this._updateEntityNameCommandRequest(e)})).subscribe()}ngOnInit(){if(!this._checkDataSourceExists()){this._messageDialogProvider.open({data:{message:"Components.ProgressBar.ProvideDataSource",actions:[u.DEFAULT_DIALOG_ACTIONS.OK]}});return}this._viewItemConfig=this._injector.get(S.VIEW_ELEMENT_CONFIG),this._viewItemConfig.entityName||this._updateEntityName()}};At.\u0275fac=function(e){return new(e||At)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(g.DesignerSchemaService),n.\u0275\u0275directiveInject(le),n.\u0275\u0275directiveInject(g.DesignerCommandFactoryService),n.\u0275\u0275directiveInject(u.MessageDialogProvider))},At.\u0275cmp=n.\u0275\u0275defineComponent({type:At,selectors:[["crt-designer-entity-stage-progress-bar"]],decls:1,vars:2,consts:[[3,"steps","currentStep"]],template:function(e,t){e&1&&n.\u0275\u0275element(0,"crt-step-progress-bar",0),e&2&&n.\u0275\u0275property("steps",t.stages)("currentStep",t.currentStage)},dependencies:[u.CrtStepProgressBarComponent],encapsulation:2}),At=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerEntityStageProgressBar",overrideType:"crt.EntityStageProgressBar"}),(0,p.__metadata)("design:paramtypes",[n.Injector,g.DesignerSchemaService,le,g.DesignerCommandFactoryService,u.MessageDialogProvider])],At);let Vt=class{};Vt.\u0275fac=function(e){return new(e||Vt)},Vt.\u0275mod=n.\u0275\u0275defineNgModule({type:Vt}),Vt.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,u.CrtButtonToggleGroupModule,w.CrtSkeletonLoaderModule,u.CrtStepProgressBarModule]}),Vt=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[At]})],Vt),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Vt,{declarations:[At],imports:[f.CommonModule,u.CrtButtonToggleGroupModule,w.CrtSkeletonLoaderModule,u.CrtStepProgressBarModule],exports:[At]})}();let Ze=class extends S.CrtBaseComponent{set schemaName(e){this._schemaName=e,this._actualizeCaption().then()}get schemaName(){return this._schemaName}get title(){return this._title}constructor(e,t,a){super(e),this._schemaInfoService=t,this._translateService=a,this._title="",this._schemaName=""}_actualizeCaption(){var e=this;return(0,F.Z)(function*(){e._title=e.schemaName;let t=yield e._schemaInfoService.getSchemaCaptionByName(e.schemaName);t||(t=e._translateService.instant("SchemaOutlet.SchemaNotFound")),e._title=`${t} (${e.schemaName})`,e.detectChanges()})()}};Ze.\u0275fac=function(e){return new(e||Ze)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(ae.SchemaInfoService),n.\u0275\u0275directiveInject(D.TranslateService))},Ze.\u0275cmp=n.\u0275\u0275defineComponent({type:Ze,selectors:[["crt-schema-outlet"]],inputs:{schemaName:"schemaName"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:2,vars:1,consts:[[1,"schema-placeholder"],[1,"schema-placeholder__label",3,"caption"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275element(1,"crt-label",1),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275advance(1),n.\u0275\u0275property("caption",t.title))},dependencies:[u.CrtLabelComponent],styles:[".schema-placeholder[_ngcontent-%COMP%]{background-color:#f5f5f5;min-width:32px;min-height:32px;width:100%;height:100%;padding:8px}"],changeDetection:0}),(0,p.__decorate)([(0,h.CrtInput)(),(0,p.__metadata)("design:type",String),(0,p.__metadata)("design:paramtypes",[String])],Ze.prototype,"schemaName",null),Ze=(0,p.__decorate)([(0,h.CrtViewElement)({type:"crt.SchemaOutlet",reuseStrategy:h.ViewElementReuseStrategy.Reuse,defaultSize:{height:"32px"}}),(0,h.CrtInterfaceDesignerItem)({toolbarConfig:{icon:v(45115),position:100,hint:"SchemaOutlet.Hint",requiredFeatures:{DesignerSchemaOutletComponent:!0}},viewElementGroupType:h.ViewElementGroupType.LayoutElements,propertiesPanelComponentTypeName:"crt.SchemaOutletPropertiesPanel",typeCaption:"SchemaOutlet.Caption"}),(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerSchemaOutlet",overrideType:"crt.SchemaOutlet"}),(0,p.__metadata)("design:paramtypes",[n.Injector,ae.SchemaInfoService,D.TranslateService])],Ze);let Ne=class{};Ne.\u0275fac=function(e){return new(e||Ne)},Ne.\u0275mod=n.\u0275\u0275defineNgModule({type:Ne}),Ne.\u0275inj=n.\u0275\u0275defineInjector({imports:[u.CrtLabelModule]}),Ne=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[Ze],viewElements:[Ze]})],Ne),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Ne,{declarations:[Ze],imports:[u.CrtLabelModule]})}();function Ud(r,e){r&1&&(n.\u0275\u0275elementStart(0,"tr")(1,"td"),n.\u0275\u0275element(2,"div",4),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(3,"td")(4,"td")(5,"td")(6,"td"),n.\u0275\u0275elementEnd())}const Hd=function(){return[0,1,2,3,4,5,6]};let Xe=class extends S.CrtBaseComponent{};Xe.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Xe)))(t||Xe)}}(),Xe.\u0275cmp=n.\u0275\u0275defineComponent({type:Xe,selectors:[["crt-designer-calendar"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:159,vars:2,consts:[[1,"designer-calendar"],["aria-describedby","calendar"],["scope","tile-strip"],[1,"tile-strip","tile-strip-column"],[1,"tile-strip","tile-strip-row"],[1,"tile"],[1,"tile-strip"],[1,"tile","tile-x2"],[4,"ngFor","ngForOf"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0)(1,"table",1)(2,"tr")(3,"th",2),n.\u0275\u0275element(4,"div",3),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(5,"th",2),n.\u0275\u0275element(6,"div",3),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(7,"th",2),n.\u0275\u0275element(8,"div",3),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(9,"th",2),n.\u0275\u0275element(10,"div",3),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(11,"th",2),n.\u0275\u0275element(12,"div",3),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(13,"tr")(14,"td"),n.\u0275\u0275element(15,"div",4),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(16,"td")(17,"td")(18,"td")(19,"td"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(20,"tr")(21,"td"),n.\u0275\u0275element(22,"div",4),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(23,"td")(24,"td")(25,"td")(26,"td"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(27,"tr")(28,"td"),n.\u0275\u0275element(29,"div",4),n.\u0275\u0275elementStart(30,"div",5),n.\u0275\u0275element(31,"div",6)(32,"div",6)(33,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(34,"td"),n.\u0275\u0275elementStart(35,"td")(36,"div",5),n.\u0275\u0275element(37,"div",6)(38,"div",6)(39,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(40,"td"),n.\u0275\u0275elementStart(41,"td")(42,"div",7),n.\u0275\u0275element(43,"div",6)(44,"div",6)(45,"div",6),n.\u0275\u0275elementEnd()()(),n.\u0275\u0275elementStart(46,"tr")(47,"td"),n.\u0275\u0275element(48,"div",4),n.\u0275\u0275elementStart(49,"div",5),n.\u0275\u0275element(50,"div",6)(51,"div",6)(52,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(53,"td")(54,"div",7),n.\u0275\u0275element(55,"div",6)(56,"div",6)(57,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(58,"td")(59,"div",5),n.\u0275\u0275element(60,"div",6)(61,"div",6)(62,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(63,"td")(64,"div",5),n.\u0275\u0275element(65,"div",6)(66,"div",6)(67,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(68,"td"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(69,"tr")(70,"td"),n.\u0275\u0275element(71,"div",4),n.\u0275\u0275elementStart(72,"div",5),n.\u0275\u0275element(73,"div",6)(74,"div",6)(75,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(76,"td")(77,"td"),n.\u0275\u0275elementStart(78,"td")(79,"div",5),n.\u0275\u0275element(80,"div",6)(81,"div",6)(82,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(83,"td"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(84,"tr")(85,"td"),n.\u0275\u0275element(86,"div",4),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(87,"td")(88,"td"),n.\u0275\u0275elementStart(89,"td")(90,"div",7),n.\u0275\u0275element(91,"div",6)(92,"div",6)(93,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(94,"td"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(95,"tr")(96,"td"),n.\u0275\u0275element(97,"div",4),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(98,"td")(99,"td")(100,"td")(101,"td"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(102,"tr")(103,"td"),n.\u0275\u0275element(104,"div",4),n.\u0275\u0275elementStart(105,"div",7),n.\u0275\u0275element(106,"div",6)(107,"div",6)(108,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(109,"td")(110,"td")(111,"td"),n.\u0275\u0275elementStart(112,"td")(113,"div",7),n.\u0275\u0275element(114,"div",6)(115,"div",6)(116,"div",6),n.\u0275\u0275elementEnd()()(),n.\u0275\u0275elementStart(117,"tr")(118,"td"),n.\u0275\u0275element(119,"div",4),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(120,"td")(121,"div",7),n.\u0275\u0275element(122,"div",6)(123,"div",6)(124,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(125,"td")(126,"div",7),n.\u0275\u0275element(127,"div",6)(128,"div",6)(129,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(130,"td")(131,"td"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(132,"tr")(133,"td"),n.\u0275\u0275element(134,"div",4),n.\u0275\u0275elementStart(135,"div",7),n.\u0275\u0275element(136,"div",6)(137,"div",6)(138,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(139,"td")(140,"td"),n.\u0275\u0275elementStart(141,"td")(142,"div",5),n.\u0275\u0275element(143,"div",6)(144,"div",6)(145,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(146,"td"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(147,"tr")(148,"td"),n.\u0275\u0275element(149,"div",4),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(150,"td")(151,"td"),n.\u0275\u0275elementStart(152,"td")(153,"div",5),n.\u0275\u0275element(154,"div",6)(155,"div",6)(156,"div",6),n.\u0275\u0275elementEnd()(),n.\u0275\u0275element(157,"td"),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(158,Ud,7,0,"tr",8),n.\u0275\u0275elementEnd()()),e&2&&(n.\u0275\u0275advance(158),n.\u0275\u0275property("ngForOf",n.\u0275\u0275pureFunction0(1,Hd)))},dependencies:[f.NgForOf],styles:["[_nghost-%COMP%]{background:var(--crt-palette-interaction-A100)}.designer-calendar[_ngcontent-%COMP%]{width:100%;height:100%}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{table-layout:fixed;border-collapse:collapse;width:calc(100% - 30px);height:calc(100% - 25px);margin-top:25px;margin-left:30px;min-width:200px}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:calc(20% - 10px);height:45px;border:1px solid #e7e7e7;border-right:none;border-bottom:none;border-collapse:collapse;padding-left:1px;padding-right:6px;display:inline-block}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:3px solid #e7e7e7}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, .designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{border-left:none}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, .designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{border-right:none}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]{background-color:#eff3fd;width:100%;height:100%;border-radius:4px;border-left:3px solid #c6d4f8;overflow:hidden;position:relative;box-sizing:content-box}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]   .tile-strip[_ngcontent-%COMP%]{height:8px;width:80%;margin-bottom:5px;margin-left:5%}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]   .tile-strip[_ngcontent-%COMP%]:first-child{margin-top:12px}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]   .tile-strip[_ngcontent-%COMP%]:nth-child(2){width:50%}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]   .tile-strip[_ngcontent-%COMP%]:nth-child(3){width:30%}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .tile-strip[_ngcontent-%COMP%]{background-image:linear-gradient(to right,rgba(24,24,24,.05),rgba(24,24,24,0));border-radius:4px}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .tile.tile-x2[_ngcontent-%COMP%]{height:93px}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .tile-strip.tile-strip-column[_ngcontent-%COMP%]{height:12px;width:40%;margin-left:30%;margin-top:-20px}.designer-calendar[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .tile-strip.tile-strip-row[_ngcontent-%COMP%]{height:10px;width:26px;margin-left:-30px;margin-top:-8px;position:absolute}"]}),Xe=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerCalendar",overrideType:"crt.Calendar"})],Xe);let Re=class{};Re.\u0275fac=function(e){return new(e||Re)},Re.\u0275mod=n.\u0275\u0275defineNgModule({type:Re}),Re.\u0275inj=n.\u0275\u0275defineInjector({providers:[g.DesignerSchemaService,B],imports:[f.CommonModule,E.MatIconModule,D.TranslateModule,q,he,S.ViewModule,Ct.MatExpansionModule,j,P.CdkModule,w.DialogModule,w.MaskModule,u.CrtComponentsModule,w.CrtSkeletonLoaderModule]}),Re=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[Xe]})],Re),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Re,{declarations:[Xe],imports:[f.CommonModule,E.MatIconModule,D.TranslateModule,q,he,S.ViewModule,Ct.MatExpansionModule,j,P.CdkModule,w.DialogModule,w.MaskModule,u.CrtComponentsModule,w.CrtSkeletonLoaderModule],exports:[Xe]})}();let qn=class{constructor(e){this._extResourceFrameWindowMessenger=e,this._subscription=new d.Subscription,this.loaded=new n.EventEmitter,this.openModalBox=new n.EventEmitter,this.settingsChanged=new n.EventEmitter}ngOnInit(){this._subscription.add(this._extResourceFrameWindowMessenger.designerLoaded$.subscribe(()=>this.loaded.emit())),this._subscription.add(this._extResourceFrameWindowMessenger.modalOpening$.subscribe(()=>this.openModalBox.emit(!0))),this._subscription.add(this._extResourceFrameWindowMessenger.modalClosing$.subscribe(()=>this.openModalBox.emit(!1)))}ngOnDestroy(){this._subscription.unsubscribe()}onConfigure(e){this._settings=e,this.filterParams={entitySchemaName:e.entitySchemaName,filters:e.filters}}onFilterParamsChanged(e){this.settingsChanged.emit({...this._settings,filters:e.filters})}validate(){return{isValid:!0}}};qn.\u0275fac=function(e){return new(e||qn)(n.\u0275\u0275directiveInject(u.ExtResourceFrameMessengerService))},qn.\u0275cmp=n.\u0275\u0275defineComponent({type:qn,selectors:[["crt-filter-builder"]],outputs:{loaded:"loaded",openModalBox:"openModalBox",settingsChanged:"settingsChanged"},decls:1,vars:1,consts:[[3,"filterParams","filterParamsChange"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"crt-filters",0),n.\u0275\u0275listener("filterParamsChange",function(i){return t.onFilterParamsChanged(i)}),n.\u0275\u0275elementEnd()),e&2&&n.\u0275\u0275property("filterParams",t.filterParams)},dependencies:[u.CrtFiltersComponent],styles:["[_nghost-%COMP%]{flex:1}iframe[_ngcontent-%COMP%]{display:block;border:none;width:100%;height:100%}"]}),qn=(0,p.__decorate)([_a({type:"crt.FilterBuilder"}),(0,p.__metadata)("design:paramtypes",[u.ExtResourceFrameMessengerService])],qn);class un{}un.\u0275fac=function(e){return new(e||un)},un.\u0275mod=n.\u0275\u0275defineNgModule({type:un}),un.\u0275inj=n.\u0275\u0275defineInjector({imports:[u.CrtFiltersModule]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(un,{declarations:[qn],imports:[u.CrtFiltersModule],exports:[qn]})}();const Xr=new n.InjectionToken("Represents a map with names of widget designers");class Kn{constructor(e,t){this._domSanitizer=e,this._widgetsDesignersMap=t,this.WIDGET_DESIGNER_LOADER_URL="Nui/ViewModule.aspx?vm=WidgetDesignerLoader&designSchemaName="}createUrl(e,t){const a=(0,C.getWorkspaceBaseUrl)(),i=this._widgetsDesignersMap.get(e)||"";let o=f.Location.joinWithSlash(a,this.WIDGET_DESIGNER_LOADER_URL+i+"&disableLogo=1&isAngularPage=true");return t&&(o=`${o}&hasIdAttributeInViewModel=true`),this._domSanitizer.bypassSecurityTrustResourceUrl(o)}}Kn.\u0275fac=function(e){return new(e||Kn)(n.\u0275\u0275inject(ri.DomSanitizer),n.\u0275\u0275inject(Xr))},Kn.\u0275prov=n.\u0275\u0275defineInjectable({token:Kn,factory:Kn.\u0275fac,providedIn:"root"});const Wd=["widgetDesignerPage"];function Qd(r,e){if(r&1&&n.\u0275\u0275element(0,"iframe",1,2),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("src",t.uri,n.\u0275\u0275sanitizeResourceUrl)}}let Ft=class{constructor(e,t){this._widgetWindowMessenger=e,this._widgetDesignerUrlCreator=t,this._destroyed$=new d.Subject,this.loaded=new n.EventEmitter,this.openModalBox=new n.EventEmitter,this.settingsChanged=new n.EventEmitter}ngOnInit(){this._widgetWindowMessenger.configChanged$.subscribe(e=>this.settingsChanged.emit(e)),this._widgetWindowMessenger.designerLoaded$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(()=>this.loaded.emit()),this._widgetWindowMessenger.modalOpening$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(()=>this.openModalBox.emit(!0)),this._widgetWindowMessenger.modalClosing$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(()=>this.openModalBox.emit(!1))}ngAfterViewInit(){const{nativeElement:{contentWindow:e=null}={}}=this._widgetDesignerPageIFrameRef??{};e&&this._widgetWindowMessenger.initCommunication(e).pipe((0,l.takeUntil)(this._destroyed$)).subscribe(t=>this._widgetWindowMessenger.onMessage(t))}onConfigure(e){this._widgetWindowMessenger.initialConfig=e;const t=e?.itemConfig,a=!!e.viewModelConfig?.attributes?.Id;this.uri=this._widgetDesignerUrlCreator.createUrl(t?.type,a)}validate(){return{isValid:!0,messages:[]}}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}};Ft.\u0275fac=function(e){return new(e||Ft)(n.\u0275\u0275directiveInject(qt),n.\u0275\u0275directiveInject(Kn))},Ft.\u0275cmp=n.\u0275\u0275defineComponent({type:Ft,selectors:[["crt-widget-designer"]],viewQuery:function(e,t){if(e&1&&n.\u0275\u0275viewQuery(Wd,5),e&2){let a;n.\u0275\u0275queryRefresh(a=n.\u0275\u0275loadQuery())&&(t._widgetDesignerPageIFrameRef=a.first)}},decls:1,vars:1,consts:[["data-qa","widget-designer-iframe","title","widget-designer-iframe",3,"src",4,"ngIf"],["data-qa","widget-designer-iframe","title","widget-designer-iframe",3,"src"],["widgetDesignerPage",""]],template:function(e,t){e&1&&n.\u0275\u0275template(0,Qd,2,1,"iframe",0),e&2&&n.\u0275\u0275property("ngIf",t.uri)},dependencies:[f.NgIf],styles:["[_nghost-%COMP%]{flex:1}iframe[_ngcontent-%COMP%]{display:block;border:none;width:100%;height:100%}"]}),Ft=(0,p.__decorate)([_a({type:"crt.ChartWidget"}),_a({type:"crt.IndicatorWidget"}),_a({type:"crt.GaugeWidget"}),_a({type:"crt.FunnelWidget"}),_a({type:"crt.FullPipelineWidget"}),(0,p.__metadata)("design:paramtypes",[qt,Kn])],Ft);let hn=class{};hn.\u0275fac=function(e){return new(e||hn)},hn.\u0275mod=n.\u0275\u0275defineNgModule({type:hn}),hn.\u0275inj=n.\u0275\u0275defineInjector({providers:[{provide:Xr,useValue:new Map([["crt.ChartWidget","HomePageChartDesigner"],["crt.IndicatorWidget","HomePageIndicatorDesigner"],["crt.GaugeWidget","HomePageGaugeDesigner"],["crt.FunnelWidget","HomePageFunnelDesigner"],["crt.FullPipelineWidget","HomePageFullPipelineDesigner"]])},Kn],imports:[f.CommonModule,mt.forRoot()]}),hn=(0,p.__decorate)([(0,h.CrtModule)({viewElements:[Ft]})],hn),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(hn,{declarations:[Ft],imports:[f.CommonModule,mt],exports:[Ft]})}();var jo=v(11667),Go=v(12947);function qd(r,e){r&1&&n.\u0275\u0275element(0,"div",1)}let Nt=class extends u.CrtAppBackgroundComponent{};Nt.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Nt)))(t||Nt)}}(),Nt.\u0275cmp=n.\u0275\u0275defineComponent({type:Nt,selectors:[["crt-designer-app-background"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["class","background-container",4,"ngIf"],[1,"background-container"]],template:function(e,t){e&1&&n.\u0275\u0275template(0,qd,1,0,"div",0),e&2&&n.\u0275\u0275property("ngIf",t.backgroundConfigStr)},dependencies:[f.NgIf],styles:[".background-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:-10;height:100%;width:100%;background-size:cover}"]}),Nt=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerAppBackground",overrideType:"crt.AppBackground"})],Nt);let bn=class{};bn.\u0275fac=function(e){return new(e||bn)},bn.\u0275mod=n.\u0275\u0275defineNgModule({type:bn}),bn.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,u.CrtAppBackgroundModule]}),bn=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[Nt]})],bn),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(bn,{declarations:[Nt],imports:[f.CommonModule,u.CrtAppBackgroundModule],exports:[Nt]})}();const Kd=function(r){return{rtl:r}};let _n=class extends u.CrtApprovalComponent{get isActive(){return!0}_initDesignerItems(e){const t=e?.items??[];this.designerItems=me(t,{selected:!1})}_subscribeElementDesignVisibilityChanges(){this._designerContainerService.designVisibility$.pipe((0,l.takeUntil)(this.destroyed$)).subscribe({next:({name:e,visible:t})=>{const a=this.designerItems.find(i=>i.name===e);a&&(a.hidden=!t,this.detectChanges())}})}constructor(e,t,a,i,o){super(e,t,a),this._approvalSchemaService=i,this._designerSchemaService=o,this.designerItems=[],this._designerContainerService=this.injector.get(z),this.positiveCount=1,this.negativeCount=2,this.pendingCount=1}_addMasterRecordDataSourceAttribute(e){const t="Id";if(this._designerSchemaService.isViewModelAttributeExists(t))return;const a={modelConfig:{path:`${e}.${t}`}};this._designerSchemaService.createViewModelAttribute(t,a)}ngOnInit(){super.ngOnInit(),this._viewItemConfig=this.injector.get(S.VIEW_ELEMENT_CONFIG),this._initDesignerItems(this._viewItemConfig),this._subscribeElementDesignVisibilityChanges(),(!this._viewItemConfig.entityName||!this._viewItemConfig.approvalEntityName)&&this._approvalSchemaService.getDefaultApprovalConfig().pipe((0,d.map)(e=>(this._viewItemConfig.entityName=e?.rootEntityName,this._viewItemConfig.approvalEntityName=e?.approvalSchemaConfig?.entityName,this._primaryDataSourceName=e?.primaryDataSourceName,e)),(0,d.mergeMap)(e=>this._approvalSchemaService.updateComponentProperties(this._viewItemConfig.name,e)),(0,d.map)(()=>{this._addMasterRecordDataSourceAttribute(this._primaryDataSourceName)})).subscribe()}};_n.\u0275fac=function(e){return new(e||_n)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(D.TranslateService),n.\u0275\u0275directiveInject(hi.Directionality),n.\u0275\u0275directiveInject(_e),n.\u0275\u0275directiveInject(g.DesignerSchemaService))},_n.\u0275cmp=n.\u0275\u0275defineComponent({type:_n,selectors:[["crt-designer-approval"]],features:[n.\u0275\u0275InheritDefinitionFeature],decls:46,vars:58,consts:[[1,"approval-widget-wrapper",3,"ngClass"],["approvalWidgetContainer",""],["tabindex","0",1,"approval-widget-main-section"],[1,"approval-widget-header"],[1,"header-caption",3,"caption"],[1,"approval-widget-purpose"],[1,"purpose-caption",3,"caption"],[1,"approval-widget-objective-container"],[1,"approval-objective-label",3,"caption"],[1,"approval-widget-items-container"],[1,"approval-widget-actions"],["icon","approve-icon","iconPosition","only-icon","color","accent",1,"approve-icon",3,"ariaLabel"],["icon","reject-icon","iconPosition","only-icon","color","warn",1,"reject-icon",3,"ariaLabel"],[1,"approval-droppable-items"],["propertyName","items",1,"approval-droppable-list",3,"items"],[1,"approval-metrics"],["tabindex","0",1,"metric-wrapper"],["labelType","caption",1,"approval-metric-label",3,"caption"],[1,"metric-value"],["svgIcon","approve-icon","color","accent"],["labelType","headline-1-small",1,"approval-positive-value-label",3,"caption"],["svgIcon","reject-icon","color","warn"],["labelType","headline-1-small",1,"approval-negative-value-label",3,"caption"],["svgIcon","pending-icon"],["labelType","headline-1-small",1,"approval-pending-value-label",3,"caption"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"div",0,1)(2,"div",2)(3,"div",3),n.\u0275\u0275element(4,"crt-label",4),n.\u0275\u0275pipe(5,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"div",5),n.\u0275\u0275element(7,"crt-label",6),n.\u0275\u0275pipe(8,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(9,"div",7),n.\u0275\u0275element(10,"crt-label",8),n.\u0275\u0275pipe(11,"translate"),n.\u0275\u0275pipe(12,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(13,"div",9)(14,"div",10),n.\u0275\u0275element(15,"crt-button",11),n.\u0275\u0275pipe(16,"translate"),n.\u0275\u0275element(17,"crt-button",12),n.\u0275\u0275pipe(18,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(19,"div",13),n.\u0275\u0275element(20,"crt-droppable-list",14),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(21,"div",15)(22,"div",16),n.\u0275\u0275pipe(23,"translate"),n.\u0275\u0275element(24,"crt-label",17),n.\u0275\u0275pipe(25,"translate"),n.\u0275\u0275pipe(26,"translate"),n.\u0275\u0275elementStart(27,"div",18),n.\u0275\u0275element(28,"mat-icon",19)(29,"crt-label",20),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(30,"div",16),n.\u0275\u0275pipe(31,"translate"),n.\u0275\u0275element(32,"crt-label",17),n.\u0275\u0275pipe(33,"translate"),n.\u0275\u0275pipe(34,"translate"),n.\u0275\u0275elementStart(35,"div",18),n.\u0275\u0275element(36,"mat-icon",21)(37,"crt-label",22),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(38,"div",16),n.\u0275\u0275pipe(39,"translate"),n.\u0275\u0275element(40,"crt-label",17),n.\u0275\u0275pipe(41,"translate"),n.\u0275\u0275pipe(42,"translate"),n.\u0275\u0275elementStart(43,"div",18),n.\u0275\u0275element(44,"mat-icon",23)(45,"crt-label",24),n.\u0275\u0275elementEnd()()()()()),e&2&&(n.\u0275\u0275styleProp("background-color",t.activeColor),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(56,Kd,t.isRtl())),n.\u0275\u0275advance(2),n.\u0275\u0275attribute("aria-label","Approval "+(t.currentApproval==null?null:t.currentApproval.objective)),n.\u0275\u0275advance(2),n.\u0275\u0275property("caption",n.\u0275\u0275pipeBind1(5,26,"Approvals.ComponentHeaderLabel")),n.\u0275\u0275advance(3),n.\u0275\u0275property("caption",n.\u0275\u0275pipeBind1(8,28,"Approvals.ApprovalPurposeLabel")),n.\u0275\u0275advance(3),n.\u0275\u0275property("caption",n.\u0275\u0275pipeBind1(12,32,"Approvals.DesignTime.ApprovalObjective")),n.\u0275\u0275attribute("title",n.\u0275\u0275pipeBind1(11,30,"Approvals.DesignTime.ApprovalObjective")),n.\u0275\u0275advance(5),n.\u0275\u0275property("ariaLabel",n.\u0275\u0275pipeBind1(16,34,"Approvals.ApproveButtonLabel")),n.\u0275\u0275advance(2),n.\u0275\u0275property("ariaLabel",n.\u0275\u0275pipeBind1(18,36,"Approvals.RejectButtonLabel")),n.\u0275\u0275advance(3),n.\u0275\u0275property("items",t.designerItems),n.\u0275\u0275advance(2),n.\u0275\u0275attribute("aria-label",n.\u0275\u0275pipeBind1(23,38,"Approvals.PositiveMetricLabel")+t.positiveCount),n.\u0275\u0275advance(2),n.\u0275\u0275property("caption",n.\u0275\u0275pipeBind1(26,42,"Approvals.PositiveMetricLabel")),n.\u0275\u0275attribute("title",n.\u0275\u0275pipeBind1(25,40,"Approvals.PositiveMetricLabel")),n.\u0275\u0275advance(5),n.\u0275\u0275property("caption",t.positiveCount),n.\u0275\u0275attribute("title",t.positiveCount),n.\u0275\u0275advance(1),n.\u0275\u0275attribute("aria-label",n.\u0275\u0275pipeBind1(31,44,"Approvals.NegativeMetricLabel")+t.negativeCount),n.\u0275\u0275advance(2),n.\u0275\u0275property("caption",n.\u0275\u0275pipeBind1(34,48,"Approvals.NegativeMetricLabel")),n.\u0275\u0275attribute("title",n.\u0275\u0275pipeBind1(33,46,"Approvals.NegativeMetricLabel")),n.\u0275\u0275advance(5),n.\u0275\u0275property("caption",t.negativeCount),n.\u0275\u0275attribute("title",t.negativeCount),n.\u0275\u0275advance(1),n.\u0275\u0275attribute("aria-label",n.\u0275\u0275pipeBind1(39,50,"Approvals.PendingMetricLabel")+t.pendingCount),n.\u0275\u0275advance(2),n.\u0275\u0275property("caption",n.\u0275\u0275pipeBind1(42,54,"Approvals.PendingMetricLabel")),n.\u0275\u0275attribute("title",n.\u0275\u0275pipeBind1(41,52,"Approvals.PendingMetricLabel")),n.\u0275\u0275advance(5),n.\u0275\u0275property("caption",t.pendingCount),n.\u0275\u0275attribute("title",t.pendingCount))},dependencies:[f.NgClass,E.MatIcon,u.CrtLabelComponent,u.CrtButtonComponent,we,D.TranslatePipe],styles:[`.approval-widget-wrapper{height:100%;width:100%;display:flex;flex-direction:column;justify-content:stretch;border-radius:8px;border-width:0;overflow:auto}.approval-widget-wrapper .approval-metrics{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between;padding:16px 24px}.approval-widget-wrapper .approval-metrics .metric-wrapper{display:flex;flex-direction:column;justify-content:space-between}.approval-widget-wrapper .approval-metrics .metric-wrapper .metric-value{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:flex-start;align-items:center}.approval-widget-wrapper .approval-metrics .metric-wrapper .metric-value mat-icon{height:16px;width:16px;margin-right:3px;margin-top:2px}.approval-widget-wrapper .approve-icon{margin-right:5px}.approval-widget-wrapper.rtl .approve-icon{margin-left:5px}.approval-widget-approved-placeholder,.approval-widget-rejected-placeholder{display:flex;flex-direction:row;padding:8px 0 0 24px}.approval-widget-approved-placeholder mat-icon,.approval-widget-rejected-placeholder mat-icon{height:17px;width:17px;margin-right:2px}.approval-widget-main-section{min-width:50%;display:flex;flex-direction:column;justify-content:space-between}.approval-widget-history-section{min-width:50%}.approval-widget-header{display:flex;flex-direction:row;justify-content:space-between;padding:20px 24px 12px}.approval-widget-header .header-caption{flex-grow:1}.approval-widget-header .icon-2{height:16px;width:16px;background-color:#fff}.approval-widget-purpose{display:flex;margin-bottom:8px;padding:0 24px}.approval-widget-objective-container{display:flex;flex-direction:row;justify-content:left;display:-webkit-box;padding:0 24px;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;text-align:left}.approval-widget-objective-container label{display:block}.approval-widget-items-container{display:flex;border-bottom:1px solid #e6e6e6;padding:16px 24px;flex-direction:row;justify-content:space-between;flex-wrap:wrap}.approval-widget-items-container .approval-widget-actions{display:flex;flex-direction:row;justify-content:right;align-items:center}.approval-widget-items-container .approval-widget-actions .approve-icon,.approval-widget-items-container .approval-widget-actions .reject-icon{height:-moz-fit-content;height:fit-content;width:-moz-fit-content;width:fit-content;max-width:100%}.approval-widget-items-container .approval-widget-actions .approve-icon button,.approval-widget-items-container .approval-widget-actions .reject-icon button{border-radius:4px}.approval-widget-request{color:#fff;display:flex;justify-content:center;align-content:center}.approval-widget-wrapper.rtl .reject-icon{margin-left:5px}.approval-widget-wrapper.rtl .approval-widget-objective-container{text-align:right}.label-fade-in{animation:fadein .5s}.label-fade-out{opacity:0}@keyframes fadein{0%{opacity:0}to{opacity:1}}
`,`.approval-widget-main-section .approval-widget-items-container{display:flex;flex-direction:row;justify-content:space-between;margin:0;flex-wrap:wrap}.approval-widget-main-section .approval-widget-items-container .approval-droppable-items{display:flex;flex:0 0 40%;margin-top:5px;margin-bottom:5px;flex-direction:row;z-index:100}.approval-widget-main-section .approval-widget-items-container .approval-droppable-list{width:100%}
`],encapsulation:2,changeDetection:0}),_n=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerApproval",overrideType:"crt.Approval"}),(0,p.__metadata)("design:paramtypes",[n.Injector,D.TranslateService,hi.Directionality,_e,g.DesignerSchemaService])],_n);let fn=class{};fn.\u0275fac=function(e){return new(e||fn)},fn.\u0275mod=n.\u0275\u0275defineNgModule({type:fn}),fn.\u0275inj=n.\u0275\u0275defineInjector({imports:[u.CrtApprovalModule,f.CommonModule,E.MatIconModule,S.ViewModule,w.ResizableModule,w.CrtSkeletonLoaderModule,u.CrtLabelModule,u.CrtButtonModule,q,D.TranslateModule]}),fn=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[_n]})],fn),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(fn,{declarations:[_n],imports:[u.CrtApprovalModule,f.CommonModule,E.MatIconModule,S.ViewModule,w.ResizableModule,w.CrtSkeletonLoaderModule,u.CrtLabelModule,u.CrtButtonModule,q,D.TranslateModule],exports:[_n]})}();class Cn extends Bt{constructor(){super(...arguments),this.typeName="ApprovalList",this.defaultColumnCodes=["VisaOwner","Objective","CreatedOn","SetDate","SetBy","Status"],this.defaultSorting={columnName:"CreatedOn",direction:"desc"}}getColumnsChangedConfig(e,t,a){const i=super.getColumnsChangedConfig(e,t,a);return i.columns.forEach(o=>{o.width=175}),i}}Cn.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Cn)))(t||Cn)}}(),Cn.\u0275prov=n.\u0275\u0275defineInjectable({token:Cn,factory:Cn.\u0275fac});function Jd(r,e){if(r&1&&n.\u0275\u0275element(0,"crt-placeholder",2),r&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("image",t.placeholderImage)}}let Ye=class extends fe{constructor(e,t,a,i,o,s,c){super(e,a,i,c),this.designerApprovalSchemaService=t,this._designerSchemaService=a,this.designerCommandFactoryService=i,this._designerDataGridStateHandler=o,this._messageDialogProvider=s,this.viewConfig=c}_setApprovalConfigData(e){return this._viewItemConfig.entityName=e?.rootEntityName,this._viewItemConfig.approvalEntityName=e?.approvalSchemaConfig?.entityName,this.approvalConfig=e?.approvalSchemaConfig,this.primaryDataSourceName=e?.primaryDataSourceName,e}_setViewElementConfigAttributes(){return this.designerSchemaService.isDataSourceExists(this.dataSourceName)||!this.primaryDataSourceName?(0,d.of)(null):(this._addMasterRecordDataSourceAttribute(this.primaryDataSourceName),this.placeholder=!1,this._designerDataGridStateHandler.handleEntitySelect(this._viewItemConfig,this._viewItemConfig.approvalEntityName).pipe((0,l.tap)(()=>{this.designerApprovalSchemaService.setDependencies(this.dataSourceName,this.primaryDataSourceName,this.approvalConfig.masterColumnName)})))}_checkDataSourceExists(){return this._designerSchemaService.getDataSources()[0]?.config?.entitySchemaName?!0:(this._messageDialogProvider.open({data:{message:"Components.ApprovalList.ProvideDataSource",actions:[u.DEFAULT_DIALOG_ACTIONS.OK]}}),!1)}_addMasterRecordDataSourceAttribute(e,t){if(t=t||"Id",this._designerSchemaService.isViewModelAttributeExists(t))return;const a={modelConfig:{path:`${e}.${t}`}};this._designerSchemaService.createViewModelAttribute(t,a)}_updateFeatures(){const e={name:this._viewItemConfig.name,changes:[{path:"itemConfig.features",value:{editable:!1},applyPropertyStrategy:_.ApplyChangedPropertyStrategy.Override}]};this.designerCommandFactoryService.create("crt.ChangeViewItemCommand",e).pipe((0,d.mergeMap)(t=>t.execute())).subscribe()}ngOnInit(){!this._checkDataSourceExists()||(this._viewItemConfig=this.injector.get(S.VIEW_ELEMENT_CONFIG),this._viewItemConfig.features||this._updateFeatures(),this.dataSourceName=`${this._viewItemConfig.name}${I.DATA_SOURCE_PREFIX}`,(!this._viewItemConfig.entityName||!this._viewItemConfig.approvalEntityName)&&this.designerApprovalSchemaService.getDefaultApprovalConfig().pipe((0,d.map)(e=>this._setApprovalConfigData(e)),(0,d.mergeMap)(e=>this.designerApprovalSchemaService.updateComponentProperties(this._viewItemConfig.name,e)),(0,d.mergeMap)(()=>(this.entityName=this._viewItemConfig.entityName,this.approvalEntityName=this._viewItemConfig.approvalEntityName,this._setViewElementConfigAttributes()))).subscribe(()=>{this.detectChanges()}))}};Ye.\u0275fac=function(e){return new(e||Ye)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(_e),n.\u0275\u0275directiveInject(g.DesignerSchemaService),n.\u0275\u0275directiveInject(g.DesignerCommandFactoryService),n.\u0275\u0275directiveInject(Cn),n.\u0275\u0275directiveInject(u.MessageDialogProvider),n.\u0275\u0275directiveInject(S.VIEW_ELEMENT_CONFIG))},Ye.\u0275cmp=n.\u0275\u0275defineComponent({type:Ye,selectors:[["crt-designer-approval-list"]],inputs:{entityName:"entityName",approvalEntityName:"approvalEntityName"},features:[n.\u0275\u0275ProvidersFeature([Cn]),n.\u0275\u0275InheritDefinitionFeature],decls:2,vars:7,consts:[[3,"items","header","columns","sorting","loading","primaryColumnName","sortingChange"],["skeleton","","title","","subhead","",3,"image",4,"ngIf"],["skeleton","","title","","subhead","",3,"image"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"crt-data-grid",0),n.\u0275\u0275listener("sortingChange",function(i){return t.onSortingChanged(i)}),n.\u0275\u0275template(1,Jd,1,1,"crt-placeholder",1),n.\u0275\u0275elementEnd()),e&2&&(n.\u0275\u0275property("items",t.items)("header",t.header)("columns",t.columns)("sorting",t.dataGridSorting)("loading",t.loading)("primaryColumnName",t.primaryColumnName),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.placeholderVisible))},dependencies:[f.NgIf,u.CrtDataGridComponent,w.CrtPlaceholderComponent],styles:[`.container11{width:200px;height:300px;background-color:red}
`],encapsulation:2,changeDetection:0}),(0,p.__decorate)([(0,h.CrtInput)(),(0,p.__metadata)("design:type",String)],Ye.prototype,"entityName",void 0),(0,p.__decorate)([(0,h.CrtInput)(),(0,p.__metadata)("design:type",String)],Ye.prototype,"approvalEntityName",void 0),Ye=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerApprovalList",overrideType:"crt.ApprovalList"}),(0,p.__metadata)("design:paramtypes",[n.Injector,_e,g.DesignerSchemaService,g.DesignerCommandFactoryService,Cn,u.MessageDialogProvider,Object])],Ye);let yn=class{};yn.\u0275fac=function(e){return new(e||yn)},yn.\u0275mod=n.\u0275\u0275defineNgModule({type:yn}),yn.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,u.CrtApprovalModule,u.CrtDataGridModule,w.CrtPlaceholderModule]}),yn=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[Ye]})],yn),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(yn,{declarations:[Ye],imports:[f.CommonModule,u.CrtApprovalModule,u.CrtDataGridModule,w.CrtPlaceholderModule],exports:[Ye]})}();let et=class{};et.\u0275fac=function(e){return new(e||et)},et.\u0275mod=n.\u0275\u0275defineNgModule({type:et}),et.\u0275inj=n.\u0275\u0275defineInjector({imports:[f.CommonModule,u.CrtButtonModule,E.MatIconModule,Qe.MatLegacyButtonModule,Wi.MatDividerModule,u.CrtMenuModule,w.ResizableModule]}),et=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[pn]})],et),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(et,{declarations:[pn],imports:[f.CommonModule,u.CrtButtonModule,E.MatIconModule,Qe.MatLegacyButtonModule,Wi.MatDividerModule,u.CrtMenuModule,w.ResizableModule]})}();function Zd(r,e){r&1&&n.\u0275\u0275element(0,"crt-base-message-composer",2),r&2&&n.\u0275\u0275property("inputPlaceHolder","")("footerPanelExpanded",!0)}function Xd(r,e){r&1&&n.\u0275\u0275element(0,"crt-base-message-composer",2),r&2&&n.\u0275\u0275property("inputPlaceHolder","")("footerPanelExpanded",!0)}let vn=class extends S.CrtBaseComponent{get designerViewConfig(){if(!this._designerMessageComposerViewConfig){const e=this.injector.get(S.VIEW_ELEMENT_CONFIG);this._designerMessageComposerViewConfig=this._designerSchemaService.getViewConfigInfoByName(e.name).viewConfig}return this._designerMessageComposerViewConfig}constructor(e,t,a,i,o,s){super(e),this.injector=e,this._designerSchemaService=t,this._messageComposerService=a,this._designerConfigService=i,this._viewCommandExecutor=o,this._designerContainerService=s,this._destroyed$=new d.Subject,this.designerItems=[],this.isLoaded=!1}_subscribeToSchemaChanged(){this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{parentName:e,operation:t}})=>e===this.name)).subscribe(()=>{this._updateView()}),this._designerSchemaService.schemaChanged$.pipe((0,l.filter)(({changes:{operation:e}})=>e===_.MetaItemDesignSettingChangesOperation.CreateDataSource)).subscribe(()=>{this._initDesignerItems()})}_initDesignerMessageComposer(){this.isLoaded||this._initDesignerItems()}_updateView(){const e=me(this.designerViewConfig?.items,{selected:!1});e?.length!==0&&(0,d.from)(e).pipe((0,l.concatMap)(t=>this._designerConfigService.getCaption(t.data).pipe((0,l.tap)(a=>{t.data.caption=a}))),(0,l.last)()).subscribe(()=>{this.designerItems=[...e].sort((t,a)=>t.data.caption>a.data.caption?1:t.data.caption<a.data.caption?-1:0),this.isLoaded=!0,this.detectChanges()})}_initDesignerItems(){this.designerViewConfig?.items?.length===0?this._messageComposerService.getPredefinedChannels().subscribe(t=>{this._addItems(t)}):this._updateView()}_addItems(e){const t=this.designerViewConfig;(0,d.from)(e).pipe((0,l.concatMap)(a=>this._viewCommandExecutor.add(this._designerConfigService.getNewViewItemConfig(a,t)).pipe((0,l.switchMap)(i=>i.execute()))),(0,l.last)()).subscribe(()=>this._updateView())}_subscribeElementDesignVisibilityChanges(){this._designerContainerService.designVisibility$.pipe((0,l.takeUntil)(this._destroyed$)).subscribe({next:({name:e,visible:t})=>{const a=this.designerItems.find(i=>i.name===e);a&&(a.hidden=!t,this.detectChanges())}})}ngOnInit(){this._subscribeToSchemaChanged(),this._initDesignerMessageComposer(),this._subscribeElementDesignVisibilityChanges()}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}};vn.\u0275fac=function(e){return new(e||vn)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(g.DesignerSchemaService),n.\u0275\u0275directiveInject(ke),n.\u0275\u0275directiveInject(ee),n.\u0275\u0275directiveInject(g.ViewItemCommandExecutor),n.\u0275\u0275directiveInject(z))},vn.\u0275cmp=n.\u0275\u0275defineComponent({type:vn,selectors:[["crt-designer-message-composer"]],features:[n.\u0275\u0275ProvidersFeature([u.ChangeComposerService]),n.\u0275\u0275InheritDefinitionFeature],decls:5,vars:1,consts:[[3,"items"],["items",""],[3,"inputPlaceHolder","footerPanelExpanded"]],template:function(e,t){e&1&&(n.\u0275\u0275elementStart(0,"crt-message-composer-selector",0),n.\u0275\u0275template(1,Zd,1,2,"ng-template",null,1,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275template(3,Xd,1,2,"ng-template",null,1,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementEnd()),e&2&&n.\u0275\u0275property("items",t.designerItems)},dependencies:[u.CrtBaseMessageComposerComponent,u.CrtMessageComposerSelectorComponent]}),vn=(0,p.__decorate)([(0,h.CrtDesignTimeViewElement)({type:"crt.DesignerMessageComposer",overrideType:"crt.MessageComposerSelector"}),(0,p.__metadata)("design:paramtypes",[n.Injector,g.DesignerSchemaService,ke,ee,g.ViewItemCommandExecutor,z])],vn);let tt=class{};tt.\u0275fac=function(e){return new(e||tt)},tt.\u0275mod=n.\u0275\u0275defineNgModule({type:tt}),tt.\u0275inj=n.\u0275\u0275defineInjector({providers:[g.DesignerSchemaService,B,ke,ee],imports:[f.CommonModule,E.MatIconModule,Yt.MatLegacyMenuModule,D.TranslateModule,q,he,S.ViewModule,Ct.MatExpansionModule,j,P.CdkModule,w.DialogModule,N.MatLegacyDialogModule,Qe.MatLegacyButtonModule,Ci.MatLegacyCheckboxModule,w.MaskModule,se.MatLegacyFormFieldModule,Dt.MatLegacyInputModule,u.CrtComponentsModule,w.CrtSkeletonLoaderModule]}),tt=(0,p.__decorate)([(0,h.CrtModule)({designTimeViewElements:[vn]})],tt),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(tt,{declarations:[vn],imports:[f.CommonModule,E.MatIconModule,Yt.MatLegacyMenuModule,D.TranslateModule,q,he,S.ViewModule,Ct.MatExpansionModule,j,P.CdkModule,w.DialogModule,N.MatLegacyDialogModule,Qe.MatLegacyButtonModule,Ci.MatLegacyCheckboxModule,w.MaskModule,se.MatLegacyFormFieldModule,Dt.MatLegacyInputModule,u.CrtComponentsModule,w.CrtSkeletonLoaderModule],exports:[vn]})}();class Jn{}Jn.\u0275fac=function(e){return new(e||Jn)},Jn.\u0275mod=n.\u0275\u0275defineNgModule({type:Jn}),Jn.\u0275inj=n.\u0275\u0275defineInjector({providers:[I.ViewModelGenerator,de,fa],imports:[f.CommonModule,P.CdkModule,P.ExpansionButtonModule,re.ResizableModule,S.ViewModule,E.MatIconModule,Qe.MatLegacyButtonModule,D.TranslateModule,u.CrtBreadcrumbsModule,C.MacrosModule]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Jn,{declarations:[Xt],imports:[f.CommonModule,P.CdkModule,P.ExpansionButtonModule,re.ResizableModule,S.ViewModule,E.MatIconModule,Qe.MatLegacyButtonModule,D.TranslateModule,u.CrtBreadcrumbsModule,C.MacrosModule],exports:[Xt]})}();class Yd extends I.DataSourceInitError{get entitySchemaName(){return this._entitySchemaName}constructor(e,t){super(e,`Data source object with '${t}' code not found.`),this._entitySchemaName=t}}class em extends I.BaseDataSource{constructor(e,t){super(e,t),this.dataSourceName=e,this.type=C.EntityDataSourceTypeName,this._designerEntityService=t.get(B),this._designerSchemaService=t.get(g.DesignerSchemaService),this._transformer=t.get(pa),this._lczToString=t.get(C.LczToStringPipe)}_getLocalizableValue(e){return this._lczToString.transform(new C.LocalizableStringArray(e.filter(t=>t.value)))}_getDataSourceConfig(){return this._designerSchemaService.getDataSourceConfigByName(this.dataSourceName)??this.initialConfig}innerDelete(e){return(0,d.of)(null)}innerInsert(e){return(0,d.of)(null)}innerLoad(e,t){return(0,d.of)([])}innerSave(e,t){return(0,d.of)(null)}innerGetLookupDataSchema(e){return(0,d.of)(null)}innerGetSchema(){const e=this._getDataSourceConfig()?.entitySchemaName;return e?this._designerEntityService.getByName(e).pipe((0,l.tap)(t=>{if(t.isDeleted){const a=new Yd(this,this._entitySchemaName);this._errors.push(a)}}),(0,l.mergeMap)(t=>{if(t.isDeleted)return(0,d.of)(this.getEmptySchema());const a=this._transformer.toDataSchema(t),i=[],o=this._getDataSourceConfig();return Object.entries(o.attributes??{}).filter(([,s])=>s.type==="ForwardReference").forEach(([s,c])=>{i.push(this._designerEntityService.getReferenceColumn(`${o.entitySchemaName}.${c.path}`).pipe((0,l.map)(m=>{if(m){const b=new I.DataSchemaAttribute;b.name=s,b.caption=this._getLocalizableValue(m.caption),b.dataValueType=m.type,b.validators={},b.attributeType=h.DataSchemaAttributeType.ForwardReferenceAttribute,b.path=c.path,b.isRequired=m.requirementType===ie.EntitySchemaColumnRequirementType.YES,b.defaultValueSchema=m.defValue,a.attributes.push(b)}})))}),i.length===0?(0,d.of)(a):(0,d.combineLatest)(i).pipe((0,l.take)(1),(0,l.map)(()=>a))})):(0,d.of)(this.getEmptySchema())}innerGetDefaultValues(){return(0,d.of)(null)}innerCanDelete(e){return(0,d.of)(null)}innerCanEdit(e){return(0,d.of)(null)}innerCanCreate(e){return(0,d.of)(null)}init(e,t){return super.init(e,t).pipe((0,l.tap)(()=>{this._entitySchemaName=this.initialConfig.entitySchemaName}))}getEmptySchema(){return this._entitySchemaName?new I.DataSchema({name:this._entitySchemaName,dataSourceConfig:{type:"crt.EntityDataSource",config:{...this._getDataSourceConfig()}}}):super.getEmptySchema()}}class tm extends I.BaseDataSource{constructor(e,t){super(e,t),this.dataSourceName=e,this._dataSourceCaptionKey="pageParametersDataSource",this.type=C.PAGE_PARAMETERS_DATA_SOURCE_TYPE_NAME,this._lczToString=t.get(C.LczToStringPipe),this._userInfo=t.get(C.UserInfo),this._translateService=t.get(D.TranslateService)}_getLocalizableValue(e){return this._lczToString.transform(new C.LocalizableStringArray(e.filter(t=>t.value)))}_createAttribute(e){const t=new I.DataSchemaAttribute({name:e.name,path:e.name,referenceSchemaName:e.referenceSchemaName,caption:this._getLocalizableValue(e.caption),dataValueType:e.dataValueType,isRequired:e.required,attributeType:h.DataSchemaAttributeType.OwnAttribute,isMasked:!1,isFormatValidated:!0});return t.addDefaultValidators(),t}innerDelete(e){return(0,d.of)(null)}innerInsert(e){return(0,d.of)(null)}innerLoad(e,t){return(0,d.of)([])}innerSave(e,t){return(0,d.of)(null)}innerGetLookupDataSchema(e){return(0,d.of)(null)}innerGetSchema(){const e=this.initialConfig.parameters;return(0,d.of)(new I.DataSchema({attributes:Object.values(e).map(t=>this._createAttribute(t)),caption:this._translateService.instant(this._dataSourceCaptionKey),name:this.initialConfig.schemaName,type:h.DataSchemaType.ClientUnit,dataSourceConfig:{type:C.PAGE_PARAMETERS_DATA_SOURCE_TYPE_NAME,config:this.initialConfig}}))}innerGetDefaultValues(){return(0,d.of)(null)}innerCanDelete(e){return(0,d.of)(null)}innerCanEdit(e){return(0,d.of)(null)}innerCanCreate(e){return(0,d.of)(null)}}class Za{resolve(e){let t;switch(e){case"crt.EntityDataSource":t=em;break;case C.PAGE_PARAMETERS_DATA_SOURCE_TYPE_NAME:t=tm;break;case"crt.WebServiceDataSource":t=I.WebServiceDataSource;break;default:t=null}return(0,d.of)(t)}}Za.\u0275fac=function(e){return new(e||Za)},Za.\u0275prov=n.\u0275\u0275defineInjectable({token:Za,factory:Za.\u0275fac});function nm(){throw new Error("Object is destroyed")}function Yr(r){const e=new Set;for(let t=r;t!=null;t=Object.getPrototypeOf(t)){const a=Object.getOwnPropertyNames(t);for(const i of a)typeof t[i]=="function"&&e.add(i)}for(const t of e)r[t]=nm}class Ce{constructor(){this.injector=(0,n.inject)(n.EnvironmentInjector)}instantiate(e,t){return this.injector.runInContext(()=>new e(...t))}destroy(){Yr(this)}}var ye=v(2546);class $o extends Ce{constructor(e){super(),this._config=e,this.type=ye.DataSourceType.EntityDataSource,this.sync(e)}addAttribute(e){throw new Error("Method not implemented.")}getAttribute(e){throw new Error("Method not implemented.")}removeAttribute(e){throw new Error("Method not implemented.")}sync(e){this._config=e,this.entitySchemaName=e.config.entitySchemaName}}function Uo(r,e,t,a,i){const o=new Map(r.map(s=>[e(s),s]));t.forEach((s,c)=>{const m=a(s);if(o.has(m)){const b=o.get(m);o.delete(m),r[c]=i.update(b,s)||b}else r[c]=i.create(s)}),o.forEach(i.destroy),r.length=t.length}function xi(r,e,t){const a=new Map(r);for(const i in e){let o;r.has(i)?(a.delete(i),o=r.get(i),o=t.update(o,e[i],i)||o):o=t.create(e[i],i),r.set(i,o)}for(const[i,o]of a)r.delete(i),t.destroy(o)}class am extends Ce{constructor(e){super(),this._config=e,this._designerService=(0,n.inject)(g.DesignerSchemaService),this._dataSources=new Map,this.sync(e)}_addEntityDataSource(e,t,a){const i=a.map(c=>[c,{path:c}]),o={type:ye.DataSourceType.EntityDataSource,scope:h.DataSourceScope.ViewElement,config:{entitySchemaName:t,attributes:i}};this._designerService.createDataSource(e,o);const s=this.instantiate($o,[this._config.dataSources[e]]);return this._dataSources.set(e,s),s}addDataSource(e,t){if(t.type===ye.DataSourceType.EntityDataSource)return this._addEntityDataSource(e,t.entitySchemaName,t.columns);throw new Error("Method not implemented")}getDataSource(e){return this._dataSources.get(e)}getAllDataSources(){return this._dataSources}canRemoveDataSource(e){return!this._designerService.isDataSourceBound(e)}hasDataSource(e){return this._dataSources.has(e)}removeDataSource(e){this._designerService.removeUnboundDataSource(e),this._dataSources.delete(e)}getPrimaryDataSourceName(){return this._designerService.getPrimaryDataSourceName()}sync(e){this._config=e,xi(this._dataSources,e.dataSources,{create:t=>{if(t.type===ye.DataSourceType.EntityDataSource)return this.instantiate($o,[t]);console.error(t.type,"Not implemented")},update:(t,a)=>t?.sync(a),destroy:t=>t?.destroy()})}}class Ho extends Ce{constructor(e){super(),this._expression=e,this.type=ye.BindingType.Attribute;const t=(0,_.parseExpression)(this._expression);this.attributePath=t.attributePath}}class im extends Ce{constructor(e){super(),this.value=e,this.type=ye.BindingType.Const}}class rm extends Ce{constructor(e){super(),this._config=e,this.type=ye.BindingType.Request,this.requestType=this._config.request}}class om extends Ce{constructor(e){super(),this._expression=e,this.type=ye.BindingType.Resource;const t=(0,_.parseExpression)(this._expression);this.resourcePath=t.resourcePath}}class Xa extends Ce{constructor(e,t){super(),this._config=e,this._parent=t,this._manipulationService=(0,n.inject)(_.ViewNodeManipulationService),this._bindings=new Map,this._content=new Map,this.type=this._config.type,this.name=this._config.name,this._viewElementsRegistryItem=h.ViewElementRegistry.viewElements.get(this.type),this._contentSlotNames=(this._viewElementsRegistryItem?.contentSlots??[]).map(a=>typeof a=="string"?a:a.name),this.sync(this._config)}_syncContent(){xi(this._content,this._contentConfig,{create:e=>e.map(t=>this.instantiate(Xa,[t,this])),update:(e,t)=>Uo(e,a=>a.name,t,a=>a.name,{create:a=>this.instantiate(Xa,[a,this]),update:(a,i)=>a.sync(i),destroy:a=>a.destroy()}),destroy:e=>e.forEach(t=>t.destroy())})}_syncBindings(){const e=(a,i)=>{if(this._isOutputProperty(i))return this.instantiate(rm,[a]);if((0,_.isBindingExpression)(a)){const o=(0,_.parseExpression)(a);if(o.attributePath)return this.instantiate(Ho,[a]);if(o.resourcePath)return this.instantiate(om,[a])}else return this.instantiate(im,[a])},t=a=>a.destroy();xi(this._bindings,this._propertiesConfig,{create:e,destroy:t,update:(a,i,o)=>(t(a),e(i,o))})}_isOutputProperty(e){return Boolean(this._viewElementsRegistryItem?.outputs?.[e])}remove(){this._parent.removeChild(this.name)}removeChild(e){for(const t of this._content.values()){const a=t.findIndex(i=>i.name===e);if(a>-1){this._manipulationService.remove(t[a]),t[a].destroy(),t.splice(a,1);return}}}getChildren(){return Array.from(this._content.values()).flatMap(e=>e)}getBinding(e){return this._bindings.get(e)}bindProperty(e,t){this._bindings.has(e)&&(this._bindings.get(e).destroy(),this._bindings.delete(e));const a="$"+t.toAttribute;this._manipulationService.update(this,{itemConfig:{...this._config,[e]:a},resources:null,viewModelConfig:null,applyPropertiesStrategies:null});const i=this.instantiate(Ho,[a]);return this._bindings.set(e,i),i}sync(e){this._config=e,this._contentConfig=(0,x.pick)(this._config,this._contentSlotNames),this._syncContent(),this._propertiesConfig=(0,x.omit)(this._config,this._contentSlotNames),this._syncBindings()}createChild(e){const t=this._manipulationService.create({parentName:this.name,...e}),a=this._content.get(e.slotName),i=this.instantiate(Xa,[t,this]);return a.push(i),i}}class sm extends Ce{constructor(e){super(),this._config=e,this._manipulationService=(0,n.inject)(_.ViewNodeManipulationService),this._nodes=[],this.sync(this._config)}sync(e){Uo(this._nodes,t=>t.name,e,t=>t.name,{create:t=>this.instantiate(Xa,[t,this]),update:(t,a)=>t.sync(a),destroy:t=>t.destroy()})}getNodeByName(e,t=this._nodes){for(const a of t){if(a.name===e)return a;const i=this.getNodeByName(e,a.getChildren());if(i)return i}return null}findNodes(e,t=this._nodes){const a=[];for(const i of t){e(i)&&a.push(i);const o=this.findNodes(e,i.getChildren());a.push(...o)}return a}createNode(e,t){const a=this._manipulationService.create({...t,parentName:e}),i=this.instantiate(Xa,[a,this]);return this._nodes.push(i),i}removeChild(e){const t=this._nodes.findIndex(a=>a.name===e);t>-1&&(this._manipulationService.remove(this._nodes[t]),this._nodes[t].destroy(),this._nodes.splice(t,1))}}class Wo extends Ce{constructor(e){super(),this._config=e,this.path=this._config.path,[this.dataSourceName,this.dataSourceAttributePath]=this.path.split(/\.(.*)/s)}}class Qo extends Ce{get value(){return this._config?.value}set value(e){this._config.value=e}constructor(e,t){super(),this.name=e,this.attributeConfig=t,this.type=ye.ViewModelAttributeType.Simple,this.sync(t)}bindToModel(e,t){if(this.hasModelBinding())throw new Error("Attribute already bound to model.");return this._config.modelConfig={path:e+"."+t},this._modelBinding=this.instantiate(Wo,[this._config.modelConfig]),this._modelBinding}unbindFromModel(){delete this._config.modelConfig,this._modelBinding?.destroy(),this._modelBinding=null}getModelBinding(){return this._modelBinding}hasModelBinding(){return Boolean(this._modelBinding)}sync(e){this._config=e,this._modelBinding&&(!e.modelConfig||e.modelConfig.path!==this._modelBinding.path)&&(this._modelBinding.destroy(),this._modelBinding=null),e.modelConfig&&!this._modelBinding&&(this._modelBinding=this.instantiate(Wo,[e.modelConfig]))}}class cm{constructor(e){this._config=e,this.type="unknown"}sync(e){this._config=e}destroy(){Yr(this)}}class qo extends Ce{constructor(){super(...arguments),this.attributes=new Map,this.designerSchemaService=(0,n.inject)(g.DesignerSchemaService)}instantiateAttribute(e,t){return Object.getOwnPropertyNames(t).every(i=>["value","modelConfig"].includes(i))?this.instantiate(Qo,[e,t]):this.instantiate(cm,[t])}createAttribute(e,t){var a;if(this.hasAttribute(e))throw new Error(`ViewModel already contain attribute with name '${e}'`);(a=this.vmConfig).attributes??(a.attributes={});const i={value:t};this.vmConfig.attributes[e]=i;const o=this.instantiate(Qo,[e,i]);return this.attributes.set(e,o),o}hasAttribute(e){const t=e.split(".");if(t.length===1)return this.attributes.has(t[0]);const a=this.getAttribute(t.slice(0,-1).join("."));if(a.type!==ye.ViewModelAttributeType.ViewModelCollection)throw new Error(`Wrong attribute path: '${e}'`);return a.hasAttribute(t.at(-1))}getAttribute(e){const t=e.split("."),a=this.attributes.get(t[0]);if(t.length===1)return a;if(a.type!==ye.ViewModelAttributeType.ViewModelCollection)throw new Error(`Wrong attribute path: '${e}'`);return a.getAttribute(t.slice(1).join("."))}getAllAttributes(){return this.attributes}removeAttribute(e){const t=e.split(".");if(t.length===1){delete this.vmConfig.attributes[t[0]],this.attributes.delete(t[0]);return}const a=this.getAttribute(t.slice(0,-1).join("."));if(a.type!==ye.ViewModelAttributeType.ViewModelCollection)throw new Error(`Wrong attribute path: '${e}'`);return a.removeAttribute(t.at(-1))}canRemoveAttribute(e){return!this.designerSchemaService.isViewModelAttributeBound(e)}sync(e){this.vmConfig=e,xi(this.attributes,e.attributes,{create:(t,a)=>this.instantiateAttribute(a,t),update:(t,a)=>t.sync(a),destroy:t=>t.destroy()})}destroy(){this.attributes.forEach(e=>{e.destroy()}),this.attributes.clear(),Yr(this)}}class Ko extends Ce{constructor(e){super(),this._config=e,this.dataSourceName=this._config.path.split(".")[0]}}class Jo extends qo{constructor(e,t){super(),this.name=e,this.attributeConfig=t,this.type=ye.ViewModelAttributeType.ViewModelCollection,this.sync(t)}unbindFromModel(){delete this.attributeConfig.modelConfig,this._modelBinding.destroy(),this._modelBinding=null}bindToModel(e,t){return this.designerSchemaService.bindViewModelAttributeCollection(this.name,e,t,"",0),this._modelBinding=this.instantiate(Ko,[this.attributeConfig.modelConfig]),this._modelBinding}getModelBinding(){return this._modelBinding}hasModelBinding(){return Boolean(this._modelBinding)}sync(e){this.attributeConfig=e,super.sync(e.viewModelConfig),this._modelBinding&&(!e.modelConfig||e.modelConfig.path!==this._modelBinding.dataSourceName)&&(this._modelBinding.destroy(),this._modelBinding=null),e.modelConfig&&!this._modelBinding&&(this._modelBinding=this.instantiate(Ko,[e.modelConfig]))}}class lm extends qo{constructor(e){super(),this.vmConfig=e,this.sync(e)}instantiateAttribute(e,t){return"viewModelConfig"in t&&t.isCollection?this.instantiate(Jo,[e,t]):super.instantiateAttribute(e,t)}createViewModelCollectionAttribute(e){var t;if(this.hasAttribute(e))throw new Error(`ViewModel already contain attribute with name '${e}'`);(t=this.vmConfig).attributes??(t.attributes={});const a={isCollection:!0,viewModelConfig:{attributes:{}}};this.vmConfig.attributes[e]=a;const i=this.instantiate(Jo,[e,a]);return this.attributes.set(e,i),i}}class dm extends Ce{get view(){return this._view||(this._view=this.instantiate(sm,[this._schema.viewConfig])),this._view}get viewModel(){return this._viewModel||(this._viewModel=this.instantiate(lm,[this._schema.viewModelConfig])),this._viewModel}get model(){return this._model||(this._model=this.instantiate(am,[this._schema.modelConfig])),this._model}constructor(e){super(),this._schema=e}sync(){this.view.sync(this._schema.viewConfig),this.viewModel.sync(this._schema.viewModelConfig),this.model.sync(this._schema.modelConfig)}}class Ma{constructor(){this._debugPropertyPath="creatio.debugging.__schemaApi__",this._injector=(0,n.inject)(n.EnvironmentInjector),this._window=(0,n.inject)(G.WINDOW_TOKEN)}get schemaApi(){return this._schemaApi}init(e){this._injector.runInContext(()=>{this._schemaApi=new dm(e),(0,x.set)(this._window,this._debugPropertyPath,this._schemaApi)})}ngOnDestroy(){(0,x.set)(this._window,this._debugPropertyPath,null)}}Ma.\u0275fac=function(e){return new(e||Ma)},Ma.\u0275prov=n.\u0275\u0275defineInjectable({token:Ma,factory:Ma.\u0275fac});const Ya=new n.InjectionToken("CHANGE_LISTENER");class Zn extends C.RootInjectorGuard{constructor(e){super()}}Zn.\u0275fac=function(e){return new(e||Zn)(n.\u0275\u0275inject(Ya,8))},Zn.\u0275prov=n.\u0275\u0275defineInjectable({token:Zn,factory:Zn.\u0275fac});class mm extends si(_.CrtInjectorConstructor){}class Sn extends mm{constructor(e){super(e),this.injector=e,this.destroyed$=new d.Subject,this.initDependency()}get dataSourceName(){return(0,x.isEmpty)(this._dataSourceName)&&(this._dataSourceName=this.designerSchemaService.getPrimaryDataSourceName()),this._dataSourceName}get entitySchemaName(){return(0,x.isEmpty)(this._entitySchemaName)&&(this._entitySchemaName=this.designerSchemaService.getDataSourceConfigByName(this.dataSourceName)?.entitySchemaName),this._entitySchemaName}initDependency(){this.designerSchemaService=this.injector.get(g.DesignerSchemaService),this.viewCommandExecutor=this.injector.get(g.ViewItemCommandExecutor)}ngOnDestroy(){super.ngOnDestroy(),this.destroyed$.next(),this.destroyed$.complete()}filterSchemaChanges(e){return this.filterChanges(e?.changes?.viewConfig)}filterSchemaChangesOperator(){return(0,l.observeOn)(d.asyncScheduler)}handleInsertChanges(e){this.handleInsert(e.changes)}handleUpdateChanges(e){this.handleUpdate(e.changes)}}Sn.\u0275fac=function(e){return new(e||Sn)(n.\u0275\u0275inject(n.Injector))},Sn.\u0275prov=n.\u0275\u0275defineInjectable({token:Sn,factory:Sn.\u0275fac});class xa extends Sn{_setDefaultViewConfig(e){const a=`${this.designerSchemaService.getPrimaryDataSourceName()}.Id`,i=this.designerSchemaService.findAttributeByDataSourceAttributePath(a);e.recordId=`$${i||this.designerSchemaService.getOrAddViewModelAttribute("Id","#PrimaryDataSourceName()#")}`,e.defaultSenderRequest=u.DefaultSenderRequestType.DefaultMailbox,e.entitySchemaName=this.entitySchemaName}filterChanges(e){return e.type==="crt.EmailComposer"}handleInsert(e){this._setDefaultViewConfig(e.viewConfig)}handleUpdate(e){}}xa.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(xa)))(t||xa)}}(),xa.\u0275prov=n.\u0275\u0275defineInjectable({token:xa,factory:xa.\u0275fac});class Ia extends Sn{initDependency(){super.initDependency()}_setDefaultViewConfig(e){e.feedType=u.FeedSourceType.Record;const t=`${this.dataSourceName}.Id`,a=this.designerSchemaService.findAttributeByDataSourceAttributePath(t);e.primaryColumnValue=`$${a||this.designerSchemaService.getOrAddViewModelAttribute("Id","#PrimaryDataSourceName()#")}`,e.cardState="$CardState",e.entitySchemaName=this.entitySchemaName,e.dataSourceName=this.dataSourceName}filterChanges(e){return e.type==="crt.FeedComposer"}handleInsert(e){this._setDefaultViewConfig(e.viewConfig)}handleUpdate(e){}}Ia.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Ia)))(t||Ia)}}(),Ia.\u0275prov=n.\u0275\u0275defineInjectable({token:Ia,factory:Ia.\u0275fac});class Pa extends Sn{_setFeedViewConfig(e){const t=`${this.dataSourceName}.Id`,a=this.designerSchemaService.findAttributeByDataSourceAttributePath(t);e.primaryColumnValue=`$${a||this.designerSchemaService.getOrAddViewModelAttribute("Id","#PrimaryDataSourceName()#")}`,e.cardState="$CardState",e.feedType=u.FeedSourceType.Record,e.dataSourceName=this.dataSourceName,e.entitySchemaName=this.entitySchemaName}_setEmailViewConfig(e){const t=`${this.dataSourceName}.Id`,a=this.designerSchemaService.findAttributeByDataSourceAttributePath(t);e.recordId=`$${a||this.designerSchemaService.getOrAddViewModelAttribute("Id","#PrimaryDataSourceName()#")}`,e.defaultSenderRequest=u.DefaultSenderRequestType.DefaultMailbox,e.entitySchemaName=this.entitySchemaName}_setDefaultViewConfig(e){const t=e?.items?.find(i=>i.type==="crt.FeedComposer");t&&this._setFeedViewConfig(t);const a=e?.items?.find(i=>i.type==="crt.EmailComposer");a&&this._setEmailViewConfig(a)}filterChanges(e){return e.type==="crt.MessageComposerSelector"}handleInsert(e){this._setDefaultViewConfig(e.viewConfig)}handleUpdate(e){}}Pa.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Pa)))(t||Pa)}}(),Pa.\u0275prov=n.\u0275\u0275defineInjectable({token:Pa,factory:Pa.\u0275fac});class Ea extends Sn{_prepareButtonToggleGroup(e){const{parentName:t,index:a,viewConfig:i}=this.designerSchemaService.getViewConfigInfoByName(e);return{containerName:t,defaultViewConfig:{for:i.name,layoutConfig:i?.layoutConfig,fitContent:!0},propertyName:"items",designerTool:{defaultConfig:{type:"crt.ButtonToggleGroup"}},index:a}}initDependency(){super.initDependency(),this._designerContainerService=this.injector.get(z)}filterChanges(e){return e.type==="crt.TabPanel"}handleInsert(e){const t=e.viewConfig;if(t.mode==="toggle"){const i=this._prepareButtonToggleGroup(t.name);this.viewCommandExecutor.add(i).pipe((0,l.switchMap)(o=>o.execute()),(0,l.take)(1)).subscribe()}}handleUpdate(e){const t=e.viewConfig;t.mode==="tab"&&this._designerContainerService.showElement(t.name)}}Ea.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Ea)))(t||Ea)}}(),Ea.\u0275prov=n.\u0275\u0275defineInjectable({token:Ea,factory:Ea.\u0275fac});class Xn{constructor(e){this._initializer=e}}Xn.\u0275fac=function(e){return new(e||Xn)(n.\u0275\u0275inject(Zn))},Xn.\u0275mod=n.\u0275\u0275defineNgModule({type:Xn}),Xn.\u0275inj=n.\u0275\u0275defineInjector({providers:[Zn,{provide:Ya,useClass:Ea,multi:!0},{provide:Ya,useClass:Ia,multi:!0},{provide:Ya,useClass:Pa,multi:!0},{provide:Ya,useClass:xa,multi:!0}]});const pm="EnableDataGridColumnEdit";class ei{constructor(e){this._featureService=e}getFeatures(){return(0,d.forkJoin)([this._featureService.getFeatureState(pm)]).pipe((0,l.map)(([e])=>({rows:{toolbar:!1,numeration:!1,selection:{enable:!0,multiple:!1}},columns:{toolbar:!0,sorting:!0,resizing:!0,dragAndDrop:!0,editing:e,adding:!0},cells:{selection:!1},header:{visible:!0},editable:!1})))}}ei.\u0275fac=function(e){return new(e||ei)(n.\u0275\u0275inject(ae.FeatureService))},ei.\u0275prov=n.\u0275\u0275defineInjectable({token:ei,factory:ei.\u0275fac,providedIn:"root"});let Zo={};const gm={provide:u.DATA_GRID_FEATURES,useFactory:()=>Zo};class ti{constructor(e){this._dataGridFeaturesService=e}init(){return this._dataGridFeaturesService.getFeatures().pipe((0,d.tap)(e=>Zo=e),(0,d.mapTo)(void 0))}}ti.\u0275fac=function(e){return new(e||ti)(n.\u0275\u0275inject(ei))},ti.\u0275prov=n.\u0275\u0275defineInjectable({token:ti,factory:ti.\u0275fac,providedIn:"root"});var Xo=v(18369),um=v(99194);function hm(r){(0,d.lastValueFrom)(r.init())}class Yn{constructor(e){this._dataGridInitializer=e,hm(e)}}Yn.\u0275fac=function(e){return new(e||Yn)(n.\u0275\u0275inject(ti))},Yn.\u0275mod=n.\u0275\u0275defineNgModule({type:Yn}),Yn.\u0275inj=n.\u0275\u0275defineInjector({providers:[pi.DATA_GRID_CELL_VIEW_CONFIG_CREATOR_FACTORY_PROVIDER,{provide:u.DATA_GRID_STATE_HANDLER,useClass:Bt},{provide:u.DataGridColumnSelectionService,useClass:pi.StructureExplorerDataGridColumnSelectionService},{provide:u.DATA_GRID_COLUMN_EDIT_HANDLER,useClass:um.P},gm],imports:[Xo.StructureExplorerModule,P.DataSourceStructureExplorerModule]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(Yn,{imports:[Xo.StructureExplorerModule,P.DataSourceStructureExplorerModule]})}();class ni extends P.DataSourceStructureExplorerService{constructor(e,t,a,i){super(),this._dataSourceManager=e,this._dataSchemaRepository=t,this._entityBackwardReferenceService=a,this._featureValues=i}getDataSchemaAttributeByPath(e,t){return this._dataSchemaRepository.getSchemaAttribute(e,t)}getDataSchemaByName(e,t){return this._dataSchemaRepository.getSchema(e,t).pipe((0,l.take)(1))}getDataSources(){return this._dataSourceManager.getDataSources$(h.DataSourceScope.Page).pipe((0,l.take)(1))}getDataSourceByName(e){return this._dataSourceManager.getDataSourceByName$(e)}getDataSchemaBackReference(e){return this._featureValues.UseBackwardReferencesInStructureExplorer?this._entityBackwardReferenceService.getBackwardReferences(e):(0,d.of)([])}}ni.\u0275fac=function(e){return new(e||ni)(n.\u0275\u0275inject($),n.\u0275\u0275inject(Ut),n.\u0275\u0275inject(P.EntityBackwardReferenceService),n.\u0275\u0275inject(C.FEATURE_VALUES))},ni.\u0275prov=n.\u0275\u0275defineInjectable({token:ni,factory:ni.\u0275fac});class ea{}ea.\u0275fac=function(e){return new(e||ea)},ea.\u0275mod=n.\u0275\u0275defineNgModule({type:ea}),ea.\u0275inj=n.\u0275\u0275defineInjector({providers:[$,Ut,{provide:P.DataSourceStructureExplorerService,useClass:ni}],imports:[P.DataSourceStructureExplorerModule,P.DataSourceStructureExplorerModule]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(ea,{imports:[P.DataSourceStructureExplorerModule],exports:[P.DataSourceStructureExplorerModule]})}();class Ta extends mo{constructor(){super(...arguments),this._dataSourceService=(0,n.inject)(zt)}getAttributeData(e,t){return this._dataSourceService.getDataSources$().pipe((0,l.take)(1),(0,l.map)(a=>a.find(i=>i.dataSourceName===C.PAGE_PARAMETERS_DATA_SOURCE_NAME)),(0,l.map)(a=>a.getSchema()),(0,l.mergeMap)(a=>a.pipe((0,l.map)(i=>i.dataSourceConfig.config.parameters))),(0,l.map)(a=>a[t]),(0,l.map)(a=>a?{...(0,x.omit)(a,["dataValueType","isOwnParameter","required"]),type:a.dataValueType,isReadonly:!a?.isOwnParameter,requirementType:a.required?it.AttributeRequirementType.YES:it.AttributeRequirementType.NO,referenceSchema:a.referenceSchemaUId}:null))}}Ta.\u0275fac=function(){let r;return function(t){return(r||(r=n.\u0275\u0275getInheritedFactory(Ta)))(t||Ta)}}(),Ta.\u0275prov=n.\u0275\u0275defineInjectable({token:Ta,factory:Ta.\u0275fac,providedIn:"any"});function bm(r){try{JSON.parse(r.value)}catch{return{invalidJSON:!0}}return null}var eo;let Ii=eo=class extends I.AngularBaseValidator{constructor(e){super(e),this.injector=e,this.i18nMessageKey="Validators.GridColumnsCount.Message",this.async=!1,this._designerSchemaService=e.get(g.DesignerSchemaService)}static _getMaxFilledColumnsCount(e){let t=0;return e.forEach(a=>{const i=a.layoutConfig.column+a.layoutConfig.colSpan;i>t&&(t=i)}),t-1}validate(e,t){const a=this._designerSchemaService.getViewConfigInfoByName(t.gridName),i=a?.viewConfig?.items;if(!a||!i?.length)return null;const o=eo._getMaxFilledColumnsCount(i);return e?.value<o?{invalidColumnsCount:this.defaultValidationError(t)}:null}};Ii=eo=(0,p.__decorate)([(0,h.CrtValidator)({type:"crt.GridColumns"}),(0,p.__metadata)("design:paramtypes",[n.Injector])],Ii);const _m=JSON.parse('{"DataGroupColumnsSubGroups":{"NewColumn":"Add new field","ExistingColumns":"Data model attributes"},"ColumnAddedOnPage":"Column already added on the page","ColumnValidators":{"ErrorMessages":{"LookupReferenceSchemaNotSetError":"Data source is not set for lookup column"}},"NewColumnSubGroup":{"MEDIUM_TEXTColumn":"Text","IntegerColumn":"Number","BooleanColumn":"Checkbox","ColorColumn":"Color","DateTimeColumn":"Date/Time","LookupColumn":"Dropdown","RICH_TEXTColumn":"Rich text","AutonumberColumn":"Autonumber","IMAGELOOKUPColumn":"Image","PhoneColumn":"Phone","LongPhoneColumn":"Phone number","WebColumn":"Web link","EmailColumn":"Email","LongEmailColumn":"Email address"},"ModalPageDesigner":{"Operation":{"Copy":"Copy"},"Defaults":{"Caption":"New modal page","CaptionTemplate":"{{0}} new modal page","CaptionWithEntityTemplate":"{{0}} modal page"}},"DataGroupParametersSubGroups":{"NewParameter":"Add new parameter","ExistingParameters":"Existing parameters"},"NewParameterSubGroup":{"MEDIUM_TEXTParameter":"Text","IntegerParameter":"Number","BooleanParameter":"Checkbox","DateTimeParameter":"Date/Time","LookupParameter":"Dropdown","RICH_TEXTParameter":"Rich text","PhoneParameter":"Phone","LongPhoneParameter":"Phone number","WebParameter":"Web link","EmailParameter":"Email","LongEmailParameter":"Email address"},"CDK":{"ChartsGroupCaption":"Charts","DataGroupCaption":"Data","PageParametersDataGroupCaption":"Page parameters","ComponentsGroupCaption":"Components","LayoutElementsGroupCaption":"Layout elements","InputsGroupCaption":"Inputs","CustomElementsGroupCaption":"Custom components"},"SchemaOutlet":{"Caption":"Schema container","Hint":"The container displays a schema","SchemaNotFound":"<not found>"}}'),fm=JSON.parse('{"DataGroupColumnsSubGroups":{"NewColumn":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u043E\u0432\u043E\u0435 \u043F\u043E\u043B\u0435","ExistingColumns":"\u0421\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0435 \u043A\u043E\u043B\u043E\u043D\u043A\u0438"},"DataGroupParametersSubGroups":{"NewParameter":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u043E\u0432\u044B\u0439 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440","ExistingParameters":"\u0421\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0435 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B"},"NewParameterSubGroup":{"MEDIUM_TEXTParameter":"\u0421\u0442\u0440\u043E\u043A\u0430","IntegerParameter":"\u0427\u0438\u0441\u043B\u043E","BooleanParameter":"\u041B\u043E\u0433\u0438\u0447\u0435\u0441\u043A\u043E\u0435","DateTimeParameter":"\u0414\u0430\u0442\u0430/\u0412\u0440\u0435\u043C\u044F","LookupParameter":"\u0412\u044B\u043F\u0430\u0434\u0430\u044E\u0449\u0438\u0439 \u0441\u043F\u0438\u0441\u043E\u043A","RICH_TEXTParameter":"\u0424\u043E\u0440\u043C\u0430\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0439 \u0442\u0435\u043A\u0441\u0442","PhoneParameter":"\u0422\u0435\u043B\u0435\u0444\u043E\u043D","LongPhoneParameter":"\u0422\u0435\u043B\u0435\u0444\u043E\u043D\u043D\u044B\u0439 \u043D\u043E\u043C\u0435\u0440","WebParameter":"\u041F\u043E\u043B\u0435 Web","EmailParameter":"Email","LongEmailParameter":"Email-\u0430\u0434\u0440\u0435\u0441"},"ColumnAddedOnPage":"\u041A\u043E\u043B\u043E\u043D\u043A\u0430 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443","ColumnValidators":{"ErrorMessages":{"LookupReferenceSchemaNotSetError":"\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A \u0434\u0430\u043D\u043D\u044B\u0445 \u0434\u043B\u044F \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0430"}},"NewColumnSubGroup":{"MEDIUM_TEXTColumn":"\u0421\u0442\u0440\u043E\u043A\u0430","IntegerColumn":"\u0427\u0438\u0441\u043B\u043E","BooleanColumn":"\u041B\u043E\u0433\u0438\u0447\u0435\u0441\u043A\u043E\u0435","ColorColumn":"\u0426\u0432\u0435\u0442","DateTimeColumn":"\u0414\u0430\u0442\u0430/\u0412\u0440\u0435\u043C\u044F","LookupColumn":"\u0412\u044B\u043F\u0430\u0434\u0430\u044E\u0449\u0438\u0439 \u0441\u043F\u0438\u0441\u043E\u043A","RICH_TEXTColumn":"\u0424\u043E\u0440\u043C\u0430\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0439 \u0442\u0435\u043A\u0441\u0442","AutonumberColumn":"\u0410\u0432\u0442\u043E\u043D\u0443\u043C\u0435\u0440\u0430\u0446\u0438\u044F","IMAGELOOKUPColumn":"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435","PhoneColumn":"\u0422\u0435\u043B\u0435\u0444\u043E\u043D","WebColumn":"\u041F\u043E\u043B\u0435 Web","EmailColumn":"Email"},"CDK":{"ChartsGroupCaption":"\u0413\u0440\u0430\u0444\u0438\u043A\u0438","DataGroupCaption":"\u0414\u0430\u043D\u043D\u044B\u0435","PageParametersDataGroupCaption":"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B","ComponentsGroupCaption":"\u041A\u043E\u043C\u043F\u043E\u043D\u0435\u043D\u0442\u044B","LayoutElementsGroupCaption":"\u042D\u043B\u0435\u043C\u0435\u043D\u0442\u044B \u0440\u0430\u0437\u043C\u0435\u0442\u043A\u0438","CustomElementsGroupCaption":"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C\u0441\u043A\u0438\u0435 \u043A\u043E\u043C\u043F\u043E\u043D\u0435\u043D\u0442\u044B"},"SchemaOutlet":{"Caption":"\u041A\u043E\u043D\u0442\u0435\u0439\u043D\u0435\u0440 \u0441\u0445\u0435\u043C\u044B","Hint":"\u041A\u043E\u043D\u0442\u0435\u0439\u043D\u0435\u0440 \u0434\u043B\u044F \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u0441\u0445\u0435\u043C\u044B","SchemaNotFound":"<\u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E>"}}'),Cm=JSON.parse('{"DataGroupColumnsSubGroups":{"NewColumn":"\u0414\u043E\u0434\u0430\u0442\u0438 \u043D\u043E\u0432\u0435 \u043F\u043E\u043B\u0435","ExistingColumns":"\u0406\u0441\u043D\u0443\u044E\u0447\u0456 \u043A\u043E\u043B\u043E\u043D\u043A\u0438"},"ColumnValidators":{"ErrorMessages":{"LookupReferenceSchemaNotSetError":"\u041D\u0435 \u0432\u043A\u0430\u0437\u0430\u043D\u043E \u0434\u0436\u0435\u0440\u0435\u043B\u043E \u0434\u0430\u043D\u0438\u0445 \u0434\u043B\u044F \u0434\u043E\u0432\u0456\u0434\u043D\u0438\u043A\u0430"}},"NewColumnSubGroup":{"MEDIUM_TEXTColumn":"\u0420\u044F\u0434\u043E\u043A","IntegerColumn":"\u0427\u0438\u0441\u043B\u043E","BooleanColumn":"\u041B\u043E\u0433\u0456\u0447\u043D\u0435","ColorColumn":"\u041A\u043E\u043B\u0456\u0440","DateTimeColumn":"\u0414\u0430\u0442\u0430/\u0427\u0430\u0441","LookupColumn":"\u0412\u0438\u043F\u0430\u0434\u0430\u044E\u0447\u0438\u0439 \u0441\u043F\u0438\u0441\u043E\u043A","AutonumberColumn":"\u0410\u0432\u0442\u043E\u043D\u0443\u043C\u0435\u0440\u0430\u0446\u0456\u044F","IMAGELOOKUPColumn":"\u0417\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F","PhoneColumn":"\u0422\u0435\u043B\u0435\u0444\u043E\u043D","WebColumn":"\u041F\u043E\u043B\u0435 Web","EmailColumn":"Email"},"CDK":{"ChartsGroupCaption":"\u0413\u0440\u0430\u0444\u0456\u043A\u0438","DataGroupCaption":"\u0414\u0430\u043D\u0456","ComponentsGroupCaption":"\u041A\u043E\u043C\u043F\u043E\u043D\u0435\u043D\u0442\u0438","LayoutElementsGroupCaption":"\u0415\u043B\u0435\u043C\u0435\u043D\u0442\u0438 \u0440\u043E\u0437\u043C\u0456\u0442\u043A\u0438","CustomElementsGroupCaption":"\u041A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u043B\u044C\u043D\u0438\u0446\u044C\u043A\u0456 \u043A\u043E\u043C\u043F\u043E\u043D\u0435\u043D\u0442\u0438"}}'),ym={"en-US":_m,"ru-RU":fm,"ua-UA":Cm};let wn=class{constructor(e){this._dropListRefProxy=e}};wn.\u0275fac=function(e){return new(e||wn)(n.\u0275\u0275inject(kt))},wn.\u0275mod=n.\u0275\u0275defineNgModule({type:wn}),wn.\u0275inj=n.\u0275\u0275defineInjector({providers:[g.ConnectedDropListService,I.DataSourceFactoryService,Fn,Ma,g.DesignerSchemaService,g.DesignerCommandFactoryService,g.DesignerSyncService,B,be,at,V,kt,C.GenerateNameMacroProcessor,_.JsonApplierService,_.JsonPathApplierService,J,g.MetaItemDesignSettingChangesApplierService,Y,g.MetaItemDesignSettingsService,I.ModelGenerator,ba,S.ToolbarViewElementConfigResolver,I.ViewModelGenerator,An,$,Ut,R,_e,Ht,g.ViewItemCommandExecutor,oe,Dn,{provide:I.AbstractValidatorTypeResolver,useClass:I.DesignTimeValidatorTypeResolver},{provide:I.DataSourceTypeResolver,useClass:Za},{provide:I.ModelGenerator,useClass:ua},{provide:_.SchemaService,useExisting:g.DesignerSchemaService},{provide:_.ViewNodeManipulationService,useExisting:Fn},{provide:_.SchemaApiService,useExisting:Ma},G.WINDOW_PROVIDER,ce,ga,dt,I.BaseViewModelAttributeGenerator,_.RelatedViewElementsService,Qt,Pn,$t,st,{provide:C.IS_DESIGN_TIME,useValue:!0},{provide:g.PAGE_PARAMETERS_ATTRIBUTE_PROPERTIES_DATA_PROVIDER_TOKEN,useClass:Ta},C.MacrosHandlerService,Le,{provide:it.AddonSchemaService,useClass:B},g.DesignerLoaderService,{provide:g.USE_DESIGNER_LOADER_MASK,useValue:!0}],imports:[Kt,Jt,P.CdkModule,Xn,f.CommonModule,u.CrtComponentsModule,Oe,et,Re,Me,tt,Ae,Te,Ee,Fe,ea,Se,j,De,O.DragDropModule,P.ExpansionButtonModule,un,Gt,On,Q.FormsModule,Yn,Jn,P.LocalizableTextModule,w.MaskModule,Qe.MatLegacyButtonModule,N.MatLegacyDialogModule,se.MatLegacyFormFieldModule,E.MatIconModule,Yt.MatLegacyMenuModule,jo.MatLegacySelectModule,en.MatLegacyTooltipModule,I.ModelModule,Q.ReactiveFormsModule,re.ResizableModule,D.TranslateModule,S.ViewModule,Go.WorkspaceErrorsDialogModule,P.DataItemMarkerModule,_.LowCodeModule,G.CrtLibTranslateModule.forRoot({i18n:ym}),Ne,xe,Pe]}),wn=(0,p.__decorate)([(0,h.CrtModule)({includes:[Se,j,Oe,De,Ee,yt,ge,St,ft,Te,Re,I.ModelModule,fn,tt,Fe,yn,Ae,Me,It,Pt,et,bn,Vt,Ne,xe,Pe],validators:[Ii]}),(0,p.__metadata)("design:paramtypes",[kt])],wn),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(wn,{declarations:[an,Ga,Vn,$n,$a,Gn,jn,nn,ya,ja,va],imports:[Kt,Jt,P.CdkModule,Xn,f.CommonModule,u.CrtComponentsModule,Oe,et,Re,Me,tt,Ae,Te,Ee,Fe,ea,Se,j,De,O.DragDropModule,P.ExpansionButtonModule,un,Gt,On,Q.FormsModule,Yn,Jn,P.LocalizableTextModule,w.MaskModule,Qe.MatLegacyButtonModule,N.MatLegacyDialogModule,se.MatLegacyFormFieldModule,E.MatIconModule,Yt.MatLegacyMenuModule,jo.MatLegacySelectModule,en.MatLegacyTooltipModule,I.ModelModule,Q.ReactiveFormsModule,re.ResizableModule,D.TranslateModule,S.ViewModule,Go.WorkspaceErrorsDialogModule,P.DataItemMarkerModule,_.LowCodeModule,G.CrtLibTranslateModule,Ne,xe,Pe],exports:[an,$n,Vn,jn,nn]})}();class di extends W{constructor(){super(...arguments),this.translateService=(0,n.inject)(D.TranslateService),this.designerLoaderService=(0,n.inject)(g.DesignerLoaderService),this.lczToString=(0,n.inject)(C.LczToStringPipe),this.designerSchemaService=(0,n.inject)(g.DesignerSchemaService),this._attributeControlExtraConfigProvider=(0,n.inject)(g.AttributeControlExtraConfigProvider)}_getNewAttributesGroup(e){const t=e.dataSourceName,a=`${t}_NewItems`,i=this.translateService.instant(this.newAttributeGroupCaptionResourceName),o=this.createGroupDesignerTool(a,i,t),s=this.getNewAttributesDesignerTools(e,o.name);return[o,...s]}_getExistAttributesGroup(e){const t=e.dataSourceName,a=`${t}_ExistingItems`,i=this.translateService.instant(this.existingAttributesGroupCaptionResourceName),o=this.createGroupDesignerTool(a,i,t),s=this.getExistingAttributesDesignerTools(e,o.name);return o.attributes=s,[o,...s]}_getDataSourceDesignerToolItem(e){const t=this.getDataSourceDesignerToolItemCaption(e);return this.createGroupDesignerTool(e.dataSourceName,t)}_toolExistOnPage(e,t){return this.designerSchemaService.findAllAttributesByDataSourceAttributePath(`${e}.${t}`).some(i=>this.designerSchemaService.getViewConfigsByViewModelAttribute(i)?.length>0)}getInfoIcons(e,t){const a=[];return this._toolExistOnPage(e,t)&&a.push({icon:"checkmark-icon",tooltip:this.translateService.instant("ColumnAddedOnPage"),classes:["icon-info"]}),a}getControlConfigByDataValueType(e){return this.designerDataSourceService.attributeConfigProvider.getConfigByType(e)}getDefaultDesignerToolItem(e,t,a,i){return{name:e,iconName:null,caption:t,addCommandTypeName:i||"crt.AddDataSourceItemCommand",defaultConfig:{defaultPropertyValues:{},defaultLocalizableStrings:{}},canDrop:!0,groupType:h.DesignerToolGroupType.Data,parentName:a}}getDesignerToolItems(e){if(!e)return[];const t=this._getDataSourceDesignerToolItem(e),a=this._getNewAttributesGroup(e),i=this._getExistAttributesGroup(e);return[t,...a,...i]}createGroupDesignerTool(e,t,a){const i=this.getDefaultDesignerToolItem(e,t,a);return i.defaultConfig.defaultPropertyValues={},i.canDrop=!1,i.editable=!0,i.expanded=!0,i}getLocalizableValue(e){return this.lczToString.transform(e)??""}getPropertiesPanelComponentTypeName(e){return this.getControlConfigByDataValueType(e).propertiesPanelComponentTypeName}fillDefaultDesignerToolConfig(e,t,a,i){const o=e.defaultConfig;o.type=t;const s=this._attributeControlExtraConfigProvider.getControlExtraConfig(t,a,i);o.defaultPropertyValues={...o.defaultPropertyValues,...s}}getAttributeName(e){return e}getNewAttributesDesignerTools(e,t){return[this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("Text"),type:g.ControlTypes.Input,dataValueType:h.DataValueType.MEDIUM_TEXT}),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("Integer"),type:g.ControlTypes.NumberInput,dataValueType:h.DataValueType.Integer}),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("Boolean"),type:g.ControlTypes.Checkbox,dataValueType:h.DataValueType.Boolean}),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("DateTime"),type:g.ControlTypes.DateTime,dataValueType:h.DataValueType.DateTime}),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("RichText"),type:g.ControlTypes.RichInput,dataValueType:h.DataValueType.RICH_TEXT}),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("Phone"),captionKey:this.getAttributeName("Phone"),captionDataValKey:this.getAttributeName("LongPhone"),type:g.ControlTypes.PhoneInput,dataValueType:h.DataValueType.PHONE_TEXT}),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("Email"),captionKey:this.getAttributeName("Email"),captionDataValKey:this.getAttributeName("LongEmail"),type:g.ControlTypes.EmailInput,dataValueType:h.DataValueType.EMAIL_TEXT}),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("Web"),captionKey:this.getAttributeName("Web"),type:g.ControlTypes.WebInput,dataValueType:h.DataValueType.WEB_TEXT})]}schemaChanges$(){const e=_.MetaItemDesignSettingChangesOperation;return(0,d.merge)(this.designerSchemaService.schemaLoaded$,this.designerSchemaService.schemaChanged$.pipe((0,d.filter)(t=>[e.Insert,e.Update,e.Remove,e.CreateDataSource].includes(t.changes?.operation)))).pipe((0,d.debounceTime)(100))}clearCache(){this.designerDataSourceService.clearCache()}}di.defaultAddCommandType="crt.AddDataSourceItemCommand";let to=class extends di{constructor(){super(...arguments),this.designerDataSourceService=(0,n.inject)(le),this.designItemsIconsProvider=(0,n.inject)(g.EntityDataSourceDesignItemsIconsProvider),this.newAttributeGroupCaptionResourceName="DataGroupColumnsSubGroups.NewColumn",this.existingAttributesGroupCaptionResourceName="DataGroupColumnsSubGroups.ExistingColumns",this._designerEntityService=(0,n.inject)(B),this._allowedDataValueTypes=[h.DataValueType.SHORT_TEXT,h.DataValueType.MEDIUM_TEXT,h.DataValueType.LONG_TEXT,h.DataValueType.PHONE_TEXT,h.DataValueType.WEB_TEXT,h.DataValueType.SECURE_TEXT,h.DataValueType.EMAIL_TEXT,h.DataValueType.MAXSIZE_TEXT,h.DataValueType.Text,h.DataValueType.RICH_TEXT,h.DataValueType.Integer,h.DataValueType.Float,h.DataValueType.Money,h.DataValueType.DateTime,h.DataValueType.Date,h.DataValueType.Time,h.DataValueType.Lookup,h.DataValueType.Enum,h.DataValueType.Boolean,h.DataValueType.Color,h.DataValueType.FLOAT1,h.DataValueType.FLOAT2,h.DataValueType.FLOAT3,h.DataValueType.FLOAT4,h.DataValueType.FLOAT8,h.DataValueType.IMAGELOOKUP],this.type="crt.DataSource"}_getErrorMessageForColumn(e){return e.type===h.DataValueType.Lookup&&!e.referenceSchema?this.translateService.instant("ColumnValidators.ErrorMessages.LookupReferenceSchemaNotSetError"):""}_columnCanBeDisplayed(e){return e.usageType!==C.EntitySchemaColumnUsageType.None&&this._allowedDataValueTypes.includes(e.type)}_getItemInfoIcons(e,t){let a=this.getInfoIcons(e,t.name);const i=this._getErrorMessageForColumn(t);return i&&(a=[{icon:"info-icon",tooltip:i,classes:["icon-warning"]},...a]),a}_getDataSourceAttributeDesignerToolItem(e,t,a){const i=e.name,o=this.getControlConfigByDataValueType(e.type),s=di.defaultAddCommandType,c=this.getDefaultDesignerToolItem(i,this.getLocalizableValue(e.caption),a,s);return this.fillDefaultDesignerToolConfig(c,o.controlType,e.type,e.isMultiLineText),{...c,iconName:this.designItemsIconsProvider.getColumnIconName(e),dataValueType:e.type,dataSourceConfig:{dataSourceName:t,dataSourceAttributeName:i,dataSourceType:C.DataSourceType.EntityDataSource,viewModelAttributeName:o.viewModelAttributeName},infoIcons:this._getItemInfoIcons(t,e),required:e.requirementType===ie.EntitySchemaColumnRequirementType.YES}}_getEntityDataSourceInfo(e,t,a){return{dataSourceName:a,entitySchemaName:t.name,config:t.dataSourceConfig,entitySchema:e,scope:h.DataSourceScope.Page}}_createErrorGroupItem(e,t){const a="InterfaceDesigner.NotFoundDataSourceObject",i=this.translateService.instant(`${a}.GroupObjectCaption`),o=this.createGroupDesignerTool(e,i),s=this.translateService.instant(`${a}.ErrorMessage`),c=Ai.String.format(s,e,t);return o.errorMessage=c,o}getAttributeName(e){return e+"Column"}createNewAttributeDesignerTool(e){const t=e.addCommand??"crt.AddNewDataSourceItemCommand",a=e.captionKey??`${h.DataValueType[e.dataValueType]}Column`,i=e.captionDataValKey,o=this.translateService.instant(`NewColumnSubGroup.${a}`),s=this.getDefaultDesignerToolItem(e.name,o,e.parentName),c=this.getControlConfigByDataValueType(e.dataValueType);this.fillDefaultDesignerToolConfig(s,c.controlType);const m=this.designItemsIconsProvider.getColumnControlIconName(e.dataValueType,e.isAutonumber);return{...s,iconName:m,addCommandTypeName:t,dataValueType:e.dataValueType,dataSourceConfig:{dataSourceType:C.DataSourceType.EntityDataSource,dataSourceName:e.dataSourceInfo.dataSourceName,schemaName:e.dataSourceInfo.entitySchemaName,dataValueType:e.dataValueType,viewModelAttributeName:c.viewModelAttributeName,captionKey:i??e.captionKey},isAutonumber:e.isAutonumber,required:!1}}getNewAttributesDesignerTools(e,t){return[...super.getNewAttributesDesignerTools(e,t),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("Lookup"),type:g.ControlTypes.Combobox,dataValueType:h.DataValueType.Lookup}),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("Color"),type:g.ControlTypes.Color,dataValueType:h.DataValueType.Color}),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:this.getAttributeName("Autonumber"),captionKey:this.getAttributeName("Autonumber"),type:g.ControlTypes.Input,dataValueType:h.DataValueType.SHORT_TEXT,isAutonumber:!0}),this.createNewAttributeDesignerTool({dataSourceInfo:e,parentName:t,name:"ImageColumn",type:g.ControlTypes.ImageLink,dataValueType:h.DataValueType.IMAGELOOKUP})]}getExistingAttributesDesignerTools(e,t){const a=e.entitySchema,i=e.dataSourceName;return[...a.columns,...a.inheritedColumns].filter(o=>this._columnCanBeDisplayed(o)).map(o=>({...this._getDataSourceAttributeDesignerToolItem(o,i,t),dragPreviewIcon:this.designItemsIconsProvider.getColumnControlIconName(o),propertiesPanelComponentTypeName:this.getPropertiesPanelComponentTypeName(o.type),errorMessage:this._getErrorMessageForColumn(o)})).sort((o,s)=>o.caption.localeCompare(s.caption))}getDataSourceDesignerToolItemCaption(e){return this.getLocalizableValue(e.entitySchema.caption)}createGroupDesignerTool(e,t,a){const i=super.createGroupDesignerTool(e,t,a);return i.propertiesPanelComponentTypeName="crt.EntityDataSourcePropertiesPanel",i}getItems$(){return this.schemaChanges$().pipe((0,d.switchMap)(()=>this.designerDataSourceService.getDataSources$(h.DataSourceScope.Page).pipe((0,d.mergeMap)(e=>{if((0,x.isEmpty)(e)||e.length===0)return(0,d.of)([]);const t=e.map(a=>a.getSchema().pipe((0,d.mergeMap)(i=>this._designerEntityService.getByName(i.name).pipe((0,d.take)(1),(0,d.map)(o=>({entitySchema:o,dataSchema:i})))),(0,d.map)(({entitySchema:i,dataSchema:o})=>this._getEntityDataSourceInfo(i,o,a.dataSourceName))));return(0,d.combineLatest)(t)}),(0,d.map)(e=>e.map(t=>t.entitySchema?.isDeleted?[this._createErrorGroupItem(t.entitySchemaName,t.dataSourceName)]:this.getDesignerToolItems(t)).flat()),(0,d.tap)(()=>{this.designerLoaderService.completeLoadingPart(g.LoadingPart.DataSourceLoaded)}))))}};to=(0,p.__decorate)([Pi()],to);let no=class extends di{constructor(){super(...arguments),this.designerDataSourceService=(0,n.inject)(zt),this.designItemsIconsProvider=(0,n.inject)(g.PageParametersDataSourceDesignItemsIconsProvider),this.newAttributeGroupCaptionResourceName="DataGroupParametersSubGroups.NewParameter",this.existingAttributesGroupCaptionResourceName="DataGroupParametersSubGroups.ExistingParameters"}_getDataSourceInfo(e,t){return{dataSourceName:e,config:t.dataSourceConfig,scope:h.DataSourceScope.Page}}createNewAttributeDesignerTool(e){const t=e.captionKey??`${h.DataValueType[e.dataValueType]}Parameter`,a=e.captionDataValKey,i=this.translateService.instant(`NewParameterSubGroup.${t}`),o=this.getDefaultDesignerToolItem(e.name,i,e.parentName),s=this.getControlConfigByDataValueType(e.dataValueType);this.fillDefaultDesignerToolConfig(o,s.controlType);const c=this.designItemsIconsProvider.getControlIconNameByDataValueType(e.dataValueType);return{...o,addCommandTypeName:"crt.AddNewDataSourceItemCommand",iconName:c,dataValueType:e.dataValueType,parentName:e.parentName,canDrop:!0,dataSourceConfig:{dataSourceType:C.DataSourceType.PageParametersDataSource,dataSourceName:"PageParameters",dataValueType:e.dataValueType,viewModelAttributeName:s.viewModelAttributeName,captionKey:a??e.captionKey}}}_getDataSourceAttributeDesignerToolItem(e,t){const a=e.name,i=this.getControlConfigByDataValueType(e.dataValueType),o=di.defaultAddCommandType,s=this.getDefaultDesignerToolItem(a,this.getLocalizableValue(e.caption),t,o);this.fillDefaultDesignerToolConfig(s,i.controlType);const c="PageParameters";return{...s,dataValueType:e.dataValueType,iconName:this.designItemsIconsProvider.getParameterIconName(e.dataValueType),removeCommandTypeName:"crt.RemoveDataSourceItemCommand",dataSourceConfig:{dataSourceName:c,dataSourceAttributeName:a,dataSourceType:C.DataSourceType.PageParametersDataSource,viewModelAttributeName:i.viewModelAttributeName},propertiesPanelDataProviderToken:i.propertiesPanelDataProviderToken,canRemove:e.isOwnParameter,infoIcons:this.getInfoIcons(c,a),required:e.required}}getAttributeName(e){return e+"Parameter"}getNewAttributesDesignerTools(e,t){return[...super.getNewAttributesDesignerTools(e,t),this.createNewAttributeDesignerTool({parentName:t,name:this.getAttributeName("Lookup"),type:g.ControlTypes.Combobox,dataValueType:h.DataValueType.Lookup,addCommand:"crt.AddNewLookupParameterCommand"})]}getDataSourceDesignerToolItemCaption(e){return this.translateService.instant("CDK.PageParametersDataGroupCaption")}getExistingAttributesDesignerTools(e,t){return Object.values(e.config.config.parameters).map(a=>({...this._getDataSourceAttributeDesignerToolItem(a,t),dragPreviewIcon:this.designItemsIconsProvider.getParameterIconName(a.dataValueType),propertiesPanelComponentTypeName:this.getPropertiesPanelComponentTypeName(a.dataValueType)})).sort((a,i)=>a.caption.localeCompare(i.caption))}createGroupDesignerTool(e,t,a){const i=super.createGroupDesignerTool(e,t,a);return a||(i.expanded=!1,i.editable=!1),i}getItems$(){return this.schemaChanges$().pipe((0,d.switchMap)(()=>this.designerDataSourceService.getDataSources$(h.DataSourceScope.Page).pipe((0,d.tap)(()=>{this.designerLoaderService.completeLoadingPart(g.LoadingPart.DataSourceLoaded)}),(0,d.mergeMap)(e=>{if(e.length===0)return(0,d.of)([]);const t=e.map(a=>a.getSchema().pipe((0,d.map)(i=>this._getDataSourceInfo(a.dataSourceName,i))));return(0,d.combineLatest)(t)}),(0,d.map)(e=>e.map(t=>this.getDesignerToolItems(t)).flat()))))}};no=(0,p.__decorate)([Pi()],no)},99194:(A,ta,v)=>{v.d(ta,{P:()=>S});var F=v(8239),N=v(94450),h=v(75378),n=v(77207),U=v(59929),g=v(34038),d=v(14537),l=v(49475),J=v(52045),Y=v(97600),D=v(21322),ee=v(27049),ke=v(98888);class S{constructor(k,V,R,W,_){this.schemaService=k,this._columnEditService=V,this._entitySchemaService=R,this._entitySchemaProvider=W,this._translateService=_}mapResourcesToLocalizableModel(k){const V=new l.LocalizableStringArray;return Object.keys(k).forEach(R=>{V.setValueLocalizableString(R,k[R])}),V}_replaceColumn(k,V,R){if(!k)return R;const W=(0,Y.findIndex)(R,_=>_.id===V);return R[W]={...k,changed:!0},R}processColumns(k,V,R,W){var _=this;return(0,F.Z)(function*(){const I=_.getDataSourceName({viewElementConfig:k,viewModel:V}),te=_.schemaService.getDataSourceConfigByName(I),G=_.schemaService.resources.strings;return R.forEach(ie=>{const C=ie.code.split("_").pop()||"",Aa=te?.attributes&&te?.attributes[C];ie.aggregationConfig=Aa?.aggregationConfig||ie.aggregationConfig;let ae=G[(0,l.removeSpecialSymbols)(ie.code)];if(!ae){const it=ie.id.split("-")[0],B=`${W.name}_${it}`;ae=G[B]}ae&&(ie.captionResources=_.mapResourcesToLocalizableModel(ae))}),{dataSourceSchemaName:te?.entitySchemaName,columns:R}})()}_processColumnOriginalCaption(k,V){const R=V.path;let W=k;return V.path?.startsWith("[")&&(W=V.referenceSchemaName),!R||!W||!V.aggregationConfig?(0,D.of)(V):this._entitySchemaProvider.getSchemaByName(W).pipe((0,ee.switchMap)(_=>this._entitySchemaService.getEntitySchemaColumnsInformationByPath(_.uId,R," > ")),(0,ee.map)(_=>{let I=_.columnCaptionPath;const te=V.aggregationConfig?.aggregationFunction;return te&&(I=this._getAggregationColumnOriginalCaption(I,V.dataValueType,te)),V.originalCaption=I,V}))}_getAggregationColumnOriginalCaption(k,V,R){const W=(0,U.getAllowedAggregationFunctionsByDataValueType)(V);W.push({func:h.AggregationFunction.Count,captionResource:"Count"});const _=W.find(te=>te.func===R)?.captionResource||"",I=this._getAggregationFunctionCaption(_);return R===h.AggregationFunction.TopOne?this._translateService.currentLang===l.DEFAULT_CULTURE_NAME?`${k} (the ${I.toLowerCase()})`:`${k} (${I.toLowerCase()})`:R===h.AggregationFunction.Count?`${k.split(" > ").slice(0,-1).join(" > ")} ${I}`:`${k} ${I}`}_getAggregationFunctionCaption(k){return this._translateService.instant("AggregationNames."+k)}getDataSourceName(k){const{viewElementConfig:V,viewModel:R}=k,W=(0,ke.TN)(V);return R.getBoundDataSourceNameByAttributePath(W)}onColumnPreparationFinished(){}handle(k,V,R){const W=R.get(d.VIEW_ELEMENT_CONFIG),_=this.schemaService.getViewConfigInfoByName(W.name).viewConfig;return R.get(d.BINDING_CONTEXT).viewModel$.pipe((0,ee.take)(1)).pipe((0,ee.mergeMap)(G=>this.processColumns(_,G,V,W)),(0,ee.mergeMap)(G=>{const ie=(0,Y.cloneDeep)(G.columns.find(C=>C.id===k));return this._processColumnOriginalCaption(G.dataSourceSchemaName,ie).pipe((0,D.tap)(()=>this.onColumnPreparationFinished()),(0,ee.mergeMap)(C=>this._columnEditService.edit(C,R).pipe((0,ee.map)(Aa=>this._replaceColumn(Aa,k,G.columns)))))}))}}S.\u0275fac=function(k){return new(k||S)(N.\u0275\u0275inject(J.SchemaService),N.\u0275\u0275inject(g.DataGridColumnEditService),N.\u0275\u0275inject(l.EntitySchemaService),N.\u0275\u0275inject(l.EntitySchemaProvider),N.\u0275\u0275inject(n.TranslateService))},S.\u0275prov=N.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac})},98888:(A,ta,v)=>{v.d(ta,{w6:()=>n,q3:()=>U,r2:()=>g,TN:()=>F});function F(d){const{items:l}=d||{};if(typeof l!="string"){console.log(`The type '${typeof l}' of 'items' attribute binding value is not supporting.`);return}if(l.startsWith("$")===!1){console.log(`The attribute value '${l}' of the 'items' is not supporting. The attribute value should be bindable (starts with a "$" character)`);return}return l.substring(1)}var N=v(14537),h=v(49475);const n=["crt.DataGrid","crt.FileList","crt.ApprovalList"];function U(d,l){const{viewConfig:J}=d;return l=l&&l.length>0?l:void 0,h.MetadataSchemaUtils.getViewConfigInfoByPropertyForValues("type",l||n,J).filter(Y=>Boolean(Y)).map(({viewConfig:Y})=>Y).filter(({name:Y})=>Y)||[]}function g(d,l){const{viewModelConfig:J}=d;return U(d,l).filter(({items:Y})=>(0,N.isBindToViewModelAttribute)(Y,J.attributes))}},66259:A=>{A.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
  <line y2="13" transform="translate(8 1.5)" fill="none" stroke="currentColor" stroke-width="2"/>
  <line y2="13" transform="translate(14.5 8) rotate(90)" fill="none" stroke="currentColor" stroke-width="2"/>
  <rect width="16" height="16" fill="none"/>
</svg>
`},96074:A=>{A.exports=`<svg width="72" height="40" viewBox="0 0 72 40" fill="none" xmlns="http://www.w3.org/2000/svg">
	<rect x="8.5" y="8.5" width="55" height="23" rx="0.5" fill="white" stroke="#0D2E4E"/>
	<path d="M37 17H19C17.3431 17 16 18.3431 16 20C16 21.6569 17.3431 23 19 23H37C38.6569 23 40 21.6569 40 20C40 18.3431 38.6569 17 37 17Z" fill="#D1D1D1"/>
	<path d="M45 14.49845H45.7838V17.00128H47.4838V13.00049H45V14.49845Z" fill="#FF4013"/>
	<path fill-rule="evenodd" clip-rule="evenodd" d="M59 14.00089H50.087V16.00089H59V14.00089ZM59 19.0005H50.087V21.0005H59V21.0005ZM45 25.7274V26.9998H48.1904V22.9998H45V24.1761H46.5V24.5073H45.75V25.3962H46.5V25.7274H45ZM59 23.9998H50.087V25.9998H59V23.9998Z" fill="#FF4013"/>
	<path d="M45 20.5638V21.9997L48.159 21.9998V20.5638L47.2617 20.5638L48.159 19.8663L48.159 18.0013L45 18.0013L45 19.4333H46.5L45 20.5638Z" fill="#FF4013"/>
</svg>
`},40153:A=>{A.exports=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M21.886 12H15.5C15.5 10.067 13.933 8.5 12 8.5C10.067 8.5 8.5 10.067 8.5 12C8.5 13.933 10.067 15.5 12 15.5V21.896H9.79498V18.953C9.15496 18.8336 8.55404 18.5589 8.04498 18.153L5.97699 20.301L3.51099 17.835L5.659 15.767C5.47489 15.4724 5.30791 15.0928 5.16586 14.7698C5.00082 14.3947 4.86945 14.096 4.784 14.096H2V9.79602H4.77899C4.90496 9.16684 5.20862 8.58693 5.65399 8.125L3.50598 5.97699L5.89203 3.51099L8.03998 5.659C8.54281 5.22835 9.14376 4.92787 9.78998 4.784V2H14.09V4.78003C14.09 4.91503 14.4202 5.04907 14.8223 5.21226L14.8223 5.21226C15.132 5.33797 15.4842 5.48097 15.761 5.65503L17.75 3.50702L20.216 5.97302L18.068 8.12097C18.4986 8.6238 18.7991 9.22476 18.943 9.87097H21.886V12Z" fill="#0D2E4E"/>
<rect x="14" y="14" width="8" height="2" fill="#0D2E4E"/>
<rect x="14" y="18" width="8" height="2" fill="#0D2E4E"/>
</svg>
`},1342:A=>{A.exports=`<svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.533 11.3618C14.6608 12.2665 13.4582 13.324 12.9317 13.9275C12.5558 14.3798 12.1041 14.8321 8.87494 13.0228C7.70062 12.3935 6.63518 11.5782 5.71967 10.6083C4.74935 9.6741 3.91405 8.60834 3.23788 7.44197C1.50789 4.19695 1.95946 3.66863 2.41022 3.37099C3.01152 2.84267 4.06453 1.71089 4.96694 2.76753C6.47066 4.57686 6.62119 5.40919 6.09471 5.86152C5.71878 6.08769 5.79362 6.16368 5.56824 6.31385C4.96694 6.91726 5.11747 7.8988 6.54546 9.33269L6.77084 9.63483C7.8238 10.6915 9.17699 11.2198 9.7792 10.6915C9.97273 10.4797 10.1488 10.2525 10.3057 10.0121C10.8321 9.48375 11.3587 9.63483 13.5394 11.3691" fill="#22AC14"/>
</svg>
`},80159:A=>{A.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
	<g fill="#DFE8EE" stroke="#B5D0EB" stroke-miterlimit="10" stroke-width="1">
		<rect x="1" y="1" width="14" height="14" rx="2"/>
	</g>
</svg>
`},92595:A=>{A.exports=`<svg id="Component_862_1" data-name="Component 862 \u2013 1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
  <g id="Rectangle_6510" data-name="Rectangle 6510" transform="translate(2 4)" fill="none" stroke="#0d2e4e" stroke-miterlimit="10" stroke-width="2">
    <rect width="9" height="11" stroke="none"/>
    <rect x="1" y="1" width="7" height="9" fill="none"/>
  </g>
  <g id="Group_7507" data-name="Group 7507" transform="translate(422.367 -404.801)">
    <path id="Path_6950" data-name="Path 6950" d="M-418.367,406.8h9v11" fill="none" stroke="#0d2e4e" stroke-miterlimit="10" stroke-width="2"/>
  </g>
  <rect id="Rectangle_1928" data-name="Rectangle 1928" width="16" height="16" fill="none"/>
</svg>
`},73972:A=>{A.exports=`<svg id="icon_delete_16" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
  <g id="Group_2209" data-name="Group 2209" transform="translate(2 1)">
    <path id="Path_1876" data-name="Path 1876" d="M1026-153h-3v-2h-5v2h-3v1h1v8.9l1.41,1.1h6.15l1.45-1.1V-152h1Zm-7-1h3v1h-3Z" transform="translate(-1015 155)" fill="#0d2e4e"/>
    <rect id="Rectangle_1349" data-name="Rectangle 1349" width="1" height="7" transform="translate(3 4)" fill="#fff"/>
    <rect id="Rectangle_1350" data-name="Rectangle 1350" width="1" height="7" transform="translate(7 4)" fill="#fff"/>
    <rect id="Rectangle_1351" data-name="Rectangle 1351" width="1" height="7" transform="translate(5 4)" fill="#fff"/>
  </g>
  <rect id="Rectangle_1352" data-name="Rectangle 1352" width="16" height="16" fill="none"/>
</svg>
`},51119:A=>{A.exports=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="114" height="114" viewBox="0 0 114 114">
	<defs>
		<style>.tile-pane-gauge-a,.tile-pane-gauge-c,.tile-pane-gauge-d,.tile-pane-gauge-f{fill:#fff;}.tile-pane-gauge-b{fill:url(#a);}.tile-pane-gauge-c,.tile-pane-gauge-d{font-size:12px;}.tile-pane-gauge-c{font-family:OpenSans, Open Sans;}.tile-pane-gauge-d{font-family:Montserrat-SemiBold, Montserrat;font-weight:600;letter-spacing:0.081em;}.tile-pane-gauge-e{clip-path:url(#b);}.tile-pane-gauge-g,.tile-pane-gauge-h{stroke:none;}.tile-pane-gauge-h{fill:#fff;}.tile-pane-gauge-i{filter:url(#c);}</style>
		<linearGradient id="a" x1="-0.076" y1="-0.059" x2="1.044" y2="1.049" gradientUnits="objectBoundingBox">
			<stop offset="0" stop-color="#0091ea" />
			<stop offset="1" stop-color="#0082cf" />
		</linearGradient>
		<clipPath id="b">
			<path class="tile-pane-gauge-a" d="M64.576,53.525h0A53.839,53.839,0,0,1,59.747,49.5a28.753,28.753,0,1,0-49.454.225,58.762,58.762,0,0,1-5.129,3.526A34.944,34.944,0,0,1,34.955,0,34.948,34.948,0,0,1,64.576,53.523Z" transform="translate(0)" />
		</clipPath>
		<filter id="c" x="46.529" y="61.027" width="47.385" height="38.128" filterUnits="userSpaceOnUse">
			<feOffset dy="3" input="SourceAlpha" />
			<feGaussianBlur stdDeviation="3" result="d" />
			<feFlood flood-color="#0058ef" />
			<feComposite operator="in" in2="d" />
			<feComposite in="SourceGraphic" />
		</filter>
	</defs>
	<rect class="tile-pane-gauge-b" width="114" height="114" rx="9" />
	<text class="tile-pane-gauge-c" transform="translate(27 21)">
		<tspan x="-19.406" y="0">Gauge</tspan>
	</text>
	<text class="tile-pane-gauge-d" transform="translate(58 92)">
		<tspan x="-8.712" y="0">XX</tspan>
	</text>
	<g transform="translate(-202.318 -1992.827)">
		<g class="tile-pane-gauge-e" transform="translate(225.746 2029.327)">
			<path class="tile-pane-gauge-a" d="M64.576,53.525h0A53.839,53.839,0,0,1,59.747,49.5a28.753,28.753,0,1,0-49.454.225,58.762,58.762,0,0,1-5.129,3.526A34.944,34.944,0,0,1,34.955,0,34.948,34.948,0,0,1,64.576,53.523Z" transform="translate(0)" />
			<g class="tile-pane-gauge-f" transform="translate(6.864 -16.321)">
				<path class="tile-pane-gauge-g" d="M 28.38788795471191 50.10850143432617 L -21.39307022094727 13.17486953735352 L -0.3786251544952393 -4.693844795227051 L 75.64794921875 12.75589275360107 L 28.38788795471191 50.10850143432617 Z" />
				<path class="tile-pane-gauge-h" d="M -0.2458915710449219 -4.150375366210938 L -20.58985137939453 13.1482048034668 L 28.37826919555664 49.47877883911133 L 74.52006530761719 13.01001358032227 L -0.2458915710449219 -4.150375366210938 M -0.5113449096679688 -5.237300872802734 L 76.77584075927734 12.50176620483398 L 28.39749526977539 50.73821640014648 L -22.1962890625 13.20152282714844 L -0.5113449096679688 -5.237300872802734 Z" />
			</g>
			<g class="tile-pane-gauge-f" transform="translate(-1.504 24.67)">
				<path class="tile-pane-gauge-g" d="M -13.75909423828125 45.78868865966797 L 3.635605335235596 -14.5278263092041 L 6.7893967628479 -13.24628829956055 L 36.39451217651367 9.271733283996582 L -13.75909423828125 45.78868865966797 Z" />
				<path class="tile-pane-gauge-h" d="M 3.962080001831055 -13.85546493530273 L -12.8746337890625 44.52622222900391 L 35.55708312988281 9.262975692749023 L 6.539575576782227 -12.80810546875 L 3.962080001831055 -13.85546493530273 M 3.309133529663086 -15.2001953125 L 7.039183616638184 -13.68449401855469 L 37.23194122314453 9.280494689941406 L -14.64355850219727 47.05116653442383 L 3.309133529663086 -15.2001953125 Z" />
			</g>
		</g>
		<g class="tile-pane-gauge-i" transform="matrix(1, 0, 0, 1, 202.32, 1992.83)">
			<path class="tile-pane-gauge-a" d="M0,2.256A2.254,2.254,0,0,1,4.251,1.208l27.319.836L4.27,3.267A2.254,2.254,0,0,1,0,2.256Z" transform="translate(57.85 67.03) rotate(31)" />
		</g>
	</g>
</svg>
`},63691:A=>{A.exports=`<svg id="Component_842_1" data-name="Component 842 \u2013 1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
  <path id="Path_10149" data-name="Path 10149" d="M13.22,6.693a8.074,8.074,0,0,0-.653-1.587c1.027-.84,1.4-1.493.187-2.52-.747-.747-1.493.28-1.96.747a8.274,8.274,0,0,0-1.587-.747C9.393,1.653,9.113,1,7.9,1s-1.493.653-1.4,1.587a12.15,12.15,0,0,0-1.587.747c-.467-.467-1.12-1.493-1.867-.84-1.213,1.027-.84,1.773.187,2.613A8.074,8.074,0,0,0,2.58,6.693C1.647,6.507.9,6.787.9,8c0,1.307.653,1.493,1.587,1.307a4.952,4.952,0,0,0,.747,1.587c-.467.467-1.4,1.213-.747,1.96,1.027,1.213,1.68.84,2.52-.187a8.074,8.074,0,0,0,1.587.653C6.407,14.253,6.687,15,7.9,15s1.493-.747,1.307-1.68a8.074,8.074,0,0,0,1.587-.653c.84,1.027,1.493,1.4,2.52.187.653-.747-.28-1.493-.747-1.96a8.274,8.274,0,0,0,.747-1.587C14.247,9.493,14.9,9.213,14.9,8S14.153,6.507,13.22,6.693ZM7.9,10.8A2.75,2.75,0,0,1,5.1,8,2.75,2.75,0,0,1,7.9,5.2,2.75,2.75,0,0,1,10.7,8,2.808,2.808,0,0,1,7.9,10.8Z" transform="translate(0.1)" fill="#0d2e4e"/>
  <rect id="Rectangle_24226" data-name="Rectangle 24226" width="16" height="16" fill="none"/>
</svg>
`},27890:A=>{A.exports=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="114" height="114" viewBox="0 0 114 114">
	<defs>
		<style>.tile-pane-metric-a{fill:url(#a);}.tile-pane-metric-b,.tile-pane-metric-c,.tile-pane-metric-d,.tile-pane-metric-e{fill:#fff;}.tile-pane-metric-b{font-size:12px;}.tile-pane-metric-b,.tile-pane-metric-c{font-family:OpenSans, Open Sans;}.tile-pane-metric-c{font-size:8px;}.tile-pane-metric-d{font-size:22px;font-family:Montserrat-SemiBold, Montserrat;font-weight:600;letter-spacing:0.081em;}</style>
		<linearGradient id="a" x1="0.5" x2="0.5" y2="1" gradientUnits="objectBoundingBox">
			<stop offset="0" stop-color="#0091ea" />
			<stop offset="1" stop-color="#0082cf" />
		</linearGradient>
	</defs>
	<rect class="tile-pane-metric-a" width="114" height="114" rx="8" />
	<text class="tile-pane-metric-b" transform="translate(42 21)">
		<tspan x="-33.826" y="0">Metric</tspan>
	</text>
	<text class="tile-pane-metric-c" transform="translate(8 102)">
		<tspan x="0" y="0">Templates</tspan>
	</text>
	<text class="tile-pane-metric-d" transform="translate(11 66)">
		<tspan x="0" y="0">XX</tspan>
	</text>
	<path class="tile-pane-metric-e" d="M3,0,6,5H0Z" transform="translate(55.5 96.5) rotate(90)" />
</svg>
`},87885:A=>{A.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M16 6H8c-.6 0-1-.4-1-1s.4-1 1-1h8c.6 0 1 .4 1 1s-.4 1-1 1zm0 14H8c-.6 0-1-.4-1-1s.4-1 1-1h8c.6 0 1 .4 1 1s-.4 1-1 1zm3-3c-.6 0-1-.4-1-1V8c0-.6.4-1 1-1s1 .4 1 1v8c0 .6-.4 1-1 1zM5 17c-.6 0-1-.4-1-1V8c0-.6.4-1 1-1s1 .4 1 1v8c0 .6-.4 1-1 1z"/><path d="M23 24H1c-.6 0-1-.4-1-1V1c0-.6.4-1 1-1h22c.6 0 1 .4 1 1v22c0 .6-.4 1-1 1zM2 22h20V2H2v20z"/></svg>'},25006:A=>{A.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000" xml:space="preserve">
  <path d="M143.6 500H10l178.2 178.2L366.4 500H232.7c0-147.4 119.8-267.3 267.3-267.3 45 0 87.8 11.1 124.7 31.2l65-65C635 164.1 569.9 143.6 500 143.6c-196.9 0-356.4 159.5-356.4 356.4zm623.7 0c0 147.4-119.8 267.3-267.3 267.3-45 0-87.8-11.1-124.7-31.2l-65 65c54.8 34.7 119.8 55.2 189.8 55.2 196.9 0 356.4-159.5 356.4-356.4H990L811.8 321.8 633.6 500h133.7z"/>
</svg>
`},45115:A=>{A.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="72" height="64">
	<g stroke="#70ACEE" stroke-width="0.5">
		<rect width="56" height="46" x="8" y="8" fill="#fff" rx="4"/>
		<rect width="55" height="45" x="8.5" y="8.5" fill="none" rx="3.5"/>
	</g>
	<g stroke="#d1d1d1" stroke-linecap="round" fill="none" stroke-width="4">
		<path d="M29 19 l-6 6 l6 6"></path>
		<path d="M39 19 l-6 23"></path>
		<path d="M43 30 l6 6 l-6 6"></path>
	</g>
</svg>
`},66576:A=>{A.exports=`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24">
  <defs>
    <path id="a" fill="#0d2e4e" d="M0,0H1.7V5.1H0V0"/>
    <path id="b" fill="#0d2e4e" d="M0,0H10.774V2.552H0V0"/>
  </defs>
  <rect width="24" height="24" fill="none" rx="4"/>
  <path fill="#0d2e4e" d="M0,0H4.031V2.552H0V0" transform="rotate(180 3.701 3.488)"/>
  <use xlink:href="#a" transform="rotate(180 4.23 4.125)"/>
  <use xlink:href="#a" transform="rotate(180 8.095 7.276)"/>
  <use xlink:href="#a" transform="rotate(180 4.095 10.421)"/>
  <path fill="#0d2e4e" d="M0,0H11.969V2.552H0V0" transform="rotate(180 7.67 6.634)"/>
  <path fill="#0d2e4e" d="M0,0H3.18V2.552H0V0" transform="rotate(180 3.276 9.823)"/>
  <use xlink:href="#b" transform="rotate(180 10.364 3.488)"/>
  <path fill="#0d2e4e" d="M0,0H3.122V2.552H0V0" transform="rotate(180 10.364 6.634)"/>
  <use xlink:href="#b" transform="rotate(180 10.364 9.823)"/>
</svg>
`},63893:A=>{A.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <g>
    <g fill="none">
      <path d="M0 0H24V24H0z"/>
      <path stroke="#0d2e4e" stroke-width="2" d="M26.432,24.593,23.268,43.581" transform="translate(-13.347 -22.087)"/>
      <path stroke="#0d2e4e" stroke-width="2" d="M7.6,0,3.8,4.008,0,0" transform="rotate(-90 15.053 .55)"/>
      <path stroke="#0d2e4e" stroke-width="2" d="M7.6,4.008,3.8,0,0,4.008" transform="rotate(-90 10.053 5.55)"/>
    </g>
  </g>
</svg>
`},70494:A=>{A.exports=`<svg id="tab-action-add" data-name="tab-action-add" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
  <g data-name="Group 2033" transform="translate(1 1)">
    <line class="tab-action-add-icon" data-name="Line 38" y2="12" transform="translate(7 1)" fill="none" stroke-width="2" stroke="currentColor"/>
    <line class="tab-action-add-icon" data-name="Line 39" y2="12" transform="translate(13 7) rotate(90)" fill="none" stroke-width="2" stroke="currentColor"/>
  </g>
  <rect id="Rectangle_23394" data-name="Rectangle 23394" width="16" height="16" fill="none"/>
</svg>
`},42702:A=>{A.exports=`<svg id="Delete" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
  <path id="Exclusion_3" data-name="Exclusion 3" d="M8.561,13H2.412L1,11.9V3H0V2H3V0H8V2h3l.012,1h-1v8.9L8.562,13ZM7,4v7H8V4ZM5,4v7H6V4ZM3,4v7H4V4ZM4,1V2H7V1Z" transform="translate(2.1 1.1)" fill="#0d2e4e"/>
  <rect id="Rectangle_1352" data-name="Rectangle 1352" width="16" height="16" fill="none"/>
</svg>
`},1781:A=>{A.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L3.71 8.71C3.08 8.08 2 8.52 2 9.41V15c0 .55.45 1 1 1h5.59c.89 0 1.34-1.08.71-1.71l-1.91-1.91c1.39-1.16 3.16-1.88 5.12-1.88 3.16 0 5.89 1.84 7.19 4.5.27.56.91.84 1.5.64.71-.23 1.07-1.04.75-1.72C20.23 10.42 16.65 8 12.5 8z"/></svg>
`},16153:A=>{A.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<line x1="4" y1="4.5" x2="12" y2="4.5" stroke="#0D2E4E"/>
<path d="M8 5V12" stroke="#0D2E4E"/>
<rect x="0.5" y="0.5" width="15" height="15" rx="1.5" stroke="#0D2E4E"/>
</svg>
`},49619:A=>{A.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<line x1="4" y1="4.5" x2="12" y2="4.5" stroke="#004FD6"/>
<path d="M8 5V12" stroke="#004FD6"/>
<rect x="0.5" y="0.5" width="15" height="15" rx="1.5" stroke="#004FD6"/>
</svg>
`}}]);
